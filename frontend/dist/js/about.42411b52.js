(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["about"],{"0040":function(t,e,n){"use strict";var r=function(){};t.exports=function(t){return{filterToEnabled:function(e,n){var i={main:[],facade:[]};return e?"string"===typeof e&&(e=[e]):e=[],t.forEach((function(t){t&&("websocket"!==t.transportName||!1!==n.websocket?e.length&&-1===e.indexOf(t.transportName)?r("not in whitelist",t.transportName):t.enabled(n)?(r("enabled",t.transportName),i.main.push(t),t.facadeTransport&&i.facade.push(t.facadeTransport)):r("disabled",t.transportName):r("disabled from server","websocket"))})),i}}}},"0072":function(t,e,n){},"01e1":function(t,e,n){var r=!1;if(Object.defineProperty)try{Object.defineProperty({},"x",{})}catch(g){r=!0}Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i});var i=n("faa1").EventEmitter,o=n("3fb5"),a=n("d30c"),s=n("8140"),c=5e3;function l(t){if(!t)return{};for(var e in t){var n=t[e];"string"==typeof n&&(t[e]={response:n})}return t}function u(t){if(t){if(t instanceof Function)return{send:t};if(t.send instanceof Function)return t;if(t.postMessage instanceof Function)return t.send=t.postMessage,t;if(t.write instanceof Function)return t.send=t.write,t;if(void 0===t.onmessage&&!(t.pause instanceof Function))throw new SyntaxError("Transport is not a function nor a valid object")}}function h(t,e){r?(this.method=t,this.params=e):(Object.defineProperty(this,"method",{value:t,enumerable:!0}),Object.defineProperty(this,"params",{value:e,enumerable:!0}))}function d(t,e,n,a){var d=this;if(!t)throw new SyntaxError("Packer is not defined");if(!t.pack||!t.unpack)throw new SyntaxError("Packer is invalid");var f=l(t.responseMethods);if(e instanceof Function){if(void 0!=n)throw new SyntaxError("There can't be parameters after onRequest");a=e,n=void 0,e=void 0}if(e&&e.send instanceof Function){if(n&&!(n instanceof Function))throw new SyntaxError("Only a function can be after transport");a=n,n=e,e=void 0}if(n instanceof Function){if(void 0!=a)throw new SyntaxError("There can't be parameters after onRequest");a=n,n=void 0}if(n&&n.send instanceof Function&&a&&!(a instanceof Function))throw new SyntaxError("Only a function can be after transport");e=e||{},i.call(this),a&&this.on("request",a),r?this.peerID=e.peerID:Object.defineProperty(this,"peerID",{value:e.peerID});var p=e.max_retries||0;function v(t){d.decode(t.data||t)}this.getTransport=function(){return n},this.setTransport=function(t){n&&(n.removeEventListener?n.removeEventListener("message",v):n.removeListener&&n.removeListener("data",v)),t&&(t.addEventListener?t.addEventListener("message",v):t.addListener&&t.addListener("data",v)),n=u(t)},r||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)}),this.setTransport(n);var m=e.request_timeout||c,b=e.ping_request_timeout||m,y=e.response_timeout||c,S=e.duplicates_timeout||c,w=0,E=new s,C=new s,x=new s,O={};function _(t,e,n){var r={message:t,timeout:setTimeout((function(){C.remove(e,n)}),y)};C.set(r,e,n)}function T(t,e){var n=setTimeout((function(){x.remove(t,e)}),S);x.set(n,t,e)}function k(e,n,i,o,a){h.call(this,e,n),this.getTransport=function(){return a},this.setTransport=function(t){a=u(t)},r||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)});var s=C.get(i,o);a||d.getTransport()||(r?this.duplicated=Boolean(s):Object.defineProperty(this,"duplicated",{value:Boolean(s)}));var c=f[e];this.pack=t.pack.bind(t,this,i),this.reply=function(e,n,r){if(e instanceof Function||e&&e.send instanceof Function){if(void 0!=n)throw new SyntaxError("There can't be parameters after callback");r=e,n=null,e=void 0}else if(n instanceof Function||n&&n.send instanceof Function){if(void 0!=r)throw new SyntaxError("There can't be parameters after callback");r=n,n=null}var a;if(r=u(r),s&&clearTimeout(s.timeout),void 0!=o&&(e&&(e.dest=o),n&&(n.dest=o)),e||void 0!=n){if(void 0!=d.peerID&&(e?e.from=d.peerID:n.from=d.peerID),c)if(void 0==c.error&&e)a={error:e};else{var l=e?c.error:c.response;a={method:l,params:e||n}}else a={error:e,result:n};a=t.pack(a,i)}else a=s?s.message:t.pack({result:null},i);return _(a,i,o),r=r||this.getTransport()||d.getTransport(),r?r.send(a):a}}function I(t){var e=O[t];if(e){delete O[t];var n=E.pop(e.id,e.dest);n&&(clearTimeout(n.timeout),T(e.id,e.dest))}}o(k,h),this.cancel=function(t){if(t)return I(t);for(var t in O)I(t)},this.close=function(){var t=this.getTransport();t&&t.close&&t.close(4003,"Cancel request"),this.cancel(),x.forEach(clearTimeout),C.forEach((function(t){clearTimeout(t.timeout)}))},this.encode=function(e,n,r,i,o){if(n instanceof Function){if(void 0!=r)throw new SyntaxError("There can't be parameters after callback");o=n,i=void 0,r=void 0,n=void 0}else if(r instanceof Function){if(void 0!=i)throw new SyntaxError("There can't be parameters after callback");o=r,i=void 0,r=void 0}else if(i instanceof Function){if(void 0!=o)throw new SyntaxError("There can't be parameters after callback");o=i,i=void 0}void 0!=d.peerID&&(n=n||{},n.from=d.peerID),void 0!=r&&(n=n||{},n.dest=r);var a={method:e,params:n};if(o){var s=w++,c=0;function l(t,e){d.cancel(a),o(t,e)}a=t.pack(a,s);var h={message:a,callback:l,responseMethods:f[e]||{}},g=u(i);function v(t){var n="ping"===e?b:m;return h.timeout=setTimeout(S,n*Math.pow(2,c++)),O[a]={id:s,dest:r},E.set(h,s,r),t=t||g||d.getTransport(),t?t.send(a):a}function y(t){t=u(t),console.warn(c+" retry for request message:",a);var e=x.pop(s,r);return clearTimeout(e),v(t)}function S(){if(c<p)return y(i);var t=new Error("Request has timed out");t.request=a,t.retry=y,l(t)}return v(i)}return a=t.pack(a),i=i||this.getTransport(),i?i.send(a):a},this.decode=function(e,n){if(!e)throw new TypeError("Message is not defined");try{e=t.unpack(e)}catch(g){return console.debug(g,e)}var r=e.id,i=e.ack,o=e.method,a=e.params||{},s=a.from,c=a.dest;if(void 0==d.peerID||s!=d.peerID){if(void 0==r&&void 0==i){var l=new h(o,a);if(d.emit("request",l))return;return l}if(o){if(void 0==c||c==d.peerID){var f=E.get(i,s);if(f){var p=f.responseMethods;return o==p.error?S(f,a):o==p.response?S(f,null,a):y()}var v=x.get(i,s);if(v)return w(v)}return y()}var m=e.error,b=e.result;if((!m||!m.dest||m.dest==d.peerID)&&(!b||!b.dest||b.dest==d.peerID)){f=E.get(i,s);if(!f){v=x.get(i,s);return v?w(v):console.warn("No callback was defined for this message",e)}S(f,m,b)}}function y(){if(n=u(n)||d.getTransport(),n){var t=C.get(r,s);if(t)return n.send(t.message)}var e=void 0!=r?r:i,c=new k(o,a,e,s,n);if(!d.emit("request",c))return c}function S(t,e,n){t.callback(e,n)}function w(t){console.warn("Response already processed",e),clearTimeout(t),T(i,s)}}}o(d,i),d.RpcNotification=h,t.exports=d;var f=n("498b"),p=n("79ef");d.clients=f,d.clients.transports=p,d.packers=a},"0299":function(t,e,n){"use strict";var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,a={},s=0,c=0;function l(t){var e="";do{e=i[t%o]+e,t=Math.floor(t/o)}while(t>0);return e}function u(t){var e=0;for(c=0;c<t.length;c++)e=e*o+a[t.charAt(c)];return e}function h(){var t=l(+new Date);return t!==r?(s=0,r=t):t+"."+l(s++)}for(;c<o;c++)a[i[c]]=c;h.encode=l,h.decode=u,t.exports=h},"043b":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.NetworkQualityLevelChangedEvent=void 0;var i=n("8733"),o=function(t){function e(e,n,r,i){var o=t.call(this,!1,e,"networkQualityLevelChanged")||this;return o.newValue=n,o.oldValue=r,o.connection=i,o}return r(e,t),e.prototype.callDefaultBehavior=function(){},e}(i.Event);e.NetworkQualityLevelChangedEvent=o},"0636":function(t,e,n){"use strict";n.r(e);var r=n("7a23"),i=function(t){return Object(r["pushScopeId"])("data-v-6e1c1dab"),t=t(),Object(r["popScopeId"])(),t},o={class:"container"},a=i((function(){return Object(r["createElementVNode"])("h1",{class:"form-title"},"스터디룸 수정",-1)})),s={class:"row d-flex justify-content-center"},c={class:"col-md-6 col-lg-5 col-xl-4"},l={class:"studyInfo-wrapper",enctype:"multipart/form-data"},u=i((function(){return Object(r["createElementVNode"])("label",{for:"studyName",class:"form-label"},"스터디 이름",-1)})),h={class:"mb-3"},d=i((function(){return Object(r["createElementVNode"])("label",{for:"goal",class:"form-label"},"스터디 목표",-1)})),f={class:"d-flex justify-content-start mb-4"},p={class:"dropend"},g={class:"image-wrapper scale",role:"button",id:"dropdownMenuLink","data-bs-toggle":"dropdown","aria-expanded":"false"},v=["src"],m={class:"dropdown-menu","aria-labelledby":"dropdownMenuLink"},b=i((function(){return Object(r["createElementVNode"])("li",null,[Object(r["createElementVNode"])("label",{for:"changeStudyImg",class:"dropdown-item img-form-label"},"스터디 이미지 선택")],-1)})),y={class:"form-group"};function S(t,e,n,i,S,w){var E=Object(r["resolveComponent"])("loading"),C=Object(r["resolveComponent"])("Navbar");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[Object(r["createVNode"])(E,{active:i.state.loading,"onUpdate:active":e[0]||(e[0]=function(t){return i.state.loading=t}),"can-cancel":!1,"is-full-page":!0,height:S.height,width:S.width,color:S.color,loader:S.loader,"background-color":S.bgColor,opacity:S.opacity,"lock-scroll":!1,class:"vld-overlay",style:Object(r["normalizeStyle"])(i.state.loading?"-webkit-backdrop-filter: blur(2px); backdrop-filter: blur(2px);":"")},null,8,["active","height","width","color","loader","background-color","opacity","style"]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(C),Object(r["createElementVNode"])("div",o,[a,Object(r["createElementVNode"])("div",s,[Object(r["createElementVNode"])("div",c,[Object(r["createElementVNode"])("section",null,[Object(r["createElementVNode"])("form",l,[Object(r["createElementVNode"])("div",null,[u,Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"text",class:"form-control",id:"studyName","onUpdate:modelValue":e[1]||(e[1]=function(t){return i.state.studyInfo.studyName=t}),required:"",maxlength:"20"},null,512),[[r["vModelText"],i.state.studyInfo.studyName]]),Object(r["createElementVNode"])("div",{style:Object(r["normalizeStyle"])({visibility:i.state.isValidStudyName||!i.state.wasInputed.studyName?"hidden":"visible"}),class:"invalid-feedback"}," 2~20자 사이로 작성해주세요. ",4)]),Object(r["createElementVNode"])("div",h,[d,Object(r["withDirectives"])(Object(r["createElementVNode"])("textarea",{class:"form-control form-goal",id:"studyGoal",rows:"3","onUpdate:modelValue":e[2]||(e[2]=function(t){return i.state.studyInfo.studyGoal=t}),placeholder:"스터디 목표를 한 줄로 표현해 보세요!",maxlength:"40"},null,512),[[r["vModelText"],i.state.studyInfo.studyGoal]])]),Object(r["createElementVNode"])("div",f,[Object(r["createElementVNode"])("div",p,[Object(r["createElementVNode"])("div",g,[Object(r["createElementVNode"])("img",{class:"study-img",src:i.state.studyImgSrc},null,8,v)]),Object(r["createElementVNode"])("ul",m,[b,Object(r["createElementVNode"])("li",null,[Object(r["createElementVNode"])("span",{onClick:e[3]||(e[3]=function(){return i.onClickDefaultImg&&i.onClickDefaultImg.apply(i,arguments)}),class:"dropdown-item img-revert-default"},"기본 이미지로 변경")])])]),Object(r["createElementVNode"])("div",y,[Object(r["createElementVNode"])("input",{onChange:e[4]||(e[4]=function(){return i.onClickUploadFile&&i.onClickUploadFile.apply(i,arguments)}),id:"changeStudyImg",type:"file",ref:"file",class:"form-control",accept:"image/*",style:{display:"none"}},null,544)])]),Object(r["createElementVNode"])("button",{onClick:e[5]||(e[5]=function(){return i.onClickUpdateStudy&&i.onClickUpdateStudy.apply(i,arguments)}),class:"btn btn-primary col-12"},"변경사항 수정")])])])])])])],64)}n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861");var w=n("5502"),E=n("6c02"),C=n("6c69"),x=n("ec16"),O=n("9062"),_=n.n(O),T=(n("e40d"),{name:"",data:function(){return{loader:"dots",color:"#334466",bgColor:"white",height:120,width:120,opacity:.2,lockScroll:!0}},components:{Navbar:C["a"],Loading:_.a},setup:function(){var t=Object(w["e"])(),e=Object(E["c"])(),i=Object(E["d"])(),o=Object(r["ref"])({studyInfo:Object(r["computed"])((function(){return t.state.study.studyInfo})),studyImage:"",updated:!1,studyImgSrc:Object(r["computed"])((function(){return o.value.studyInfo.studyImgUrl?o.value.studyInfo.studyImgUrl:n("f100")})),wasInputed:{studyName:!1},isValidStudyName:Object(r["computed"])((function(){return""!==o.value.studyInfo.studyName&&(o.value.wasInputed.studyName=!0),!(!o.value.studyInfo.studyName||!d(o.value.studyInfo.studyName))})),loading:!1}),a=Object(x["a"])(),s=a.notifySuccess,c=a.notifyDangerDescription;t.dispatch("GET_STUDY_INFO",e.params.studyId);var l=function(t){var e=t.target.files[0];if(e.size>2097152)return t.preventDefault(),void c("파일 사이즈가 너무 큽니다.😯","최대 2MB");o.value.studyInfo.studyImgUrl=URL.createObjectURL(e),o.value.studyImage=e,o.value.updated=!0},u=function(){o.value.studyInfo.studyImgURL="",o.value.studyInfo.studyImgUrl="",o.value.updated=!0},h=function(e){e.preventDefault();var n=new FormData;n.append("studyName",o.value.studyInfo.studyName),n.append("studyGoal",o.value.studyInfo.studyGoal),n.append("studyImage",o.value.studyImage),n.append("updated",o.value.updated),f(),t.dispatch("updateStudyInfo",{studyId:o.value.studyInfo.studyId,payload:n}),setTimeout((function(){s("스터디 정보 수정 완료!😙"),i.push({name:"StudyDetail"})}),1e3)},d=function(t){return t.length>=2&&t.length<=20};function f(){o.value.loading=!0,setTimeout((function(){o.value.loading=!1}),1e3)}return{state:o,onClickUploadFile:l,onClickDefaultImg:u,onClickUpdateStudy:h,loadingCall:f}}}),k=(n("4bd9"),n("6b0d")),I=n.n(k);const P=I()(T,[["render",S],["__scopeId","data-v-6e1c1dab"]]);e["default"]=P},"0703":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.StreamPropertyChangedEvent=void 0;var i=n("8733"),o=function(t){function e(e,n,r,i,o,a){var s=t.call(this,!1,e,"streamPropertyChanged")||this;return s.stream=n,s.changedProperty=r,s.newValue=i,s.oldValue=o,s.reason=a,s}return r(e,t),e.prototype.callDefaultBehavior=function(){},e}(i.Event);e.StreamPropertyChangedEvent=o},"0b64":function(t,e){function n(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=n,n.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(t){this.ms=t},n.prototype.setMax=function(t){this.max=t},n.prototype.setJitter=function(t){this.jitter=t}},"0cb2":function(t,e,n){var r=n("e330"),i=n("7b0b"),o=Math.floor,a=r("".charAt),s=r("".replace),c=r("".slice),l=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,n,r,h,d){var f=n+t.length,p=r.length,g=u;return void 0!==h&&(h=i(h),g=l),s(d,g,(function(i,s){var l;switch(a(s,0)){case"$":return"$";case"&":return t;case"`":return c(e,0,n);case"'":return c(e,f);case"<":l=h[c(s,1,-1)];break;default:var u=+s;if(0===u)return i;if(u>p){var d=o(u/10);return 0===d?i:d<=p?void 0===r[d-1]?a(s,1):r[d-1]+a(s,1):i}l=r[u-1]}return void 0===l?"":l}))}},"0cf2":function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{c(r.next(t))}catch(e){o(e)}}function s(t){try{c(r["throw"](t))}catch(e){o(e)}}function c(t){t.done?n(t.value):i(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return c([t,e])}}function c(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Stream=void 0;var o,a=n("ef86"),s=n("6e4e"),c=n("e649"),l=n("f852"),u=n("e9cb"),h=n("7bca"),d=n("1f15"),f=n("0703"),p=n("4edf"),g=n("f66e"),v=n("e237"),m=n("68cb"),b=n("e0ef"),y=g.OpenViduLogger.getInstance(),S=function(){function t(t,e){var n=this;this.isSubscribeToRemote=!1,this.isLocalStreamReadyToPublish=!1,this.isLocalStreamPublished=!1,this.publishedOnce=!1,this.harkSpeakingEnabled=!1,this.harkSpeakingEnabledOnce=!1,this.harkStoppedSpeakingEnabled=!1,this.harkStoppedSpeakingEnabledOnce=!1,this.harkVolumeChangeEnabled=!1,this.harkVolumeChangeEnabledOnce=!1,this.ee=new b,o=v.PlatformUtils.getInstance(),this.session=t,e.hasOwnProperty("id")?(this.inboundStreamOpts=e,this.streamId=this.inboundStreamOpts.id,this.creationTime=this.inboundStreamOpts.createdAt,this.hasAudio=this.inboundStreamOpts.hasAudio,this.hasVideo=this.inboundStreamOpts.hasVideo,this.hasAudio&&(this.audioActive=this.inboundStreamOpts.audioActive),this.hasVideo&&(this.videoActive=this.inboundStreamOpts.videoActive,this.typeOfVideo=this.inboundStreamOpts.typeOfVideo?this.inboundStreamOpts.typeOfVideo:void 0,this.frameRate=-1===this.inboundStreamOpts.frameRate?void 0:this.inboundStreamOpts.frameRate,this.videoDimensions=this.inboundStreamOpts.videoDimensions),this.inboundStreamOpts.filter&&Object.keys(this.inboundStreamOpts.filter).length>0&&(this.inboundStreamOpts.filter.lastExecMethod&&0===Object.keys(this.inboundStreamOpts.filter.lastExecMethod).length&&delete this.inboundStreamOpts.filter.lastExecMethod,this.filter=this.inboundStreamOpts.filter)):(this.outboundStreamOpts=e,this.hasAudio=this.isSendAudio(),this.hasVideo=this.isSendVideo(),this.hasAudio&&(this.audioActive=!!this.outboundStreamOpts.publisherProperties.publishAudio),this.hasVideo&&(this.videoActive=!!this.outboundStreamOpts.publisherProperties.publishVideo,this.frameRate=this.outboundStreamOpts.publisherProperties.frameRate,"undefined"!==typeof MediaStreamTrack&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?this.typeOfVideo="CUSTOM":this.typeOfVideo=this.isSendScreen()?"SCREEN":"CAMERA"),this.outboundStreamOpts.publisherProperties.filter&&(this.filter=this.outboundStreamOpts.publisherProperties.filter)),this.ee.on("mediastream-updated",(function(){n.streamManager.updateMediaStream(n.mediaStream),y.debug("Video srcObject ["+n.mediaStream+"] updated in stream ["+n.streamId+"]")}))}return t.prototype.reconnect=function(){return this.reconnectStream("API")},t.prototype.applyFilter=function(t,e){var n=this;return new Promise((function(r,i){n.session.sessionConnected()||i(n.session.notConnectedError()),y.info("Applying filter to stream "+n.streamId),e=null!=e?e:{};var o=e;"string"!==typeof o&&(o=JSON.stringify(o)),n.session.openvidu.sendRequest("applyFilter",{streamId:n.streamId,type:t,options:o},(function(o,s){if(o)y.error("Error applying filter for Stream "+n.streamId,o),401===o.code?i(new p.OpenViduError(p.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to apply a filter")):i(o);else{y.info("Filter successfully applied on Stream "+n.streamId);var c=n.filter;n.filter=new a.Filter(t,e),n.filter.stream=n,n.session.emitEvent("streamPropertyChanged",[new f.StreamPropertyChangedEvent(n.session,n,"filter",n.filter,c,"applyFilter")]),n.streamManager.emitEvent("streamPropertyChanged",[new f.StreamPropertyChangedEvent(n.streamManager,n,"filter",n.filter,c,"applyFilter")]),r(n.filter)}}))}))},t.prototype.removeFilter=function(){var t=this;return new Promise((function(e,n){t.session.sessionConnected()||n(t.session.notConnectedError()),y.info("Removing filter of stream "+t.streamId),t.session.openvidu.sendRequest("removeFilter",{streamId:t.streamId},(function(r,i){if(r)y.error("Error removing filter for Stream "+t.streamId,r),401===r.code?n(new p.OpenViduError(p.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to remove a filter")):n(r);else{y.info("Filter successfully removed from Stream "+t.streamId);var o=t.filter;delete t.filter,t.session.emitEvent("streamPropertyChanged",[new f.StreamPropertyChangedEvent(t.session,t,"filter",t.filter,o,"applyFilter")]),t.streamManager.emitEvent("streamPropertyChanged",[new f.StreamPropertyChangedEvent(t.streamManager,t,"filter",t.filter,o,"applyFilter")]),e()}}))}))},t.prototype.getRTCPeerConnection=function(){return this.webRtcPeer.pc},t.prototype.getMediaStream=function(){return this.mediaStream},t.prototype.setMediaStream=function(t){this.mediaStream=t},t.prototype.updateMediaStreamInVideos=function(){this.ee.emitEvent("mediastream-updated",[])},t.prototype.getWebRtcPeer=function(){return this.webRtcPeer},t.prototype.subscribeToMyRemote=function(t){this.isSubscribeToRemote=t},t.prototype.setOutboundStreamOptions=function(t){this.outboundStreamOpts=t},t.prototype.subscribe=function(){var t=this;return new Promise((function(e,n){t.initWebRtcPeerReceive(!1).then((function(){e()})).catch((function(t){n(t)}))}))},t.prototype.publish=function(){var t=this;return new Promise((function(e,n){t.isLocalStreamReadyToPublish?t.initWebRtcPeerSend(!1).then((function(){e()})).catch((function(t){n(t)})):t.ee.once("stream-ready-to-publish",(function(){t.publish().then((function(){e()})).catch((function(t){n(t)}))}))}))},t.prototype.disposeWebRtcPeer=function(){var t;this.webRtcPeer&&(this.webRtcPeer.dispose(),t=this.webRtcPeer.getId()),this.stopWebRtcStats(),y.info((this.outboundStreamOpts?"Outbound ":"Inbound ")+"RTCPeerConnection with id ["+t+"] from 'Stream' with id ["+this.streamId+"] is now closed")},t.prototype.disposeMediaStream=function(){this.mediaStream&&(this.mediaStream.getAudioTracks().forEach((function(t){t.stop()})),this.mediaStream.getVideoTracks().forEach((function(t){t.stop()})),delete this.mediaStream),this.localMediaStreamWhenSubscribedToRemote&&(this.localMediaStreamWhenSubscribedToRemote.getAudioTracks().forEach((function(t){t.stop()})),this.localMediaStreamWhenSubscribedToRemote.getVideoTracks().forEach((function(t){t.stop()})),delete this.localMediaStreamWhenSubscribedToRemote),this.speechEvent&&(this.speechEvent.stop&&this.speechEvent.stop(),delete this.speechEvent),y.info((this.outboundStreamOpts?"Local ":"Remote ")+"MediaStream from 'Stream' with id ["+this.streamId+"] is now disposed")},t.prototype.displayMyRemote=function(){return this.isSubscribeToRemote},t.prototype.isSendAudio=function(){return!!this.outboundStreamOpts&&null!==this.outboundStreamOpts.publisherProperties.audioSource&&!1!==this.outboundStreamOpts.publisherProperties.audioSource},t.prototype.isSendVideo=function(){return!!this.outboundStreamOpts&&null!==this.outboundStreamOpts.publisherProperties.videoSource&&!1!==this.outboundStreamOpts.publisherProperties.videoSource},t.prototype.isSendScreen=function(){var t="screen"===this.outboundStreamOpts.publisherProperties.videoSource;return o.isElectron()&&(t="string"===typeof this.outboundStreamOpts.publisherProperties.videoSource&&this.outboundStreamOpts.publisherProperties.videoSource.startsWith("screen:")),!!this.outboundStreamOpts&&t},t.prototype.enableHarkSpeakingEvent=function(){var t=this;this.setHarkListenerIfNotExists(),this.harkSpeakingEnabled||(this.harkSpeakingEnabled=!0,this.speechEvent.on("speaking",(function(){t.session.emitEvent("publisherStartSpeaking",[new h.PublisherSpeakingEvent(t.session,"publisherStartSpeaking",t.connection,t.streamId)]),t.streamManager.emitEvent("publisherStartSpeaking",[new h.PublisherSpeakingEvent(t.streamManager,"publisherStartSpeaking",t.connection,t.streamId)]),t.harkSpeakingEnabledOnce=!1})))},t.prototype.enableOnceHarkSpeakingEvent=function(){var t=this;this.setHarkListenerIfNotExists(),this.harkSpeakingEnabledOnce||(this.harkSpeakingEnabledOnce=!0,this.speechEvent.once("speaking",(function(){t.harkSpeakingEnabledOnce&&(t.session.emitEvent("publisherStartSpeaking",[new h.PublisherSpeakingEvent(t.session,"publisherStartSpeaking",t.connection,t.streamId)]),t.streamManager.emitEvent("publisherStartSpeaking",[new h.PublisherSpeakingEvent(t.streamManager,"publisherStartSpeaking",t.connection,t.streamId)])),t.disableHarkSpeakingEvent(!0)})))},t.prototype.disableHarkSpeakingEvent=function(t){if(this.speechEvent){if(this.harkSpeakingEnabledOnce=!1,t){if(this.harkSpeakingEnabled)return}else this.harkSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},t.prototype.enableHarkStoppedSpeakingEvent=function(){var t=this;this.setHarkListenerIfNotExists(),this.harkStoppedSpeakingEnabled||(this.harkStoppedSpeakingEnabled=!0,this.speechEvent.on("stopped_speaking",(function(){t.session.emitEvent("publisherStopSpeaking",[new h.PublisherSpeakingEvent(t.session,"publisherStopSpeaking",t.connection,t.streamId)]),t.streamManager.emitEvent("publisherStopSpeaking",[new h.PublisherSpeakingEvent(t.streamManager,"publisherStopSpeaking",t.connection,t.streamId)]),t.harkStoppedSpeakingEnabledOnce=!1})))},t.prototype.enableOnceHarkStoppedSpeakingEvent=function(){var t=this;this.setHarkListenerIfNotExists(),this.harkStoppedSpeakingEnabledOnce||(this.harkStoppedSpeakingEnabledOnce=!0,this.speechEvent.once("stopped_speaking",(function(){t.harkStoppedSpeakingEnabledOnce&&(t.session.emitEvent("publisherStopSpeaking",[new h.PublisherSpeakingEvent(t.session,"publisherStopSpeaking",t.connection,t.streamId)]),t.streamManager.emitEvent("publisherStopSpeaking",[new h.PublisherSpeakingEvent(t.streamManager,"publisherStopSpeaking",t.connection,t.streamId)])),t.disableHarkStoppedSpeakingEvent(!0)})))},t.prototype.disableHarkStoppedSpeakingEvent=function(t){if(this.speechEvent){if(this.harkStoppedSpeakingEnabledOnce=!1,t){if(this.harkStoppedSpeakingEnabled)return}else this.harkStoppedSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce?this.speechEvent.off("stopped_speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},t.prototype.enableHarkVolumeChangeEvent=function(t){var e=this;this.setHarkListenerIfNotExists()?this.harkVolumeChangeEnabled&&!t||(this.harkVolumeChangeEnabled=!0,this.speechEvent.on("volume_change",(function(t){var n=e.speechEvent.oldVolumeValue,r={newValue:t,oldValue:n};e.speechEvent.oldVolumeValue=t,e.streamManager.emitEvent("streamAudioVolumeChange",[new d.StreamManagerEvent(e.streamManager,"streamAudioVolumeChange",r)])}))):this.harkVolumeChangeEnabled=!0},t.prototype.enableOnceHarkVolumeChangeEvent=function(t){var e=this;this.setHarkListenerIfNotExists()?this.harkVolumeChangeEnabledOnce&&!t||(this.harkVolumeChangeEnabledOnce=!0,this.speechEvent.once("volume_change",(function(t){var n=e.speechEvent.oldVolumeValue,r={newValue:t,oldValue:n};e.speechEvent.oldVolumeValue=t,e.disableHarkVolumeChangeEvent(!0),e.streamManager.emitEvent("streamAudioVolumeChange",[new d.StreamManagerEvent(e.streamManager,"streamAudioVolumeChange",r)])}))):this.harkVolumeChangeEnabledOnce=!0},t.prototype.disableHarkVolumeChangeEvent=function(t){if(this.speechEvent){if(this.harkVolumeChangeEnabledOnce=!1,t){if(this.harkVolumeChangeEnabled)return}else this.harkVolumeChangeEnabled=!1;this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("volume_change"):(this.speechEvent.stop(),delete this.speechEvent)}},t.prototype.isLocal=function(){return!this.inboundStreamOpts&&!!this.outboundStreamOpts},t.prototype.getSelectedIceCandidate=function(){var t=this;return new Promise((function(e,n){t.webRtcStats.getSelectedIceCandidateInfo().then((function(t){return e(t)})).catch((function(t){return n(t)}))}))},t.prototype.getRemoteIceCandidateList=function(){return this.webRtcPeer.remoteCandidatesQueue},t.prototype.getLocalIceCandidateList=function(){return this.webRtcPeer.localCandidatesQueue},t.prototype.streamIceConnectionStateBroken=function(){if(!this.getWebRtcPeer()||!this.getRTCPeerConnection())return!1;if(this.isLocal()&&this.session.openvidu.advancedConfiguration.forceMediaReconnectionAfterNetworkDrop)return y.warn('OpenVidu Browser advanced configuration option "forceMediaReconnectionAfterNetworkDrop" is enabled. Stream '+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") will force a reconnection"),!0;var t=this.getRTCPeerConnection().iceConnectionState;return"connected"!==t&&"completed"!==t},t.prototype.setHarkListenerIfNotExists=function(){if(this.mediaStream){if(!this.speechEvent){var t=this.harkOptions?this.harkOptions:this.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{};t.interval="number"===typeof t.interval?t.interval:100,t.threshold="number"===typeof t.threshold?t.threshold:-50,this.speechEvent=m(this.mediaStream,t)}return!0}return!1},t.prototype.setupReconnectionEventEmitter=function(t,e){return void 0==this.reconnectionEventEmitter?(this.reconnectionEventEmitter=new b,!1):(console.warn("Trying to reconnect stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") but an ongoing reconnection process is active. Waiting for response..."),this.reconnectionEventEmitter.once("success",(function(){t()})),this.reconnectionEventEmitter.once("error",(function(t){e(t)})),!0)},t.prototype.initWebRtcPeerSend=function(t){var e=this;return new Promise((function(n,r){if(t){if(e.setupReconnectionEventEmitter(n,r))return}else e.initHarkEvents();var i=function(){var r;t&&(null===(r=e.reconnectionEventEmitter)||void 0===r||r.emitEvent("success"),delete e.reconnectionEventEmitter),n()},o=function(n){var i;t&&(null===(i=e.reconnectionEventEmitter)||void 0===i||i.emitEvent("error",[n]),delete e.reconnectionEventEmitter),r(n)},a=function(n){y.debug("Sending SDP offer to publish as "+e.streamId,n);var r,a=t?"reconnectStream":"publishVideo";if(t)r={stream:e.streamId,sdpString:n};else{var s="";e.isSendVideo()&&(s="undefined"!==typeof MediaStreamTrack&&e.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?"CUSTOM":e.isSendScreen()?"SCREEN":"CAMERA"),r={doLoopback:e.displayMyRemote()||!1,hasAudio:e.isSendAudio(),hasVideo:e.isSendVideo(),audioActive:e.audioActive,videoActive:e.videoActive,typeOfVideo:s,frameRate:e.frameRate?e.frameRate:-1,videoDimensions:JSON.stringify(e.videoDimensions),filter:e.outboundStreamOpts.publisherProperties.filter,sdpOffer:n}}e.session.openvidu.sendRequest(a,r,(function(n,r){n?401===n.code?o(new p.OpenViduError(p.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to publish")):o("Error on publishVideo: "+JSON.stringify(n)):e.webRtcPeer.processRemoteAnswer(r.sdpAnswer).then((function(){e.streamId=r.id,e.creationTime=r.createdAt,e.isLocalStreamPublished=!0,e.publishedOnce=!0,e.displayMyRemote()&&(e.localMediaStreamWhenSubscribedToRemote=e.mediaStream,e.remotePeerSuccessfullyEstablished(t)),t?e.ee.emitEvent("stream-reconnected-by-publisher",[]):e.ee.emitEvent("stream-created-by-publisher",[]),e.initWebRtcStats(),y.info("'Publisher' ("+e.streamId+") successfully "+(t?"reconnected":"published")+" to session"),i()})).catch((function(t){o(t)}))}))},s={mediaConstraints:{audio:e.hasAudio,video:e.hasVideo},simulcast:e.session.openvidu.advancedConfiguration.enableSimulcastExperimental||!1,onIceCandidate:e.connection.sendIceCandidate.bind(e.connection),onIceConnectionStateException:function(t,n,r){e.session.emitEvent("exception",[new u.ExceptionEvent(e.session,t,e,n,r)])},iceServers:e.getIceServersConf(),mediaStream:e.mediaStream,mediaServer:e.session.openvidu.mediaServer};t&&e.disposeWebRtcPeer(),e.displayMyRemote()?e.webRtcPeer=new c.WebRtcPeerSendrecv(s):e.webRtcPeer=new c.WebRtcPeerSendonly(s),e.webRtcPeer.addIceConnectionStateChangeListener("publisher of "+e.connection.connectionId),e.webRtcPeer.createOffer().then((function(t){e.webRtcPeer.processLocalOffer(t).then((function(){a(t.sdp)})).catch((function(t){o(new Error("(publish) SDP process local offer error: "+JSON.stringify(t)))}))})).catch((function(t){o(new Error("(publish) SDP create offer error: "+JSON.stringify(t)))}))}))},t.prototype.finalResolveForSubscription=function(t,e){var n;y.info("'Subscriber' ("+this.streamId+") successfully "+(t?"reconnected":"subscribed")),this.remotePeerSuccessfullyEstablished(t),this.initWebRtcStats(),t&&(null===(n=this.reconnectionEventEmitter)||void 0===n||n.emitEvent("success"),delete this.reconnectionEventEmitter),e()},t.prototype.finalRejectForSubscription=function(t,e,n){var r;y.error("Error for 'Subscriber' ("+this.streamId+") while trying to "+(t?"reconnect":"subscribe")+": "+e.toString()),t&&(null===(r=this.reconnectionEventEmitter)||void 0===r||r.emitEvent("error",[e]),delete this.reconnectionEventEmitter),n(e)},t.prototype.initWebRtcPeerReceive=function(t){var e=this;return new Promise((function(n,r){t&&e.setupReconnectionEventEmitter(n,r)||("mediasoup"===e.session.openvidu.mediaServer?e.initWebRtcPeerReceiveFromServer(t).then((function(){return e.finalResolveForSubscription(t,n)})).catch((function(n){return e.finalRejectForSubscription(t,n,r)})):e.initWebRtcPeerReceiveFromClient(t).then((function(){return e.finalResolveForSubscription(t,n)})).catch((function(n){return e.finalRejectForSubscription(t,n,r)})))}))},t.prototype.initWebRtcPeerReceiveFromClient=function(t){var e=this;return new Promise((function(n,r){e.completeWebRtcPeerReceive(t,!1).then((function(t){e.webRtcPeer.processRemoteAnswer(t.sdpAnswer).then((function(){return n()})).catch((function(t){return r(t)}))})).catch((function(t){return r(t)}))}))},t.prototype.initWebRtcPeerReceiveFromServer=function(t){var e=this;return new Promise((function(n,r){e.session.openvidu.sendRequest("prepareReceiveVideoFrom",{sender:e.streamId,reconnect:t},(function(i,o){i?r(new Error("Error on prepareReceiveVideoFrom: "+JSON.stringify(i))):e.completeWebRtcPeerReceive(t,!1,o.sdpOffer).then((function(){return n()})).catch((function(t){return r(t)}))}))}))},t.prototype.completeWebRtcPeerReceive=function(t,e,n){var r=this;return new Promise((function(i,o){y.debug("'Session.subscribe(Stream)' called");var a=function(a){y.debug("Sending local SDP "+(n?"answer":"offer")+" to subscribe to "+r.streamId,a);var s=t?"reconnectStream":"receiveVideoFrom",c={};c[t?"stream":"sender"]=r.streamId,n?c[t?"sdpString":"sdpAnswer"]=a:c["sdpOffer"]=a,t&&(c["forciblyReconnect"]=e),r.session.openvidu.sendRequest(s,c,(function(t,e){t?o(new Error("Error on "+s+" : "+JSON.stringify(t))):i(e)}))},s={mediaConstraints:{audio:r.hasAudio,video:r.hasVideo},simulcast:!1,onIceCandidate:r.connection.sendIceCandidate.bind(r.connection),onIceConnectionStateException:function(t,e,n){r.session.emitEvent("exception",[new u.ExceptionEvent(r.session,t,r,e,n)])},iceServers:r.getIceServersConf(),mediaServer:r.session.openvidu.mediaServer};t&&r.disposeWebRtcPeer(),r.webRtcPeer=new c.WebRtcPeerRecvonly(s),r.webRtcPeer.addIceConnectionStateChangeListener(r.streamId),n?r.webRtcPeer.processRemoteOffer(n).then((function(){r.webRtcPeer.createAnswer().then((function(t){r.webRtcPeer.processLocalAnswer(t).then((function(){a(t.sdp)})).catch((function(t){o(new Error("(subscribe) SDP process local answer error: "+JSON.stringify(t)))}))})).catch((function(t){o(new Error("(subscribe) SDP create answer error: "+JSON.stringify(t)))}))})).catch((function(t){o(new Error("(subscribe) SDP process remote offer error: "+JSON.stringify(t)))})):r.webRtcPeer.createOffer().then((function(t){r.webRtcPeer.processLocalOffer(t).then((function(){a(t.sdp)})).catch((function(t){o(new Error("(subscribe) SDP process local offer error: "+JSON.stringify(t)))}))})).catch((function(t){o(new Error("(subscribe) SDP create offer error: "+JSON.stringify(t)))}))}))},t.prototype.remotePeerSuccessfullyEstablished=function(t){var e;t&&null!=this.mediaStream&&this.disposeMediaStream(),this.mediaStream=new MediaStream;for(var n=0,r=this.webRtcPeer.pc.getReceivers();n<r.length;n++)e=r[n],e.track&&this.mediaStream.addTrack(e.track);if(y.debug("Peer remote stream",this.mediaStream),this.mediaStream){if(this.streamManager instanceof s.Subscriber){if(this.mediaStream.getAudioTracks()[0]){var i=t?this.audioActive:!!this.streamManager.properties.subscribeToAudio;this.mediaStream.getAudioTracks()[0].enabled=i}if(this.mediaStream.getVideoTracks()[0]){i=t?this.videoActive:!!this.streamManager.properties.subscribeToVideo;this.mediaStream.getVideoTracks()[0].enabled=i}}this.updateMediaStreamInVideos(),this.initHarkEvents()}},t.prototype.initHarkEvents=function(){this.mediaStream.getAudioTracks()[0]&&(this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!0,this.streamManager)&&this.enableOnceHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.streamManager)&&this.enableHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!0,this.streamManager)&&this.enableOnceHarkStoppedSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.streamManager)&&this.enableHarkStoppedSpeakingEvent(),this.harkVolumeChangeEnabledOnce&&this.enableOnceHarkVolumeChangeEvent(!0),this.harkVolumeChangeEnabled&&this.enableHarkVolumeChangeEvent(!0))},t.prototype.onIceConnectionStateExceptionHandler=function(t,e,n){switch(t){case u.ExceptionEventName.ICE_CONNECTION_FAILED:this.onIceConnectionFailed();break;case u.ExceptionEventName.ICE_CONNECTION_DISCONNECTED:this.onIceConnectionDisconnected();break}this.session.emitEvent("exception",[new u.ExceptionEvent(this.session,t,this,e,n)])},t.prototype.onIceConnectionFailed=function(){y.log("[ICE_CONNECTION_FAILED] Handling ICE_CONNECTION_FAILED event. Reconnecting stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+")"),this.reconnectStreamAndLogResultingIceConnectionState(u.ExceptionEventName.ICE_CONNECTION_FAILED)},t.prototype.onIceConnectionDisconnected=function(){var t=this;y.log("[ICE_CONNECTION_DISCONNECTED] Handling ICE_CONNECTION_DISCONNECTED event. Waiting for ICE to be restored and reconnect stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") if not possible");var e=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3;this.awaitWebRtcPeerConnectionState(e).then((function(n){switch(n){case"failed":y.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream "+t.streamId+" ("+(t.isLocal()?"Publisher":"Subscriber")+") is now failed after ICE_CONNECTION_DISCONNECTED");break;case"connected":case"completed":y.log("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream "+t.streamId+" ("+(t.isLocal()?"Publisher":"Subscriber")+") automatically restored after ICE_CONNECTION_DISCONNECTED. Current ICE connection state: "+n);break;case"closed":case"checking":case"new":case"disconnected":y.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream "+t.streamId+" ("+(t.isLocal()?"Publisher":"Subscriber")+") couldn't be restored after ICE_CONNECTION_DISCONNECTED event. Current ICE connection state after "+e+" ms: "+n),t.reconnectStreamAndLogResultingIceConnectionState(u.ExceptionEventName.ICE_CONNECTION_DISCONNECTED);break}}))},t.prototype.reconnectStreamAndLogResultingIceConnectionState=function(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.reconnectStreamAndReturnIceConnectionState(t)];case 1:switch(e=r.sent(),e){case"connected":case"completed":y.log("["+t+"] Stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") successfully reconnected after "+t+". Current ICE connection state: "+e);break;default:y.error("["+t+"] Stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") failed to reconnect after "+t+". Current ICE connection state: "+e);break}return[3,3];case 2:return n=r.sent(),y.error("["+t+"] Error reconnecting stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") after "+t+": "+n),[3,3];case 3:return[2]}}))}))},t.prototype.reconnectStreamAndReturnIceConnectionState=function(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:y.log("["+t+"] Reconnecting stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") after event "+t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.reconnectStream(t)];case 2:return r.sent(),e=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3,[2,this.awaitWebRtcPeerConnectionState(e)];case 3:return n=r.sent(),y.warn("["+t+"] Error reconnecting stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+"). Reason: "+n),[2,this.awaitWebRtcPeerConnectionState(1)];case 4:return[2]}}))}))},t.prototype.reconnectStream=function(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return[4,this.isWebsocketConnected(t,3e3)];case 1:if(e=r.sent(),e)return y.log("["+t+"] Trying to reconnect stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") and the websocket is opened"),this.isLocal()?[2,this.initWebRtcPeerSend(!0)]:[2,this.initWebRtcPeerReceive(!0)];throw n="["+t+"] Trying to reconnect stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") but the websocket wasn't opened",y.error(n),Error(n)}}))}))},t.prototype.isWebsocketConnected=function(t,e){var n=this;return new Promise((function(r,i){var o=n.session.openvidu.getWsReadyState();if(1===o){var a=setTimeout((function(){console.warn("["+t+"] Websocket timeout of "+e+"ms"),r(!1)}),e);n.session.openvidu.sendRequest("echo",{},(function(e,n){clearTimeout(a),e?(console.warn("["+t+"] Websocket 'echo' returned error: "+e),r(!1)):r(!0)}))}else console.warn("["+t+"] Websocket readyState is "+o),r(!1)}))},t.prototype.awaitWebRtcPeerConnectionState=function(t){return r(this,void 0,void 0,(function(){var e,n,r,o;return i(this,(function(i){switch(i.label){case 0:e=this.getRTCPeerConnection().iceConnectionState,n=150,r=Math.ceil(t/n),o=0,i.label=1;case 1:return o<r?(e=this.getRTCPeerConnection().iceConnectionState,"connected"===e||"completed"===e?[3,4]:[4,new Promise((function(t){return setTimeout(t,n)}))]):[3,4];case 2:i.sent(),i.label=3;case 3:return o++,[3,1];case 4:return[2,e]}}))}))},t.prototype.initWebRtcStats=function(){this.webRtcStats=new l.WebRtcStats(this),this.webRtcStats.initWebRtcStats()},t.prototype.stopWebRtcStats=function(){this.webRtcStats&&this.webRtcStats.isEnabled()&&this.webRtcStats.stopWebRtcStats()},t.prototype.getIceServersConf=function(){var t;return t=this.session.openvidu.advancedConfiguration.iceServers?"freeice"===this.session.openvidu.advancedConfiguration.iceServers?void 0:this.session.openvidu.advancedConfiguration.iceServers:this.session.openvidu.iceServers?this.session.openvidu.iceServers:void 0,t},t.prototype.gatherStatsForPeer=function(){var t=this;return new Promise((function(e,n){t.isLocal()?t.getRTCPeerConnection().getSenders().forEach((function(e){return e.getStats().then((function(e){e.forEach((function(e){if(t.isReportWanted(e)){var n={};n["type"]=e.type,n["timestamp"]=e.timestamp,n["id"]=e.id,"outbound-rtp"===e.type&&(n["ssrc"]=e.ssrc,n["firCount"]=e.firCount,n["pliCount"]=e.pliCount,n["nackCount"]=e.nackCount,n["qpSum"]=e.qpSum,e.kind?n["mediaType"]=e.kind:e.mediaType?n["mediaType"]=e.mediaType:n["mediaType"]=-1!==e.id.indexOf("VideoStream")?"video":"audio","video"===n["mediaType"]&&(n["framesEncoded"]=e.framesEncoded),n["packetsSent"]=e.packetsSent,n["bytesSent"]=e.bytesSent),"candidate-pair"===e.type&&void 0!==e.totalRoundTripTime&&(n["availableOutgoingBitrate"]=e.availableOutgoingBitrate,n["rtt"]=e.currentRoundTripTime,n["averageRtt"]=e.totalRoundTripTime/e.responsesReceived),"remote-inbound-rtp"===e.type||e.type,y.log(n)}}))}))})):t.getRTCPeerConnection().getReceivers().forEach((function(e){return e.getStats().then((function(e){e.forEach((function(e){if(t.isReportWanted(e)){var n={};n["type"]=e.type,n["timestamp"]=e.timestamp,n["id"]=e.id,"inbound-rtp"===e.type&&(n["ssrc"]=e.ssrc,n["firCount"]=e.firCount,n["pliCount"]=e.pliCount,n["nackCount"]=e.nackCount,n["qpSum"]=e.qpSum,e.kind?n["mediaType"]=e.kind:e.mediaType?n["mediaType"]=e.mediaType:n["mediaType"]=-1!==e.id.indexOf("VideoStream")?"video":"audio","video"===n["mediaType"]&&(n["framesDecoded"]=e.framesDecoded),n["packetsReceived"]=e.packetsReceived,n["packetsLost"]=e.packetsLost,n["jitter"]=e.jitter,n["bytesReceived"]=e.bytesReceived),"candidate-pair"===e.type&&void 0!==e.totalRoundTripTime&&(n["availableIncomingBitrate"]=e.availableIncomingBitrate,n["rtt"]=e.currentRoundTripTime,n["averageRtt"]=e.totalRoundTripTime/e.responsesReceived),"remote-inbound-rtp"===e.type||e.type,y.log(n)}}))}))}))}))},t.prototype.isReportWanted=function(t){return"inbound-rtp"===t.type&&!this.isLocal()||"outbound-rtp"===t.type&&this.isLocal()||"candidate-pair"===t.type&&t.nominated&&t.bytesSent>0},t}();e.Stream=S},"0d16":function(t,e,n){},"0e88":function(t,e,n){"use strict";var r=n("3fb5"),i=n("ada0").EventEmitter,o=function(){};function a(t,e,n){o(e),i.call(this),this.Receiver=t,this.receiveUrl=e,this.AjaxObject=n,this._scheduleReceiver()}r(a,i),a.prototype._scheduleReceiver=function(){o("_scheduleReceiver");var t=this,e=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);e.on("message",(function(e){o("message",e),t.emit("message",e)})),e.once("close",(function(n,r){o("close",n,r,t.pollIsClosing),t.poll=e=null,t.pollIsClosing||("network"===r?t._scheduleReceiver():(t.emit("close",n||1006,r),t.removeAllListeners()))}))},a.prototype.abort=function(){o("abort"),this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},t.exports=a},"0f3b":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventDispatcher=void 0;var r=n("e0ef"),i=n("f66e"),o=i.OpenViduLogger.getInstance(),a=function(){function t(){this.userHandlerArrowHandler=new WeakMap,this.ee=new r}return t.prototype.off=function(t,e){if(e){var n=this.userHandlerArrowHandler.get(e);n&&this.ee.off(t,n),this.userHandlerArrowHandler.delete(e)}else this.ee.removeAllListeners(t);return this},t.prototype.onAux=function(t,e,n){var r=function(t){t?o.info(e,t):o.info(e),n(t)};return this.userHandlerArrowHandler.set(n,r),this.ee.on(t,r),this},t.prototype.onceAux=function(t,e,n){var r=this,i=function(t){t?o.info(e,t):o.info(e),n(t),r.userHandlerArrowHandler.delete(n)};return this.userHandlerArrowHandler.set(n,i),this.ee.once(t,i),this},t}();e.EventDispatcher=a},1:function(t,e){},1015:function(t,e){t.exports="1.5.2"},"103a":function(t,e,n){var r=n("01e1"),i=n("714c"),o=n("f66e").OpenViduLogger;Date.now=Date.now||function(){return+new Date};var a=5e3,s="RECONNECTING",c="CONNECTED",l="DISCONNECTED",u=o.getInstance();function h(t){var e,n=this,o=t.ws,h=-1,d=0,f=!0,p=!1,g=l,v=o.onreconnecting,m=o.onreconnected,b=o.onconnected,y=o.onerror;t.rpc.pull=function(t,e){e.reply(null,"push")},o.onreconnecting=function(){u.debug("--------- ONRECONNECTING -----------"),g!==s?(_(),g=s,v&&v()):u.error("Websocket already in RECONNECTING state when receiving a new ONRECONNECTING message. Ignoring it")},o.onreconnected=function(){u.debug("--------- ONRECONNECTED -----------"),g!==c?(g=c,C(),m&&m()):u.error("Websocket already in CONNECTED state when receiving a new ONRECONNECTED message. Ignoring it")},o.onconnected=function(){u.debug("--------- ONCONNECTED -----------"),g!==c?(g=c,f=!0,O(),b&&b()):u.error("Websocket already in CONNECTED state when receiving a new ONCONNECTED message. Ignoring it")},o.onerror=function(t){u.debug("--------- ONERROR -----------"),g=l,_(),y&&y(t)};var S=new i(o);u.debug("Connecting websocket to URI: "+o.uri);var w={request_timeout:t.rpc.requestTimeout,ping_request_timeout:t.rpc.heartbeatRequestTimeout},E=new r(r.packers.JsonRPC,w,S,(function(e){u.debug("Received request: "+JSON.stringify(e));try{var n=t.rpc[e.method];void 0===n?u.error("Method "+e.method+" not registered in client"):n(e.params,e)}catch(r){u.error("Exception processing request: "+JSON.stringify(e)),u.error(r)}}));function C(){u.debug("notReconnectIfNumLessThan = "+d+" (old="+h+")"),h=d}function x(){if(f){var e=null;0!=d&&d!=h||(e={interval:t.heartbeat||a}),d++,n.send("ping",e,function(t){return function(e,n){e&&(u.debug("Error in ping request #"+t+" ("+e.message+")"),t>h&&(f=!1,C(),u.debug("Server did not respond to ping message #"+t+". Reconnecting... "),S.reconnectWs()))}}(d))}else u.debug("Trying to send ping, but ping is not enabled")}function O(){p||(u.debug("Starting ping (if configured)"),p=!0,void 0!=t.heartbeat&&(e=setInterval(x,t.heartbeat),x()))}function _(){clearInterval(e),p=!1,f=!1,d=-1,E.cancel()}this.send=function(t,e,n){var r=Date.now();E.encode(t,e,(function(i,o){if(i){try{u.error("ERROR:"+i.message+" in Request: method:"+t+" params:"+JSON.stringify(e)+" request:"+i.request),i.data&&u.error("ERROR DATA:"+JSON.stringify(i.data))}catch(a){}i.requestTime=r}n&&(void 0!=o&&"pong"!==o.value&&u.debug("Response: "+JSON.stringify(o)),n(i,o))}))},this.close=function(t,n){u.debug("Closing  with code: "+t+" because: "+n),void 0!=e&&(u.debug("Clearing ping interval"),clearInterval(e)),p=!1,f=!1,S.close(t,n)},this.forceClose=function(t){S.forceClose(t)},this.reconnect=function(){S.reconnectWs()},this.resetPing=function(){f=!0,d=0,O()},this.getReadyState=function(){return S.getReadyState()}}t.exports=h},1066:function(t,e,n){},1148:function(t,e,n){"use strict";var r=n("da84"),i=n("5926"),o=n("577e"),a=n("1d80"),s=r.RangeError;t.exports=function(t){var e=o(a(this)),n="",r=i(t);if(r<0||r==1/0)throw s("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(n+=e);return n}},"11c5":function(t,e){var n,r,i="screen";if("undefined"!==typeof window&&"undefined"!==typeof navigator&&"undefined"!==typeof navigator.userAgent){var o="undefined"!==typeof window.InstallTrigger,a=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;window.chrome;window.addEventListener("message",(function(t){t.origin==window.location.origin&&s(t.data)}))}function s(t){if("PermissionDeniedError"==t){if(r)return r("PermissionDeniedError");throw new Error("PermissionDeniedError")}"rtcmulticonnection-extension-loaded"==t&&(i="desktop"),t.sourceId&&r&&r(n=t.sourceId,!0===t.canRequestAudioTrack)}function c(t){if(t){if("desktop"==i)return t(!0);window.postMessage("are-you-there","*"),setTimeout((function(){t("screen"!=i)}),2e3)}}function l(t){if(!t)throw'"callback" parameter is mandatory.';if(n)return t(n);r=t,window.postMessage("get-sourceId","*")}function u(t){if(!t)throw'"callback" parameter is mandatory.';if(n)return t(n);r=t,window.postMessage("audio-plus-tab","*")}function h(t,e){if(o)return e("not-chrome");2!=arguments.length&&(e=t,t="lfcgfepafnobdloecchnfaclibenjold");var n=document.createElement("img");n.src="chrome-extension://"+t+"/icon.png",n.onload=function(){i="screen",window.postMessage("are-you-there","*"),setTimeout((function(){e("screen"==i?"installed-disabled":"installed-enabled")}),2e3)},n.onerror=function(){e("not-installed")}}function d(t){f(t,!0)}function f(t,e){n="";var r={mozMediaSource:"window",mediaSource:"window"};if(o)return t(null,r);var a={mandatory:{chromeMediaSource:i,maxWidth:screen.width>1920?screen.width:1920,maxHeight:screen.height>1080?screen.height:1080},optional:[]};"desktop"!=i||n?("desktop"==i&&(a.mandatory.chromeMediaSourceId=n),t(null,a)):e?u((function(e,n){a.mandatory.chromeMediaSourceId=e,n&&(a.canRequestAudioTrack=!0),t("PermissionDeniedError"==e?e:null,a)})):l((function(e){a.mandatory.chromeMediaSourceId=e,t("PermissionDeniedError"==e?e:null,a)}))}e.getScreenConstraints=f,e.getScreenConstraintsWithAudio=d,e.isChromeExtensionAvailable=c,e.getChromeExtensionStatus=h,e.getSourceId=l},1276:function(t,e,n){"use strict";var r=n("2ba4"),i=n("c65b"),o=n("e330"),a=n("d784"),s=n("44e7"),c=n("825a"),l=n("1d80"),u=n("4840"),h=n("8aa5"),d=n("50c4"),f=n("577e"),p=n("dc4a"),g=n("4dae"),v=n("14c3"),m=n("9263"),b=n("9f7f"),y=n("d039"),S=b.UNSUPPORTED_Y,w=4294967295,E=Math.min,C=[].push,x=o(/./.exec),O=o(C),_=o("".slice),T=!y((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));a("split",(function(t,e,n){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var o=f(l(this)),a=void 0===n?w:n>>>0;if(0===a)return[];if(void 0===t)return[o];if(!s(t))return i(e,o,t,a);var c,u,h,d=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),v=0,b=new RegExp(t.source,p+"g");while(c=i(m,b,o)){if(u=b.lastIndex,u>v&&(O(d,_(o,v,c.index)),c.length>1&&c.index<o.length&&r(C,d,g(c,1)),h=c[0].length,v=u,d.length>=a))break;b.lastIndex===c.index&&b.lastIndex++}return v===o.length?!h&&x(b,"")||O(d,""):O(d,_(o,v)),d.length>a?g(d,0,a):d}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:i(e,this,t,n)}:e,[function(e,n){var r=l(this),a=void 0==e?void 0:p(e,t);return a?i(a,e,r,n):i(o,f(r),e,n)},function(t,r){var i=c(this),a=f(t),s=n(o,i,a,r,o!==e);if(s.done)return s.value;var l=u(i,RegExp),p=i.unicode,g=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(S?"g":"y"),m=new l(S?"^(?:"+i.source+")":i,g),b=void 0===r?w:r>>>0;if(0===b)return[];if(0===a.length)return null===v(m,a)?[a]:[];var y=0,C=0,x=[];while(C<a.length){m.lastIndex=S?0:C;var T,k=v(m,S?_(a,C):a);if(null===k||(T=E(d(m.lastIndex+(S?C:0)),a.length))===y)C=h(a,C,p);else{if(O(x,_(a,y,C)),x.length===b)return x;for(var I=1;I<=k.length-1;I++)if(O(x,k[I]),x.length===b)return x;C=y=T}}return O(x,_(a,y)),x}]}),!T,S)},"132d":function(t,e,n){},"13c0":function(t,e,n){"use strict";(function(e){var n=e.WebSocket||e.MozWebSocket;t.exports=n?function(t){return new n(t)}:void 0}).call(this,n("c8ba"))},"14c3":function(t,e,n){var r=n("da84"),i=n("c65b"),o=n("825a"),a=n("1626"),s=n("c6b6"),c=n("9263"),l=r.TypeError;t.exports=function(t,e){var n=t.exec;if(a(n)){var r=i(n,t,e);return null!==r&&o(r),r}if("RegExp"===s(t))return i(c,t,e);throw l("RegExp#exec called on incompatible receiver")}},1548:function(t,e,n){"use strict";var r=n("3fb5"),i=n("ada0").EventEmitter,o=function(){};function a(t,e){o(t),i.call(this);var n=this;this.bufferPosition=0,this.xo=new e("POST",t,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",(function(t,e){o("finish",t,e),n._chunkHandler(t,e),n.xo=null;var r=200===t?"network":"permanent";o("close",r),n.emit("close",null,r),n._cleanup()}))}r(a,i),a.prototype._chunkHandler=function(t,e){if(o("_chunkHandler",t),200===t&&e)for(var n=-1;;this.bufferPosition+=n+1){var r=e.slice(this.bufferPosition);if(n=r.indexOf("\n"),-1===n)break;var i=r.slice(0,n);i&&(o("message",i),this.emit("message",i))}},a.prototype._cleanup=function(){o("_cleanup"),this.removeAllListeners()},a.prototype.abort=function(){o("abort"),this.xo&&(this.xo.close(),o("close"),this.emit("close",null,"user"),this.xo=null),this._cleanup()},t.exports=a},"16f9":function(t,e,n){},1816:function(t,e,n){"use strict";(function(e){var r=n("440d"),i=n("9c59"),o=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,a=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,s=/^[a-zA-Z]:/,c="[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]",l=new RegExp("^"+c+"+");function u(t){return(t||"").toString().replace(l,"")}var h=[["#","hash"],["?","query"],function(t,e){return p(e.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],d={hash:1,query:1};function f(t){var n;n="undefined"!==typeof window?window:"undefined"!==typeof e?e:"undefined"!==typeof self?self:{};var r=n.location||{};t=t||r;var i,a={},s=typeof t;if("blob:"===t.protocol)a=new m(unescape(t.pathname),{});else if("string"===s)for(i in a=new m(t,{}),d)delete a[i];else if("object"===s){for(i in t)i in d||(a[i]=t[i]);void 0===a.slashes&&(a.slashes=o.test(t.href))}return a}function p(t){return"file:"===t||"ftp:"===t||"http:"===t||"https:"===t||"ws:"===t||"wss:"===t}function g(t,e){t=u(t),e=e||{};var n,r=a.exec(t),i=r[1]?r[1].toLowerCase():"",o=!!r[2],s=!!r[3],c=0;return o?s?(n=r[2]+r[3]+r[4],c=r[2].length+r[3].length):(n=r[2]+r[4],c=r[2].length):s?(n=r[3]+r[4],c=r[3].length):n=r[4],"file:"===i?c>=2&&(n=n.slice(2)):p(i)?n=r[4]:i?o&&(n=n.slice(2)):c>=2&&p(e.protocol)&&(n=r[4]),{protocol:i,slashes:o||p(i),slashesCount:c,rest:n}}function v(t,e){if(""===t)return e;var n=(e||"/").split("/").slice(0,-1).concat(t.split("/")),r=n.length,i=n[r-1],o=!1,a=0;while(r--)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),a++):a&&(0===r&&(o=!0),n.splice(r,1),a--);return o&&n.unshift(""),"."!==i&&".."!==i||n.push(""),n.join("/")}function m(t,e,n){if(t=u(t),!(this instanceof m))return new m(t,e,n);var o,a,c,l,d,b,y=h.slice(),S=typeof e,w=this,E=0;for("object"!==S&&"string"!==S&&(n=e,e=null),n&&"function"!==typeof n&&(n=i.parse),e=f(e),a=g(t||"",e),o=!a.protocol&&!a.slashes,w.slashes=a.slashes||o&&e.slashes,w.protocol=a.protocol||e.protocol||"",t=a.rest,("file:"===a.protocol&&(2!==a.slashesCount||s.test(t))||!a.slashes&&(a.protocol||a.slashesCount<2||!p(w.protocol)))&&(y[3]=[/(.*)/,"pathname"]);E<y.length;E++)l=y[E],"function"!==typeof l?(c=l[0],b=l[1],c!==c?w[b]=t:"string"===typeof c?~(d=t.indexOf(c))&&("number"===typeof l[2]?(w[b]=t.slice(0,d),t=t.slice(d+l[2])):(w[b]=t.slice(d),t=t.slice(0,d))):(d=c.exec(t))&&(w[b]=d[1],t=t.slice(0,d.index)),w[b]=w[b]||o&&l[3]&&e[b]||"",l[4]&&(w[b]=w[b].toLowerCase())):t=l(t,w);n&&(w.query=n(w.query)),o&&e.slashes&&"/"!==w.pathname.charAt(0)&&(""!==w.pathname||""!==e.pathname)&&(w.pathname=v(w.pathname,e.pathname)),"/"!==w.pathname.charAt(0)&&p(w.protocol)&&(w.pathname="/"+w.pathname),r(w.port,w.protocol)||(w.host=w.hostname,w.port=""),w.username=w.password="",w.auth&&(l=w.auth.split(":"),w.username=l[0],w.password=l[1]||""),w.origin="file:"!==w.protocol&&p(w.protocol)&&w.host?w.protocol+"//"+w.host:"null",w.href=w.toString()}function b(t,e,n){var o=this;switch(t){case"query":"string"===typeof e&&e.length&&(e=(n||i.parse)(e)),o[t]=e;break;case"port":o[t]=e,r(e,o.protocol)?e&&(o.host=o.hostname+":"+e):(o.host=o.hostname,o[t]="");break;case"hostname":o[t]=e,o.port&&(e+=":"+o.port),o.host=e;break;case"host":o[t]=e,/:\d+$/.test(e)?(e=e.split(":"),o.port=e.pop(),o.hostname=e.join(":")):(o.hostname=e,o.port="");break;case"protocol":o.protocol=e.toLowerCase(),o.slashes=!n;break;case"pathname":case"hash":if(e){var a="pathname"===t?"/":"#";o[t]=e.charAt(0)!==a?a+e:e}else o[t]=e;break;case"username":case"password":o[t]=encodeURIComponent(e);break;case"auth":var s=e.split(":");o.username=s[0],o.password=2===s.length?s[1]:""}for(var c=0;c<h.length;c++){var l=h[c];l[4]&&(o[l[1]]=o[l[1]].toLowerCase())}return o.auth=o.password?o.username+":"+o.password:o.username,o.origin="file:"!==o.protocol&&p(o.protocol)&&o.host?o.protocol+"//"+o.host:"null",o.href=o.toString(),o}function y(t){t&&"function"===typeof t||(t=i.stringify);var e,n=this,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var o=r+(n.protocol&&n.slashes||p(n.protocol)?"//":"");return n.username?(o+=n.username,n.password&&(o+=":"+n.password),o+="@"):n.password&&(o+=":"+n.password,o+="@"),o+=n.host+n.pathname,e="object"===typeof n.query?t(n.query):n.query,e&&(o+="?"!==e.charAt(0)?"?"+e:e),n.hash&&(o+=n.hash),o}m.prototype={set:b,toString:y},m.extractProtocol=g,m.location=f,m.trimLeft=u,m.qs=i,t.exports=m}).call(this,n("c8ba"))},"194a":function(t,e,n){"use strict";n("5e2d")},"1c8c":function(t,e,n){t.exports=n.p+"img/trash-1E304F.9b87f60c.svg"},"1cb0":function(t,e,n){"use strict";n("0d16")},"1f15":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.StreamManagerEvent=void 0;var i=n("8733"),o=function(t){function e(e,n,r){var i=t.call(this,!1,e,n)||this;return i.value=r,i}return r(e,t),e.prototype.callDefaultBehavior=function(){},e}(i.Event);e.StreamManagerEvent=o},"1f49":function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return d}));var r=n("34ba"),i=n("4f2a"),o=n.n(i),a=n("0299"),s=n.n(a),c=n("af7f"),l=n("744a"),u=n("33e8");const h="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class d extends r["a"]{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,n=h?{}:Object(c["b"])(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=l["d"]&&!h?e?new l["a"](t,e):new l["a"](t):new l["a"](t,e,n)}catch(r){return this.emit("error",r)}this.ws.binaryType=this.socket.binaryType||l["b"],this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],i=n===e.length-1;Object(u["c"])(r,this.supportsBinary,e=>{const n={};if(!l["d"]&&(r.options&&(n.compress=r.options.compress),this.opts.perMessageDeflate)){const r="string"===typeof e?t.byteLength(e):e.length;r<this.opts.perMessageDeflate.threshold&&(n.compress=!1)}try{l["d"]?this.ws.send(e):this.ws.send(e,n)}catch(o){}i&&Object(l["c"])(()=>{this.writable=!0,this.emit("drain")},this.setTimeoutFn)})}}doClose(){"undefined"!==typeof this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let n="";this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=s()()),this.supportsBinary||(t.b64=1);const r=o.a.encode(t),i=-1!==this.opts.hostname.indexOf(":");return e+"://"+(i?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}check(){return!!l["a"]&&!("__initialize"in l["a"]&&this.name===d.prototype.name)}}}).call(this,n("b639").Buffer)},"1fb5":function(t,e,n){"use strict";e.byteLength=u,e.toByteArray=d,e.fromByteArray=g;for(var r=[],i=[],o="undefined"!==typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");-1===n&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function u(t){var e=l(t),n=e[0],r=e[1];return 3*(n+r)/4-r}function h(t,e,n){return 3*(e+n)/4-n}function d(t){var e,n,r=l(t),a=r[0],s=r[1],c=new o(h(t,a,s)),u=0,d=s>0?a-4:a;for(n=0;n<d;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],c[u++]=e>>16&255,c[u++]=e>>8&255,c[u++]=255&e;return 2===s&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,c[u++]=255&e),1===s&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,c[u++]=e>>8&255,c[u++]=255&e),c}function f(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function p(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),i.push(f(r));return i.join("")}function g(t){for(var e,n=t.length,i=n%3,o=[],a=16383,s=0,c=n-i;s<c;s+=a)o.push(p(t,s,s+a>c?c:s+a));return 1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},2:function(t,e){},"20a4":function(t,e,n){"use strict";e["a"]=(()=>"undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")())()},"21a2":function(t,e,n){"use strict";n("0072")},2532:function(t,e,n){"use strict";var r=n("23e7"),i=n("e330"),o=n("5a34"),a=n("1d80"),s=n("577e"),c=n("ab13"),l=i("".indexOf);r({target:"String",proto:!0,forced:!c("includes")},{includes:function(t){return!!~l(s(a(this)),s(o(t)),arguments.length>1?arguments[1]:void 0)}})},2533:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__awaiter||function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{c(r.next(t))}catch(e){o(e)}}function s(t){try{c(r["throw"](t))}catch(e){o(e)}}function c(t){t.done?n(t.value):i(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return c([t,e])}}function c(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Session=void 0;var a,s=n("af24"),c=n("ef86"),l=n("6e4e"),u=n("0f3b"),h=n("f0a5"),d=n("fa28"),f=n("ad42"),p=n("92c2"),g=n("b2e1"),v=n("4def"),m=n("0703"),b=n("f1bf"),y=n("043b"),S=n("4edf"),w=n("fdd2"),E=n("f66e"),C=n("e237"),x=E.OpenViduLogger.getInstance(),O=function(t){function e(e){var n=t.call(this)||this;return n.streamManagers=[],n.remoteStreamsCreated=new Map,n.remoteConnections=new Map,a=C.PlatformUtils.getInstance(),n.openvidu=e,n}return r(e,t),e.prototype.connect=function(t,e){var n=this;return new Promise((function(r,i){n.processToken(t),n.openvidu.checkSystemRequirements()?(n.options={sessionId:n.sessionId,participantId:t,metadata:e?n.stringClientMetadata(e):""},n.connectAux(t).then((function(){r()})).catch((function(t){i(t)}))):i(new S.OpenViduError(S.OpenViduErrorName.BROWSER_NOT_SUPPORTED,"Browser "+a.getName()+" (version "+a.getVersion()+") for "+a.getFamily()+" is not supported in OpenVidu"))}))},e.prototype.disconnect=function(){this.leave(!1,"disconnect")},e.prototype.subscribe=function(t,e,n,r){var i={};i=n&&"function"!==typeof n?{insertMode:"undefined"!==typeof n.insertMode?"string"===typeof n.insertMode?w.VideoInsertMode[n.insertMode]:i.insertMode:w.VideoInsertMode.APPEND,subscribeToAudio:"undefined"===typeof n.subscribeToAudio||n.subscribeToAudio,subscribeToVideo:"undefined"===typeof n.subscribeToVideo||n.subscribeToVideo}:{insertMode:w.VideoInsertMode.APPEND,subscribeToAudio:!0,subscribeToVideo:!0};var o=void 0;if(n&&"function"===typeof n?o=n:r&&(o=r),!this.sessionConnected())throw void 0!==o&&o(this.notConnectedError()),this.notConnectedError();x.info("Subscribing to "+t.connection.connectionId),t.subscribe().then((function(){x.info("Subscribed correctly to "+t.connection.connectionId),void 0!==o&&o(void 0)})).catch((function(t){void 0!==o&&o(t)}));var a=new l.Subscriber(t,e,i);return a.targetElement&&t.streamManager.createVideoElement(a.targetElement,i.insertMode),a},e.prototype.subscribeAsync=function(t,e,n){var r=this;return new Promise((function(i,o){var a;r.sessionConnected()||o(r.notConnectedError());var s=function(t){t?o(t):i(a)};a=n?r.subscribe(t,e,n,s):r.subscribe(t,e,s)}))},e.prototype.unsubscribe=function(t){var e=this;return new Promise((function(n,r){if(e.sessionConnected()){var i=t.stream.connection.connectionId;x.info("Unsubscribing from "+i),e.openvidu.sendRequest("unsubscribeFromVideo",{sender:t.stream.connection.connectionId},(function(e,o){e?(x.error("Error unsubscribing from "+i),r(e)):(x.info("Unsubscribed correctly from "+i),t.stream.streamManager.removeAllVideos(),t.stream.disposeWebRtcPeer(),t.stream.disposeMediaStream(),n())}))}else r(e.notConnectedError())}))},e.prototype.publish=function(t){var e=this;return new Promise((function(n,r){e.sessionConnected()||r(e.notConnectedError()),t.session=e,t.stream.session=e,t.stream.publishedOnce?t.initialize().then((function(){e.connection.addStream(t.stream),t.reestablishStreamPlayingEvent(),t.stream.publish().then((function(){e.sendVideoData(t,8,!0,5),n()})).catch((function(t){r(t)}))})).catch((function(t){r(t)})):(e.connection.addStream(t.stream),t.stream.publish().then((function(){e.sendVideoData(t,8,!0,5),n()})).catch((function(t){r(t)})))}))},e.prototype.unpublish=function(t){var e=this;return new Promise((function(n,r){if(!e.sessionConnected())throw e.notConnectedError();var i=t.stream;i.connection?i.connection!==e.connection?r(new Error("The associated Connection object of this Publisher is not your local Connection.Only moderators can force unpublish on remote Streams via 'forceUnpublish' method")):(x.info("Unpublishing local media ("+i.connection.connectionId+")"),e.openvidu.sendRequest("unpublishVideo",(function(e,o){if(e)r(e);else{x.info("Media unpublished correctly"),i.disposeWebRtcPeer(),i.connection.stream==i&&delete i.connection.stream;var a=new v.StreamEvent(!0,t,"streamDestroyed",t.stream,"unpublish");t.emitEvent("streamDestroyed",[a]),a.callDefaultBehavior(),n()}}))):r(new Error("The associated Connection object of this Publisher is null"))}))},e.prototype.forceDisconnect=function(t){var e=this;return new Promise((function(n,r){e.sessionConnected()||r(e.notConnectedError()),x.info("Forcing disconnect for connection "+t.connectionId),e.openvidu.sendRequest("forceDisconnect",{connectionId:t.connectionId},(function(e,i){e?(x.error("Error forcing disconnect for Connection "+t.connectionId,e),401===e.code?r(new S.OpenViduError(S.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force a disconnection")):r(e)):(x.info("Forcing disconnect correctly for Connection "+t.connectionId),n())}))}))},e.prototype.forceUnpublish=function(t){var e=this;return new Promise((function(n,r){e.sessionConnected()||r(e.notConnectedError()),x.info("Forcing unpublish for stream "+t.streamId),e.openvidu.sendRequest("forceUnpublish",{streamId:t.streamId},(function(e,i){e?(x.error("Error forcing unpublish for Stream "+t.streamId,e),401===e.code?r(new S.OpenViduError(S.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force an unpublishing")):r(e)):(x.info("Forcing unpublish correctly for Stream "+t.streamId),n())}))}))},e.prototype.signal=function(t){var e=this;return new Promise((function(n,r){e.sessionConnected()||r(e.notConnectedError());var i={};if(t.to&&t.to.length>0){var o=[];t.to.forEach((function(t){t.connectionId&&o.push(t.connectionId)})),i["to"]=o}else i["to"]=[];i["data"]=t.data?t.data:"";var a=t.type?t.type:"signal";a&&"signal:"!==a.substring(0,7)&&(a="signal:"+a),i["type"]=a,e.openvidu.sendRequest("sendMessage",{message:JSON.stringify(i)},(function(t,e){t?r(t):n()}))}))},e.prototype.on=function(e,n){var r,i,o,a;return t.prototype.onAux.call(this,e,"Event '"+e+"' triggered by 'Session'",n),"publisherStartSpeaking"===e&&(this.remoteConnections.forEach((function(t){var e;(null===(e=t.stream)||void 0===e?void 0:e.hasAudio)&&t.stream.enableHarkSpeakingEvent()})),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.hasAudio)&&this.connection.stream.enableHarkSpeakingEvent()),"publisherStopSpeaking"===e&&(this.remoteConnections.forEach((function(t){var e;(null===(e=t.stream)||void 0===e?void 0:e.hasAudio)&&t.stream.enableHarkStoppedSpeakingEvent()})),(null===(a=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===a?void 0:a.hasAudio)&&this.connection.stream.enableHarkStoppedSpeakingEvent()),this},e.prototype.once=function(e,n){var r,i,o,a;return t.prototype.onceAux.call(this,e,"Event '"+e+"' triggered once by 'Session'",n),"publisherStartSpeaking"===e&&(this.remoteConnections.forEach((function(t){var e;(null===(e=t.stream)||void 0===e?void 0:e.hasAudio)&&t.stream.enableOnceHarkSpeakingEvent()})),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.hasAudio)&&this.connection.stream.enableOnceHarkSpeakingEvent()),"publisherStopSpeaking"===e&&(this.remoteConnections.forEach((function(t){var e;(null===(e=t.stream)||void 0===e?void 0:e.hasAudio)&&t.stream.enableOnceHarkStoppedSpeakingEvent()})),(null===(a=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===a?void 0:a.hasAudio)&&this.connection.stream.enableOnceHarkStoppedSpeakingEvent()),this},e.prototype.off=function(e,n){var r,i,o,a,s=this;return t.prototype.off.call(this,e,n),"publisherStartSpeaking"===e&&(this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1)||(this.remoteConnections.forEach((function(t){var e;(null===(e=t.stream)||void 0===e?void 0:e.streamManager)&&(s.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,t.stream.streamManager)||t.stream.disableHarkSpeakingEvent(!1))})),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.streamManager)&&(this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.connection.stream.streamManager)||this.connection.stream.disableHarkSpeakingEvent(!1)))),"publisherStopSpeaking"===e&&(this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1)||(this.remoteConnections.forEach((function(t){var e;(null===(e=t.stream)||void 0===e?void 0:e.streamManager)&&(s.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,t.stream.streamManager)||t.stream.disableHarkStoppedSpeakingEvent(!1))})),(null===(a=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===a?void 0:a.streamManager)&&(this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.connection.stream.streamManager)||this.connection.stream.disableHarkStoppedSpeakingEvent(!1)))),this},e.prototype.onParticipantJoined=function(t){var e=this;this.getConnection(t.id,"").then((function(t){x.warn("Connection "+t.connectionId+" already exists in connections list")})).catch((function(n){var r=new s.Connection(e,t);e.remoteConnections.set(t.id,r),e.ee.emitEvent("connectionCreated",[new h.ConnectionEvent(!1,e,"connectionCreated",r,"")])}))},e.prototype.onParticipantLeft=function(t){var e=this;this.getRemoteConnection(t.connectionId,"onParticipantLeft").then((function(n){if(n.stream){var r=n.stream,i=new v.StreamEvent(!0,e,"streamDestroyed",r,t.reason);e.ee.emitEvent("streamDestroyed",[i]),i.callDefaultBehavior(),e.remoteStreamsCreated.delete(r.streamId)}e.remoteConnections.delete(n.connectionId),e.ee.emitEvent("connectionDestroyed",[new h.ConnectionEvent(!1,e,"connectionDestroyed",n,t.reason)])})).catch((function(t){x.error(t)}))},e.prototype.onParticipantPublished=function(t){var e,n=this,r=function(t){n.remoteConnections.set(t.connectionId,t),n.remoteStreamsCreated.get(t.stream.streamId)||n.ee.emitEvent("streamCreated",[new v.StreamEvent(!1,n,"streamCreated",t.stream,"")]),n.remoteStreamsCreated.set(t.stream.streamId,!0)};this.getRemoteConnection(t.id,"onParticipantPublished").then((function(n){e=n,t.metadata=n.data,e.remoteOptions=t,e.initRemoteStreams(t.streams),r(e)})).catch((function(i){e=new s.Connection(n,t),r(e)}))},e.prototype.onParticipantUnpublished=function(t){var e=this;t.connectionId===this.connection.connectionId?this.stopPublisherStream(t.reason):this.getRemoteConnection(t.connectionId,"onParticipantUnpublished").then((function(n){var r=new v.StreamEvent(!0,e,"streamDestroyed",n.stream,t.reason);e.ee.emitEvent("streamDestroyed",[r]),r.callDefaultBehavior();var i=n.stream.streamId;e.remoteStreamsCreated.delete(i),n.removeStream(i)})).catch((function(t){x.error(t)}))},e.prototype.onParticipantEvicted=function(t){t.connectionId===this.connection.connectionId&&this.sessionId&&!this.connection.disposed&&this.leave(!0,t.reason)},e.prototype.onNewMessage=function(t){var e=this;x.info("New signal: "+JSON.stringify(t));var n=t.type?t.type.replace(/^(signal:)/,""):void 0;t.from?this.getConnection(t.from,"Connection '"+t.from+"' unknown when 'onNewMessage'. Existing remote connections: "+JSON.stringify(this.remoteConnections.keys())+". Existing local connection: "+this.connection.connectionId).then((function(r){e.ee.emitEvent("signal",[new g.SignalEvent(e,n,t.data,r)]),t.type&&"signal"!==t.type&&e.ee.emitEvent(t.type,[new g.SignalEvent(e,n,t.data,r)])})).catch((function(t){x.error(t)})):(this.ee.emitEvent("signal",[new g.SignalEvent(this,n,t.data,void 0)]),t.type&&"signal"!==t.type&&this.ee.emitEvent(t.type,[new g.SignalEvent(this,n,t.data,void 0)]))},e.prototype.onStreamPropertyChanged=function(t){var e=this,n=function(n){if(n.stream&&n.stream.streamId===t.streamId){var r=n.stream,i=void 0;switch(t.property){case"audioActive":i=r.audioActive,t.newValue="true"===t.newValue,r.audioActive=t.newValue;break;case"videoActive":i=r.videoActive,t.newValue="true"===t.newValue,r.videoActive=t.newValue;break;case"videoDimensions":i=r.videoDimensions,t.newValue=JSON.parse(JSON.parse(t.newValue)),r.videoDimensions=t.newValue;break;case"filter":i=r.filter,t.newValue=Object.keys(t.newValue).length>0?t.newValue:void 0,void 0!==t.newValue?(r.filter=new c.Filter(t.newValue.type,t.newValue.options),r.filter.stream=r,t.newValue.lastExecMethod&&(r.filter.lastExecMethod=t.newValue.lastExecMethod)):delete r.filter,t.newValue=r.filter;break}e.ee.emitEvent("streamPropertyChanged",[new m.StreamPropertyChangedEvent(e,r,t.property,t.newValue,i,t.reason)]),r.streamManager&&r.streamManager.emitEvent("streamPropertyChanged",[new m.StreamPropertyChangedEvent(r.streamManager,r,t.property,t.newValue,i,t.reason)])}else x.error("No stream with streamId '"+t.streamId+"' found for connection '"+t.connectionId+"' on 'streamPropertyChanged' event")};t.connectionId===this.connection.connectionId?n(this.connection):this.getRemoteConnection(t.connectionId,"onStreamPropertyChanged").then((function(t){n(t)})).catch((function(t){x.error(t)}))},e.prototype.onConnectionPropertyChanged=function(t){var e;switch(t.property){case"role":e=this.connection.role.slice(),this.connection.role=t.newValue,this.connection.localOptions.role=t.newValue;break;case"record":e=this.connection.record,t.newValue="true"===t.newValue,this.connection.record=t.newValue,this.connection.localOptions.record=t.newValue;break}this.ee.emitEvent("connectionPropertyChanged",[new b.ConnectionPropertyChangedEvent(this,this.connection,t.property,t.newValue,e)])},e.prototype.onNetworkQualityLevelChangedChanged=function(t){var e=this;t.connectionId===this.connection.connectionId?this.ee.emitEvent("networkQualityLevelChanged",[new y.NetworkQualityLevelChangedEvent(this,t.newValue,t.oldValue,this.connection)]):this.getConnection(t.connectionId,"Connection not found for connectionId "+t.connectionId).then((function(n){e.ee.emitEvent("networkQualityLevelChanged",[new y.NetworkQualityLevelChangedEvent(e,t.newValue,t.oldValue,n)])})).catch((function(t){x.error(t)}))},e.prototype.recvIceCandidate=function(t){var e={candidate:t.candidate,sdpMid:t.sdpMid,sdpMLineIndex:t.sdpMLineIndex,component:null,foundation:null,port:null,priority:null,protocol:null,relatedAddress:null,relatedPort:null,tcpType:null,usernameFragment:null,type:null,toJSON:function(){return{candidate:t.candidate}}};this.getConnection(t.senderConnectionId,"Connection not found for connectionId "+t.senderConnectionId+" owning endpoint "+t.endpointName+". Ice candidate will be ignored: "+e).then((function(n){var r=n.stream;r.getWebRtcPeer().addIceCandidate(e).catch((function(e){x.error("Error adding candidate for "+r.streamId+" stream of endpoint "+t.endpointName+": "+e)}))})).catch((function(t){x.error(t)}))},e.prototype.onSessionClosed=function(t){x.info("Session closed: "+JSON.stringify(t));var e=t.sessionId;void 0!==e?this.ee.emitEvent("session-closed",[{session:e}]):x.warn("Session undefined on session closed",t)},e.prototype.onLostConnection=function(t){x.warn("Lost connection in Session "+this.sessionId),this.sessionId&&this.connection&&!this.connection.disposed&&this.leave(!0,t)},e.prototype.onRecoveredConnection=function(){x.info("Recovered connection in Session "+this.sessionId),this.reconnectBrokenStreams(),this.ee.emitEvent("reconnected",[])},e.prototype.onMediaError=function(t){x.error("Media error: "+JSON.stringify(t));var e=t.error;e?this.ee.emitEvent("error-media",[{error:e}]):x.warn("Received undefined media error:",t)},e.prototype.onRecordingStarted=function(t){this.ee.emitEvent("recordingStarted",[new f.RecordingEvent(this,"recordingStarted",t.id,t.name)])},e.prototype.onRecordingStopped=function(t){this.ee.emitEvent("recordingStopped",[new f.RecordingEvent(this,"recordingStopped",t.id,t.name,t.reason)])},e.prototype.onFilterEventDispatched=function(t){var e=this,n=t.connectionId;this.getConnection(n,"No connection found for connectionId "+n).then((function(n){var r;x.info("Filter event dispatched");var i=n.stream;null===(r=i.filter.handlers.get(t.eventType))||void 0===r||r.call(e,new d.FilterEvent(i.filter,t.eventType,t.data))}))},e.prototype.onForciblyReconnectSubscriber=function(t){var e=this;return new Promise((function(n,r){e.getRemoteConnection(t.connectionId,"onForciblyReconnectSubscriber").then((function(i){if(i.stream&&i.stream.streamId===t.streamId){var o=i.stream;if(o.setupReconnectionEventEmitter(n,r)){if(null!=o.reconnectionEventEmitter["onForciblyReconnectSubscriberLastEvent"])o.reconnectionEventEmitter["onForciblyReconnectSubscriberLastEvent"]=t,r("Ongoing forced subscriber reconnection");else{o.reconnectionEventEmitter["onForciblyReconnectSubscriberLastEvent"]=t;var a=function(){var t=o.reconnectionEventEmitter["onForciblyReconnectSubscriberLastEvent"];delete o.reconnectionEventEmitter["onForciblyReconnectSubscriberLastEvent"],e.onForciblyReconnectSubscriber(t)};o.reconnectionEventEmitter.once("success",(function(){a()})),o.reconnectionEventEmitter.once("error",(function(){a()}))}return}o.completeWebRtcPeerReceive(!0,!0,t.sdpOffer).then((function(){return o.finalResolveForSubscription(!0,n)})).catch((function(e){return o.finalRejectForSubscription(!0,"Error while forcibly reconnecting remote stream "+t.streamId+": "+e.toString(),r)}))}else{var s="No stream with streamId '"+t.streamId+"' found for connection '"+t.connectionId+"' on 'streamPropertyChanged' event";x.error(s),r(s)}})).catch((function(t){x.error(t),r(t)}))}))},e.prototype.reconnectBrokenStreams=function(){x.info("Re-establishing media connections...");var t=!1;this.connection.stream&&this.connection.stream.streamIceConnectionStateBroken()&&(x.warn("Re-establishing Publisher "+this.connection.stream.streamId),this.connection.stream.initWebRtcPeerSend(!0),t=!0),this.remoteConnections.forEach((function(e){e.stream&&e.stream.streamIceConnectionStateBroken()&&(x.warn("Re-establishing Subscriber "+e.stream.streamId),e.stream.initWebRtcPeerReceive(!0),t=!0)})),t||x.info("There were no media streams in need of a reconnection")},e.prototype.emitEvent=function(t,e){this.ee.emitEvent(t,e)},e.prototype.leave=function(t,e){var n=this;if(t=!!t,x.info("Leaving Session (forced="+t+")"),this.stopVideoDataIntervals(),this.connection){if(this.connection.disposed||t?this.openvidu.closeWs():this.openvidu.sendRequest("leaveRoom",(function(t,e){t&&x.error("leaveRoom error: "+JSON.stringify(t)),n.openvidu.closeWs()})),this.stopPublisherStream(e),!this.connection.disposed){var r=new p.SessionDisconnectedEvent(this,e);this.ee.emitEvent("sessionDisconnected",[r]),r.callDefaultBehavior()}}else x.warn("You were not connected to the session "+this.sessionId);x.flush()},e.prototype.initializeParams=function(t){var e={token:t||"",session:this.sessionId,platform:a.getDescription()?a.getDescription():"unknown",metadata:this.options.metadata?this.options.metadata:"",secret:this.openvidu.getSecret(),recorder:this.openvidu.getRecorder()};return e},e.prototype.sendVideoData=function(t,e,n,r){var s,c,l=this;if(void 0===e&&(e=1),void 0===n&&(n=!1),void 0===r&&(r=1),a.isChromeBrowser()||a.isChromeMobileBrowser()||a.isOperaBrowser()||a.isOperaMobileBrowser()||a.isEdgeBrowser()||a.isEdgeMobileBrowser()||a.isElectron()||a.isSafariBrowser()&&!a.isIonicIos()||a.isAndroidBrowser()||a.isSamsungBrowser()||a.isIonicAndroid()||a.isIOSWithSafari()){var u=function(){return i(l,void 0,void 0,(function(){var e,n,r;return o(this,(function(i){switch(i.label){case 0:return e=t.stream.getRTCPeerConnection(),"connected"!==e.connectionState?[3,2]:[4,e.getStats()];case 1:n=i.sent(),r=[],n.forEach((function(t){"frameWidth"in t&&"frameHeight"in t&&0===r.length&&r.push(t)})),r.length>0&&this.openvidu.sendRequest("videoData",{height:r[0].frameHeight,width:r[0].frameWidth,videoActive:null!=t.stream.videoActive&&t.stream.videoActive,audioActive:null!=t.stream.audioActive&&t.stream.audioActive},(function(t,e){t&&x.error("Error sending 'videoData' event",t)})),i.label=2;case 2:return[2]}}))}))};if(n){var h=1;this.videoDataInterval=setInterval((function(){h<r?(h++,u()):clearInterval(l.videoDataInterval)}),1e3*e)}else this.videoDataTimeout=setTimeout(u,1e3*e)}else a.isFirefoxBrowser()||a.isFirefoxMobileBrowser()||a.isIonicIos()||a.isReactNative()?this.openvidu.sendRequest("videoData",{height:(null===(s=t.stream.videoDimensions)||void 0===s?void 0:s.height)||0,width:(null===(c=t.stream.videoDimensions)||void 0===c?void 0:c.width)||0,videoActive:null!=t.stream.videoActive&&t.stream.videoActive,audioActive:null!=t.stream.audioActive&&t.stream.audioActive},(function(t,e){t&&x.error("Error sending 'videoData' event",t)})):x.error("Browser "+a.getName()+" (version "+a.getVersion()+") for "+a.getFamily()+" is not supported in OpenVidu for Network Quality")},e.prototype.sessionConnected=function(){return null!=this.connection},e.prototype.notConnectedError=function(){return new S.OpenViduError(S.OpenViduErrorName.OPENVIDU_NOT_CONNECTED,"There is no connection to the session. Method 'Session.connect' must be successfully completed first")},e.prototype.anySpeechEventListenerEnabled=function(t,e,n){var r=this.ee.getListeners(t);e&&(r=r.filter((function(t){return t.once})));var i=r.length;if(i>0)return!0;var o=0;if(n){var a=n.ee.getListeners(t);e&&(a=a.filter((function(t){return t.once}))),o=a.length}return o>0},e.prototype.connectAux=function(t){var e=this;return new Promise((function(n,r){e.openvidu.startWs((function(i){if(i)r(i);else{var o=e.initializeParams(t);e.openvidu.sendRequest("joinRoom",o,(function(i,o){if(i)r(i);else{e.processJoinRoomResponse(o),E.OpenViduLogger.configureJSNLog(e.openvidu,t),e.connection=new s.Connection(e,o);var a={connections:new Array,streams:new Array},c=o.value;c.forEach((function(t){var n=new s.Connection(e,t);e.remoteConnections.set(n.connectionId,n),a.connections.push(n),n.stream&&(e.remoteStreamsCreated.set(n.stream.streamId,!0),a.streams.push(n.stream))})),e.ee.emitEvent("connectionCreated",[new h.ConnectionEvent(!1,e,"connectionCreated",e.connection,"")]),a.connections.forEach((function(t){e.ee.emitEvent("connectionCreated",[new h.ConnectionEvent(!1,e,"connectionCreated",t,"")])})),a.streams.forEach((function(t){e.ee.emitEvent("streamCreated",[new v.StreamEvent(!1,e,"streamCreated",t,"")])})),n()}}))}}))}))},e.prototype.stopPublisherStream=function(t){this.connection.stream&&(this.connection.stream.disposeWebRtcPeer(),this.connection.stream.isLocalStreamPublished&&this.connection.stream.ee.emitEvent("local-stream-destroyed",[t]))},e.prototype.stopVideoDataIntervals=function(){clearInterval(this.videoDataInterval),clearTimeout(this.videoDataTimeout)},e.prototype.stringClientMetadata=function(t){return"string"!==typeof t?JSON.stringify(t):t},e.prototype.getConnection=function(t,e){var n=this;return new Promise((function(r,i){var o=n.remoteConnections.get(t);o?r(o):n.connection.connectionId===t?r(n.connection):i(new S.OpenViduError(S.OpenViduErrorName.GENERIC_ERROR,e))}))},e.prototype.getRemoteConnection=function(t,e){var n=this;return new Promise((function(r,i){var o=n.remoteConnections.get(t);if(o)r(o);else{var a="Remote connection "+t+" unknown when '"+e+"'. Existing remote connections: "+JSON.stringify(n.remoteConnections.keys());i(new S.OpenViduError(S.OpenViduErrorName.GENERIC_ERROR,a))}}))},e.prototype.processToken=function(t){var e=t.match(/^(wss?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);if(e){var n={protocol:e[1],host:e[2],hostname:e[3],port:e[4],pathname:e[5],search:e[6],hash:e[7]},r=t.split("?"),i=decodeURI(r[1]).split("&").map((function(t){return t.split("=")})).reduce((function(t,e){var n=e[0],r=e[1];return t[n]=r,t}),{});this.sessionId=i["sessionId"];var o=i["secret"],a=i["recorder"],s=i["webrtcStatsInterval"],c=i["sendBrowserLogs"];o&&(this.openvidu.secret=o),a&&(this.openvidu.recorder=!0),s&&(this.openvidu.webrtcStatsInterval=+s),c&&(this.openvidu.sendBrowserLogs=c),this.openvidu.isPro=!!s&&!!c,this.openvidu.wsUri="wss://"+n.host+"/openvidu",this.openvidu.httpUri="https://"+n.host}else x.error('Token "'+t+'" is not valid')},e.prototype.processJoinRoomResponse=function(t){if(this.sessionId=t.session,null!=t.coturnIp&&null!=t.coturnPort&&null!=t.turnUsername&&null!=t.turnCredential){var e="turn:"+t.coturnIp+":"+t.coturnPort;this.openvidu.iceServers=[{urls:[e],username:t.turnUsername,credential:t.turnCredential}],x.log("STUN/TURN server IP: "+t.coturnIp),x.log("TURN temp credentials ["+t.turnUsername+":"+t.turnCredential+"]")}this.openvidu.role=t.role,this.openvidu.finalUserId=t.finalUserId,this.openvidu.mediaServer=t.mediaServer,this.capabilities={subscribe:!0,publish:"SUBSCRIBER"!==this.openvidu.role,forceUnpublish:"MODERATOR"===this.openvidu.role,forceDisconnect:"MODERATOR"===this.openvidu.role},x.info("openvidu-server version: "+t.version),null!=t.life&&(this.openvidu.life=t.life),t.version!==this.openvidu.libraryVersion&&x.warn("OpenVidu Server ("+t.version+") and OpenVidu Browser ("+this.openvidu.libraryVersion+") versions do NOT match. There may be incompatibilities")},e}(u.EventDispatcher);e.Session=O},2582:function(t,e,n){"use strict";var r=n("cfe6"),i="abcdefghijklmnopqrstuvwxyz012345";t.exports={string:function(t){for(var e=i.length,n=r.randomBytes(t),o=[],a=0;a<t;a++)o.push(i.substr(n[a]%e,1));return o.join("")},number:function(t){return Math.floor(Math.random()*t)},numberString:function(t){var e=(""+(t-1)).length,n=new Array(e+1).join("0");return(n+this.number(t)).slice(-e)}}},"25eb":function(t,e,n){t.exports=n.p+"img/upload_icon.984ffc88.svg"},"26a0":function(t,e,n){"use strict";(function(e){t.exports={isOpera:function(){return e.navigator&&/opera/i.test(e.navigator.userAgent)},isKonqueror:function(){return e.navigator&&/konqueror/i.test(e.navigator.userAgent)},hasDomain:function(){if(!e.document)return!0;try{return!!e.document.domain}catch(t){return!1}}}}).call(this,n("c8ba"))},"26e3":function(t,e,n){"use strict";(function(e){var r=n("3fb5"),i=n("9f3a"),o=n("d5e5");t.exports=function(t){function n(e,n){i.call(this,t.transportName,e,n)}return r(n,i),n.enabled=function(n,r){if(!e.document)return!1;var a=o.extend({},r);return a.sameOrigin=!0,t.enabled(a)&&i.enabled()},n.transportName="iframe-"+t.transportName,n.needBody=!0,n.roundTrips=i.roundTrips+t.roundTrips-1,n.facadeTransport=t,n}}).call(this,n("c8ba"))},"2c42":function(t,e,n){t.exports=n.p+"img/download_1E304F.632eab9a.svg"},"2e03":function(t,e,n){},3:function(t,e){},3029:function(t,e,n){var r,i=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function o(t){if(!t)return o.__;Array.prototype.reduce||(Array.prototype.reduce=function(t,e){for(var n=e,r=0;r<this.length;r++)n=t(n,this[r],r,this);return n});var e="",n=("."+t).split(".").reduce((function(t,n,r,i){e?e+="."+n:e=n;var a=t["__"+e];return void 0===a&&(o.Logger.prototype=t,a=new o.Logger(e),t["__"+e]=a),a}),o.__);return n}(function(t){function e(t,e,n){void 0!==e[t]&&(null!==e[t]?n[t]=e[t]:delete n[t])}function n(e){if(null!=t.enabled&&!t.enabled)return!1;try{if(e.userAgentRegex&&!new RegExp(e.userAgentRegex).test(navigator.userAgent))return!1}catch(n){}try{if(e.ipRegex&&t.clientIP&&!new RegExp(e.ipRegex).test(t.clientIP))return!1}catch(n){}return!0}function r(t,e){try{if(t.disallow&&new RegExp(t.disallow).test(e))return!1}catch(n){}return!0}function o(t){return"function"==typeof t?t instanceof RegExp?t.toString():t():t}t.requestId="",t.entryId=0,t._createXMLHttpRequest=function(){return new XMLHttpRequest},t._getTime=function(){return(new Date).getTime()},t._console=console,t._appenderNames=[];var a=function(){function t(t,e,n){this.msg=t,this.meta=e,this.finalString=n}return t}();function s(e){var n,r=o(e);switch(typeof r){case"string":return new a(r,null,r);case"number":return n=r.toString(),new a(n,null,n);case"boolean":return n=r.toString(),new a(n,null,n);case"undefined":return new a("undefined",null,"undefined");case"object":return r instanceof RegExp||r instanceof String||r instanceof Number||r instanceof Boolean?(n=r.toString(),new a(n,null,n)):(n="function"===typeof t.serialize?t.serialize.call(this,r):JSON.stringify(r),new a("",r,n));default:return new a("unknown",null,"unknown")}}function c(t){return e("enabled",t,this),e("maxMessages",t,this),e("defaultAjaxUrl",t,this),e("clientIP",t,this),e("requestId",t,this),e("defaultBeforeSend",t,this),e("serialize",t,this),this}function l(){return-2147483648}function u(){return 1e3}function h(){return 2e3}function d(){return 3e3}function f(){return 4e3}function p(){return 5e3}function g(){return 6e3}function v(){return 2147483647}function m(t){return t<=1e3?"trace":t<=2e3?"debug":t<=3e3?"info":t<=4e3?"warn":t<=5e3?"error":"fatal"}t.setOptions=c,t.getAllLevel=l,t.getTraceLevel=u,t.getDebugLevel=h,t.getInfoLevel=d,t.getWarnLevel=f,t.getErrorLevel=p,t.getFatalLevel=g,t.getOffLevel=v;var b=function(){function t(t,e){this.inner=e,this.name="JL.Exception",this.message=s(t).finalString}return t}();t.Exception=b,b.prototype=new Error;var y=function(){function t(t,e,n,r,i){this.l=t,this.m=e,this.n=n,this.t=r,this.u=i}return t}();function S(e,n,r){return t.entryId++,new y(e,n,r,t._getTime(),t.entryId)}function w(t){t.id&&(clearTimeout(t.id),t.id=null)}function E(t,e,n){var r=this;t.id||(t.id=setTimeout((function(){n.call(r)}),e))}t.LogItem=y;var C=function(){function i(e,n){this.appenderName=e,this.sendLogItems=n,this.level=t.getTraceLevel(),this.sendWithBufferLevel=2147483647,this.storeInBufferLevel=-2147483648,this.bufferSize=0,this.batchSize=1,this.maxBatchSize=20,this.batchTimeout=2147483647,this.sendTimeout=5e3,this.buffer=[],this.batchBuffer=[],this.batchTimeoutTimer={id:null},this.sendTimeoutTimer={id:null},this.nbrLogItemsSkipped=0,this.nbrLogItemsBeingSent=0;var r="Trying to create an appender without a name or with an empty name";if(void 0==e)throw r;if(-1!=t._appenderNames.indexOf(e)){if(!e)throw r;throw"Multiple appenders use the same name "+e}t._appenderNames.push(e)}return i.prototype.addLogItemsToBuffer=function(e){if(this.batchBuffer.length>=this.maxBatchSize)this.nbrLogItemsSkipped+=e.length;else{if(null!=t.maxMessages){if(t.maxMessages<1)return;t.maxMessages-=e.length}this.batchBuffer=this.batchBuffer.concat(e);var n=this;E(this.batchTimeoutTimer,this.batchTimeout,(function(){n.sendBatch.call(n)}))}},i.prototype.batchBufferHasOverdueMessages=function(){for(var e=0;e<this.batchBuffer.length;e++){var n=t._getTime()-this.batchBuffer[e].t;if(n>this.batchTimeout)return!0}return!1},i.prototype.batchBufferHasStrandedMessage=function(){return!(null==t.maxMessages)&&t.maxMessages<1&&this.batchBuffer.length>0},i.prototype.sendBatchIfComplete=function(){(this.batchBuffer.length>=this.batchSize||this.batchBufferHasOverdueMessages()||this.batchBufferHasStrandedMessage())&&this.sendBatch()},i.prototype.onSendingEnded=function(){w(this.sendTimeoutTimer),this.nbrLogItemsBeingSent=0,this.sendBatchIfComplete()},i.prototype.setOptions=function(n){if(e("level",n,this),e("ipRegex",n,this),e("userAgentRegex",n,this),e("disallow",n,this),e("sendWithBufferLevel",n,this),e("storeInBufferLevel",n,this),e("bufferSize",n,this),e("batchSize",n,this),e("maxBatchSize",n,this),e("batchTimeout",n,this),e("sendTimeout",n,this),this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize),this.maxBatchSize<this.batchSize)throw new t.Exception({message:"maxBatchSize cannot be smaller than batchSize",maxBatchSize:this.maxBatchSize,batchSize:this.batchSize});return this},i.prototype.log=function(t,e,i,o,a,s,c){var l;n(this)&&r(this,s)&&(a<this.storeInBufferLevel||(l=S(a,s,c),a<this.level?this.bufferSize>0&&(this.buffer.push(l),this.buffer.length>this.bufferSize&&this.buffer.shift()):(this.addLogItemsToBuffer([l]),a>=this.sendWithBufferLevel&&this.buffer.length&&(this.addLogItemsToBuffer(this.buffer),this.buffer.length=0),this.sendBatchIfComplete())))},i.prototype.sendBatch=function(){if(!(this.nbrLogItemsBeingSent>0)&&(w(this.batchTimeoutTimer),0!=this.batchBuffer.length)){this.nbrLogItemsBeingSent=this.batchBuffer.length;var t=this;E(this.sendTimeoutTimer,this.sendTimeout,(function(){t.onSendingEnded.call(t)})),this.sendLogItems(this.batchBuffer,(function(){t.batchBuffer.splice(0,t.nbrLogItemsBeingSent),t.nbrLogItemsSkipped>0&&(t.batchBuffer.push(S(f(),"Lost "+t.nbrLogItemsSkipped+" messages. Either connection with the server was down or logging was disabled via the enabled option. Reduce lost messages by increasing the ajaxAppender option maxBatchSize.",t.appenderName)),t.nbrLogItemsSkipped=0),t.onSendingEnded.call(t)}))}},i}();t.Appender=C;var x=function(r){function o(t){return r.call(this,t,o.prototype.sendLogItemsAjax)||this}return i(o,r),o.prototype.setOptions=function(t){return e("url",t,this),e("beforeSend",t,this),r.prototype.setOptions.call(this,t),this},o.prototype.sendLogItemsAjax=function(e,r){try{if(!n(this))return;this.xhr&&0!=this.xhr.readyState&&4!=this.xhr.readyState&&this.xhr.abort(),this.xhr=t._createXMLHttpRequest();var i="/jsnlog.logger";null!=t.defaultAjaxUrl&&(i=t.defaultAjaxUrl),this.url&&(i=this.url),this.xhr.open("POST",i),this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("JSNLog-RequestId",t.requestId);var o=this;this.xhr.onreadystatechange=function(){4==o.xhr.readyState&&o.xhr.status>=200&&o.xhr.status<300&&r()};var a={r:t.requestId,lg:e};"function"===typeof this.beforeSend?this.beforeSend.call(this,this.xhr,a):"function"===typeof t.defaultBeforeSend&&t.defaultBeforeSend.call(this,this.xhr,a);var s=JSON.stringify(a);this.xhr.send(s)}catch(c){}},o}(C);t.AjaxAppender=x;var O=function(e){function r(t){return e.call(this,t,r.prototype.sendLogItemsConsole)||this}return i(r,e),r.prototype.clog=function(e){t._console.log(e)},r.prototype.cerror=function(e){t._console.error?t._console.error(e):this.clog(e)},r.prototype.cwarn=function(e){t._console.warn?t._console.warn(e):this.clog(e)},r.prototype.cinfo=function(e){t._console.info?t._console.info(e):this.clog(e)},r.prototype.cdebug=function(e){t._console.debug?t._console.debug(e):this.cinfo(e)},r.prototype.sendLogItemsConsole=function(e,r){try{if(!n(this))return;if(!t._console)return;var i;for(i=0;i<e.length;++i){var o=e[i],a=o.n+": "+o.m;"undefined"===typeof window&&(a=new Date(o.t)+" | "+a),o.l<=t.getDebugLevel()?this.cdebug(a):o.l<=t.getInfoLevel()?this.cinfo(a):o.l<=t.getWarnLevel()?this.cwarn(a):this.cerror(a)}}catch(s){}r()},r}(C);t.ConsoleAppender=O;var _,T=function(){function t(t){this.loggerName=t,this.seenRegexes=[]}return t.prototype.setOptions=function(t){return e("level",t,this),e("userAgentRegex",t,this),e("disallow",t,this),e("ipRegex",t,this),e("appenders",t,this),e("onceOnly",t,this),this.seenRegexes=[],this},t.prototype.buildExceptionObject=function(t){var e={};return t.stack?e.stack=t.stack:e.e=t,t.message&&(e.message=t.message),t.name&&(e.name=t.name),t.data&&(e.data=t.data),t.inner&&(e.inner=this.buildExceptionObject(t.inner)),e},t.prototype.log=function(t,e,i){var a,c,l=0;if(!this.appenders)return this;if(t>=this.level&&n(this)&&(i?(c=this.buildExceptionObject(i),c.logData=o(e)):c=e,a=s(c),r(this,a.finalString))){if(this.onceOnly){l=this.onceOnly.length-1;while(l>=0){if(new RegExp(this.onceOnly[l]).test(a.finalString)){if(this.seenRegexes[l])return this;this.seenRegexes[l]=!0}l--}}a.meta=a.meta||{},l=this.appenders.length-1;while(l>=0)this.appenders[l].log(m(t),a.msg,a.meta,(function(){}),t,a.finalString,this.loggerName),l--}return this},t.prototype.trace=function(t){return this.log(u(),t)},t.prototype.debug=function(t){return this.log(h(),t)},t.prototype.info=function(t){return this.log(d(),t)},t.prototype.warn=function(t){return this.log(f(),t)},t.prototype.error=function(t){return this.log(p(),t)},t.prototype.fatal=function(t){return this.log(g(),t)},t.prototype.fatalException=function(t,e){return this.log(g(),t,e)},t}();function k(t){return new x(t)}function I(t){return new O(t)}t.Logger=T,t.createAjaxAppender=k,t.createConsoleAppender=I,_="undefined"!==typeof window?new x(""):new O(""),t.__=new t.Logger(""),t.__.setOptions({level:t.getDebugLevel(),appenders:[_]})})(o||(o={})),e.__esModule=!0,e.JL=o,"function"==typeof r&&r.amd&&r("jsnlog",[],(function(){return o})),"function"==typeof __jsnlog_configure&&__jsnlog_configure(o),"undefined"===typeof window||window.onerror||(window.onerror=function(t,e,n,r,i){return o("onerrorLogger").fatalException({msg:"Uncaught Exception",errorMsg:t?t.message||t:"",url:e,"line number":n,column:r},i),!1}),"undefined"===typeof window||window.onunhandledrejection||(window.onunhandledrejection=function(t){o("onerrorLogger").fatalException({msg:"unhandledrejection",errorMsg:t.reason?t.reason.message:t.message||null},t.reason)})},3172:function(t,e,n){"use strict";n("4176")},"32e1":function(t,e,n){},"33e8":function(t,e,n){"use strict";n.d(e,"e",(function(){return x})),n.d(e,"c",(function(){return h})),n.d(e,"d",(function(){return E})),n.d(e,"a",(function(){return S})),n.d(e,"b",(function(){return C}));const r=Object.create(null);r["open"]="0",r["close"]="1",r["ping"]="2",r["pong"]="3",r["message"]="4",r["upgrade"]="5",r["noop"]="6";const i=Object.create(null);Object.keys(r).forEach(t=>{i[r[t]]=t});const o={type:"error",data:"parser error"},a="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),s="function"===typeof ArrayBuffer,c=t=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,l=({type:t,data:e},n,i)=>a&&e instanceof Blob?n?i(e):u(e,i):s&&(e instanceof ArrayBuffer||c(e))?n?i(e):u(new Blob([e]),i):i(r[t]+(e||"")),u=(t,e)=>{const n=new FileReader;return n.onload=function(){const t=n.result.split(",")[1];e("b"+t)},n.readAsDataURL(t)};for(var h=l,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f="undefined"===typeof Uint8Array?[]:new Uint8Array(256),p=0;p<d.length;p++)f[d.charCodeAt(p)]=p;var g=function(t){var e,n,r,i,o,a=.75*t.length,s=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var l=new ArrayBuffer(a),u=new Uint8Array(l);for(e=0;e<s;e+=4)n=f[t.charCodeAt(e)],r=f[t.charCodeAt(e+1)],i=f[t.charCodeAt(e+2)],o=f[t.charCodeAt(e+3)],u[c++]=n<<2|r>>4,u[c++]=(15&r)<<4|i>>2,u[c++]=(3&i)<<6|63&o;return l};const v="function"===typeof ArrayBuffer,m=(t,e)=>{if("string"!==typeof t)return{type:"message",data:y(t,e)};const n=t.charAt(0);if("b"===n)return{type:"message",data:b(t.substring(1),e)};const r=i[n];return r?t.length>1?{type:i[n],data:t.substring(1)}:{type:i[n]}:o},b=(t,e)=>{if(v){const n=g(t);return y(n,e)}return{base64:!0,data:t}},y=(t,e)=>{switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}};var S=m;const w=String.fromCharCode(30),E=(t,e)=>{const n=t.length,r=new Array(n);let i=0;t.forEach((t,o)=>{h(t,!1,t=>{r[o]=t,++i===n&&e(r.join(w))})})},C=(t,e)=>{const n=t.split(w),r=[];for(let i=0;i<n.length;i++){const t=S(n[i],e);if(r.push(t),"error"===t.type)break}return r},x=4},"34ba":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("33e8"),i=n("b19d"),o=n("af7f");class a extends i["Emitter"]{constructor(t){super(),this.writable=!1,Object(o["a"])(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e){const n=new Error(t);return n.type="TransportError",n.description=e,super.emit("error",n),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emit("open")}onData(t){const e=Object(r["a"])(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emit("packet",t)}onClose(){this.readyState="closed",super.emit("close")}}},"397f":function(t,e,n){"use strict";var r=n("c282"),i=n("621f"),o=n("3fb5"),a=n("ada0").EventEmitter,s=n("13c0"),c=function(){};function l(t,e,n){if(!l.enabled())throw new Error("Transport created when disabled");a.call(this),c("constructor",t);var o=this,u=i.addPath(t,"/websocket");u="https"===u.slice(0,5)?"wss"+u.slice(5):"ws"+u.slice(4),this.url=u,this.ws=new s(this.url,[],n),this.ws.onmessage=function(t){c("message event",t.data),o.emit("message",t.data)},this.unloadRef=r.unloadAdd((function(){c("unload"),o.ws.close()})),this.ws.onclose=function(t){c("close event",t.code,t.reason),o.emit("close",t.code,t.reason),o._cleanup()},this.ws.onerror=function(t){c("error event",t),o.emit("close",1006,"WebSocket connection broken"),o._cleanup()}}o(l,a),l.prototype.send=function(t){var e="["+t+"]";c("send",e),this.ws.send(e)},l.prototype.close=function(){c("close");var t=this.ws;this._cleanup(),t&&t.close()},l.prototype._cleanup=function(){c("_cleanup");var t=this.ws;t&&(t.onmessage=t.onclose=t.onerror=null),r.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},l.enabled=function(){return c("enabled"),!!s},l.transportName="websocket",l.roundTrips=2,t.exports=l},"3c35":function(t,e){(function(e){t.exports=e}).call(this,{})},"3c4c":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__awaiter||function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{c(r.next(t))}catch(e){o(e)}}function s(t){try{c(r["throw"](t))}catch(e){o(e)}}function c(t){t.done?n(t.value):i(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return c([t,e])}}function c(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Publisher=void 0;var a,s=n("2533"),c=n("0cf2"),l=n("3f7b"),u=n("4def"),h=n("0703"),d=n("a081"),f=n("4edf"),p=n("f66e"),g=n("e237"),v=p.OpenViduLogger.getInstance(),m=function(t){function e(e,n,r){var i=t.call(this,new c.Stream(r.session?r.session:new s.Session(r),{publisherProperties:n,mediaConstraints:{}}),e)||this;return i.accessAllowed=!1,i.isSubscribedToRemote=!1,i.accessDenied=!1,a=g.PlatformUtils.getInstance(),i.properties=n,i.openvidu=r,i.stream.ee.on("local-stream-destroyed",(function(t){i.stream.isLocalStreamPublished=!1;var e=new u.StreamEvent(!0,i,"streamDestroyed",i.stream,t);i.emitEvent("streamDestroyed",[e]),e.callDefaultBehavior()})),i}return r(e,t),e.prototype.publishAudio=function(t){var e=this;if(this.stream.audioActive!==t){var n=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream();n.getAudioTracks().forEach((function(e){e.enabled=t})),this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"audioActive",newValue:t,reason:"publishAudio"},(function(n,r){n?v.error("Error sending 'streamPropertyChanged' event",n):(e.session.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(e.session,e.stream,"audioActive",t,!t,"publishAudio")]),e.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(e,e.stream,"audioActive",t,!t,"publishAudio")]),e.session.sendVideoData(e.stream.streamManager))})),this.stream.audioActive=t,v.info("'Publisher' has "+(t?"published":"unpublished")+" its audio stream")}},e.prototype.publishVideo=function(t){var e=this;if(this.stream.videoActive!==t){var n=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream();n.getVideoTracks().forEach((function(e){e.enabled=t})),this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"videoActive",newValue:t,reason:"publishVideo"},(function(n,r){n?v.error("Error sending 'streamPropertyChanged' event",n):(e.session.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(e.session,e.stream,"videoActive",t,!t,"publishVideo")]),e.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(e,e.stream,"videoActive",t,!t,"publishVideo")]),e.session.sendVideoData(e.stream.streamManager))})),this.stream.videoActive=t,v.info("'Publisher' has "+(t?"published":"unpublished")+" its video stream")}},e.prototype.subscribeToRemote=function(t){t=void 0===t||t,this.isSubscribedToRemote=t,this.stream.subscribeToMyRemote(t)},e.prototype.on=function(e,n){var r=this;return t.prototype.on.call(this,e,n),"streamCreated"===e&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new u.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.on("stream-created-by-publisher",(function(){r.emitEvent("streamCreated",[new u.StreamEvent(!1,r,"streamCreated",r.stream,"")])}))),"remoteVideoPlaying"===e&&this.stream.displayMyRemote()&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&this.emitEvent("remoteVideoPlaying",[new d.VideoElementEvent(this.videos[0].video,this,"remoteVideoPlaying")]),"accessAllowed"===e&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),"accessDenied"===e&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},e.prototype.once=function(e,n){var r=this;return t.prototype.once.call(this,e,n),"streamCreated"===e&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new u.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.once("stream-created-by-publisher",(function(){r.emitEvent("streamCreated",[new u.StreamEvent(!1,r,"streamCreated",r.stream,"")])}))),"remoteVideoPlaying"===e&&this.stream.displayMyRemote()&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&this.emitEvent("remoteVideoPlaying",[new d.VideoElementEvent(this.videos[0].video,this,"remoteVideoPlaying")]),"accessAllowed"===e&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),"accessDenied"===e&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},e.prototype.replaceTrack=function(t){return i(this,void 0,void 0,(function(){var e,n,r,i,a=this;return o(this,(function(o){switch(o.label){case 0:e=function(){return new Promise((function(e,n){var r,i=a.stream.displayMyRemote()?a.stream.localMediaStreamWhenSubscribedToRemote:a.stream.getMediaStream();r="video"===t.kind?i.getVideoTracks()[0]:i.getAudioTracks()[0],i.removeTrack(r),r.stop(),i.addTrack(t),"video"===t.kind&&a.stream.isLocalStreamPublished&&(a.openvidu.sendNewVideoDimensionsIfRequired(a,"trackReplaced",50,30),a.session.sendVideoData(a.stream.streamManager,5,!0,5)),e()}))},n=function(){return new Promise((function(e,n){var r,i=a.stream.getRTCPeerConnection().getSenders();if("video"===t.kind){if(r=i.find((function(t){return!!t.track&&"video"===t.track.kind})),!r)return void n(new Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object"))}else{if("audio"!==t.kind)return void n(new Error("Unknown track kind "+t.kind));if(r=i.find((function(t){return!!t.track&&"audio"===t.track.kind})),!r)return void n(new Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object"))}r.replaceTrack(t).then((function(){e()})).catch((function(t){n(t)}))}))},r=t.enabled,"video"===t.kind?t.enabled=this.stream.videoActive:"audio"===t.kind&&(t.enabled=this.stream.audioActive),o.label=1;case 1:return o.trys.push([1,7,,8]),this.stream.isLocalStreamPublished?[4,n()]:[3,4];case 2:return o.sent(),[4,e()];case 3:return[2,o.sent()];case 4:return[4,e()];case 5:return[2,o.sent()];case 6:return[3,8];case 7:throw i=o.sent(),t.enabled=r,i;case 8:return[2]}}))}))},e.prototype.initialize=function(){var t=this;return new Promise((function(e,n){var r,i={},o={},s=1500,c=function(e){t.accessDenied=!0,t.accessAllowed=!1,v.error("Publisher initialization failed. "+e.name+": "+e.message),n(e)},l=function(n){if(t.accessAllowed=!0,t.accessDenied=!1,"undefined"!==typeof MediaStreamTrack&&t.properties.audioSource instanceof MediaStreamTrack&&(n.removeTrack(n.getAudioTracks()[0]),n.addTrack(t.properties.audioSource)),"undefined"!==typeof MediaStreamTrack&&t.properties.videoSource instanceof MediaStreamTrack&&(n.removeTrack(n.getVideoTracks()[0]),n.addTrack(t.properties.videoSource)),n.getAudioTracks()[0]){var r=void 0!==t.stream.audioActive&&null!==t.stream.audioActive?t.stream.audioActive:!!t.stream.outboundStreamOpts.publisherProperties.publishAudio;n.getAudioTracks()[0].enabled=r}if(n.getVideoTracks()[0]){r=void 0!==t.stream.videoActive&&null!==t.stream.videoActive?t.stream.videoActive:!!t.stream.outboundStreamOpts.publisherProperties.publishVideo;n.getVideoTracks()[0].enabled=r}t.initializeVideoReference(n),t.stream.displayMyRemote()||t.stream.updateMediaStreamInVideos(),delete t.firstVideoElement,t.stream.isSendVideo()?t.getVideoDimensions(n).then((function(e){t.stream.videoDimensions={width:e.width,height:e.height},t.stream.isSendScreen()&&(t.screenShareResizeInterval=setInterval((function(){var e=n.getVideoTracks()[0].getSettings(),r=e.width,i=e.height;!t.stream.isLocalStreamPublished||r===t.stream.videoDimensions.width&&i===t.stream.videoDimensions.height||t.openvidu.sendVideoDimensionsChangedEvent(t,"screenResized",t.stream.videoDimensions.width,t.stream.videoDimensions.height,r||0,i||0)}),650)),t.stream.isLocalStreamReadyToPublish=!0,t.stream.ee.emitEvent("stream-ready-to-publish",[])})):(t.stream.isLocalStreamReadyToPublish=!0,t.stream.ee.emitEvent("stream-ready-to-publish",[])),e()},u=function(e,n){t.clearPermissionDialogTimer(r,s),t.stream.isSendScreen()&&t.stream.isSendAudio()?(o.audio=n,o.video=!1,r=Date.now(),t.setPermissionDialogTimer(s),navigator.mediaDevices.getUserMedia(o).then((function(n){t.clearPermissionDialogTimer(r,s),e.addTrack(n.getAudioTracks()[0]),l(e)})).catch((function(n){t.clearPermissionDialogTimer(r,s),e.getAudioTracks().forEach((function(t){t.stop()})),e.getVideoTracks().forEach((function(t){t.stop()})),c(t.openvidu.generateAudioDeviceError(n,i))}))):l(e)},h=function(e){var n,o;switch(v.error("getMediaError: "+e.toString()),t.clearPermissionDialogTimer(r,s),"Error"===e.name&&(e.name=e.constructor.name),e.name.toLowerCase()){case"notfounderror":navigator.mediaDevices.getUserMedia({audio:!1,video:i.video}).then((function(t){t.getVideoTracks().forEach((function(t){t.stop()})),n=f.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,o=e.toString(),c(new f.OpenViduError(n,o))})).catch((function(t){n=f.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,o=e.toString(),c(new f.OpenViduError(n,o))}));break;case"notallowederror":n=t.stream.isSendScreen()?f.OpenViduErrorName.SCREEN_CAPTURE_DENIED:f.OpenViduErrorName.DEVICE_ACCESS_DENIED,o=e.toString(),c(new f.OpenViduError(n,o));break;case"overconstrainederror":navigator.mediaDevices.getUserMedia({audio:!1,video:i.video}).then((function(t){t.getVideoTracks().forEach((function(t){t.stop()})),"deviceid"===e.constraint.toLowerCase()?(n=f.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,o="Audio input device with deviceId '"+i.audio.deviceId.exact+"' not found"):(n=f.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,o="Audio input device doesn't support the value passed for constraint '"+e.constraint+"'"),c(new f.OpenViduError(n,o))})).catch((function(t){"deviceid"===e.constraint.toLowerCase()?(n=f.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,o="Video input device with deviceId '"+i.video.deviceId.exact+"' not found"):(n=f.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,o="Video input device doesn't support the value passed for constraint '"+e.constraint+"'"),c(new f.OpenViduError(n,o))}));break;case"aborterror":case"notreadableerror":n=f.OpenViduErrorName.DEVICE_ALREADY_IN_USE,o=e.toString(),c(new f.OpenViduError(n,o));break;default:n=f.OpenViduErrorName.GENERIC_ERROR,o=e.toString(),c(new f.OpenViduError(n,o));break}};t.openvidu.generateMediaConstraints(t.properties).then((function(e){var n,c;if(e.videoTrack&&e.audioTrack||e.audioTrack&&!1===(null===(n=e.constraints)||void 0===n?void 0:n.video)||e.videoTrack&&!1===(null===(c=e.constraints)||void 0===c?void 0:c.audio))l(t.openvidu.addAlreadyProvidedTracks(e,new MediaStream));else{i=e.constraints;var d={mediaConstraints:i,publisherProperties:t.properties};t.stream.setOutboundStreamOptions(d);var f=void 0===i.audio||i.audio;o.audio=!t.stream.isSendScreen()&&f,o.video=i.video,r=Date.now(),t.setPermissionDialogTimer(s),t.stream.isSendScreen()&&navigator.mediaDevices["getDisplayMedia"]&&!a.isElectron()?navigator.mediaDevices["getDisplayMedia"]({video:!0}).then((function(n){t.openvidu.addAlreadyProvidedTracks(e,n),u(n,f)})).catch((function(t){h(t)})):navigator.mediaDevices.getUserMedia(o).then((function(n){t.openvidu.addAlreadyProvidedTracks(e,n),u(n,f)})).catch((function(t){h(t)}))}})).catch((function(t){c(t)}))}))},e.prototype.getVideoDimensions=function(t){var e=this;return new Promise((function(t,n){var r,i=a.isIonicIos()||a.isIOSWithSafari(),o=function(){var n,o;if("function"===typeof e.stream.getMediaStream().getVideoTracks()[0].getSettings){var s=e.stream.getMediaStream().getVideoTracks()[0].getSettings();n=s.width||e.videoReference.videoWidth,o=s.height||e.videoReference.videoHeight}else v.warn("MediaStreamTrack does not have getSettings method on "+a.getDescription()),n=e.videoReference.videoWidth,o=e.videoReference.videoHeight;null!=r&&e.videoReference.removeEventListener("loadedmetadata",r),i&&document.body.removeChild(e.videoReference),t({width:n,height:o})};e.videoReference.readyState>=1?o():(r=function(){if(e.videoReference.videoWidth)o();else var t=setInterval((function(){e.videoReference.videoWidth&&(clearInterval(t),o())}),40)},e.videoReference.addEventListener("loadedmetadata",r),i&&document.body.appendChild(e.videoReference))}))},e.prototype.reestablishStreamPlayingEvent=function(){this.ee.getListeners("streamPlaying").length>0&&this.addPlayEventToFirstVideo()},e.prototype.initializeVideoReference=function(t){this.videoReference=document.createElement("video"),this.videoReference.setAttribute("muted","true"),this.videoReference.style.display="none",(a.isSafariBrowser()||a.isIPhoneOrIPad()&&(a.isChromeMobileBrowser()||a.isEdgeMobileBrowser()||a.isOperaMobileBrowser()||a.isFirefoxMobileBrowser()))&&this.videoReference.setAttribute("playsinline","true"),this.stream.setMediaStream(t),this.firstVideoElement&&this.createVideoElement(this.firstVideoElement.targetElement,this.properties.insertMode),this.videoReference.srcObject=t},e.prototype.setPermissionDialogTimer=function(t){var e=this;this.permissionDialogTimeout=setTimeout((function(){e.emitEvent("accessDialogOpened",[])}),t)},e.prototype.clearPermissionDialogTimer=function(t,e){clearTimeout(this.permissionDialogTimeout),Date.now()-t>e&&this.emitEvent("accessDialogClosed",[])},e}(l.StreamManager);e.Publisher=m},"3cf7":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OpenVidu=void 0;var r,i=n("b489"),o=n("3c4c"),a=n("2533"),s=n("92c2"),c=n("0703"),l=n("4edf"),u=n("fdd2"),h=n("f66e"),d=n("e237"),f=n("fb6e"),p=n("11c5"),g=n("49d9"),v=n("e0ef"),m=n("01e1"),b=n("bea1"),y=h.OpenViduLogger.getInstance(),S=function(){function t(){var t=this;this.masterNodeHasCrashed=!1,this.publishers=[],this.secret="",this.recorder=!1,this.life=-1,this.advancedConfiguration={},this.webrtcStatsInterval=-1,this.sendBrowserLogs=g.OpenViduLoggerConfiguration.disabled,this.isPro=!1,this.ee=new v,r=d.PlatformUtils.getInstance(),this.libraryVersion=b.version,y.info("OpenVidu initialized"),y.info("Platform detected: "+r.getDescription()),y.info("openvidu-browser version: "+this.libraryVersion),(r.isMobileDevice()||r.isReactNative())&&this.onOrientationChanged((function(){t.publishers.forEach((function(e){e.stream.isLocalStreamPublished&&e.stream&&e.stream.hasVideo&&t.sendNewVideoDimensionsIfRequired(e,"deviceRotated",75,10)}))}))}return t.prototype.onOrientationChanged=function(t){window.addEventListener("orientationchange",t)},t.prototype.sendNewVideoDimensionsIfRequired=function(t,e,n,r){var i=this,o=0,a=t.stream.videoDimensions.width,s=t.stream.videoDimensions.height,c=setInterval((function(){o++,o>r&&clearTimeout(c),t.getVideoDimensions(t.stream.getMediaStream()).then((function(n){n.width===a&&n.height===s||(clearTimeout(c),i.sendVideoDimensionsChangedEvent(t,e,a,s,n.width,n.height))}))}),n)},t.prototype.sendVideoDimensionsChangedEvent=function(t,e,n,r,i,o){var a=this;t.stream.videoDimensions={width:i||0,height:o||0},this.sendRequest("streamPropertyChanged",{streamId:t.stream.streamId,property:"videoDimensions",newValue:JSON.stringify(t.stream.videoDimensions),reason:e},(function(i,o){i?y.error("Error sending 'streamPropertyChanged' event",i):(a.session.emitEvent("streamPropertyChanged",[new c.StreamPropertyChangedEvent(a.session,t.stream,"videoDimensions",t.stream.videoDimensions,{width:n,height:r},e)]),t.emitEvent("streamPropertyChanged",[new c.StreamPropertyChangedEvent(t,t.stream,"videoDimensions",t.stream.videoDimensions,{width:n,height:r},e)]),a.session.sendVideoData(t))}))},t.prototype.initSession=function(){return this.session=new a.Session(this),this.session},t.prototype.initPublisher=function(t,e,n){var r;e&&"function"!==typeof e?(r=e,r={audioSource:"undefined"!==typeof r.audioSource?r.audioSource:void 0,frameRate:"undefined"!==typeof MediaStreamTrack&&r.videoSource instanceof MediaStreamTrack?void 0:"undefined"!==typeof r.frameRate?r.frameRate:void 0,insertMode:"undefined"!==typeof r.insertMode?"string"===typeof r.insertMode?u.VideoInsertMode[r.insertMode]:r.insertMode:u.VideoInsertMode.APPEND,mirror:"undefined"===typeof r.mirror||r.mirror,publishAudio:"undefined"===typeof r.publishAudio||r.publishAudio,publishVideo:"undefined"===typeof r.publishVideo||r.publishVideo,resolution:"undefined"!==typeof MediaStreamTrack&&r.videoSource instanceof MediaStreamTrack?void 0:"undefined"!==typeof r.resolution?r.resolution:"640x480",videoSource:"undefined"!==typeof r.videoSource?r.videoSource:void 0,filter:r.filter}):r={insertMode:u.VideoInsertMode.APPEND,mirror:!0,publishAudio:!0,publishVideo:!0,resolution:"640x480"};var i,a=new o.Publisher(t,r,this);return e&&"function"===typeof e?i=e:n&&(i=n),a.initialize().then((function(){void 0!==i&&i(void 0),a.emitEvent("accessAllowed",[])})).catch((function(t){void 0!==i&&i(t),a.emitEvent("accessDenied",[t])})),this.publishers.push(a),a},t.prototype.initPublisherAsync=function(t,e){var n=this;return new Promise((function(r,i){var o,a=function(t){t?i(t):r(o)};o=e?n.initPublisher(t,e,a):n.initPublisher(t,a)}))},t.prototype.initLocalRecorder=function(t){return new i.LocalRecorder(t)},t.prototype.checkSystemRequirements=function(){return r.isIPhoneOrIPad()?r.isIOSWithSafari()||r.isIonicIos()||r.isChromeMobileBrowser()||r.isEdgeMobileBrowser()||r.isOperaMobileBrowser()||r.isFirefoxMobileBrowser()?1:0:r.isChromeBrowser()||r.isChromeMobileBrowser()||r.isFirefoxBrowser()||r.isFirefoxMobileBrowser()||r.isOperaBrowser()||r.isOperaMobileBrowser()||r.isEdgeBrowser()||r.isEdgeMobileBrowser()||r.isSafariBrowser()||r.isAndroidBrowser()||r.isElectron()||r.isSamsungBrowser()?1:0},t.prototype.checkScreenSharingCapabilities=function(){return r.canScreenShare()},t.prototype.getDevices=function(){return new Promise((function(t,e){navigator.mediaDevices.enumerateDevices().then((function(e){var n,i=[];r.isIonicAndroid()&&"undefined"!=typeof cordova&&(null===(n=null===cordova||void 0===cordova?void 0:cordova.plugins)||void 0===n?void 0:n.EnumerateDevicesPlugin)?cordova.plugins.EnumerateDevicesPlugin.getEnumerateDevices().then((function(n){var r=[],o=[],a=[];r=n.filter((function(t){return"audioinput"===t.kind})),o=e.filter((function(t){return"videoinput"===t.kind})),a=e.filter((function(t){return"audioinput"===t.kind})),o.forEach((function(t,e){if(t.label)i.push({kind:t.kind,deviceId:t.deviceId,label:t.label});else{var n="";n=0===e?"Front Camera":1===e?"Back Camera":"Unknown Camera",i.push({kind:t.kind,deviceId:t.deviceId,label:n})}})),a.forEach((function(t,e){if(t.label)i.push({kind:t.kind,deviceId:t.deviceId,label:t.label});else{var n="";switch(e){case 0:n="Default";break;case 1:var o=r.filter((function(t){return t.label.includes("Built")}))[0];n=o?o.label:"Built-in Microphone";break;case 2:var a=r.filter((function(t){return t.label.includes("Wired")}))[0];n=a?a.label:"Headset earpiece";break;case 3:var s=r.filter((function(t){return t.label.includes("Bluetooth")}))[0];n=s?s.label:"Wireless";break;default:n="Unknown Microphone";break}i.push({kind:t.kind,deviceId:t.deviceId,label:n})}})),t(i)})):(e.forEach((function(t){"audioinput"!==t.kind&&"videoinput"!==t.kind||i.push({kind:t.kind,deviceId:t.deviceId,label:t.label})})),t(i))})).catch((function(t){y.error("Error getting devices",t),e(t)}))}))},t.prototype.getUserMedia=function(t){var e=this;return new Promise((function(n,i){var o=function(t,r){var o=void 0===r.audio||r.audio,a={audio:o,video:!1};navigator.mediaDevices.getUserMedia(a).then((function(e){t.addTrack(e.getAudioTracks()[0]),n(t)})).catch((function(n){t.getAudioTracks().forEach((function(t){t.stop()})),t.getVideoTracks().forEach((function(t){t.stop()})),i(e.generateAudioDeviceError(n,a))}))};e.generateMediaConstraints(t).then((function(a){var s,c;if(a.videoTrack&&a.audioTrack||a.audioTrack&&!1===(null===(s=a.constraints)||void 0===s?void 0:s.video)||a.videoTrack&&!1===(null===(c=a.constraints)||void 0===c?void 0:c.audio))n(e.addAlreadyProvidedTracks(a,new MediaStream));else{a.videoTrack&&delete a.constraints.video,a.audioTrack&&delete a.constraints.audio;var u=!1;if("string"===typeof t.videoSource&&("screen"===t.videoSource||"window"===t.videoSource||r.isElectron()&&t.videoSource.startsWith("screen:"))&&(u=!a.audioTrack&&null!==t.audioSource&&!1!==t.audioSource,navigator.mediaDevices["getDisplayMedia"]&&!r.isElectron()))return void navigator.mediaDevices["getDisplayMedia"]({video:!0}).then((function(t){e.addAlreadyProvidedTracks(a,t),u?o(t,a.constraints):n(t)})).catch((function(t){var e=l.OpenViduErrorName.SCREEN_CAPTURE_DENIED,n=t.toString();i(new l.OpenViduError(e,n))}));var h=u?{video:a.constraints.video}:a.constraints;navigator.mediaDevices.getUserMedia(h).then((function(t){e.addAlreadyProvidedTracks(a,t),u?o(t,a.constraints):n(t)})).catch((function(e){var n,r=e.toString();n="screen"!==t.videoSource?l.OpenViduErrorName.DEVICE_ACCESS_DENIED:l.OpenViduErrorName.SCREEN_CAPTURE_DENIED,i(new l.OpenViduError(n,r))}))}})).catch((function(t){i(t)}))}))},t.prototype.enableProdMode=function(){y.enableProdMode()},t.prototype.setAdvancedConfiguration=function(t){this.advancedConfiguration=t},t.prototype.generateMediaConstraints=function(t){var e=this;return new Promise((function(n,r){var i={audioTrack:void 0,videoTrack:void 0,constraints:{audio:void 0,video:void 0}},o=t.audioSource,a=t.videoSource;if(null!==o&&!1!==o||(i.constraints.audio=!1),null!==a&&!1!==a||(i.constraints.video=!1),!1===i.constraints.audio&&!1===i.constraints.video&&r(new l.OpenViduError(l.OpenViduErrorName.NO_INPUT_SOURCE_SET,"Properties 'audioSource' and 'videoSource' cannot be set to false or null at the same time")),"undefined"!==typeof MediaStreamTrack&&o instanceof MediaStreamTrack&&(i.audioTrack=o),"undefined"!==typeof MediaStreamTrack&&a instanceof MediaStreamTrack&&(i.videoTrack=a),void 0===o&&(i.constraints.audio=!0),void 0===a&&(i.constraints.video={width:{ideal:640},height:{ideal:480}}),null!==a&&!1!==a){if(t.resolution){var s=t.resolution.toLowerCase().split("x"),c=Number(s[0]),u=Number(s[1]);i.constraints.video={width:{ideal:c},height:{ideal:u}}}t.frameRate&&(i.constraints.video.frameRate={ideal:t.frameRate})}e.configureDeviceIdOrScreensharing(i,t,n,r),n(i)}))},t.prototype.startWs=function(t){var e={heartbeat:5e3,ws:{uri:this.wsUri+"?sessionId="+this.session.sessionId,onconnected:t,ondisconnect:this.disconnectCallback.bind(this),onreconnecting:this.reconnectingCallback.bind(this),onreconnected:this.reconnectedCallback.bind(this),ismasternodecrashed:this.isMasterNodeCrashed.bind(this)},rpc:{requestTimeout:1e4,participantJoined:this.session.onParticipantJoined.bind(this.session),participantPublished:this.session.onParticipantPublished.bind(this.session),participantUnpublished:this.session.onParticipantUnpublished.bind(this.session),participantLeft:this.session.onParticipantLeft.bind(this.session),participantEvicted:this.session.onParticipantEvicted.bind(this.session),recordingStarted:this.session.onRecordingStarted.bind(this.session),recordingStopped:this.session.onRecordingStopped.bind(this.session),sendMessage:this.session.onNewMessage.bind(this.session),streamPropertyChanged:this.session.onStreamPropertyChanged.bind(this.session),connectionPropertyChanged:this.session.onConnectionPropertyChanged.bind(this.session),networkQualityLevelChanged:this.session.onNetworkQualityLevelChangedChanged.bind(this.session),filterEventDispatched:this.session.onFilterEventDispatched.bind(this.session),iceCandidate:this.session.recvIceCandidate.bind(this.session),mediaError:this.session.onMediaError.bind(this.session),masterNodeCrashedNotification:this.onMasterNodeCrashedNotification.bind(this),forciblyReconnectSubscriber:this.session.onForciblyReconnectSubscriber.bind(this.session)}};this.jsonRpcClient=new m.clients.JsonRpcClient(e)},t.prototype.onMasterNodeCrashedNotification=function(t){console.error("Master Node has crashed"),this.masterNodeHasCrashed=!0,this.session.onLostConnection("nodeCrashed"),this.jsonRpcClient.close(4103,"Master Node has crashed")},t.prototype.getWsReadyState=function(){return this.jsonRpcClient.getReadyState()},t.prototype.closeWs=function(){this.jsonRpcClient.close(4102,"Connection closed by client")},t.prototype.sendRequest=function(t,e,n){e&&e instanceof Function&&(n=e,e={}),y.debug('Sending request: {method:"'+t+'", params: '+JSON.stringify(e)+"}"),this.jsonRpcClient.send(t,e,n)},t.prototype.getWsUri=function(){return this.wsUri},t.prototype.getSecret=function(){return this.secret},t.prototype.getRecorder=function(){return this.recorder},t.prototype.generateAudioDeviceError=function(t,e){var n,r;switch("Error"===t.name&&(t.name=t.constructor.name),t.name.toLowerCase()){case"notfounderror":return n=l.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r=t.toString(),new l.OpenViduError(n,r);case"notallowederror":return n=l.OpenViduErrorName.DEVICE_ACCESS_DENIED,r=t.toString(),new l.OpenViduError(n,r);case"overconstrainederror":return"deviceid"===t.constraint.toLowerCase()?(n=l.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r="Audio input device with deviceId '"+e.audio.deviceId.exact+"' not found"):(n=l.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,r="Audio input device doesn't support the value passed for constraint '"+t.constraint+"'"),new l.OpenViduError(n,r);case"notreadableerror":return n=l.OpenViduErrorName.DEVICE_ALREADY_IN_USE,r=t.toString(),new l.OpenViduError(n,r);default:return new l.OpenViduError(l.OpenViduErrorName.INPUT_AUDIO_DEVICE_GENERIC_ERROR,t.toString())}},t.prototype.addAlreadyProvidedTracks=function(t,e){return t.videoTrack&&e.addTrack(t.videoTrack),t.audioTrack&&e.addTrack(t.audioTrack),e},t.prototype.configureDeviceIdOrScreensharing=function(t,e,n,i){var o=this,a=e.audioSource,s=e.videoSource;if("string"===typeof a&&(t.constraints.audio={deviceId:{exact:a}}),"string"===typeof s)if(this.isScreenShare(s))if(this.checkScreenSharingCapabilities())if(r.isElectron()){var c="screen:",u=s,h=u.substr(u.indexOf(c)+c.length);t.constraints.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:h}},n(t)}else{if(this.advancedConfiguration.screenShareChromeExtension&&!r.isFirefoxBrowser()&&!r.isFirefoxMobileBrowser()&&!navigator.mediaDevices["getDisplayMedia"])return void p.getScreenConstraints((function(e,r){if(e||r.mandatory&&"screen"===r.mandatory.chromeMediaSource){if("permission-denied"!==e&&"PermissionDeniedError"!==e){var a=o.advancedConfiguration.screenShareChromeExtension.split("/").pop().trim();return void p.getChromeExtensionStatus(a,(function(t){if("installed-disabled"===t){var e=new l.OpenViduError(l.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");y.error(e),i(e)}if("not-installed"===t){var n=new l.OpenViduError(l.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,o.advancedConfiguration.screenShareChromeExtension);y.error(n),i(n)}}))}var s=new l.OpenViduError(l.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");y.error(s),i(s)}else t.constraints.video=r,n(t)}));if(!navigator.mediaDevices["getDisplayMedia"]){var d=r.isFirefoxBrowser()||r.isFirefoxMobileBrowser()?e.videoSource:void 0;return void f.getScreenId(d,(function(e,r,a){if(e)if("not-installed"===e){var s=o.advancedConfiguration.screenShareChromeExtension?o.advancedConfiguration.screenShareChromeExtension:"https://chrome.google.com/webstore/detail/openvidu-screensharing/lfcgfepafnobdloecchnfaclibenjold",c=new l.OpenViduError(l.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,s);y.error(c),i(c)}else if("installed-disabled"===e){c=new l.OpenViduError(l.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");y.error(c),i(c)}else if("permission-denied"===e){c=new l.OpenViduError(l.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");y.error(c),i(c)}else{c=new l.OpenViduError(l.OpenViduErrorName.GENERIC_ERROR,"Unknown error when accessing screen share");y.error(c),y.error(e),i(c)}else t.constraints.video=a.video,n(t)}))}n(t)}else{var g=new l.OpenViduError(l.OpenViduErrorName.SCREEN_SHARING_NOT_SUPPORTED,"You can only screen share in desktop Chrome, Firefox, Opera, Safari (>=13.0), Edge (>= 80) or Electron. Detected client: "+r.getName()+" "+r.getVersion());y.error(g),i(g)}else this.setVideoSource(t,s)},t.prototype.setVideoSource=function(t,e){t.constraints.video||(t.constraints.video={}),t.constraints.video["deviceId"]={exact:e}},t.prototype.disconnectCallback=function(){y.warn("Websocket connection lost"),this.isRoomAvailable()?this.session.onLostConnection("networkDisconnect"):alert("Connection error. Please reload page.")},t.prototype.reconnectingCallback=function(){y.warn("Websocket connection lost (reconnecting)"),this.isRoomAvailable()?this.session.emitEvent("reconnecting",[]):alert("Connection error. Please reload page.")},t.prototype.reconnectedCallback=function(){var t=this;if(y.warn("Websocket reconnected"),this.isRoomAvailable())if(this.session.connection)this.sendRequest("connect",{sessionId:this.session.connection.rpcSessionId},(function(e,n){if(e)if(t.isMasterNodeCrashed())y.warn("Master Node has crashed!");else{y.error(e);var r=function(e){y.warn("Websocket was able to reconnect to OpenVidu Server, but your Connection was already destroyed due to timeout. You are no longer a participant of the Session and your media streams have been destroyed"),t.session.onLostConnection("networkDisconnect"),t.jsonRpcClient.close(4101,"Reconnection fault")};-1===t.life?r(e):t.sendRequest("sessionStatus",{sessionId:t.session.sessionId},(function(e,n){t.life===n.life?r(e):(y.warn("Websocket was able to reconnect to OpenVidu Server, but your Master Node crashed."),t.session.onLostConnection("nodeCrashed"),t.jsonRpcClient.close(4101,"Reconnection fault"))}))}else t.jsonRpcClient.resetPing(),t.session.onRecoveredConnection()}));else{y.warn("There was no previous connection when running reconnection callback");var e=new s.SessionDisconnectedEvent(this.session,"networkDisconnect");this.session.ee.emitEvent("sessionDisconnected",[e]),e.callDefaultBehavior()}else alert("Connection error. Please reload page.")},t.prototype.isMasterNodeCrashed=function(){return this.masterNodeHasCrashed},t.prototype.isRoomAvailable=function(){return void 0!==this.session&&this.session instanceof a.Session||(y.warn("Session instance not found"),!1)},t.prototype.isScreenShare=function(t){return"screen"===t||"window"===t||r.isElectron()&&t.startsWith("screen:")},t}();e.OpenVidu=S},"3d9c":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventDispatcher=e.ExceptionEvent=e.NetworkQualityLevelChangedEvent=e.FilterEvent=e.ConnectionPropertyChangedEvent=e.StreamPropertyChangedEvent=e.VideoElementEvent=e.StreamManagerEvent=e.StreamEvent=e.SignalEvent=e.SessionDisconnectedEvent=e.RecordingEvent=e.PublisherSpeakingEvent=e.ConnectionEvent=e.Event=e.VideoInsertMode=e.OpenViduError=e.LocalRecorderState=e.Filter=e.LocalRecorder=e.Connection=e.Stream=e.StreamManager=e.Subscriber=e.Publisher=e.Session=e.OpenVidu=void 0;var r=n("3029"),i=n("3cf7");Object.defineProperty(e,"OpenVidu",{enumerable:!0,get:function(){return i.OpenVidu}});var o=n("2533");Object.defineProperty(e,"Session",{enumerable:!0,get:function(){return o.Session}});var a=n("3c4c");Object.defineProperty(e,"Publisher",{enumerable:!0,get:function(){return a.Publisher}});var s=n("6e4e");Object.defineProperty(e,"Subscriber",{enumerable:!0,get:function(){return s.Subscriber}});var c=n("3f7b");Object.defineProperty(e,"StreamManager",{enumerable:!0,get:function(){return c.StreamManager}});var l=n("0cf2");Object.defineProperty(e,"Stream",{enumerable:!0,get:function(){return l.Stream}});var u=n("af24");Object.defineProperty(e,"Connection",{enumerable:!0,get:function(){return u.Connection}});var h=n("b489");Object.defineProperty(e,"LocalRecorder",{enumerable:!0,get:function(){return h.LocalRecorder}});var d=n("ef86");Object.defineProperty(e,"Filter",{enumerable:!0,get:function(){return d.Filter}});var f=n("627d");Object.defineProperty(e,"LocalRecorderState",{enumerable:!0,get:function(){return f.LocalRecorderState}});var p=n("4edf");Object.defineProperty(e,"OpenViduError",{enumerable:!0,get:function(){return p.OpenViduError}});var g=n("fdd2");Object.defineProperty(e,"VideoInsertMode",{enumerable:!0,get:function(){return g.VideoInsertMode}});var v=n("8733");Object.defineProperty(e,"Event",{enumerable:!0,get:function(){return v.Event}});var m=n("f0a5");Object.defineProperty(e,"ConnectionEvent",{enumerable:!0,get:function(){return m.ConnectionEvent}});var b=n("7bca");Object.defineProperty(e,"PublisherSpeakingEvent",{enumerable:!0,get:function(){return b.PublisherSpeakingEvent}});var y=n("ad42");Object.defineProperty(e,"RecordingEvent",{enumerable:!0,get:function(){return y.RecordingEvent}});var S=n("92c2");Object.defineProperty(e,"SessionDisconnectedEvent",{enumerable:!0,get:function(){return S.SessionDisconnectedEvent}});var w=n("b2e1");Object.defineProperty(e,"SignalEvent",{enumerable:!0,get:function(){return w.SignalEvent}});var E=n("4def");Object.defineProperty(e,"StreamEvent",{enumerable:!0,get:function(){return E.StreamEvent}});var C=n("1f15");Object.defineProperty(e,"StreamManagerEvent",{enumerable:!0,get:function(){return C.StreamManagerEvent}});var x=n("a081");Object.defineProperty(e,"VideoElementEvent",{enumerable:!0,get:function(){return x.VideoElementEvent}});var O=n("0703");Object.defineProperty(e,"StreamPropertyChangedEvent",{enumerable:!0,get:function(){return O.StreamPropertyChangedEvent}});var _=n("f1bf");Object.defineProperty(e,"ConnectionPropertyChangedEvent",{enumerable:!0,get:function(){return _.ConnectionPropertyChangedEvent}});var T=n("fa28");Object.defineProperty(e,"FilterEvent",{enumerable:!0,get:function(){return T.FilterEvent}});var k=n("043b");Object.defineProperty(e,"NetworkQualityLevelChangedEvent",{enumerable:!0,get:function(){return k.NetworkQualityLevelChangedEvent}});var I=n("e9cb");Object.defineProperty(e,"ExceptionEvent",{enumerable:!0,get:function(){return I.ExceptionEvent}});var P=n("0f3b");Object.defineProperty(e,"EventDispatcher",{enumerable:!0,get:function(){return P.EventDispatcher}}),r.JL.setOptions({enabled:!1})},"3e1e":function(t,e,n){"use strict";(function(e){var r=n("3fb5"),i=n("7577"),o=n("1548"),a=n("df09"),s=n("73aa"),c=n("26a0");function l(t){if(!s.enabled&&!a.enabled)throw new Error("Transport created when disabled");i.call(this,t,"/xhr_streaming",o,a)}r(l,i),l.enabled=function(t){return!t.nullOrigin&&(!c.isOpera()&&a.enabled)},l.transportName="xhr-streaming",l.roundTrips=2,l.needBody=!!e.document,t.exports=l}).call(this,n("c8ba"))},"3f7b":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.StreamManager=void 0;var i,o=n("0f3b"),a=n("1f15"),s=n("a081"),c=n("fdd2"),l=n("f66e"),u=n("e237"),h=n("e9cb"),d=l.OpenViduLogger.getInstance(),f=function(t){function e(e,n){var r=t.call(this)||this;if(r.videos=[],r.lazyLaunchVideoElementCreatedEvent=!1,i=u.PlatformUtils.getInstance(),r.stream=e,r.stream.streamManager=r,r.remote=!r.stream.isLocal(),n){var o=void 0;"string"===typeof n?o=document.getElementById(n):n instanceof HTMLElement&&(o=n),o&&(r.firstVideoElement={targetElement:o,video:document.createElement("video"),id:"",canplayListenerAdded:!1},(i.isSafariBrowser()||i.isIPhoneOrIPad()&&(i.isChromeMobileBrowser()||i.isEdgeMobileBrowser()||i.isOperaMobileBrowser()||i.isFirefoxMobileBrowser()))&&r.firstVideoElement.video.setAttribute("playsinline","true"),r.targetElement=o,r.element=o)}return r.canPlayListener=function(){r.deactivateStreamPlayingEventExceptionTimeout(),r.remote?(d.info("Remote 'Stream' with id ["+r.stream.streamId+"] video is now playing"),r.ee.emitEvent("videoPlaying",[new s.VideoElementEvent(r.videos[0].video,r,"videoPlaying")])):r.stream.displayMyRemote()?(d.info("Your own remote 'Stream' with id ["+r.stream.streamId+"] video is now playing"),r.ee.emitEvent("remoteVideoPlaying",[new s.VideoElementEvent(r.videos[0].video,r,"remoteVideoPlaying")])):(d.info("Your local 'Stream' with id ["+r.stream.streamId+"] video is now playing"),r.ee.emitEvent("videoPlaying",[new s.VideoElementEvent(r.videos[0].video,r,"videoPlaying")])),r.ee.emitEvent("streamPlaying",[new a.StreamManagerEvent(r,"streamPlaying",void 0)])},r}return r(e,t),e.prototype.on=function(e,n){return t.prototype.onAux.call(this,e,"Event '"+e+"' triggered by '"+(this.remote?"Subscriber":"Publisher")+"'",n),"videoElementCreated"===e&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&(this.ee.emitEvent("videoElementCreated",[new s.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!1),"streamPlaying"!==e&&"videoPlaying"!==e||this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&(this.ee.emitEvent("streamPlaying",[new a.StreamManagerEvent(this,"streamPlaying",void 0)]),this.ee.emitEvent("videoPlaying",[new s.VideoElementEvent(this.videos[0].video,this,"videoPlaying")])),this.stream.hasAudio&&("publisherStartSpeaking"===e&&this.stream.enableHarkSpeakingEvent(),"publisherStopSpeaking"===e&&this.stream.enableHarkStoppedSpeakingEvent(),"streamAudioVolumeChange"===e&&this.stream.enableHarkVolumeChangeEvent(!1)),this},e.prototype.once=function(e,n){return t.prototype.onceAux.call(this,e,"Event '"+e+"' triggered once by '"+(this.remote?"Subscriber":"Publisher")+"'",n),"videoElementCreated"===e&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&this.ee.emitEvent("videoElementCreated",[new s.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),"streamPlaying"!==e&&"videoPlaying"!==e||this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&(this.ee.emitEvent("streamPlaying",[new a.StreamManagerEvent(this,"streamPlaying",void 0)]),this.ee.emitEvent("videoPlaying",[new s.VideoElementEvent(this.videos[0].video,this,"videoPlaying")])),this.stream.hasAudio&&("publisherStartSpeaking"===e&&this.stream.enableOnceHarkSpeakingEvent(),"publisherStopSpeaking"===e&&this.stream.enableOnceHarkStoppedSpeakingEvent(),"streamAudioVolumeChange"===e&&this.stream.enableOnceHarkVolumeChangeEvent(!1)),this},e.prototype.off=function(e,n){if(t.prototype.off.call(this,e,n),"publisherStartSpeaking"===e){var r=this.ee.getListeners(e).length+this.stream.session.ee.getListeners(e).length;0===r&&this.stream.disableHarkSpeakingEvent(!1)}if("publisherStopSpeaking"===e){var i=this.ee.getListeners(e).length+this.stream.session.ee.getListeners(e).length;0===i&&this.stream.disableHarkStoppedSpeakingEvent(!1)}if("streamAudioVolumeChange"===e){var o=this.ee.getListeners(e).length;0===o&&this.stream.disableHarkVolumeChangeEvent(!1)}return this},e.prototype.addVideoElement=function(t){this.initializeVideoProperties(t),!this.remote&&this.stream.displayMyRemote()&&t.srcObject!==this.stream.getMediaStream()&&(t.srcObject=this.stream.getMediaStream());for(var e=0,n=this.videos;e<n.length;e++){var r=n[e];if(r.video===t)return 0}for(var i=1,o=0,a=this.stream.session.streamManagers;o<a.length;o++){var s=a[o];if(s.disassociateVideo(t)){i=-1;break}}return this.stream.session.streamManagers.forEach((function(e){e.disassociateVideo(t)})),this.pushNewStreamManagerVideo({video:t,id:t.id,canplayListenerAdded:!1}),d.info("New video element associated to ",this),i},e.prototype.createVideoElement=function(t,e){var n;if("string"===typeof t){if(n=document.getElementById(t),!n)throw new Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+t)}else{if(!(t instanceof HTMLElement))throw new Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+t);n=t}var r=this.createVideo();this.initializeVideoProperties(r);var i=e||c.VideoInsertMode.APPEND;switch(i){case c.VideoInsertMode.AFTER:n.parentNode.insertBefore(r,n.nextSibling);break;case c.VideoInsertMode.APPEND:n.appendChild(r);break;case c.VideoInsertMode.BEFORE:n.parentNode.insertBefore(r,n);break;case c.VideoInsertMode.PREPEND:n.insertBefore(r,n.childNodes[0]);break;case c.VideoInsertMode.REPLACE:n.parentNode.replaceChild(r,n);break;default:i=c.VideoInsertMode.APPEND,n.appendChild(r);break}var o={targetElement:n,video:r,insertMode:i,id:r.id,canplayListenerAdded:!1};return this.pushNewStreamManagerVideo(o),this.ee.emitEvent("videoElementCreated",[new s.VideoElementEvent(o.video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!!this.firstVideoElement,r},e.prototype.updatePublisherSpeakingEventsOptions=function(t){var e=this.stream.harkOptions?this.stream.harkOptions:this.stream.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{},n="number"===typeof t.interval?t.interval:"number"===typeof e.interval?e.interval:100,r="number"===typeof t.threshold?t.threshold:"number"===typeof e.threshold?e.threshold:-50;this.stream.harkOptions={interval:n,threshold:r},this.stream.speechEvent&&(this.stream.speechEvent.setInterval(n),this.stream.speechEvent.setThreshold(r))},e.prototype.initializeVideoProperties=function(t){!this.remote&&this.stream.displayMyRemote()||t.srcObject!==this.stream.getMediaStream()&&(t.srcObject=this.stream.getMediaStream()),t.autoplay=!0,t.controls=!1,(i.isSafariBrowser()||i.isIPhoneOrIPad()&&(i.isChromeMobileBrowser()||i.isEdgeMobileBrowser()||i.isOperaMobileBrowser()||i.isFirefoxMobileBrowser()))&&t.setAttribute("playsinline","true"),t.id||(t.id=(this.remote?"remote-":"local-")+"video-"+this.stream.streamId,!this.id&&this.targetElement&&(this.id=t.id)),this.remote||this.stream.displayMyRemote()||(t.muted=!0,"rotateY(180deg)"!==t.style.transform||this.stream.outboundStreamOpts.publisherProperties.mirror?this.stream.outboundStreamOpts.publisherProperties.mirror&&!this.stream.isSendScreen()&&this.mirrorVideo(t):this.removeMirrorVideo(t))},e.prototype.removeAllVideos=function(){for(var t=this,e=this.stream.session.streamManagers.length-1;e>=0;--e)this.stream.session.streamManagers[e]===this&&this.stream.session.streamManagers.splice(e,1);this.videos.forEach((function(e){e.video&&e.video.removeEventListener&&e.video.removeEventListener("canplay",t.canPlayListener),e.canplayListenerAdded=!1,e.targetElement&&(e.video.parentNode.removeChild(e.video),t.ee.emitEvent("videoElementDestroyed",[new s.VideoElementEvent(e.video,t,"videoElementDestroyed")])),t.removeSrcObject(e),t.videos.filter((function(t){return!t.targetElement}))}))},e.prototype.disassociateVideo=function(t){for(var e=!1,n=0;n<this.videos.length;n++)if(this.videos[n].video===t){this.videos[n].video.removeEventListener("canplay",this.canPlayListener),this.videos.splice(n,1),e=!0,d.info("Video element disassociated from ",this);break}return e},e.prototype.addPlayEventToFirstVideo=function(){this.videos[0]&&this.videos[0].video&&!this.videos[0].canplayListenerAdded&&(this.activateStreamPlayingEventExceptionTimeout(),this.videos[0].video.addEventListener("canplay",this.canPlayListener),this.videos[0].canplayListenerAdded=!0)},e.prototype.updateMediaStream=function(t){this.videos.forEach((function(e){if(e.video.srcObject=t,i.isIonicIos()){var n=e.video.parentElement,r=e.video;n.replaceChild(r,e.video),e.video=r}}))},e.prototype.emitEvent=function(t,e){this.ee.emitEvent(t,e)},e.prototype.createVideo=function(){return document.createElement("video")},e.prototype.removeSrcObject=function(t){t.video.srcObject=null,this.deactivateStreamPlayingEventExceptionTimeout()},e.prototype.pushNewStreamManagerVideo=function(t){this.videos.push(t),this.addPlayEventToFirstVideo(),-1===this.stream.session.streamManagers.indexOf(this)&&this.stream.session.streamManagers.push(this)},e.prototype.mirrorVideo=function(t){i.isIonicIos()||(t.style.transform="rotateY(180deg)",t.style.webkitTransform="rotateY(180deg)")},e.prototype.removeMirrorVideo=function(t){t.style.transform="unset",t.style.webkitTransform="unset"},e.prototype.activateStreamPlayingEventExceptionTimeout=function(){var t=this;if(this.remote&&null==this.streamPlayingEventExceptionTimeout){var e=this.stream.session.openvidu.advancedConfiguration.noStreamPlayingEventExceptionTimeout||4e3;this.streamPlayingEventExceptionTimeout=setTimeout((function(){var n="StreamManager of Stream "+t.stream.streamId+" ("+(t.remote?"Subscriber":"Publisher")+') did not trigger "streamPlaying" event in '+e+" ms";d.warn(n),t.stream.session.emitEvent("exception",[new h.ExceptionEvent(t.stream.session,h.ExceptionEventName.NO_STREAM_PLAYING_EVENT,t,n)]),delete t.streamPlayingEventExceptionTimeout}),e)}},e.prototype.deactivateStreamPlayingEventExceptionTimeout=function(){clearTimeout(this.streamPlayingEventExceptionTimeout),delete this.streamPlayingEventExceptionTimeout},e}(o.EventDispatcher);e.StreamManager=f},"3fb5":function(t,e){"function"===typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},"408a":function(t,e,n){var r=n("e330");t.exports=r(1..valueOf)},"40b2":function(t,e,n){"use strict";var r=n("3fb5"),i=n("54d6"),o=n("73aa"),a=n("7577");function s(t){if(!i.enabled)throw new Error("Transport created when disabled");a.call(this,t,"/htmlfile",i,o)}r(s,a),s.enabled=function(t){return i.enabled&&t.sameOrigin},s.transportName="htmlfile",s.roundTrips=2,t.exports=s},4176:function(t,e,n){},"440d":function(t,e,n){"use strict";t.exports=function(t,e){if(e=e.split(":")[0],t=+t,!t)return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t}},"44e7":function(t,e,n){var r=n("861d"),i=n("c6b6"),o=n("b622"),a=o("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[a])?!!e:"RegExp"==i(t))}},"47e4":function(t,e,n){"use strict";var r=n("3fb5"),i=n("9a83");function o(t){i.call(this),this.initEvent("message",!1,!1),this.data=t}r(o,i),t.exports=o},"486c":function(t,e,n){"use strict";(function(e){n("7725");var r,i=n("1816"),o=n("3fb5"),a=n("930c"),s=n("2582"),c=n("84fc"),l=n("621f"),u=n("c282"),h=n("0040"),d=n("d5e5"),f=n("26a0"),p=n("48cd"),g=n("9a83"),v=n("97a2"),m=n("a0e2"),b=n("e362"),y=n("47e4"),S=n("b9a8"),w=function(){};function E(t,e,n){if(!(this instanceof E))return new E(t,e,n);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");v.call(this),this.readyState=E.CONNECTING,this.extensions="",this.protocol="",n=n||{},n.protocols_whitelist&&p.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=n.transports,this._transportOptions=n.transportOptions||{},this._timeout=n.timeout||0;var r=n.sessionId||8;if("function"===typeof r)this._generateSessionId=r;else{if("number"!==typeof r)throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._generateSessionId=function(){return s.string(r)}}this._server=n.server||s.numberString(1e3);var o=new i(t);if(!o.host||!o.protocol)throw new SyntaxError("The URL '"+t+"' is invalid");if(o.hash)throw new SyntaxError("The URL must not contain a fragment");if("http:"!==o.protocol&&"https:"!==o.protocol)throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+o.protocol+"' is not allowed.");var a="https:"===o.protocol;if("https:"===m.protocol&&!a&&!l.isLoopbackAddr(o.hostname))throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");e?Array.isArray(e)||(e=[e]):e=[];var c=e.sort();c.forEach((function(t,e){if(!t)throw new SyntaxError("The protocols entry '"+t+"' is invalid.");if(e<c.length-1&&t===c[e+1])throw new SyntaxError("The protocols entry '"+t+"' is duplicated.")}));var u=l.getOrigin(m.href);this._origin=u?u.toLowerCase():null,o.set("pathname",o.pathname.replace(/\/+$/,"")),this.url=o.href,w("using url",this.url),this._urlInfo={nullOrigin:!f.hasDomain(),sameOrigin:l.isOriginEqual(this.url,m.href),sameScheme:l.isSchemeEqual(this.url,m.href)},this._ir=new S(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}function C(t){return 1e3===t||t>=3e3&&t<=4999}o(E,v),E.prototype.close=function(t,e){if(t&&!C(t))throw new Error("InvalidAccessError: Invalid code");if(e&&e.length>123)throw new SyntaxError("reason argument has an invalid length");if(this.readyState!==E.CLOSING&&this.readyState!==E.CLOSED){var n=!0;this._close(t||1e3,e||"Normal closure",n)}},E.prototype.send=function(t){if("string"!==typeof t&&(t=""+t),this.readyState===E.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===E.OPEN&&this._transport.send(c.quote(t))},E.version=n("1015"),E.CONNECTING=0,E.OPEN=1,E.CLOSING=2,E.CLOSED=3,E.prototype._receiveInfo=function(t,e){if(w("_receiveInfo",e),this._ir=null,t){this._rto=this.countRTO(e),this._transUrl=t.base_url?t.base_url:this.url,t=d.extend(t,this._urlInfo),w("info",t);var n=r.filterToEnabled(this._transportsWhitelist,t);this._transports=n.main,w(this._transports.length+" enabled transports"),this._connect()}else this._close(1002,"Cannot connect to server")},E.prototype._connect=function(){for(var t=this._transports.shift();t;t=this._transports.shift()){if(w("attempt",t.transportName),t.needBody&&(!e.document.body||"undefined"!==typeof e.document.readyState&&"complete"!==e.document.readyState&&"interactive"!==e.document.readyState))return w("waiting for body"),this._transports.unshift(t),void u.attachEvent("load",this._connect.bind(this));var n=Math.max(this._timeout,this._rto*t.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),n),w("using timeout",n);var r=l.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),i=this._transportOptions[t.transportName];w("transport url",r);var o=new t(r,this._transUrl,i);return o.on("message",this._transportMessage.bind(this)),o.once("close",this._transportClose.bind(this)),o.transportName=t.transportName,void(this._transport=o)}this._close(2e3,"All transports failed",!1)},E.prototype._transportTimeout=function(){w("_transportTimeout"),this.readyState===E.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))},E.prototype._transportMessage=function(t){w("_transportMessage",t);var e,n=this,r=t.slice(0,1),i=t.slice(1);switch(r){case"o":return void this._open();case"h":return this.dispatchEvent(new g("heartbeat")),void w("heartbeat",this.transport)}if(i)try{e=a.parse(i)}catch(o){w("bad json",i)}if("undefined"!==typeof e)switch(r){case"a":Array.isArray(e)&&e.forEach((function(t){w("message",n.transport,t),n.dispatchEvent(new y(t))}));break;case"m":w("message",this.transport,e),this.dispatchEvent(new y(e));break;case"c":Array.isArray(e)&&2===e.length&&this._close(e[0],e[1],!0);break}else w("empty payload",i)},E.prototype._transportClose=function(t,e){w("_transportClose",this.transport,t,e),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),C(t)||2e3===t||this.readyState!==E.CONNECTING?this._close(t,e):this._connect()},E.prototype._open=function(){w("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===E.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=E.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new g("open")),w("connected",this.transport)):this._close(1006,"Server lost session")},E.prototype._close=function(t,e,n){w("_close",this.transport,t,e,n,this.readyState);var r=!1;if(this._ir&&(r=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===E.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=E.CLOSING,setTimeout(function(){this.readyState=E.CLOSED,r&&this.dispatchEvent(new g("error"));var i=new b("close");i.wasClean=n||!1,i.code=t||1e3,i.reason=e,this.dispatchEvent(i),this.onmessage=this.onclose=this.onerror=null,w("disconnected")}.bind(this),0)},E.prototype.countRTO=function(t){return t>100?4*t:300+t},t.exports=function(t){return r=h(t),n("9fa7")(E,t),E}}).call(this,n("c8ba"))},"48cd":function(t,e,n){"use strict";(function(e){var n={};["log","debug","warn"].forEach((function(t){var r;try{r=e.console&&e.console[t]&&e.console[t].apply}catch(i){}n[t]=r?function(){return e.console[t].apply(e.console,arguments)}:"log"===t?function(){}:n.log})),t.exports=n}).call(this,n("c8ba"))},"498b":function(t,e,n){var r=n("103a");e.JsonRpcClient=r},"49d9":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OpenViduLoggerConfiguration=void 0,function(t){t["disabled"]="disabled",t["debug"]="debug",t["debug_app"]="debug_app"}(e.OpenViduLoggerConfiguration||(e.OpenViduLoggerConfiguration={}))},"4b91":function(t,e,n){"use strict";n("ab9d")},"4bd9":function(t,e,n){"use strict";n("d010")},"4be5":function(t,e,n){"use strict";n("9bbd")},"4c53":function(t,e,n){"use strict";var r=n("23e7"),i=n("857a"),o=n("af03");r({target:"String",proto:!0,forced:o("sub")},{sub:function(){return i(this,"sub","","")}})},"4c6a":function(t,e,n){"use strict";n("b24f")},"4def":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.StreamEvent=void 0;var i=n("8733"),o=n("3c4c"),a=n("2533"),s=n("f66e"),c=s.OpenViduLogger.getInstance(),l=function(t){function e(e,n,r,i,o){var a=t.call(this,e,n,r)||this;return a.stream=i,a.reason=o,a}return r(e,t),e.prototype.callDefaultBehavior=function(){if("streamDestroyed"===this.type){if(this.target instanceof a.Session)c.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'"),this.stream.disposeWebRtcPeer();else if(this.target instanceof o.Publisher){c.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Publisher'"),clearInterval(this.target.screenShareResizeInterval),this.stream.isLocalStreamReadyToPublish=!1;for(var t=this.target.openvidu.publishers,e=0;e<t.length;e++)if(t[e]===this.target){t.splice(e,1);break}}this.stream.disposeMediaStream(),this.stream.streamManager&&this.stream.streamManager.removeAllVideos(),this.stream.session.remoteStreamsCreated.delete(this.stream.streamId);var n=this.stream.session.remoteConnections.get(this.stream.connection.connectionId);if(n&&n.remoteOptions){var r=n.remoteOptions.streams;for(e=r.length-1;e>=0;--e)r[e].id===this.stream.streamId&&r.splice(e,1)}}},e}(i.Event);e.StreamEvent=l},"4edf":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OpenViduError=e.OpenViduErrorName=void 0,function(t){t["BROWSER_NOT_SUPPORTED"]="BROWSER_NOT_SUPPORTED",t["DEVICE_ACCESS_DENIED"]="DEVICE_ACCESS_DENIED",t["DEVICE_ALREADY_IN_USE"]="DEVICE_ALREADY_IN_USE",t["SCREEN_CAPTURE_DENIED"]="SCREEN_CAPTURE_DENIED",t["SCREEN_SHARING_NOT_SUPPORTED"]="SCREEN_SHARING_NOT_SUPPORTED",t["SCREEN_EXTENSION_NOT_INSTALLED"]="SCREEN_EXTENSION_NOT_INSTALLED",t["SCREEN_EXTENSION_DISABLED"]="SCREEN_EXTENSION_DISABLED",t["INPUT_VIDEO_DEVICE_NOT_FOUND"]="INPUT_VIDEO_DEVICE_NOT_FOUND",t["INPUT_AUDIO_DEVICE_NOT_FOUND"]="INPUT_AUDIO_DEVICE_NOT_FOUND",t["INPUT_AUDIO_DEVICE_GENERIC_ERROR"]="INPUT_AUDIO_DEVICE_GENERIC_ERROR",t["NO_INPUT_SOURCE_SET"]="NO_INPUT_SOURCE_SET",t["PUBLISHER_PROPERTIES_ERROR"]="PUBLISHER_PROPERTIES_ERROR",t["OPENVIDU_PERMISSION_DENIED"]="OPENVIDU_PERMISSION_DENIED",t["OPENVIDU_NOT_CONNECTED"]="OPENVIDU_NOT_CONNECTED",t["GENERIC_ERROR"]="GENERIC_ERROR"}(e.OpenViduErrorName||(e.OpenViduErrorName={}));var r=function(){function t(t,e){this.name=t,this.message=e}return t}();e.OpenViduError=r},"4f2a":function(t,e){e.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},e.decode=function(t){for(var e={},n=t.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}},5317:function(t,e){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function i(t,e){var n=/\/{2,9}/g,r=e.replace(n,"/").split("/");return"/"!=e.substr(0,1)&&0!==e.length||r.splice(0,1),"/"==e.substr(e.length-1,1)&&r.splice(r.length-1,1),r}function o(t,e){var n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,r){e&&(n[e]=r)})),n}t.exports=function(t){var e=t,a=t.indexOf("["),s=t.indexOf("]");-1!=a&&-1!=s&&(t=t.substring(0,a)+t.substring(a,s).replace(/:/g,";")+t.substring(s,t.length));var c=n.exec(t||""),l={},u=14;while(u--)l[r[u]]=c[u]||"";return-1!=a&&-1!=s&&(l.source=e,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=i(l,l["path"]),l.queryKey=o(l,l["query"]),l}},5319:function(t,e,n){"use strict";var r=n("2ba4"),i=n("c65b"),o=n("e330"),a=n("d784"),s=n("d039"),c=n("825a"),l=n("1626"),u=n("5926"),h=n("50c4"),d=n("577e"),f=n("1d80"),p=n("8aa5"),g=n("dc4a"),v=n("0cb2"),m=n("14c3"),b=n("b622"),y=b("replace"),S=Math.max,w=Math.min,E=o([].concat),C=o([].push),x=o("".indexOf),O=o("".slice),_=function(t){return void 0===t?t:String(t)},T=function(){return"$0"==="a".replace(/./,"$0")}(),k=function(){return!!/./[y]&&""===/./[y]("a","$0")}(),I=!s((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}));a("replace",(function(t,e,n){var o=k?"$":"$0";return[function(t,n){var r=f(this),o=void 0==t?void 0:g(t,y);return o?i(o,t,r,n):i(e,d(r),t,n)},function(t,i){var a=c(this),s=d(t);if("string"==typeof i&&-1===x(i,o)&&-1===x(i,"$<")){var f=n(e,a,s,i);if(f.done)return f.value}var g=l(i);g||(i=d(i));var b=a.global;if(b){var y=a.unicode;a.lastIndex=0}var T=[];while(1){var k=m(a,s);if(null===k)break;if(C(T,k),!b)break;var I=d(k[0]);""===I&&(a.lastIndex=p(s,h(a.lastIndex),y))}for(var P="",j=0,M=0;M<T.length;M++){k=T[M];for(var D=d(k[0]),R=S(w(u(k.index),s.length),0),A=[],N=1;N<k.length;N++)C(A,_(k[N]));var L=k.groups;if(g){var B=E([D],A,R,s);void 0!==L&&C(B,L);var V=d(r(i,void 0,B))}else V=v(D,s,R,A,L,i);R>=j&&(P+=O(s,j,R)+V,j=R+D.length)}return P+O(s,j)}]}),!I||!T||k)},"54d6":function(t,e,n){"use strict";(function(e){var r=n("3fb5"),i=n("f1f8"),o=n("621f"),a=n("ada0").EventEmitter,s=n("2582"),c=function(){};function l(t){c(t),a.call(this);var n=this;i.polluteGlobalNamespace(),this.id="a"+s.string(6),t=o.addQuery(t,"c="+decodeURIComponent(i.WPrefix+"."+this.id)),c("using htmlfile",l.htmlfileEnabled);var r=l.htmlfileEnabled?i.createHtmlfile:i.createIframe;e[i.WPrefix][this.id]={start:function(){c("start"),n.iframeObj.loaded()},message:function(t){c("message",t),n.emit("message",t)},stop:function(){c("stop"),n._cleanup(),n._close("network")}},this.iframeObj=r(t,(function(){c("callback"),n._cleanup(),n._close("permanent")}))}r(l,a),l.prototype.abort=function(){c("abort"),this._cleanup(),this._close("user")},l.prototype._cleanup=function(){c("_cleanup"),this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete e[i.WPrefix][this.id]},l.prototype._close=function(t){c("_close",t),this.emit("close",null,t),this.removeAllListeners()},l.htmlfileEnabled=!1;var u=["Active"].concat("Object").join("X");if(u in e)try{l.htmlfileEnabled=!!new e[u]("htmlfile")}catch(h){}l.enabled=l.htmlfileEnabled||i.iframeEnabled,t.exports=l}).call(this,n("c8ba"))},5560:function(t,e,n){"use strict";n.r(e);var r=n("7a23"),i=function(t){return Object(r["pushScopeId"])("data-v-72b99909"),t=t(),Object(r["popScopeId"])(),t},o={class:"container"},a=i((function(){return Object(r["createElementVNode"])("h1",{class:"form-title"},"스터디룸 만들기",-1)})),s={class:"row d-flex justify-content-center"},c={class:"col-md-6 col-lg-5 col-xl-4"},l={class:"studyInfo-wrapper",enctype:"multipart/form-data"},u=i((function(){return Object(r["createElementVNode"])("label",{for:"studyName",class:"form-label"},"스터디 이름",-1)})),h={class:"mb-3"},d=i((function(){return Object(r["createElementVNode"])("label",{for:"goal",class:"form-label"},"스터디 목표",-1)})),f={class:"d-flex justify-content-start mb-4"},p={class:"dropend"},g={class:"image-wrapper scale",role:"button",id:"dropdownMenuLink","data-bs-toggle":"dropdown","aria-expanded":"false"},v=["src"],m={class:"dropdown-menu","aria-labelledby":"dropdownMenuLink"},b=i((function(){return Object(r["createElementVNode"])("li",null,[Object(r["createElementVNode"])("label",{for:"changeStudyImg",class:"dropdown-item img-form-label"},"스터디 이미지 선택")],-1)})),y={class:"form-group"};function S(t,e,n,i,S,w){var E=Object(r["resolveComponent"])("Navbar"),C=Object(r["resolveComponent"])("loading");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["createVNode"])(E),Object(r["createVNode"])(C,{active:i.state.loading,"onUpdate:active":e[0]||(e[0]=function(t){return i.state.loading=t}),"can-cancel":!1,"is-full-page":!0,height:S.height,width:S.width,color:S.color,loader:S.loader,"background-color":S.bgColor,opacity:S.opacity,"lock-scroll":!1,class:"vld-overlay",style:Object(r["normalizeStyle"])(i.state.loading?"-webkit-backdrop-filter: blur(2px); backdrop-filter: blur(2px);":"")},null,8,["active","height","width","color","loader","background-color","opacity","style"]),Object(r["createElementVNode"])("div",o,[a,Object(r["createElementVNode"])("div",s,[Object(r["createElementVNode"])("div",c,[Object(r["createElementVNode"])("section",null,[Object(r["createElementVNode"])("form",l,[Object(r["createElementVNode"])("div",null,[u,Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"text",class:"form-control",id:"studyName","onUpdate:modelValue":e[1]||(e[1]=function(t){return i.state.studyName=t}),required:"",placeholder:"스터디 이름",maxlength:"20"},null,512),[[r["vModelText"],i.state.studyName]]),Object(r["createElementVNode"])("div",{style:Object(r["normalizeStyle"])({visibility:i.state.isValidStudyName||!i.state.wasInputed.studyName?"hidden":"visible"}),class:"invalid-feedback"}," 2~20자 사이로 작성해주세요. ",4)]),Object(r["createElementVNode"])("div",h,[d,Object(r["withDirectives"])(Object(r["createElementVNode"])("textarea",{class:"form-control form-goal",id:"studyGoal",rows:"3","onUpdate:modelValue":e[2]||(e[2]=function(t){return i.state.studyGoal=t}),placeholder:"스터디 목표를 한 줄로 표현해 보세요!",maxlength:"40"},"\r\n                ",512),[[r["vModelText"],i.state.studyGoal]])]),Object(r["createElementVNode"])("div",f,[Object(r["createElementVNode"])("div",p,[Object(r["createElementVNode"])("div",g,[Object(r["createElementVNode"])("img",{class:"study-img",src:i.state.studyImgSrc},null,8,v)]),Object(r["createElementVNode"])("ul",m,[b,Object(r["createElementVNode"])("li",null,[Object(r["createElementVNode"])("span",{onClick:e[3]||(e[3]=function(){return i.onClickDefaultImg&&i.onClickDefaultImg.apply(i,arguments)}),class:"dropdown-item img-revert-default"},"기본 이미지로 변경")])])]),Object(r["createElementVNode"])("div",y,[Object(r["createElementVNode"])("input",{onChange:e[4]||(e[4]=function(){return i.onClickUploadFile&&i.onClickUploadFile.apply(i,arguments)}),id:"changeStudyImg",type:"file",ref:"file",class:"form-control",accept:"image/*",style:{display:"none"}},null,544)])]),Object(r["createElementVNode"])("button",{onClick:e[5]||(e[5]=function(){return i.onClickCreateStudy&&i.onClickCreateStudy.apply(i,arguments)}),class:"btn btn-primary col-12"},"스터디 만들기")])])])])])])}n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861");var w=n("6c02"),E=n("4bfb"),C=n("6c69"),x=n("ec16"),O=n("9062"),_=n.n(O),T=(n("e40d"),{name:"",data:function(){return{loader:"dots",color:"#334466",bgColor:"white",height:120,width:120,opacity:.2,lockScroll:!0}},components:{Navbar:C["a"],Loading:_.a},setup:function(){var t=Object(w["d"])(),e=Object(r["ref"])({studyName:"",studyGoal:"",studyImgURL:"",studyImage:"",studyImgSrc:Object(r["computed"])((function(){return e.value.studyImgURL?e.value.studyImgURL:n("f100")})),wasInputed:{studyName:!1},isValidStudyName:Object(r["computed"])((function(){return""!==e.value.studyName&&(e.value.wasInputed.studyName=!0),!(!e.value.studyName||!h(e.value.studyName))})),loading:!1}),i=Object(x["a"])(),o=i.notifyDanger,a=i.notifySuccess,s=i.notifyDangerDescription,c=function(t){var n=t.target.files[0];if(n.size>2097152)return t.preventDefault(),void s("파일 사이즈가 너무 큽니다.😯","최대 2MB");e.value.studyImgURL=URL.createObjectURL(n),e.value.studyImage=n},l=function(t){t.preventDefault(),e.value.studyImgURL="",e.value.studyImage=""},u=function(n){if(n.preventDefault(),""!==e.value.studyName){if(e.value.isValidStudyName){var r=new FormData;r.append("studyName",e.value.studyName),r.append("studyGoal",e.value.studyGoal),r.append("studyImage",e.value.studyImage),Object(E["b"])(r,(function(e){switch(d(),e.data.code){case 200:setTimeout((function(){a("스터디룸 생성 완료!🔨"),t.push({name:"Main"})}),1001);break;case 400:o("스터디룸 생성 실패😥");break}}),(function(t){console.log(t),o("서버에 문제가 발생했습니다.😰")}))}}else e.value.wasInputed.studyName=!0},h=function(t){return t.length>=2&&t.length<=20};function d(){e.value.loading=!0,setTimeout((function(){e.value.loading=!1}),1e3)}return{state:e,onClickUploadFile:c,onClickDefaultImg:l,onClickCreateStudy:u,loadingCall:d}}}),k=(n("dd13"),n("6b0d")),I=n.n(k);const P=I()(T,[["render",S],["__scopeId","data-v-72b99909"]]);e["default"]=P},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var r=n("e330"),i=n("1d80"),o=n("577e"),a=n("5899"),s=r("".replace),c="["+a+"]",l=RegExp("^"+c+c+"*"),u=RegExp(c+c+"*$"),h=function(t){return function(e){var n=o(i(e));return 1&t&&(n=s(n,l,"")),2&t&&(n=s(n,u,"")),n}};t.exports={start:h(1),end:h(2),trim:h(3)}},"5a0c":function(t,e,n){!function(e,n){t.exports=n()}(0,(function(){"use strict";var t=1e3,e=6e4,n=36e5,r="millisecond",i="second",o="minute",a="hour",s="day",c="week",l="month",u="quarter",h="year",d="date",f="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},b={s:m,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?"+":"-")+m(r,2,"0")+":"+m(i,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,l),o=n-i<0,a=e.clone().add(r+(o?-1:1),l);return+(-(r+(n-i)/(o?i-a:a-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:l,y:h,w:c,d:s,D:d,h:a,m:o,s:i,ms:r,Q:u}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},y="en",S={};S[y]=v;var w=function(t){return t instanceof O},E=function(t,e,n){var r;if(!t)return y;if("string"==typeof t)S[t]&&(r=t),e&&(S[t]=e,r=t);else{var i=t.name;S[i]=t,r=i}return!n&&r&&(y=r),r||!n&&y},C=function(t,e){if(w(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new O(n)},x=b;x.l=E,x.i=w,x.w=function(t,e){return C(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var O=function(){function v(t){this.$L=E(t.locale,null,!0),this.parse(t)}var m=v.prototype;return m.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(x.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(p);if(r){var i=r[2]-1||0,o=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},m.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},m.$utils=function(){return x},m.isValid=function(){return!(this.$d.toString()===f)},m.isSame=function(t,e){var n=C(t);return this.startOf(e)<=n&&n<=this.endOf(e)},m.isAfter=function(t,e){return C(t)<this.startOf(e)},m.isBefore=function(t,e){return this.endOf(e)<C(t)},m.$g=function(t,e,n){return x.u(t)?this[e]:this.set(n,t)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(t,e){var n=this,r=!!x.u(e)||e,u=x.p(t),f=function(t,e){var i=x.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(s)},p=function(t,e){return x.w(n.toDate()[t].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},g=this.$W,v=this.$M,m=this.$D,b="set"+(this.$u?"UTC":"");switch(u){case h:return r?f(1,0):f(31,11);case l:return r?f(1,v):f(0,v+1);case c:var y=this.$locale().weekStart||0,S=(g<y?g+7:g)-y;return f(r?m-S:m+(6-S),v);case s:case d:return p(b+"Hours",0);case a:return p(b+"Minutes",1);case o:return p(b+"Seconds",2);case i:return p(b+"Milliseconds",3);default:return this.clone()}},m.endOf=function(t){return this.startOf(t,!1)},m.$set=function(t,e){var n,c=x.p(t),u="set"+(this.$u?"UTC":""),f=(n={},n[s]=u+"Date",n[d]=u+"Date",n[l]=u+"Month",n[h]=u+"FullYear",n[a]=u+"Hours",n[o]=u+"Minutes",n[i]=u+"Seconds",n[r]=u+"Milliseconds",n)[c],p=c===s?this.$D+(e-this.$W):e;if(c===l||c===h){var g=this.clone().set(d,1);g.$d[f](p),g.init(),this.$d=g.set(d,Math.min(this.$D,g.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},m.set=function(t,e){return this.clone().$set(t,e)},m.get=function(t){return this[x.p(t)]()},m.add=function(r,u){var d,f=this;r=Number(r);var p=x.p(u),g=function(t){var e=C(f);return x.w(e.date(e.date()+Math.round(t*r)),f)};if(p===l)return this.set(l,this.$M+r);if(p===h)return this.set(h,this.$y+r);if(p===s)return g(1);if(p===c)return g(7);var v=(d={},d[o]=e,d[a]=n,d[i]=t,d)[p]||1,m=this.$d.getTime()+r*v;return x.w(m,this)},m.subtract=function(t,e){return this.add(-1*t,e)},m.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||f;var r=t||"YYYY-MM-DDTHH:mm:ssZ",i=x.z(this),o=this.$H,a=this.$m,s=this.$M,c=n.weekdays,l=n.months,u=function(t,n,i,o){return t&&(t[n]||t(e,r))||i[n].substr(0,o)},h=function(t){return x.s(o%12||12,t,"0")},d=n.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:x.s(s+1,2,"0"),MMM:u(n.monthsShort,s,l,3),MMMM:u(l,s),D:this.$D,DD:x.s(this.$D,2,"0"),d:String(this.$W),dd:u(n.weekdaysMin,this.$W,c,2),ddd:u(n.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(o),HH:x.s(o,2,"0"),h:h(1),hh:h(2),a:d(o,a,!0),A:d(o,a,!1),m:String(a),mm:x.s(a,2,"0"),s:String(this.$s),ss:x.s(this.$s,2,"0"),SSS:x.s(this.$ms,3,"0"),Z:i};return r.replace(g,(function(t,e){return e||p[t]||i.replace(":","")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,d,f){var p,g=x.p(d),v=C(r),m=(v.utcOffset()-this.utcOffset())*e,b=this-v,y=x.m(this,v);return y=(p={},p[h]=y/12,p[l]=y,p[u]=y/3,p[c]=(b-m)/6048e5,p[s]=(b-m)/864e5,p[a]=b/n,p[o]=b/e,p[i]=b/t,p)[g]||b,f?y:x.a(y)},m.daysInMonth=function(){return this.endOf(l).$D},m.$locale=function(){return S[this.$L]},m.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=E(t,e,!0);return r&&(n.$L=r),n},m.clone=function(){return x.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},v}(),_=O.prototype;return C.prototype=_,[["$ms",r],["$s",i],["$m",o],["$H",a],["$W",s],["$M",l],["$y",h],["$D",d]].forEach((function(t){_[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),C.extend=function(t,e){return t.$i||(t(e,O,C),t.$i=!0),C},C.locale=E,C.isDayjs=w,C.unix=function(t){return C(1e3*t)},C.en=S[y],C.Ls=S,C.p={},C}))},"5a34":function(t,e,n){var r=n("da84"),i=n("44e7"),o=r.TypeError;t.exports=function(t){if(i(t))throw o("The method doesn't accept regular expressions");return t}},"5e2d":function(t,e,n){},"60fd":function(t,e,n){"use strict";n("d714")},"621f":function(t,e,n){"use strict";var r=n("1816"),i=function(){};t.exports={getOrigin:function(t){if(!t)return null;var e=new r(t);if("file:"===e.protocol)return null;var n=e.port;return n||(n="https:"===e.protocol?"443":"80"),e.protocol+"//"+e.hostname+":"+n},isOriginEqual:function(t,e){var n=this.getOrigin(t)===this.getOrigin(e);return i("same",t,e,n),n},isSchemeEqual:function(t,e){return t.split(":")[0]===e.split(":")[0]},addPath:function(t,e){var n=t.split("?");return n[0]+e+(n[1]?"?"+n[1]:"")},addQuery:function(t,e){return t+(-1===t.indexOf("?")?"?"+e:"&"+e)},isLoopbackAddr:function(t){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(t)||/^\[::1\]$/.test(t)}}},"627d":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LocalRecorderState=void 0,function(t){t["READY"]="READY",t["RECORDING"]="RECORDING",t["PAUSED"]="PAUSED",t["FINISHED"]="FINISHED"}(e.LocalRecorderState||(e.LocalRecorderState={}))},"62e4":function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},6567:function(t,e,n){"use strict";n("c2d8")},6675:function(t,e,n){},"67c3":function(t,e,n){"use strict";n("6c67")},"68cb":function(t,e,n){var r,i=n("a7b3");function o(t,e){var n=-1/0;t.getFloatFrequencyData(e);for(var r=4,i=e.length;r<i;r++)e[r]>n&&e[r]<0&&(n=e[r]);return n}"undefined"!==typeof window&&(r=window.AudioContext||window.webkitAudioContext);var a=null;t.exports=function(t,e){var n=new i;if(!r)return n;e=e||{};var s,c,l,u=e.smoothing||.1,h=e.interval||50,d=e.threshold,f=e.play,p=e.history||10,g=!0;a=e.audioContext||a||new r,l=a.createAnalyser(),l.fftSize=512,l.smoothingTimeConstant=u,c=new Float32Array(l.frequencyBinCount),t.jquery&&(t=t[0]),t instanceof HTMLAudioElement||t instanceof HTMLVideoElement?(s=a.createMediaElementSource(t),"undefined"===typeof f&&(f=!0),d=d||-50):(s=a.createMediaStreamSource(t),d=d||-50),s.connect(l),f&&l.connect(a.destination),n.speaking=!1,n.suspend=function(){return a.suspend()},n.resume=function(){return a.resume()},Object.defineProperty(n,"state",{get:function(){return a.state}}),a.onstatechange=function(){n.emit("state_change",a.state)},n.setThreshold=function(t){d=t},n.setInterval=function(t){h=t},n.stop=function(){g=!1,n.emit("volume_change",-100,d),n.speaking&&(n.speaking=!1,n.emit("stopped_speaking")),l.disconnect(),s.disconnect()},n.speakingHistory=[];for(var v=0;v<p;v++)n.speakingHistory.push(0);var m=function(){setTimeout((function(){if(g){var t=o(l,c);n.emit("volume_change",t,d);var e=0;if(t>d&&!n.speaking){for(var r=n.speakingHistory.length-3;r<n.speakingHistory.length;r++)e+=n.speakingHistory[r];e>=2&&(n.speaking=!0,n.emit("speaking"))}else if(t<d&&n.speaking){for(r=0;r<n.speakingHistory.length;r++)e+=n.speakingHistory[r];0==e&&(n.speaking=!1,n.emit("stopped_speaking"))}n.speakingHistory.shift(),n.speakingHistory.push(0+(t>d)),m()}}),h)};return m(),n}},6945:function(t,e,n){"use strict";t.exports=[n("397f"),n("3e1e"),n("b185"),n("7b4d"),n("26e3")(n("7b4d")),n("40b2"),n("26e3")(n("40b2")),n("e2b3"),n("e556"),n("26e3")(n("e2b3")),n("f84c")]},"6c67":function(t,e,n){},"6c671":function(t,e,n){"use strict";n("32e1")},"6e4e":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Subscriber=void 0;var i=n("3f7b"),o=n("f66e"),a=o.OpenViduLogger.getInstance(),s=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.element=i.targetElement,i.stream=e,i.properties=r,i}return r(e,t),e.prototype.subscribeToAudio=function(t){return this.stream.getMediaStream().getAudioTracks().forEach((function(e){e.enabled=t})),this.stream.audioActive=t,a.info("'Subscriber' has "+(t?"subscribed to":"unsubscribed from")+" its audio stream"),this},e.prototype.subscribeToVideo=function(t){return this.stream.getMediaStream().getVideoTracks().forEach((function(e){e.enabled=t})),this.stream.videoActive=t,a.info("'Subscriber' has "+(t?"subscribed to":"unsubscribed from")+" its video stream"),this},e}(i.StreamManager);e.Subscriber=s},"714c":function(t,e,n){"use strict";var r=n("f66e").OpenViduLogger,i=r.getInstance(),o=2e3,a=3e3,s=3;function c(t){var e,n=!1,r=t.uri,c=!1,l=new WebSocket(r);l.onopen=function(){i.debug("WebSocket connected to "+r),t.onconnected&&t.onconnected()},l.onerror=function(e){i.error("Could not connect to "+r+" (invoking onerror if defined)",e),t.onerror&&t.onerror(e)};var u=function(){l.readyState===s?n?i.debug("Connection closed by user"):t.ismasternodecrashed()?i.error("Master Node has crashed. Stopping reconnection process"):(i.debug("Connection closed unexpectedly. Reconnecting..."),h(o,1)):i.debug("Close callback from previous websocket. Ignoring it")};function h(e,n){if(i.debug("reconnect (attempt #"+n+", max="+e+")"),1===n){if(c)return void i.warn("Trying to reconnect when already reconnecting... Ignoring this reconnection.");c=!0,t.onreconnecting&&t.onreconnecting()}d(e,n)}function d(n,o){i.debug("Reconnection attempt #"+o),l.close(),l=new WebSocket(r),l.onopen=function(){i.debug("Reconnected to "+r+" after "+o+" attempts..."),c=!1,e(),t.onreconnected()&&t.onreconnected(),l.onclose=u},l.onerror=function(e){i.warn("Reconnection error: ",e),o===n?t.ondisconnect&&t.ondisconnect():setTimeout((function(){h(n,o+1)}),a)}}l.onclose=u,this.close=function(){n=!0,l.close()},this.forceClose=function(){l.close()},this.reconnectWs=function(){i.debug("reconnectWs"),h(o,1)},this.send=function(t){l.send(t)},this.addEventListener=function(t,n){e=function(){l.addEventListener(t,n)},e()},this.getReadyState=function(){return l.readyState}}t.exports=c},7156:function(t,e,n){var r=n("1626"),i=n("861d"),o=n("d2bb");t.exports=function(t,e,n){var a,s;return o&&r(a=e.constructor)&&a!==n&&i(s=a.prototype)&&s!==n.prototype&&o(t,s),t}},"73aa":function(t,e,n){"use strict";var r=n("3fb5"),i=n("d8d6");function o(t,e,n){i.call(this,t,e,n,{noCredentials:!0})}r(o,i),o.enabled=i.enabled,t.exports=o},"744a":function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"d",(function(){return a})),n.d(e,"b",(function(){return s}));var r=n("20a4");const i=(()=>{const t="function"===typeof Promise&&"function"===typeof Promise.resolve;return t?t=>Promise.resolve().then(t):(t,e)=>e(t,0)})(),o=r["a"].WebSocket||r["a"].MozWebSocket,a=!0,s="arraybuffer"},"74fc":function(t,e,n){"use strict";n("1066")},7577:function(t,e,n){"use strict";var r=n("3fb5"),i=n("621f"),o=n("f7a9"),a=function(){};function s(t){return function(e,n,r){a("create ajax sender",e,n);var o={};"string"===typeof n&&(o.headers={"Content-type":"text/plain"});var s=i.addPath(e,"/xhr_send"),c=new t("POST",s,n,o);return c.once("finish",(function(t){if(a("finish",t),c=null,200!==t&&204!==t)return r(new Error("http status "+t));r()})),function(){a("abort"),c.close(),c=null;var t=new Error("Aborted");t.code=1e3,r(t)}}}function c(t,e,n,r){o.call(this,t,e,s(r),n,r)}r(c,o),t.exports=c},"75ee":function(t,e){function n(t,e){var n={jsonrpc:"2.0"};if(t.method)n.method=t.method,t.params&&(n.params=t.params),void 0!=e&&(n.id=e);else if(void 0!=e){if(t.error){if(void 0!==t.result)throw new TypeError("Both result and error are defined");n.error=t.error}else{if(void 0===t.result)throw new TypeError("No result or error is defined");n.result=t.result}n.id=e}return JSON.stringify(n)}function r(t){var e=t;("string"===typeof t||t instanceof String)&&(e=JSON.parse(t));var n=e.jsonrpc;if("2.0"!==n)throw new TypeError("Invalid JsonRPC version '"+n+"': "+t);if(void 0==e.method){if(void 0==e.id)throw new TypeError("Invalid message: "+t);var r=void 0!==e.result,i=void 0!==e.error;if(r&&i)throw new TypeError("Both result and error are defined: "+t);if(!r&&!i)throw new TypeError("No result or error is defined: "+t);e.ack=e.id,delete e.id}return e}e.pack=n,e.unpack=r},7725:function(t,e,n){"use strict";var r,i=Array.prototype,o=Object.prototype,a=Function.prototype,s=String.prototype,c=i.slice,l=o.toString,u=function(t){return"[object Function]"===o.toString.call(t)},h=function(t){return"[object Array]"===l.call(t)},d=function(t){return"[object String]"===l.call(t)},f=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(t){return!1}}();r=f?function(t,e,n,r){!r&&e in t||Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:!0,value:n})}:function(t,e,n,r){!r&&e in t||(t[e]=n)};var p=function(t,e,n){for(var i in e)o.hasOwnProperty.call(e,i)&&r(t,i,e[i],n)},g=function(t){if(null==t)throw new TypeError("can't convert "+t+" to object");return Object(t)};function v(t){var e=+t;return e!==e?e=0:0!==e&&e!==1/0&&e!==-1/0&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e}function m(t){return t>>>0}function b(){}p(a,{bind:function(t){var e=this;if(!u(e))throw new TypeError("Function.prototype.bind called on incompatible "+e);for(var n=c.call(arguments,1),r=function(){if(this instanceof s){var r=e.apply(this,n.concat(c.call(arguments)));return Object(r)===r?r:this}return e.apply(t,n.concat(c.call(arguments)))},i=Math.max(0,e.length-n.length),o=[],a=0;a<i;a++)o.push("$"+a);var s=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this, arguments); }")(r);return e.prototype&&(b.prototype=e.prototype,s.prototype=new b,b.prototype=null),s}}),p(Array,{isArray:h});var y=Object("a"),S="a"!==y[0]||!(0 in y),w=function(t){var e=!0,n=!0;return t&&(t.call("foo",(function(t,n,r){"object"!==typeof r&&(e=!1)})),t.call([1],(function(){n="string"===typeof this}),"x")),!!t&&e&&n};p(i,{forEach:function(t){var e=g(this),n=S&&d(this)?this.split(""):e,r=arguments[1],i=-1,o=n.length>>>0;if(!u(t))throw new TypeError;while(++i<o)i in n&&t.call(r,n[i],i,e)}},!w(i.forEach));var E=Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2);p(i,{indexOf:function(t){var e=S&&d(this)?this.split(""):g(this),n=e.length>>>0;if(!n)return-1;var r=0;for(arguments.length>1&&(r=v(arguments[1])),r=r>=0?r:Math.max(0,n+r);r<n;r++)if(r in e&&e[r]===t)return r;return-1}},E);var C=s.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?function(){var t=void 0===/()??/.exec("")[1];s.split=function(e,n){var r=this;if(void 0===e&&0===n)return[];if("[object RegExp]"!==l.call(e))return C.call(this,e,n);var o,a,s,c,u=[],h=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),d=0;e=new RegExp(e.source,h+"g"),r+="",t||(o=new RegExp("^"+e.source+"$(?!\\s)",h)),n=void 0===n?-1>>>0:m(n);while(a=e.exec(r)){if(s=a.index+a[0].length,s>d&&(u.push(r.slice(d,a.index)),!t&&a.length>1&&a[0].replace(o,(function(){for(var t=1;t<arguments.length-2;t++)void 0===arguments[t]&&(a[t]=void 0)})),a.length>1&&a.index<r.length&&i.push.apply(u,a.slice(1)),c=a[0].length,d=s,u.length>=n))break;e.lastIndex===a.index&&e.lastIndex++}return d===r.length?!c&&e.test("")||u.push(""):u.push(r.slice(d)),u.length>n?u.slice(0,n):u}}():"0".split(void 0,0).length&&(s.split=function(t,e){return void 0===t&&0===e?[]:C.call(this,t,e)});var x=s.substr,O="".substr&&"b"!=="0b".substr(-1);p(s,{substr:function(t,e){return x.call(this,t<0&&(t=this.length+t)<0?0:t,e)}},O)},"79ef":function(t,e,n){var r=n("714c");e.WebSocketWithReconnection=r},"7a94":function(t,e,n){(function(t){
/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */
var r=r||{version:"5.0.0"};if(e.fabric=r,"undefined"!==typeof document&&"undefined"!==typeof window)document instanceof("undefined"!==typeof HTMLDocument?HTMLDocument:Document)?r.document=document:r.document=document.implementation.createHTMLDocument(""),r.window=window;else{var i=n(1),o=new i.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;r.document=o.document,r.jsdomImplForWrapper=n(2).implForWrapper,r.nodeCanvas=n(3).Canvas,r.window=o,DOMParser=r.window.DOMParser}function a(t){var e=t.targetCanvas,n=e.width,r=e.height,i=t.destinationWidth,o=t.destinationHeight;n===i&&r===o||(e.width=i,e.height=o)}function s(t,e){var n=t.canvas,r=e.targetCanvas,i=r.getContext("2d");i.translate(0,r.height),i.scale(1,-1);var o=n.height-r.height;i.drawImage(n,0,o,r.width,r.height,0,0,r.width,r.height)}function c(t,e){var n=e.targetCanvas,r=n.getContext("2d"),i=e.destinationWidth,o=e.destinationHeight,a=i*o*4,s=new Uint8Array(this.imageBuffer,0,a),c=new Uint8ClampedArray(this.imageBuffer,0,a);t.readPixels(0,0,i,o,t.RGBA,t.UNSIGNED_BYTE,s);var l=new ImageData(c,i,o);r.putImageData(l,0,0)}r.isTouchSupported="ontouchstart"in r.window||"ontouchstart"in r.document||r.window&&r.window.navigator&&r.window.navigator.maxTouchPoints>0,r.isLikelyNode="undefined"!==typeof t&&"undefined"===typeof window,r.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],r.DPI=96,r.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",r.commaWsp="(?:\\s+,?\\s*|,\\s*)",r.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,r.reNonWord=/[ \n\.,;!\?\-]/,r.fontPaths={},r.iMatrix=[1,0,0,1,0,0],r.svgNS="http://www.w3.org/2000/svg",r.perfLimitSizeTotal=2097152,r.maxCacheSideLimit=4096,r.minCacheSideLimit=256,r.charWidthsCache={},r.textureSize=2048,r.disableStyleCopyPaste=!1,r.enableGLFiltering=!0,r.devicePixelRatio=r.window.devicePixelRatio||r.window.webkitDevicePixelRatio||r.window.mozDevicePixelRatio||1,r.browserShadowBlurConstant=1,r.arcToSegmentsCache={},r.boundsOfCurveCache={},r.cachesBoundsOfCurve=!0,r.forceGLPutImageData=!1,r.initFilterBackend=function(){return r.enableGLFiltering&&r.isWebglSupported&&r.isWebglSupported(r.textureSize)?(console.log("max texture size: "+r.maxTextureSize),new r.WebglFilterBackend({tileSize:r.textureSize})):r.Canvas2dFilterBackend?new r.Canvas2dFilterBackend:void 0},"undefined"!==typeof document&&"undefined"!==typeof window&&(window.fabric=r),function(){function t(t,e){if(this.__eventListeners[t]){var n=this.__eventListeners[t];e?n[n.indexOf(e)]=!1:r.util.array.fill(n,!1)}}function e(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var n in t)this.on(n,t[n]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this}function n(t,e){var n=function(){e.apply(this,arguments),this.off(t,n)}.bind(this);this.on(t,n)}function i(t,e){if(1===arguments.length)for(var r in t)n.call(this,r,t[r]);else n.call(this,t,e);return this}function o(e,n){if(!this.__eventListeners)return this;if(0===arguments.length)for(e in this.__eventListeners)t.call(this,e);else if(1===arguments.length&&"object"===typeof arguments[0])for(var r in e)t.call(this,r,e[r]);else t.call(this,e,n);return this}function a(t,e){if(!this.__eventListeners)return this;var n=this.__eventListeners[t];if(!n)return this;for(var r=0,i=n.length;r<i;r++)n[r]&&n[r].call(this,e||{});return this.__eventListeners[t]=n.filter((function(t){return!1!==t})),this}r.Observable={fire:a,on:e,once:i,off:o}}(),r.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(t,e,n){var r=this._objects;return n?r[e]=t:r.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var t,e=this._objects,n=!1,r=0,i=arguments.length;r<i;r++)t=e.indexOf(arguments[r]),-1!==t&&(n=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[r]));return this.renderOnAddRemove&&n&&this.requestRenderAll(),this},forEachObject:function(t,e){for(var n=this.getObjects(),r=0,i=n.length;r<i;r++)t.call(e,n[r],r,n);return this},getObjects:function(t){return"undefined"===typeof t?this._objects.concat():this._objects.filter((function(e){return e.type===t}))},item:function(t){return this._objects[t]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(t,e){return this._objects.indexOf(t)>-1||!!e&&this._objects.some((function(e){return"function"===typeof e.contains&&e.contains(t,!0)}))},complexity:function(){return this._objects.reduce((function(t,e){return t+=e.complexity?e.complexity():0,t}),0)}},r.CommonMethods={_setOptions:function(t){for(var e in t)this.set(e,t[e])},_initGradient:function(t,e){!t||!t.colorStops||t instanceof r.Gradient||this.set(e,new r.Gradient(t))},_initPattern:function(t,e,n){!t||!t.source||t instanceof r.Pattern?n&&n():this.set(e,new r.Pattern(t,n))},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"===typeof t?this._setObject(t):this._set(t,e),this},_set:function(t,e){this[t]=e},toggle:function(t){var e=this.get(t);return"boolean"===typeof e&&this.set(t,!e),this},get:function(t){return this[t]}},function(t){var e=Math.sqrt,n=Math.atan2,i=Math.pow,o=Math.PI/180,a=Math.PI/2;r.util={cos:function(t){if(0===t)return 1;t<0&&(t=-t);var e=t/a;switch(e){case 1:case 3:return 0;case 2:return-1}return Math.cos(t)},sin:function(t){if(0===t)return 0;var e=t/a,n=1;switch(t<0&&(n=-1),e){case 1:return n;case 2:return 0;case 3:return-n}return Math.sin(t)},removeFromArray:function(t,e){var n=t.indexOf(e);return-1!==n&&t.splice(n,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*o},radiansToDegrees:function(t){return t/o},rotatePoint:function(t,e,n){var i=new r.Point(t.x-e.x,t.y-e.y),o=r.util.rotateVector(i,n);return new r.Point(o.x,o.y).addEquals(e)},rotateVector:function(t,e){var n=r.util.sin(e),i=r.util.cos(e),o=t.x*i-t.y*n,a=t.x*n+t.y*i;return{x:o,y:a}},createVector:function(t,e){return new r.Point(e.x-t.x,e.y-t.y)},calcAngleBetweenVectors:function(t,e){return Math.acos((t.x*e.x+t.y*e.y)/(Math.hypot(t.x,t.y)*Math.hypot(e.x,e.y)))},getHatVector:function(t){return new r.Point(t.x,t.y).multiply(1/Math.hypot(t.x,t.y))},getBisector:function(t,e,n){var i=r.util.createVector(t,e),o=r.util.createVector(t,n),a=r.util.calcAngleBetweenVectors(i,o),s=r.util.calcAngleBetweenVectors(r.util.rotateVector(i,a),o),c=a*(0===s?1:-1)/2;return{vector:r.util.getHatVector(r.util.rotateVector(i,c)),angle:a}},projectStrokeOnPoints:function(t,e,n){var i=[],o=e.strokeWidth/2,a=e.strokeUniform?new r.Point(1/e.scaleX,1/e.scaleY):new r.Point(1,1),s=function(t){var e=o/Math.hypot(t.x,t.y);return new r.Point(t.x*e*a.x,t.y*e*a.y)};return t.length<=1||t.forEach((function(c,l){var u,h,d=new r.Point(c.x,c.y);0===l?(h=t[l+1],u=n?s(r.util.createVector(h,d)).addEquals(d):t[t.length-1]):l===t.length-1?(u=t[l-1],h=n?s(r.util.createVector(u,d)).addEquals(d):t[0]):(u=t[l-1],h=t[l+1]);var f,p,g=r.util.getBisector(d,u,h),v=g.vector,m=g.angle;if("miter"===e.strokeLineJoin&&(f=-o/Math.sin(m/2),p=new r.Point(v.x*f*a.x,v.y*f*a.y),Math.hypot(p.x,p.y)/o<=e.strokeMiterLimit))return i.push(d.add(p)),void i.push(d.subtract(p));f=-o*Math.SQRT2,p=new r.Point(v.x*f*a.x,v.y*f*a.y),i.push(d.add(p)),i.push(d.subtract(p))})),i},transformPoint:function(t,e,n){return n?new r.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new r.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},makeBoundingBoxFromPoints:function(t,e){if(e)for(var n=0;n<t.length;n++)t[n]=r.util.transformPoint(t[n],e);var i=[t[0].x,t[1].x,t[2].x,t[3].x],o=r.util.array.min(i),a=r.util.array.max(i),s=a-o,c=[t[0].y,t[1].y,t[2].y,t[3].y],l=r.util.array.min(c),u=r.util.array.max(c),h=u-l;return{left:o,top:l,width:s,height:h}},invertTransform:function(t){var e=1/(t[0]*t[3]-t[1]*t[2]),n=[e*t[3],-e*t[1],-e*t[2],e*t[0]],i=r.util.transformPoint({x:t[4],y:t[5]},n,!0);return n[4]=-i.x,n[5]=-i.y,n},toFixed:function(t,e){return parseFloat(Number(t).toFixed(e))},parseUnit:function(t,e){var n=/\D{0,2}$/.exec(t),i=parseFloat(t);switch(e||(e=r.Text.DEFAULT_SVG_FONT_SIZE),n[0]){case"mm":return i*r.DPI/25.4;case"cm":return i*r.DPI/2.54;case"in":return i*r.DPI;case"pt":return i*r.DPI/72;case"pc":return i*r.DPI/72*12;case"em":return i*e;default:return i}},falseFunction:function(){return!1},getKlass:function(t,e){return t=r.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),r.util.resolveNamespace(e)[t]},getSvgAttributes:function(t){var e=["instantiated_by_use","style","id","class"];switch(t){case"linearGradient":e=e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":e=e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":e=e.concat(["offset","stop-color","stop-opacity"]);break}return e},resolveNamespace:function(e){if(!e)return r;var n,i=e.split("."),o=i.length,a=t||r.window;for(n=0;n<o;++n)a=a[i[n]];return a},loadImage:function(t,e,n,i){if(t){var o=r.util.createImage(),a=function(){e&&e.call(n,o,!1),o=o.onload=o.onerror=null};o.onload=a,o.onerror=function(){r.log("Error loading "+o.src),e&&e.call(n,null,!0),o=o.onload=o.onerror=null},0!==t.indexOf("data")&&void 0!==i&&null!==i&&(o.crossOrigin=i),"data:image/svg"===t.substring(0,14)&&(o.onload=null,r.util.loadImageInDom(o,a)),o.src=t}else e&&e.call(n,t)},loadImageInDom:function(t,e){var n=r.document.createElement("div");n.style.width=n.style.height="1px",n.style.left=n.style.top="-100%",n.style.position="absolute",n.appendChild(t),r.document.querySelector("body").appendChild(n),t.onload=function(){e(),n.parentNode.removeChild(n),n=null}},enlivenObjects:function(t,e,n,i){t=t||[];var o=[],a=0,s=t.length;function c(){++a===s&&e&&e(o.filter((function(t){return t})))}s?t.forEach((function(t,e){if(t&&t.type){var a=r.util.getKlass(t.type,n);a.fromObject(t,(function(n,r){r||(o[e]=n),i&&i(t,n,r),c()}))}else c()})):e&&e(o)},enlivenObjectEnlivables:function(t,e,n){var i=r.Object.ENLIVEN_PROPS.filter((function(e){return!!t[e]}));r.util.enlivenObjects(i.map((function(e){return t[e]})),(function(t){var r={};i.forEach((function(n,i){r[n]=t[i],e&&(e[n]=t[i])})),n&&n(r)}))},enlivenPatterns:function(t,e){function n(){++o===a&&e&&e(i)}t=t||[];var i=[],o=0,a=t.length;a?t.forEach((function(t,e){t&&t.source?new r.Pattern(t,(function(t){i[e]=t,n()})):(i[e]=t,n())})):e&&e(i)},groupSVGElements:function(t,e,n){var i;return t&&1===t.length?t[0]:(e&&(e.width&&e.height?e.centerPoint={x:e.width/2,y:e.height/2}:(delete e.width,delete e.height)),i=new r.Group(t,e),"undefined"!==typeof n&&(i.sourcePath=n),i)},populateWithProperties:function(t,e,n){if(n&&"[object Array]"===Object.prototype.toString.call(n))for(var r=0,i=n.length;r<i;r++)n[r]in t&&(e[n[r]]=t[n[r]])},createCanvasElement:function(){return r.document.createElement("canvas")},copyCanvasElement:function(t){var e=r.util.createCanvasElement();return e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e},toDataURL:function(t,e,n){return t.toDataURL("image/"+e,n)},createImage:function(){return r.document.createElement("img")},multiplyTransformMatrices:function(t,e,n){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],n?0:t[0]*e[4]+t[2]*e[5]+t[4],n?0:t[1]*e[4]+t[3]*e[5]+t[5]]},qrDecompose:function(t){var r=n(t[1],t[0]),a=i(t[0],2)+i(t[1],2),s=e(a),c=(t[0]*t[3]-t[2]*t[1])/s,l=n(t[0]*t[2]+t[1]*t[3],a);return{angle:r/o,scaleX:s,scaleY:c,skewX:l/o,skewY:0,translateX:t[4],translateY:t[5]}},calcRotateMatrix:function(t){if(!t.angle)return r.iMatrix.concat();var e=r.util.degreesToRadians(t.angle),n=r.util.cos(e),i=r.util.sin(e);return[n,i,-i,n,0,0]},calcDimensionsMatrix:function(t){var e="undefined"===typeof t.scaleX?1:t.scaleX,n="undefined"===typeof t.scaleY?1:t.scaleY,i=[t.flipX?-e:e,0,0,t.flipY?-n:n,0,0],o=r.util.multiplyTransformMatrices,a=r.util.degreesToRadians;return t.skewX&&(i=o(i,[1,0,Math.tan(a(t.skewX)),1],!0)),t.skewY&&(i=o(i,[1,Math.tan(a(t.skewY)),0,1],!0)),i},composeMatrix:function(t){var e=[1,0,0,1,t.translateX||0,t.translateY||0],n=r.util.multiplyTransformMatrices;return t.angle&&(e=n(e,r.util.calcRotateMatrix(t))),(1!==t.scaleX||1!==t.scaleY||t.skewX||t.skewY||t.flipX||t.flipY)&&(e=n(e,r.util.calcDimensionsMatrix(t))),e},resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.flipX=!1,t.flipY=!1,t.rotate(0)},saveObjectTransform:function(t){return{scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,angle:t.angle,left:t.left,flipX:t.flipX,flipY:t.flipY,top:t.top}},isTransparent:function(t,e,n,r){r>0&&(e>r?e-=r:e=0,n>r?n-=r:n=0);var i,o,a=!0,s=t.getImageData(e,n,2*r||1,2*r||1),c=s.data.length;for(i=3;i<c;i+=4)if(o=s.data[i],a=o<=0,!1===a)break;return s=null,a},parsePreserveAspectRatioAttribute:function(t){var e,n="meet",r="Mid",i="Mid",o=t.split(" ");return o&&o.length&&(n=o.pop(),"meet"!==n&&"slice"!==n?(e=n,n="meet"):o.length&&(e=o.pop())),r="none"!==e?e.slice(1,4):"none",i="none"!==e?e.slice(5,8):"none",{meetOrSlice:n,alignX:r,alignY:i}},clearFabricFontCache:function(t){t=(t||"").toLowerCase(),t?r.charWidthsCache[t]&&delete r.charWidthsCache[t]:r.charWidthsCache={}},limitDimsByArea:function(t,e){var n=Math.sqrt(e*t),r=Math.floor(e/n);return{x:Math.floor(n),y:r}},capValue:function(t,e,n){return Math.max(t,Math.min(e,n))},findScaleToFit:function(t,e){return Math.min(e.width/t.width,e.height/t.height)},findScaleToCover:function(t,e){return Math.max(e.width/t.width,e.height/t.height)},matrixToSVG:function(t){return"matrix("+t.map((function(t){return r.util.toFixed(t,r.Object.NUM_FRACTION_DIGITS)})).join(" ")+")"},removeTransformFromObject:function(t,e){var n=r.util.invertTransform(e),i=r.util.multiplyTransformMatrices(n,t.calcOwnMatrix());r.util.applyTransformToObject(t,i)},addTransformToObject:function(t,e){r.util.applyTransformToObject(t,r.util.multiplyTransformMatrices(e,t.calcOwnMatrix()))},applyTransformToObject:function(t,e){var n=r.util.qrDecompose(e),i=new r.Point(n.translateX,n.translateY);t.flipX=!1,t.flipY=!1,t.set("scaleX",n.scaleX),t.set("scaleY",n.scaleY),t.skewX=n.skewX,t.skewY=n.skewY,t.angle=n.angle,t.setPositionByOrigin(i,"center","center")},sizeAfterTransform:function(t,e,n){var i=t/2,o=e/2,a=[{x:-i,y:-o},{x:i,y:-o},{x:-i,y:o},{x:i,y:o}],s=r.util.calcDimensionsMatrix(n),c=r.util.makeBoundingBoxFromPoints(a,s);return{x:c.width,y:c.height}},mergeClipPaths:function(t,e){var n=t,i=e;n.inverted&&!i.inverted&&(n=e,i=t),r.util.applyTransformToObject(i,r.util.multiplyTransformMatrices(r.util.invertTransform(n.calcTransformMatrix()),i.calcTransformMatrix()));var o=n.inverted&&i.inverted;return o&&(n.inverted=i.inverted=!1),new r.Group([n],{clipPath:i,inverted:o})}}}(e),function(){var t=Array.prototype.join,e={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},n={m:"l",M:"L"};function i(t,e,n,i,o,a,s,c,l,u,h){var d=r.util.cos(t),f=r.util.sin(t),p=r.util.cos(e),g=r.util.sin(e),v=n*o*p-i*a*g+s,m=i*o*p+n*a*g+c,b=u+l*(-n*o*f-i*a*d),y=h+l*(-i*o*f+n*a*d),S=v+l*(n*o*g+i*a*p),w=m+l*(i*o*g-n*a*p);return["C",b,y,S,w,v,m]}function o(t,e,n,o,s,c,l){var u=Math.PI,h=l*u/180,d=r.util.sin(h),f=r.util.cos(h),p=0,g=0;n=Math.abs(n),o=Math.abs(o);var v=-f*t*.5-d*e*.5,m=-f*e*.5+d*t*.5,b=n*n,y=o*o,S=m*m,w=v*v,E=b*y-b*S-y*w,C=0;if(E<0){var x=Math.sqrt(1-E/(b*y));n*=x,o*=x}else C=(s===c?-1:1)*Math.sqrt(E/(b*S+y*w));var O=C*n*m/o,_=-C*o*v/n,T=f*O-d*_+.5*t,k=d*O+f*_+.5*e,I=a(1,0,(v-O)/n,(m-_)/o),P=a((v-O)/n,(m-_)/o,(-v-O)/n,(-m-_)/o);0===c&&P>0?P-=2*u:1===c&&P<0&&(P+=2*u);for(var j=Math.ceil(Math.abs(P/u*2)),M=[],D=P/j,R=8/3*Math.sin(D/4)*Math.sin(D/4)/Math.sin(D/2),A=I+D,N=0;N<j;N++)M[N]=i(I,A,f,d,n,o,T,k,R,p,g),p=M[N][5],g=M[N][6],I=A,A+=D;return M}function a(t,e,n,r){var i=Math.atan2(e,t),o=Math.atan2(r,n);return o>=i?o-i:2*Math.PI-(i-o)}function s(e,n,i,o,a,s,c,l){var u;if(r.cachesBoundsOfCurve&&(u=t.call(arguments),r.boundsOfCurveCache[u]))return r.boundsOfCurveCache[u];var h,d,f,p,g,v,m,b,y=Math.sqrt,S=Math.min,w=Math.max,E=Math.abs,C=[],x=[[],[]];d=6*e-12*i+6*a,h=-3*e+9*i-9*a+3*c,f=3*i-3*e;for(var O=0;O<2;++O)if(O>0&&(d=6*n-12*o+6*s,h=-3*n+9*o-9*s+3*l,f=3*o-3*n),E(h)<1e-12){if(E(d)<1e-12)continue;p=-f/d,0<p&&p<1&&C.push(p)}else m=d*d-4*f*h,m<0||(b=y(m),g=(-d+b)/(2*h),0<g&&g<1&&C.push(g),v=(-d-b)/(2*h),0<v&&v<1&&C.push(v));var _,T,k,I=C.length,P=I;while(I--)p=C[I],k=1-p,_=k*k*k*e+3*k*k*p*i+3*k*p*p*a+p*p*p*c,x[0][I]=_,T=k*k*k*n+3*k*k*p*o+3*k*p*p*s+p*p*p*l,x[1][I]=T;x[0][P]=e,x[1][P]=n,x[0][P+1]=c,x[1][P+1]=l;var j=[{x:S.apply(null,x[0]),y:S.apply(null,x[1])},{x:w.apply(null,x[0]),y:w.apply(null,x[1])}];return r.cachesBoundsOfCurve&&(r.boundsOfCurveCache[u]=j),j}function c(t,e,n){for(var r=n[1],i=n[2],a=n[3],s=n[4],c=n[5],l=n[6],u=n[7],h=o(l-t,u-e,r,i,s,c,a),d=0,f=h.length;d<f;d++)h[d][1]+=t,h[d][2]+=e,h[d][3]+=t,h[d][4]+=e,h[d][5]+=t,h[d][6]+=e;return h}function l(t){var e,n,r,i,o,a,s=0,l=0,u=t.length,h=0,d=0,f=[];for(n=0;n<u;++n){switch(r=!1,e=t[n].slice(0),e[0]){case"l":e[0]="L",e[1]+=s,e[2]+=l;case"L":s=e[1],l=e[2];break;case"h":e[1]+=s;case"H":e[0]="L",e[2]=l,s=e[1];break;case"v":e[1]+=l;case"V":e[0]="L",l=e[1],e[1]=s,e[2]=l;break;case"m":e[0]="M",e[1]+=s,e[2]+=l;case"M":s=e[1],l=e[2],h=e[1],d=e[2];break;case"c":e[0]="C",e[1]+=s,e[2]+=l,e[3]+=s,e[4]+=l,e[5]+=s,e[6]+=l;case"C":o=e[3],a=e[4],s=e[5],l=e[6];break;case"s":e[0]="S",e[1]+=s,e[2]+=l,e[3]+=s,e[4]+=l;case"S":"C"===i?(o=2*s-o,a=2*l-a):(o=s,a=l),s=e[3],l=e[4],e[0]="C",e[5]=e[3],e[6]=e[4],e[3]=e[1],e[4]=e[2],e[1]=o,e[2]=a,o=e[3],a=e[4];break;case"q":e[0]="Q",e[1]+=s,e[2]+=l,e[3]+=s,e[4]+=l;case"Q":o=e[1],a=e[2],s=e[3],l=e[4];break;case"t":e[0]="T",e[1]+=s,e[2]+=l;case"T":"Q"===i?(o=2*s-o,a=2*l-a):(o=s,a=l),e[0]="Q",s=e[1],l=e[2],e[1]=o,e[2]=a,e[3]=s,e[4]=l;break;case"a":e[0]="A",e[6]+=s,e[7]+=l;case"A":r=!0,f=f.concat(c(s,l,e)),s=e[6],l=e[7];break;case"z":case"Z":s=h,l=d;break;default:}r||f.push(e),i=e[0]}return f}function u(t,e,n,r){return Math.sqrt((n-t)*(n-t)+(r-e)*(r-e))}function h(t){return t*t*t}function d(t){return 3*t*t*(1-t)}function f(t){return 3*t*(1-t)*(1-t)}function p(t){return(1-t)*(1-t)*(1-t)}function g(t,e,n,r,i,o,a,s){return function(c){var l=h(c),u=d(c),g=f(c),v=p(c);return{x:a*l+i*u+n*g+t*v,y:s*l+o*u+r*g+e*v}}}function v(t,e,n,r,i,o,a,s){return function(c){var l=1-c,u=3*l*l*(n-t)+6*l*c*(i-n)+3*c*c*(a-i),h=3*l*l*(r-e)+6*l*c*(o-r)+3*c*c*(s-o);return Math.atan2(h,u)}}function m(t){return t*t}function b(t){return 2*t*(1-t)}function y(t){return(1-t)*(1-t)}function S(t,e,n,r,i,o){return function(a){var s=m(a),c=b(a),l=y(a);return{x:i*s+n*c+t*l,y:o*s+r*c+e*l}}}function w(t,e,n,r,i,o){return function(a){var s=1-a,c=2*s*(n-t)+2*a*(i-n),l=2*s*(r-e)+2*a*(o-r);return Math.atan2(l,c)}}function E(t,e,n){var r,i,o={x:e,y:n},a=0;for(i=1;i<=100;i+=1)r=t(i/100),a+=u(o.x,o.y,r.x,r.y),o=r;return a}function C(t,e){var n,r,i,o=0,a=0,s=t.iterator,c={x:t.x,y:t.y},l=.01,h=t.angleFinder;while(a<e&&l>1e-4)n=s(o),i=o,r=u(c.x,c.y,n.x,n.y),r+a>e?(o-=l,l/=2):(c=n,o+=l,a+=r);return n.angle=h(i),n}function x(t){for(var e,n,r,i,o=0,a=t.length,s=0,c=0,l=0,h=0,d=[],f=0;f<a;f++){switch(e=t[f],r={x:s,y:c,command:e[0]},e[0]){case"M":r.length=0,l=s=e[1],h=c=e[2];break;case"L":r.length=u(s,c,e[1],e[2]),s=e[1],c=e[2];break;case"C":n=g(s,c,e[1],e[2],e[3],e[4],e[5],e[6]),i=v(s,c,e[1],e[2],e[3],e[4],e[5],e[6]),r.iterator=n,r.angleFinder=i,r.length=E(n,s,c),s=e[5],c=e[6];break;case"Q":n=S(s,c,e[1],e[2],e[3],e[4]),i=w(s,c,e[1],e[2],e[3],e[4]),r.iterator=n,r.angleFinder=i,r.length=E(n,s,c),s=e[3],c=e[4];break;case"Z":case"z":r.destX=l,r.destY=h,r.length=u(s,c,l,h),s=l,c=h;break}o+=r.length,d.push(r)}return d.push({length:o,x:s,y:c}),d}function O(t,e,n){n||(n=x(t));var i=0;while(e-n[i].length>0&&i<n.length-2)e-=n[i].length,i++;var o,a=n[i],s=e/a.length,c=a.command,l=t[i];switch(c){case"M":return{x:a.x,y:a.y,angle:0};case"Z":case"z":return o=new r.Point(a.x,a.y).lerp(new r.Point(a.destX,a.destY),s),o.angle=Math.atan2(a.destY-a.y,a.destX-a.x),o;case"L":return o=new r.Point(a.x,a.y).lerp(new r.Point(l[1],l[2]),s),o.angle=Math.atan2(l[2]-a.y,l[1]-a.x),o;case"C":return C(a,e);case"Q":return C(a,e)}}function _(t){var i,o,a,s,c,l=[],u=[],h=r.rePathCommand,d="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",f="("+d+")"+r.commaWsp,p="([01])"+r.commaWsp+"?",g=f+"?"+f+"?"+f+p+p+f+"?("+d+")",v=new RegExp(g,"g");if(!t||!t.match)return l;c=t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var m,b=0,y=c.length;b<y;b++){i=c[b],s=i.slice(1).trim(),u.length=0;var S=i.charAt(0);if(m=[S],"a"===S.toLowerCase())for(var w;w=v.exec(s);)for(var E=1;E<w.length;E++)u.push(w[E]);else while(a=h.exec(s))u.push(a[0]);E=0;for(var C=u.length;E<C;E++)o=parseFloat(u[E]),isNaN(o)||m.push(o);var x=e[S.toLowerCase()],O=n[S]||S;if(m.length-1>x)for(var _=1,T=m.length;_<T;_+=x)l.push([S].concat(m.slice(_,_+x))),S=O;else l.push(m)}return l}function T(t,e){var n,i=[],o=new r.Point(t[0].x,t[0].y),a=new r.Point(t[1].x,t[1].y),s=t.length,c=1,l=0,u=s>2;for(e=e||0,u&&(c=t[2].x<a.x?-1:t[2].x===a.x?0:1,l=t[2].y<a.y?-1:t[2].y===a.y?0:1),i.push(["M",o.x-c*e,o.y-l*e]),n=1;n<s;n++){if(!o.eq(a)){var h=o.midPointFrom(a);i.push(["Q",o.x,o.y,h.x,h.y])}o=t[n],n+1<t.length&&(a=t[n+1])}return u&&(c=o.x>t[n-2].x?1:o.x===t[n-2].x?0:-1,l=o.y>t[n-2].y?1:o.y===t[n-2].y?0:-1),i.push(["L",o.x+c*e,o.y+l*e]),i}function k(t,e,n){return n&&(e=r.util.multiplyTransformMatrices(e,[1,0,0,1,-n.x,-n.y])),t.map((function(t){for(var n=t.slice(0),i={},o=1;o<t.length-1;o+=2)i.x=t[o],i.y=t[o+1],i=r.util.transformPoint(i,e),n[o]=i.x,n[o+1]=i.y;return n}))}r.util.joinPath=function(t){return t.map((function(t){return t.join(" ")})).join(" ")},r.util.parsePath=_,r.util.makePathSimpler=l,r.util.getSmoothPathFromPoints=T,r.util.getPathSegmentsInfo=x,r.util.getBoundsOfCurve=s,r.util.getPointOnPath=O,r.util.transformPath=k}(),function(){var t=Array.prototype.slice;function e(e,n){for(var r=t.call(arguments,2),i=[],o=0,a=e.length;o<a;o++)i[o]=r.length?e[o][n].apply(e[o],r):e[o][n].call(e[o]);return i}function n(t,e){return a(t,e,(function(t,e){return t>=e}))}function i(t,e){return a(t,e,(function(t,e){return t<e}))}function o(t,e){var n=t.length;while(n--)t[n]=e;return t}function a(t,e,n){if(t&&0!==t.length){var r=t.length-1,i=e?t[r][e]:t[r];if(e)while(r--)n(t[r][e],i)&&(i=t[r][e]);else while(r--)n(t[r],i)&&(i=t[r]);return i}}r.util.array={fill:o,invoke:e,min:i,max:n}}(),function(){function t(e,n,i){if(i)if(!r.isLikelyNode&&n instanceof Element)e=n;else if(n instanceof Array){e=[];for(var o=0,a=n.length;o<a;o++)e[o]=t({},n[o],i)}else if(n&&"object"===typeof n)for(var s in n)"canvas"===s||"group"===s?e[s]=null:n.hasOwnProperty(s)&&(e[s]=t({},n[s],i));else e=n;else for(var s in n)e[s]=n[s];return e}function e(e,n){return t({},e,n)}r.util.object={extend:t,clone:e},r.util.object.extend(r.util,r.Observable)}(),function(){function t(t){return t.replace(/-+(.)?/g,(function(t,e){return e?e.toUpperCase():""}))}function e(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())}function n(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function i(t){var e,n=0,r=[];for(n=0,e;n<t.length;n++)!1!==(e=o(t,n))&&r.push(e);return r}function o(t,e){var n=t.charCodeAt(e);if(isNaN(n))return"";if(n<55296||n>57343)return t.charAt(e);if(55296<=n&&n<=56319){if(t.length<=e+1)throw"High surrogate without following low surrogate";var r=t.charCodeAt(e+1);if(56320>r||r>57343)throw"High surrogate without following low surrogate";return t.charAt(e)+t.charAt(e+1)}if(0===e)throw"Low surrogate without preceding high surrogate";var i=t.charCodeAt(e-1);if(55296>i||i>56319)throw"Low surrogate without preceding high surrogate";return!1}r.util.string={camelize:t,capitalize:e,escapeXml:n,graphemeSplit:i}}(),function(){var t=Array.prototype.slice,e=function(){},n=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),i=function(t,e,r){for(var i in e)i in t.prototype&&"function"===typeof t.prototype[i]&&(e[i]+"").indexOf("callSuper")>-1?t.prototype[i]=function(t){return function(){var n=this.constructor.superclass;this.constructor.superclass=r;var i=e[t].apply(this,arguments);if(this.constructor.superclass=n,"initialize"!==t)return i}}(i):t.prototype[i]=e[i],n&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};function o(){}function a(e){var n=null,r=this;while(r.constructor.superclass){var i=r.constructor.superclass.prototype[e];if(r[e]!==i){n=i;break}r=r.constructor.superclass.prototype}return n?arguments.length>1?n.apply(this,t.call(arguments,1)):n.call(this):console.log("tried to callSuper "+e+", method not found in prototype chain",this)}function s(){var n=null,r=t.call(arguments,0);function s(){this.initialize.apply(this,arguments)}"function"===typeof r[0]&&(n=r.shift()),s.superclass=n,s.subclasses=[],n&&(o.prototype=n.prototype,s.prototype=new o,n.subclasses.push(s));for(var c=0,l=r.length;c<l;c++)i(s,r[c],n);return s.prototype.initialize||(s.prototype.initialize=e),s.prototype.constructor=s,s.prototype.callSuper=a,s}r.util.createClass=s}(),function(){var t=!!r.document.createElement("div").attachEvent,e=["touchstart","touchmove","touchend"];function n(t){var e=t.changedTouches;return e&&e[0]?e[0]:t}r.util.addListener=function(e,n,r,i){e&&e.addEventListener(n,r,!t&&i)},r.util.removeListener=function(e,n,r,i){e&&e.removeEventListener(n,r,!t&&i)},r.util.getPointer=function(t){var e=t.target,i=r.util.getScrollLeftTop(e),o=n(t);return{x:o.clientX+i.left,y:o.clientY+i.top}},r.util.isTouchEvent=function(t){return e.indexOf(t.type)>-1||"touch"===t.pointerType}}(),function(){function t(t,e){var n=t.style;if(!n)return t;if("string"===typeof e)return t.style.cssText+=";"+e,e.indexOf("opacity")>-1?a(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var r in e)if("opacity"===r)a(t,e[r]);else{var i="float"===r||"cssFloat"===r?"undefined"===typeof n.styleFloat?"cssFloat":"styleFloat":r;n[i]=e[r]}return t}var e=r.document.createElement("div"),n="string"===typeof e.style.opacity,i="string"===typeof e.style.filter,o=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,a=function(t){return t};n?a=function(t,e){return t.style.opacity=e,t}:i&&(a=function(t,e){var n=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(n.zoom=1),o.test(n.filter)?(e=e>=.9999?"":"alpha(opacity="+100*e+")",n.filter=n.filter.replace(o,e)):n.filter+=" alpha(opacity="+100*e+")",t}),r.util.setStyle=t}(),function(){var t=Array.prototype.slice;function e(t){return"string"===typeof t?r.document.getElementById(t):t}var n,i,o=function(e){return t.call(e,0)};try{n=o(r.document.childNodes)instanceof Array}catch(p){}function a(t,e){var n=r.document.createElement(t);for(var i in e)"class"===i?n.className=e[i]:"for"===i?n.htmlFor=e[i]:n.setAttribute(i,e[i]);return n}function s(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)}function c(t,e,n){return"string"===typeof e&&(e=a(e,n)),t.parentNode&&t.parentNode.replaceChild(e,t),e.appendChild(t),e}function l(t){var e=0,n=0,i=r.document.documentElement,o=r.document.body||{scrollLeft:0,scrollTop:0};while(t&&(t.parentNode||t.host))if(t=t.parentNode||t.host,t===r.document?(e=o.scrollLeft||i.scrollLeft||0,n=o.scrollTop||i.scrollTop||0):(e+=t.scrollLeft||0,n+=t.scrollTop||0),1===t.nodeType&&"fixed"===t.style.position)break;return{left:e,top:n}}function u(t){var e,n,r=t&&t.ownerDocument,o={left:0,top:0},a={left:0,top:0},s={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!r)return a;for(var c in s)a[s[c]]+=parseInt(i(t,c),10)||0;return e=r.documentElement,"undefined"!==typeof t.getBoundingClientRect&&(o=t.getBoundingClientRect()),n=l(t),{left:o.left+n.left-(e.clientLeft||0)+a.left,top:o.top+n.top-(e.clientTop||0)+a.top}}function h(t){var e=r.jsdomImplForWrapper(t);return e._canvas||e._image}function d(t){if(r.isLikelyNode){var e=r.jsdomImplForWrapper(t);e&&(e._image=null,e._canvas=null,e._currentSrc=null,e._attributes=null,e._classList=null)}}function f(t,e){t.imageSmoothingEnabled=t.imageSmoothingEnabled||t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled||t.oImageSmoothingEnabled,t.imageSmoothingEnabled=e}n||(o=function(t){var e=new Array(t.length),n=t.length;while(n--)e[n]=t[n];return e}),i=r.document.defaultView&&r.document.defaultView.getComputedStyle?function(t,e){var n=r.document.defaultView.getComputedStyle(t,null);return n?n[e]:void 0}:function(t,e){var n=t.style[e];return!n&&t.currentStyle&&(n=t.currentStyle[e]),n},function(){var t=r.document.documentElement.style,e="userSelect"in t?"userSelect":"MozUserSelect"in t?"MozUserSelect":"WebkitUserSelect"in t?"WebkitUserSelect":"KhtmlUserSelect"in t?"KhtmlUserSelect":"";function n(t){return"undefined"!==typeof t.onselectstart&&(t.onselectstart=r.util.falseFunction),e?t.style[e]="none":"string"===typeof t.unselectable&&(t.unselectable="on"),t}function i(t){return"undefined"!==typeof t.onselectstart&&(t.onselectstart=null),e?t.style[e]="":"string"===typeof t.unselectable&&(t.unselectable=""),t}r.util.makeElementUnselectable=n,r.util.makeElementSelectable=i}(),r.util.setImageSmoothing=f,r.util.getById=e,r.util.toArray=o,r.util.addClass=s,r.util.makeElement=a,r.util.wrapElement=c,r.util.getScrollLeftTop=l,r.util.getElementOffset=u,r.util.getNodeCanvas=h,r.util.cleanUpJsdomNode=d}(),function(){function t(t,e){return t+(/\?/.test(t)?"&":"?")+e}function e(){}function n(n,i){i||(i={});var o=i.method?i.method.toUpperCase():"GET",a=i.onComplete||function(){},s=new r.window.XMLHttpRequest,c=i.body||i.parameters;return s.onreadystatechange=function(){4===s.readyState&&(a(s),s.onreadystatechange=e)},"GET"===o&&(c=null,"string"===typeof i.parameters&&(n=t(n,i.parameters))),s.open(o,n,!0),"POST"!==o&&"PUT"!==o||s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(c),s}r.util.request=n}(),r.log=console.log,r.warn=console.warn,function(){var t=r.util.object.extend,e=r.util.object.clone,n=[];function i(){return!1}function o(t,e,n,r){return-n*Math.cos(t/r*(Math.PI/2))+n+e}function a(n){n||(n={});var a,s=!1,c=function(){var t=r.runningAnimations.indexOf(a);return t>-1&&r.runningAnimations.splice(t,1)[0]};return a=t(e(n),{cancel:function(){return s=!0,c()},currentValue:"startValue"in n?n.startValue:0,completionRate:0,durationRate:0}),r.runningAnimations.push(a),l((function(t){var e,r=t||+new Date,u=n.duration||500,h=r+u,d=n.onChange||i,f=n.abort||i,p=n.onComplete||i,g=n.easing||o,v="startValue"in n?n.startValue:0,m="endValue"in n?n.endValue:100,b=n.byValue||m-v;n.onStart&&n.onStart(),function t(n){e=n||+new Date;var i=e>h?u:e-r,o=i/u,y=g(i,v,b,u),S=Math.abs((y-v)/b);if(a.currentValue=y,a.completionRate=S,a.durationRate=o,!s){if(!f(y,S,o))return e>h?(a.currentValue=m,a.completionRate=1,a.durationRate=1,d(m,1,1),p(m,1,1),void c()):(d(y,S,o),void l(t));c()}}(r)})),a.cancel}r.util.object.extend(n,{cancelAll:function(){var t=this.splice(0);return t.forEach((function(t){t.cancel()})),t},cancelByCanvas:function(t){if(!t)return[];var e=this.filter((function(e){return"object"===typeof e.target&&e.target.canvas===t}));return e.forEach((function(t){t.cancel()})),e},cancelByTarget:function(t){var e=this.findAnimationsByTarget(t);return e.forEach((function(t){t.cancel()})),e},findAnimationIndex:function(t){return this.indexOf(this.findAnimation(t))},findAnimation:function(t){return this.find((function(e){return e.cancel===t}))},findAnimationsByTarget:function(t){return t?this.filter((function(e){return e.target===t})):[]}});var s=r.window.requestAnimationFrame||r.window.webkitRequestAnimationFrame||r.window.mozRequestAnimationFrame||r.window.oRequestAnimationFrame||r.window.msRequestAnimationFrame||function(t){return r.window.setTimeout(t,1e3/60)},c=r.window.cancelAnimationFrame||r.window.clearTimeout;function l(){return s.apply(r.window,arguments)}function u(){return c.apply(r.window,arguments)}r.util.animate=a,r.util.requestAnimFrame=l,r.util.cancelAnimFrame=u,r.runningAnimations=n}(),function(){function t(t,e,n){var r="rgba("+parseInt(t[0]+n*(e[0]-t[0]),10)+","+parseInt(t[1]+n*(e[1]-t[1]),10)+","+parseInt(t[2]+n*(e[2]-t[2]),10);return r+=","+(t&&e?parseFloat(t[3]+n*(e[3]-t[3])):1),r+=")",r}function e(e,n,i,o){var a=new r.Color(e).getSource(),s=new r.Color(n).getSource(),c=o.onComplete,l=o.onChange;return o=o||{},r.util.animate(r.util.object.extend(o,{duration:i||500,startValue:a,endValue:s,byValue:s,easing:function(e,n,r,i){var a=o.colorEasing?o.colorEasing(e,i):1-Math.cos(e/i*(Math.PI/2));return t(n,r,a)},onComplete:function(e,n,r){if(c)return c(t(s,s,0),n,r)},onChange:function(e,n,r){if(l){if(Array.isArray(e))return l(t(e,e,0),n,r);l(e,n,r)}}}))}r.util.animateColor=e}(),function(){function t(t,e,n,r){return t<Math.abs(e)?(t=e,r=n/4):r=0===e&&0===t?n/(2*Math.PI)*Math.asin(1):n/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:n,s:r}}function e(t,e,n){return t.a*Math.pow(2,10*(e-=1))*Math.sin((e*n-t.s)*(2*Math.PI)/t.p)}function n(t,e,n,r){return n*((t=t/r-1)*t*t+1)+e}function i(t,e,n,r){return t/=r/2,t<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e}function o(t,e,n,r){return n*(t/=r)*t*t*t+e}function a(t,e,n,r){return-n*((t=t/r-1)*t*t*t-1)+e}function s(t,e,n,r){return t/=r/2,t<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e}function c(t,e,n,r){return n*(t/=r)*t*t*t*t+e}function l(t,e,n,r){return n*((t=t/r-1)*t*t*t*t+1)+e}function u(t,e,n,r){return t/=r/2,t<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e}function h(t,e,n,r){return-n*Math.cos(t/r*(Math.PI/2))+n+e}function d(t,e,n,r){return n*Math.sin(t/r*(Math.PI/2))+e}function f(t,e,n,r){return-n/2*(Math.cos(Math.PI*t/r)-1)+e}function p(t,e,n,r){return 0===t?e:n*Math.pow(2,10*(t/r-1))+e}function g(t,e,n,r){return t===r?e+n:n*(1-Math.pow(2,-10*t/r))+e}function v(t,e,n,r){return 0===t?e:t===r?e+n:(t/=r/2,t<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(2-Math.pow(2,-10*--t))+e)}function m(t,e,n,r){return-n*(Math.sqrt(1-(t/=r)*t)-1)+e}function b(t,e,n,r){return n*Math.sqrt(1-(t=t/r-1)*t)+e}function y(t,e,n,r){return t/=r/2,t<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e}function S(n,r,i,o){var a=1.70158,s=0,c=i;if(0===n)return r;if(n/=o,1===n)return r+i;s||(s=.3*o);var l=t(c,i,s,a);return-e(l,n,o)+r}function w(e,n,r,i){var o=1.70158,a=0,s=r;if(0===e)return n;if(e/=i,1===e)return n+r;a||(a=.3*i);var c=t(s,r,a,o);return c.a*Math.pow(2,-10*e)*Math.sin((e*i-c.s)*(2*Math.PI)/c.p)+c.c+n}function E(n,r,i,o){var a=1.70158,s=0,c=i;if(0===n)return r;if(n/=o/2,2===n)return r+i;s||(s=o*(.3*1.5));var l=t(c,i,s,a);return n<1?-.5*e(l,n,o)+r:l.a*Math.pow(2,-10*(n-=1))*Math.sin((n*o-l.s)*(2*Math.PI)/l.p)*.5+l.c+r}function C(t,e,n,r,i){return void 0===i&&(i=1.70158),n*(t/=r)*t*((i+1)*t-i)+e}function x(t,e,n,r,i){return void 0===i&&(i=1.70158),n*((t=t/r-1)*t*((i+1)*t+i)+1)+e}function O(t,e,n,r,i){return void 0===i&&(i=1.70158),t/=r/2,t<1?n/2*(t*t*((1+(i*=1.525))*t-i))+e:n/2*((t-=2)*t*((1+(i*=1.525))*t+i)+2)+e}function _(t,e,n,r){return n-T(r-t,0,n,r)+e}function T(t,e,n,r){return(t/=r)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e}function k(t,e,n,r){return t<r/2?.5*_(2*t,0,n,r)+e:.5*T(2*t-r,0,n,r)+.5*n+e}r.util.ease={easeInQuad:function(t,e,n,r){return n*(t/=r)*t+e},easeOutQuad:function(t,e,n,r){return-n*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,n,r){return t/=r/2,t<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,r){return n*(t/=r)*t*t+e},easeOutCubic:n,easeInOutCubic:i,easeInQuart:o,easeOutQuart:a,easeInOutQuart:s,easeInQuint:c,easeOutQuint:l,easeInOutQuint:u,easeInSine:h,easeOutSine:d,easeInOutSine:f,easeInExpo:p,easeOutExpo:g,easeInOutExpo:v,easeInCirc:m,easeOutCirc:b,easeInOutCirc:y,easeInElastic:S,easeOutElastic:w,easeInOutElastic:E,easeInBack:C,easeOutBack:x,easeInOutBack:O,easeInBounce:_,easeOutBounce:T,easeInOutBounce:k}}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,r=e.util.object.clone,i=e.util.toFixed,o=e.util.parseUnit,a=e.util.multiplyTransformMatrices,s=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],c=["symbol","image","marker","pattern","view","svg"],l=["pattern","defs","symbol","metadata","clipPath","mask","desc"],u=["symbol","g","a","svg","clipPath","defs"],h={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},d={stroke:"strokeOpacity",fill:"fillOpacity"},f="font-size",p="clip-path";function g(t){return t in h?h[t]:t}function v(t,n,r,i){var s,c="[object Array]"===Object.prototype.toString.call(n);if("fill"!==t&&"stroke"!==t||"none"!==n){if("strokeUniform"===t)return"non-scaling-stroke"===n;if("strokeDashArray"===t)n="none"===n?null:n.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===t)n=r&&r.transformMatrix?a(r.transformMatrix,e.parseTransformAttribute(n)):e.parseTransformAttribute(n);else if("visible"===t)n="none"!==n&&"hidden"!==n,r&&!1===r.visible&&(n=!1);else if("opacity"===t)n=parseFloat(n),r&&"undefined"!==typeof r.opacity&&(n*=r.opacity);else if("textAnchor"===t)n="start"===n?"left":"end"===n?"right":"center";else if("charSpacing"===t)s=o(n,i)/i*1e3;else if("paintFirst"===t){var l=n.indexOf("fill"),u=n.indexOf("stroke");n="fill";(l>-1&&u>-1&&u<l||-1===l&&u>-1)&&(n="stroke")}else{if("href"===t||"xlink:href"===t||"font"===t)return n;if("imageSmoothing"===t)return"optimizeQuality"===n;s=c?n.map(o):o(n,i)}}else n="";return!c&&isNaN(s)?n:s}function m(t){return new RegExp("^("+t.join("|")+")\\b","i")}function b(t){for(var n in d)if("undefined"!==typeof t[d[n]]&&""!==t[n]){if("undefined"===typeof t[n]){if(!e.Object.prototype[n])continue;t[n]=e.Object.prototype[n]}if(0!==t[n].indexOf("url(")){var r=new e.Color(t[n]);t[n]=r.setAlpha(i(r.getAlpha()*t[d[n]],2)).toRgba()}}return t}function y(t,e){var n,r,i,o,a=[];for(i=0,o=e.length;i<o;i++)n=e[i],r=t.getElementsByTagName(n),a=a.concat(Array.prototype.slice.call(r));return a}function S(t,e){var n,r;t.replace(/;\s*$/,"").split(";").forEach((function(t){var i=t.split(":");n=i[0].trim().toLowerCase(),r=i[1].trim(),e[n]=r}))}function w(t,e){var n,r;for(var i in t)"undefined"!==typeof t[i]&&(n=i.toLowerCase(),r=t[i],e[n]=r)}function E(t,n){var r={};for(var i in e.cssRules[n])if(C(t,i.split(" ")))for(var o in e.cssRules[n][i])r[o]=e.cssRules[n][i][o];return r}function C(t,e){var n,r=!0;return n=O(t,e.pop()),n&&e.length&&(r=x(t,e)),n&&r&&0===e.length}function x(t,e){var n,r=!0;while(t.parentNode&&1===t.parentNode.nodeType&&e.length)r&&(n=e.pop()),t=t.parentNode,r=O(t,n);return 0===e.length}function O(t,e){var n,r,i=t.nodeName,o=t.getAttribute("class"),a=t.getAttribute("id");if(n=new RegExp("^"+i,"i"),e=e.replace(n,""),a&&e.length&&(n=new RegExp("#"+a+"(?![a-zA-Z\\-]+)","i"),e=e.replace(n,"")),o&&e.length)for(o=o.split(" "),r=o.length;r--;)n=new RegExp("\\."+o[r]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(n,"");return 0===e.length}function _(t,e){var n;if(t.getElementById&&(n=t.getElementById(e)),n)return n;var r,i,o,a=t.getElementsByTagName("*");for(i=0,o=a.length;i<o;i++)if(r=a[i],e===r.getAttribute("id"))return r}function T(t){var n=y(t,["use","svg:use"]),r=0;while(n.length&&r<n.length){var i=n[r],o=i.getAttribute("xlink:href")||i.getAttribute("href");if(null===o)return;var a,s,c,l,u,h=o.substr(1),d=i.getAttribute("x")||0,f=i.getAttribute("y")||0,p=_(t,h).cloneNode(!0),g=(p.getAttribute("transform")||"")+" translate("+d+", "+f+")",v=n.length,m=e.svgNS;if(I(p),/^svg$/i.test(p.nodeName)){var b=p.ownerDocument.createElementNS(m,"g");for(c=0,l=p.attributes,u=l.length;c<u;c++)s=l.item(c),b.setAttributeNS(m,s.nodeName,s.nodeValue);while(p.firstChild)b.appendChild(p.firstChild);p=b}for(c=0,l=i.attributes,u=l.length;c<u;c++)s=l.item(c),"x"!==s.nodeName&&"y"!==s.nodeName&&"xlink:href"!==s.nodeName&&"href"!==s.nodeName&&("transform"===s.nodeName?g=s.nodeValue+" "+g:p.setAttribute(s.nodeName,s.nodeValue));p.setAttribute("transform",g),p.setAttribute("instantiated_by_use","1"),p.removeAttribute("id"),a=i.parentNode,a.replaceChild(p,i),n.length===v&&r++}}e.svgValidTagNamesRegEx=m(s),e.svgViewBoxElementsRegEx=m(c),e.svgInvalidAncestorsRegEx=m(l),e.svgValidParentsRegEx=m(u),e.cssRules={},e.gradientDefs={},e.clipPaths={},e.parseTransformAttribute=function(){function t(t,n){var r=e.util.cos(n[0]),i=e.util.sin(n[0]),o=0,a=0;3===n.length&&(o=n[1],a=n[2]),t[0]=r,t[1]=i,t[2]=-i,t[3]=r,t[4]=o-(r*o-i*a),t[5]=a-(i*o+r*a)}function n(t,e){var n=e[0],r=2===e.length?e[1]:e[0];t[0]=n,t[3]=r}function r(t,n,r){t[r]=Math.tan(e.util.degreesToRadians(n[0]))}function i(t,e){t[4]=e[0],2===e.length&&(t[5]=e[1])}var o=e.iMatrix,a=e.reNum,s=e.commaWsp,c="(?:(skewX)\\s*\\(\\s*("+a+")\\s*\\))",l="(?:(skewY)\\s*\\(\\s*("+a+")\\s*\\))",u="(?:(rotate)\\s*\\(\\s*("+a+")(?:"+s+"("+a+")"+s+"("+a+"))?\\s*\\))",h="(?:(scale)\\s*\\(\\s*("+a+")(?:"+s+"("+a+"))?\\s*\\))",d="(?:(translate)\\s*\\(\\s*("+a+")(?:"+s+"("+a+"))?\\s*\\))",f="(?:(matrix)\\s*\\(\\s*("+a+")"+s+"("+a+")"+s+"("+a+")"+s+"("+a+")"+s+"("+a+")"+s+"("+a+")\\s*\\))",p="(?:"+f+"|"+d+"|"+h+"|"+u+"|"+c+"|"+l+")",g="(?:"+p+"(?:"+s+"*"+p+")*)",v="^\\s*(?:"+g+"?)\\s*$",m=new RegExp(v),b=new RegExp(p,"g");return function(a){var s=o.concat(),c=[];if(!a||a&&!m.test(a))return s;a.replace(b,(function(a){var l=new RegExp(p).exec(a).filter((function(t){return!!t})),u=l[1],h=l.slice(2).map(parseFloat);switch(u){case"translate":i(s,h);break;case"rotate":h[0]=e.util.degreesToRadians(h[0]),t(s,h);break;case"scale":n(s,h);break;case"skewX":r(s,h,2);break;case"skewY":r(s,h,1);break;case"matrix":s=h;break}c.push(s.concat()),s=o.concat()}));var l=c[0];while(c.length>1)c.shift(),l=e.util.multiplyTransformMatrices(l,c[0]);return l}}();var k=new RegExp("^\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*$");function I(t){if(!e.svgViewBoxElementsRegEx.test(t.nodeName))return{};var n,r,i,a,s=t.getAttribute("viewBox"),c=1,l=1,u=0,h=0,d=t.getAttribute("width"),f=t.getAttribute("height"),p=t.getAttribute("x")||0,g=t.getAttribute("y")||0,v=t.getAttribute("preserveAspectRatio")||"",m=!s||!(s=s.match(k)),b=!d||!f||"100%"===d||"100%"===f,y=m&&b,S={},w="",E=0,C=0;if(S.width=0,S.height=0,S.toBeParsed=y,m&&(p||g)&&t.parentNode&&"#document"!==t.parentNode.nodeName&&(w=" translate("+o(p)+" "+o(g)+") ",i=(t.getAttribute("transform")||"")+w,t.setAttribute("transform",i),t.removeAttribute("x"),t.removeAttribute("y")),y)return S;if(m)return S.width=o(d),S.height=o(f),S;if(u=-parseFloat(s[1]),h=-parseFloat(s[2]),n=parseFloat(s[3]),r=parseFloat(s[4]),S.minX=u,S.minY=h,S.viewBoxWidth=n,S.viewBoxHeight=r,b?(S.width=n,S.height=r):(S.width=o(d),S.height=o(f),c=S.width/n,l=S.height/r),v=e.util.parsePreserveAspectRatioAttribute(v),"none"!==v.alignX&&("meet"===v.meetOrSlice&&(l=c=c>l?l:c),"slice"===v.meetOrSlice&&(l=c=c>l?c:l),E=S.width-n*c,C=S.height-r*c,"Mid"===v.alignX&&(E/=2),"Mid"===v.alignY&&(C/=2),"Min"===v.alignX&&(E=0),"Min"===v.alignY&&(C=0)),1===c&&1===l&&0===u&&0===h&&0===p&&0===g)return S;if((p||g)&&"#document"!==t.parentNode.nodeName&&(w=" translate("+o(p)+" "+o(g)+") "),i=w+" matrix("+c+" 0 0 "+l+" "+(u*c+E)+" "+(h*l+C)+") ","svg"===t.nodeName){a=t.ownerDocument.createElementNS(e.svgNS,"g");while(t.firstChild)a.appendChild(t.firstChild);t.appendChild(a)}else a=t,a.removeAttribute("x"),a.removeAttribute("y"),i=a.getAttribute("transform")+i;return a.setAttribute("transform",i),S}function P(t,e){while(t&&(t=t.parentNode))if(t.nodeName&&e.test(t.nodeName.replace("svg:",""))&&!t.getAttribute("instantiated_by_use"))return!0;return!1}function j(t,e){var n=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],r="xlink:href",i=e.getAttribute(r).substr(1),o=_(t,i);if(o&&o.getAttribute(r)&&j(t,o),n.forEach((function(t){o&&!e.hasAttribute(t)&&o.hasAttribute(t)&&e.setAttribute(t,o.getAttribute(t))})),!e.children.length){var a=o.cloneNode(!0);while(a.firstChild)e.appendChild(a.firstChild)}e.removeAttribute(r)}e.parseSVGDocument=function(t,n,i,o){if(t){T(t);var a,s,c=e.Object.__uid++,l=I(t),u=e.util.toArray(t.getElementsByTagName("*"));if(l.crossOrigin=o&&o.crossOrigin,l.svgUid=c,0===u.length&&e.isLikelyNode){u=t.selectNodes('//*[name(.)!="svg"]');var h=[];for(a=0,s=u.length;a<s;a++)h[a]=u[a];u=h}var d=u.filter((function(t){return I(t),e.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))&&!P(t,e.svgInvalidAncestorsRegEx)}));if(!d||d&&!d.length)n&&n([],{});else{var f={};u.filter((function(t){return"clipPath"===t.nodeName.replace("svg:","")})).forEach((function(t){var n=t.getAttribute("id");f[n]=e.util.toArray(t.getElementsByTagName("*")).filter((function(t){return e.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))}))})),e.gradientDefs[c]=e.getGradientDefs(t),e.cssRules[c]=e.getCSSRules(t),e.clipPaths[c]=f,e.parseElements(d,(function(t,r){n&&(n(t,l,r,u),delete e.gradientDefs[c],delete e.cssRules[c],delete e.clipPaths[c])}),r(l),i,o)}}};var M=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+e.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+e.reNum+"))?\\s+(.*)");n(e,{parseFontDeclaration:function(t,e){var n=t.match(M);if(n){var r=n[1],i=n[3],a=n[4],s=n[5],c=n[6];r&&(e.fontStyle=r),i&&(e.fontWeight=isNaN(parseFloat(i))?i:parseFloat(i)),a&&(e.fontSize=o(a)),c&&(e.fontFamily=c),s&&(e.lineHeight="normal"===s?1:s)}},getGradientDefs:function(t){var e,n=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],r=y(t,n),i=0,o={};i=r.length;while(i--)e=r[i],e.getAttribute("xlink:href")&&j(t,e),o[e.getAttribute("id")]=e;return o},parseAttributes:function(t,r,i){if(t){var a,s,c,l={};"undefined"===typeof i&&(i=t.getAttribute("svgUid")),t.parentNode&&e.svgValidParentsRegEx.test(t.parentNode.nodeName)&&(l=e.parseAttributes(t.parentNode,r,i));var u=r.reduce((function(e,n){return a=t.getAttribute(n),a&&(e[n]=a),e}),{}),h=n(E(t,i),e.parseStyleAttribute(t));u=n(u,h),h[p]&&t.setAttribute(p,h[p]),s=c=l.fontSize||e.Text.DEFAULT_SVG_FONT_SIZE,u[f]&&(u[f]=s=o(u[f],c));var d,m,y={};for(var S in u)d=g(S),m=v(d,u[S],l,s),y[d]=m;y&&y.font&&e.parseFontDeclaration(y.font,y);var w=n(l,y);return e.svgValidParentsRegEx.test(t.nodeName)?w:b(w)}},parseElements:function(t,n,r,i,o){new e.ElementsParser(t,n,r,i,o).parse()},parseStyleAttribute:function(t){var e={},n=t.getAttribute("style");return n?("string"===typeof n?S(n,e):w(n,e),e):e},parsePointsAttribute:function(t){if(!t)return null;t=t.replace(/,/g," ").trim(),t=t.split(/\s+/);var e,n,r=[];for(e=0,n=t.length;e<n;e+=2)r.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return r},getCSSRules:function(t){var n,r,i,o=t.getElementsByTagName("style"),a={};for(n=0,r=o.length;n<r;n++){var s=o[n].textContent;s=s.replace(/\/\*[\s\S]*?\*\//g,""),""!==s.trim()&&(i=s.split("}"),i=i.filter((function(t){return t.trim()})),i.forEach((function(t){var i=t.split("{"),o={},s=i[1].trim(),c=s.split(";").filter((function(t){return t.trim()}));for(n=0,r=c.length;n<r;n++){var l=c[n].split(":"),u=l[0].trim(),h=l[1].trim();o[u]=h}t=i[0].trim(),t.split(",").forEach((function(t){t=t.replace(/^svg/i,"").trim(),""!==t&&(a[t]?e.util.object.extend(a[t],o):a[t]=e.util.object.clone(o))}))})))}return a},loadSVGFromURL:function(t,n,r,i){function o(t){var o=t.responseXML;if(!o||!o.documentElement)return n&&n(null),!1;e.parseSVGDocument(o.documentElement,(function(t,e,r,i){n&&n(t,e,r,i)}),r,i)}t=t.replace(/^\n\s*/,"").trim(),new e.util.request(t,{method:"get",onComplete:o})},loadSVGFromString:function(t,n,r,i){var o=new e.window.DOMParser,a=o.parseFromString(t.trim(),"text/xml");e.parseSVGDocument(a.documentElement,(function(t,e,r,i){n(t,e,r,i)}),r,i)}})}(e),r.ElementsParser=function(t,e,n,r,i,o){this.elements=t,this.callback=e,this.options=n,this.reviver=r,this.svgUid=n&&n.svgUid||0,this.parsingOptions=i,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=o},function(t){t.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},t.createObjects=function(){var t=this;this.elements.forEach((function(e,n){e.setAttribute("svgUid",t.svgUid),t.createObject(e,n)}))},t.findTag=function(t){return r[r.util.string.capitalize(t.tagName.replace("svg:",""))]},t.createObject=function(t,e){var n=this.findTag(t);if(n&&n.fromElement)try{n.fromElement(t,this.createCallback(e,t),this.options)}catch(i){r.log(i)}else this.checkIfDone()},t.createCallback=function(t,e){var n=this;return function(i){var o;n.resolveGradient(i,e,"fill"),n.resolveGradient(i,e,"stroke"),i instanceof r.Image&&i._originalElement&&(o=i.parsePreserveAspectRatioAttribute(e)),i._removeTransformMatrix(o),n.resolveClipPath(i,e),n.reviver&&n.reviver(e,i),n.instances[t]=i,n.checkIfDone()}},t.extractPropertyDefinition=function(t,e,n){var i=t[e],o=this.regexUrl;if(o.test(i)){o.lastIndex=0;var a=o.exec(i)[1];return o.lastIndex=0,r[n][this.svgUid][a]}},t.resolveGradient=function(t,e,n){var i=this.extractPropertyDefinition(t,n,"gradientDefs");if(i){var o=e.getAttribute(n+"-opacity"),a=r.Gradient.fromElement(i,t,o,this.options);t.set(n,a)}},t.createClipPathCallback=function(t,e){return function(t){t._removeTransformMatrix(),t.fillRule=t.clipRule,e.push(t)}},t.resolveClipPath=function(t,e){var n,i,o,a,s,c=this.extractPropertyDefinition(t,"clipPath","clipPaths");if(c){a=[],o=r.util.invertTransform(t.calcTransformMatrix());var l=c[0].parentNode,u=e;while(u.parentNode&&u.getAttribute("clip-path")!==t.clipPath)u=u.parentNode;u.parentNode.appendChild(l);for(var h=0;h<c.length;h++)n=c[h],i=this.findTag(n),i.fromElement(n,this.createClipPathCallback(t,a),this.options);c=1===a.length?a[0]:new r.Group(a),s=r.util.multiplyTransformMatrices(o,c.calcTransformMatrix()),c.clipPath&&this.resolveClipPath(c,u);var d=r.util.qrDecompose(s);c.flipX=!1,c.flipY=!1,c.set("scaleX",d.scaleX),c.set("scaleY",d.scaleY),c.angle=d.angle,c.skewX=d.skewX,c.skewY=0,c.setPositionByOrigin({x:d.translateX,y:d.translateY},"center","center"),t.clipPath=c}else delete t.clipPath},t.checkIfDone=function(){0===--this.numElements&&(this.instances=this.instances.filter((function(t){return null!=t})),this.callback(this.instances,this.elements))}}(r.ElementsParser.prototype),function(t){"use strict";var e=t.fabric||(t.fabric={});function n(t,e){this.x=t,this.y=e}e.Point?e.warn("fabric.Point is already defined"):(e.Point=n,n.prototype={type:"point",constructor:n,add:function(t){return new n(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new n(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new n(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new n(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new n(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new n(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,e){return"undefined"===typeof e&&(e=.5),e=Math.max(Math.min(1,e),0),new n(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)},distanceFrom:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},midPointFrom:function(t){return this.lerp(t)},min:function(t){return new n(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new n(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setFromPoint:function(t){return this.x=t.x,this.y=t.y,this},swap:function(t){var e=this.x,n=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=n},clone:function(){return new n(this.x,this.y)}})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});function n(t){this.status=t,this.points=[]}e.Intersection?e.warn("fabric.Intersection is already defined"):(e.Intersection=n,e.Intersection.prototype={constructor:n,appendPoint:function(t){return this.points.push(t),this},appendPoints:function(t){return this.points=this.points.concat(t),this}},e.Intersection.intersectLineLine=function(t,r,i,o){var a,s=(o.x-i.x)*(t.y-i.y)-(o.y-i.y)*(t.x-i.x),c=(r.x-t.x)*(t.y-i.y)-(r.y-t.y)*(t.x-i.x),l=(o.y-i.y)*(r.x-t.x)-(o.x-i.x)*(r.y-t.y);if(0!==l){var u=s/l,h=c/l;0<=u&&u<=1&&0<=h&&h<=1?(a=new n("Intersection"),a.appendPoint(new e.Point(t.x+u*(r.x-t.x),t.y+u*(r.y-t.y)))):a=new n}else a=new n(0===s||0===c?"Coincident":"Parallel");return a},e.Intersection.intersectLinePolygon=function(t,e,r){var i,o,a,s,c=new n,l=r.length;for(s=0;s<l;s++)i=r[s],o=r[(s+1)%l],a=n.intersectLineLine(t,e,i,o),c.appendPoints(a.points);return c.points.length>0&&(c.status="Intersection"),c},e.Intersection.intersectPolygonPolygon=function(t,e){var r,i=new n,o=t.length;for(r=0;r<o;r++){var a=t[r],s=t[(r+1)%o],c=n.intersectLinePolygon(a,s,e);i.appendPoints(c.points)}return i.points.length>0&&(i.status="Intersection"),i},e.Intersection.intersectPolygonRectangle=function(t,r,i){var o=r.min(i),a=r.max(i),s=new e.Point(a.x,o.y),c=new e.Point(o.x,a.y),l=n.intersectLinePolygon(o,s,t),u=n.intersectLinePolygon(s,a,t),h=n.intersectLinePolygon(a,c,t),d=n.intersectLinePolygon(c,o,t),f=new n;return f.appendPoints(l.points),f.appendPoints(u.points),f.appendPoints(h.points),f.appendPoints(d.points),f.points.length>0&&(f.status="Intersection"),f})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});function n(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function r(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}e.Color?e.warn("fabric.Color is already defined."):(e.Color=n,e.Color.prototype={_tryParsingColor:function(t){var e;t in n.colorNameMap&&(t=n.colorNameMap[t]),"transparent"===t&&(e=[255,255,255,0]),e||(e=n.sourceFromHex(t)),e||(e=n.sourceFromRgb(t)),e||(e=n.sourceFromHsl(t)),e||(e=[0,0,0,1]),e&&this.setSource(e)},_rgbToHsl:function(t,n,r){t/=255,n/=255,r/=255;var i,o,a,s=e.util.array.max([t,n,r]),c=e.util.array.min([t,n,r]);if(a=(s+c)/2,s===c)i=o=0;else{var l=s-c;switch(o=a>.5?l/(2-s-c):l/(s+c),s){case t:i=(n-r)/l+(n<r?6:0);break;case n:i=(r-t)/l+2;break;case r:i=(t-n)/l+4;break}i/=6}return[Math.round(360*i),Math.round(100*o),Math.round(100*a)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,n,r=this.getSource();return t=r[0].toString(16),t=1===t.length?"0"+t:t,e=r[1].toString(16),e=1===e.length?"0"+e:e,n=r[2].toString(16),n=1===n.length?"0"+n:n,t.toUpperCase()+e.toUpperCase()+n.toUpperCase()},toHexa:function(){var t,e=this.getSource();return t=Math.round(255*e[3]),t=t.toString(16),t=1===t.length?"0"+t:t,this.toHex()+t.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),n=t[3];return this.setSource([e,e,e,n]),this},toBlackWhite:function(t){var e=this.getSource(),n=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),r=e[3];return t=t||127,n=Number(n)<Number(t)?0:255,this.setSource([n,n,n,r]),this},overlayWith:function(t){t instanceof n||(t=new n(t));var e,r=[],i=this.getAlpha(),o=.5,a=this.getSource(),s=t.getSource();for(e=0;e<3;e++)r.push(Math.round(a[e]*(1-o)+s[e]*o));return r[3]=i,this.setSource(r),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},e.Color.fromRgb=function(t){return n.fromSource(n.sourceFromRgb(t))},e.Color.sourceFromRgb=function(t){var e=t.match(n.reRGBa);if(e){var r=parseInt(e[1],10)/(/%$/.test(e[1])?100:1)*(/%$/.test(e[1])?255:1),i=parseInt(e[2],10)/(/%$/.test(e[2])?100:1)*(/%$/.test(e[2])?255:1),o=parseInt(e[3],10)/(/%$/.test(e[3])?100:1)*(/%$/.test(e[3])?255:1);return[parseInt(r,10),parseInt(i,10),parseInt(o,10),e[4]?parseFloat(e[4]):1]}},e.Color.fromRgba=n.fromRgb,e.Color.fromHsl=function(t){return n.fromSource(n.sourceFromHsl(t))},e.Color.sourceFromHsl=function(t){var e=t.match(n.reHSLa);if(e){var i,o,a,s=(parseFloat(e[1])%360+360)%360/360,c=parseFloat(e[2])/(/%$/.test(e[2])?100:1),l=parseFloat(e[3])/(/%$/.test(e[3])?100:1);if(0===c)i=o=a=l;else{var u=l<=.5?l*(c+1):l+c-l*c,h=2*l-u;i=r(h,u,s+1/3),o=r(h,u,s),a=r(h,u,s-1/3)}return[Math.round(255*i),Math.round(255*o),Math.round(255*a),e[4]?parseFloat(e[4]):1]}},e.Color.fromHsla=n.fromHsl,e.Color.fromHex=function(t){return n.fromSource(n.sourceFromHex(t))},e.Color.sourceFromHex=function(t){if(t.match(n.reHex)){var e=t.slice(t.indexOf("#")+1),r=3===e.length||4===e.length,i=8===e.length||4===e.length,o=r?e.charAt(0)+e.charAt(0):e.substring(0,2),a=r?e.charAt(1)+e.charAt(1):e.substring(2,4),s=r?e.charAt(2)+e.charAt(2):e.substring(4,6),c=i?r?e.charAt(3)+e.charAt(3):e.substring(6,8):"FF";return[parseInt(o,16),parseInt(a,16),parseInt(s,16),parseFloat((parseInt(c,16)/255).toFixed(2))]}},e.Color.fromSource=function(t){var e=new n;return e.setSource(t),e})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=["e","se","s","sw","w","nw","n","ne","e"],r=["ns","nesw","ew","nwse"],i={},o="left",a="top",s="right",c="bottom",l="center",u={top:c,bottom:a,left:s,right:o,center:l},h=e.util.radiansToDegrees,d=Math.sign||function(t){return(t>0)-(t<0)||+t};function f(t,e){var n=t.angle+h(Math.atan2(e.y,e.x))+360;return Math.round(n%360/45)}function p(t,n){var r=n.transform.target,i=r.canvas,o=e.util.object.clone(n);o.target=r,i&&i.fire("object:"+t,o),r.fire(t,n)}function g(t,e){var n=e.canvas,r=n.uniScaleKey,i=t[r];return n.uniformScaling&&!i||!n.uniformScaling&&i}function v(t){return t.originX===l&&t.originY===l}function m(t,e,n){var r=t.lockScalingX,i=t.lockScalingY;return!(!r||!i)||(!(e||!r&&!i||!n)||(!(!r||"x"!==e)||!(!i||"y"!==e)))}function b(t,e,r){var i="not-allowed",o=g(t,r),a="";if(0!==e.x&&0===e.y?a="x":0===e.x&&0!==e.y&&(a="y"),m(r,a,o))return i;var s=f(r,e);return n[s]+"-resize"}function y(t,e,n){var i="not-allowed";if(0!==e.x&&n.lockSkewingY)return i;if(0!==e.y&&n.lockSkewingX)return i;var o=f(n,e)%4;return r[o]+"-resize"}function S(t,e,n){return t[n.canvas.altActionKey]?i.skewCursorStyleHandler(t,e,n):i.scaleCursorStyleHandler(t,e,n)}function w(t,e,n){var r=t[n.canvas.altActionKey];return 0===e.x?r?"skewX":"scaleY":0===e.y?r?"skewY":"scaleX":void 0}function E(t,e,n){return n.lockRotation?"not-allowed":e.cursorStyle}function C(t,e,n,r){return{e:t,transform:e,pointer:{x:n,y:r}}}function x(t){return function(e,n,r,i){var o=n.target,a=o.getCenterPoint(),s=o.translateToOriginPoint(a,n.originX,n.originY),c=t(e,n,r,i);return o.setPositionByOrigin(s,n.originX,n.originY),c}}function O(t,e){return function(n,r,i,o){var a=e(n,r,i,o);return a&&p(t,C(n,r,i,o)),a}}function _(t,n,r,i,o){var a=t.target,s=a.controls[t.corner],c=a.canvas.getZoom(),l=a.padding/c,u=a.toLocalPoint(new e.Point(i,o),n,r);return u.x>=l&&(u.x-=l),u.x<=-l&&(u.x+=l),u.y>=l&&(u.y-=l),u.y<=l&&(u.y+=l),u.x-=s.offsetX,u.y-=s.offsetY,u}function T(t){return t.flipX!==t.flipY}function k(t,e,n,r,i){if(0!==t[e]){var o=t._getTransformedDimensions()[r],a=i/o*t[n];t.set(n,a)}}function I(t,e,n,r){var i,l=e.target,u=l._getTransformedDimensions(0,l.skewY),d=_(e,e.originX,e.originY,n,r),f=Math.abs(2*d.x)-u.x,p=l.skewX;f<2?i=0:(i=h(Math.atan2(f/l.scaleX,u.y/l.scaleY)),e.originX===o&&e.originY===c&&(i=-i),e.originX===s&&e.originY===a&&(i=-i),T(l)&&(i=-i));var g=p!==i;if(g){var v=l._getTransformedDimensions().y;l.set("skewX",i),k(l,"skewY","scaleY","y",v)}return g}function P(t,e,n,r){var i,l=e.target,u=l._getTransformedDimensions(l.skewX,0),d=_(e,e.originX,e.originY,n,r),f=Math.abs(2*d.y)-u.y,p=l.skewY;f<2?i=0:(i=h(Math.atan2(f/l.scaleY,u.x/l.scaleX)),e.originX===o&&e.originY===c&&(i=-i),e.originX===s&&e.originY===a&&(i=-i),T(l)&&(i=-i));var g=p!==i;if(g){var v=l._getTransformedDimensions().x;l.set("skewY",i),k(l,"skewX","scaleX","x",v)}return g}function j(t,e,n,r){var i,c=e.target,u=c.skewX,h=e.originY;if(c.lockSkewingX)return!1;if(0===u){var d=_(e,l,l,n,r);i=d.x>0?o:s}else u>0&&(i=h===a?o:s),u<0&&(i=h===a?s:o),T(c)&&(i=i===o?s:o);e.originX=i;var f=O("skewing",x(I));return f(t,e,n,r)}function M(t,e,n,r){var i,s=e.target,u=s.skewY,h=e.originX;if(s.lockSkewingY)return!1;if(0===u){var d=_(e,l,l,n,r);i=d.y>0?a:c}else u>0&&(i=h===o?a:c),u<0&&(i=h===o?c:a),T(s)&&(i=i===a?c:a);e.originY=i;var f=O("skewing",x(P));return f(t,e,n,r)}function D(t,e,n,r){var i=e,o=i.target,a=o.translateToOriginPoint(o.getCenterPoint(),i.originX,i.originY);if(o.lockRotation)return!1;var s=Math.atan2(i.ey-a.y,i.ex-a.x),c=Math.atan2(r-a.y,n-a.x),l=h(c-s+i.theta),u=!0;if(o.snapAngle>0){var d=o.snapAngle,f=o.snapThreshold||d,p=Math.ceil(l/d)*d,g=Math.floor(l/d)*d;Math.abs(l-g)<f?l=g:Math.abs(l-p)<f&&(l=p)}return l<0&&(l=360+l),l%=360,u=o.angle!==l,o.angle=l,u}function R(t,e,n,r,i){i=i||{};var o,a,s,c,l,h,f=e.target,p=f.lockScalingX,b=f.lockScalingY,y=i.by,S=g(t,f),w=m(f,y,S),E=e.gestureScale;if(w)return!1;if(E)a=e.scaleX*E,s=e.scaleY*E;else{if(o=_(e,e.originX,e.originY,n,r),l="y"!==y?d(o.x):1,h="x"!==y?d(o.y):1,e.signX||(e.signX=l),e.signY||(e.signY=h),f.lockScalingFlip&&(e.signX!==l||e.signY!==h))return!1;if(c=f._getTransformedDimensions(),S&&!y){var C=Math.abs(o.x)+Math.abs(o.y),x=e.original,O=Math.abs(c.x*x.scaleX/f.scaleX)+Math.abs(c.y*x.scaleY/f.scaleY),T=C/O;a=x.scaleX*T,s=x.scaleY*T}else a=Math.abs(o.x*f.scaleX/c.x),s=Math.abs(o.y*f.scaleY/c.y);v(e)&&(a*=2,s*=2),e.signX!==l&&"y"!==y&&(e.originX=u[e.originX],a*=-1,e.signX=l),e.signY!==h&&"x"!==y&&(e.originY=u[e.originY],s*=-1,e.signY=h)}var k=f.scaleX,I=f.scaleY;return y?("x"===y&&f.set("scaleX",a),"y"===y&&f.set("scaleY",s)):(!p&&f.set("scaleX",a),!b&&f.set("scaleY",s)),k!==f.scaleX||I!==f.scaleY}function A(t,e,n,r){return R(t,e,n,r)}function N(t,e,n,r){return R(t,e,n,r,{by:"x"})}function L(t,e,n,r){return R(t,e,n,r,{by:"y"})}function B(t,e,n,r){return t[e.target.canvas.altActionKey]?i.skewHandlerX(t,e,n,r):i.scalingY(t,e,n,r)}function V(t,e,n,r){return t[e.target.canvas.altActionKey]?i.skewHandlerY(t,e,n,r):i.scalingX(t,e,n,r)}function F(t,e,n,r){var i=e.target,o=_(e,e.originX,e.originY,n,r),a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),s=v(e)?2:1,c=i.width,l=Math.abs(o.x*s/i.scaleX)-a;return i.set("width",Math.max(l,0)),c!==l}function U(t,e,n,r){var i=e.target,o=n-e.offsetX,a=r-e.offsetY,s=!i.get("lockMovementX")&&i.left!==o,c=!i.get("lockMovementY")&&i.top!==a;return s&&i.set("left",o),c&&i.set("top",a),(s||c)&&p("moving",C(t,e,n,r)),s||c}i.scaleCursorStyleHandler=b,i.skewCursorStyleHandler=y,i.scaleSkewCursorStyleHandler=S,i.rotationWithSnapping=O("rotating",x(D)),i.scalingEqually=O("scaling",x(A)),i.scalingX=O("scaling",x(N)),i.scalingY=O("scaling",x(L)),i.scalingYOrSkewingX=B,i.scalingXOrSkewingY=V,i.changeWidth=O("resizing",x(F)),i.skewHandlerX=j,i.skewHandlerY=M,i.dragHandler=U,i.scaleOrSkewActionName=w,i.rotationStyleHandler=E,i.fireEvent=p,i.wrapWithFixedAnchor=x,i.wrapWithFireEvent=O,i.getLocalPoint=_,e.controlsUtils=i}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.degreesToRadians,r=e.controlsUtils;function i(t,e,n,r,i){r=r||{};var o,a=this.sizeX||r.cornerSize||i.cornerSize,s=this.sizeY||r.cornerSize||i.cornerSize,c="undefined"!==typeof r.transparentCorners?r.transparentCorners:i.transparentCorners,l=c?"stroke":"fill",u=!c&&(r.cornerStrokeColor||i.cornerStrokeColor),h=e,d=n;t.save(),t.fillStyle=r.cornerColor||i.cornerColor,t.strokeStyle=r.cornerStrokeColor||i.cornerStrokeColor,a>s?(o=a,t.scale(1,s/a),d=n*a/s):s>a?(o=s,t.scale(a/s,1),h=e*s/a):o=a,t.lineWidth=1,t.beginPath(),t.arc(h,d,o/2,0,2*Math.PI,!1),t[l](),u&&t.stroke(),t.restore()}function o(t,e,r,i,o){i=i||{};var a=this.sizeX||i.cornerSize||o.cornerSize,s=this.sizeY||i.cornerSize||o.cornerSize,c="undefined"!==typeof i.transparentCorners?i.transparentCorners:o.transparentCorners,l=c?"stroke":"fill",u=!c&&(i.cornerStrokeColor||o.cornerStrokeColor),h=a/2,d=s/2;t.save(),t.fillStyle=i.cornerColor||o.cornerColor,t.strokeStyle=i.cornerStrokeColor||o.cornerStrokeColor,t.lineWidth=1,t.translate(e,r),t.rotate(n(o.angle)),t[l+"Rect"](-h,-d,a,s),u&&t.strokeRect(-h,-d,a,s),t.restore()}r.renderCircleControl=i,r.renderSquareControl=o}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});function n(t){for(var e in t)this[e]=t[e]}e.Control=n,e.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(t,e){return e.cursorStyle},getActionName:function(t,e){return e.actionName},getVisibility:function(t,e){var n=t._controlsVisibility;return n&&"undefined"!==typeof n[e]?n[e]:this.visible},setVisibility:function(t){this.visible=t},positionHandler:function(t,n){var r=e.util.transformPoint({x:this.x*t.x+this.offsetX,y:this.y*t.y+this.offsetY},n);return r},calcCornerCoords:function(t,n,r,i,o){var a,s,c,l,u=o?this.touchSizeX:this.sizeX,h=o?this.touchSizeY:this.sizeY;if(u&&h&&u!==h){var d=Math.atan2(h,u),f=Math.sqrt(u*u+h*h)/2,p=d-e.util.degreesToRadians(t),g=Math.PI/2-d-e.util.degreesToRadians(t);a=f*e.util.cos(p),s=f*e.util.sin(p),c=f*e.util.cos(g),l=f*e.util.sin(g)}else{var v=u&&h?u:n;f=.7071067812*v;p=e.util.degreesToRadians(45-t);a=c=f*e.util.cos(p),s=l=f*e.util.sin(p)}return{tl:{x:r-l,y:i-c},tr:{x:r+a,y:i-s},bl:{x:r-a,y:i+s},br:{x:r+l,y:i+c}}},render:function(t,n,r,i,o){switch(i=i||{},i.cornerStyle||o.cornerStyle){case"circle":e.controlsUtils.renderCircleControl.call(this,t,n,r,i,o);break;default:e.controlsUtils.renderSquareControl.call(this,t,n,r,i,o)}}}}(e),function(){function t(t,e){var n,i,o,a,s=t.getAttribute("style"),c=t.getAttribute("offset")||0;if(c=parseFloat(c)/(/%$/.test(c)?100:1),c=c<0?0:c>1?1:c,s){var l=s.split(/\s*;\s*/);for(""===l[l.length-1]&&l.pop(),a=l.length;a--;){var u=l[a].split(/\s*:\s*/),h=u[0].trim(),d=u[1].trim();"stop-color"===h?n=d:"stop-opacity"===h&&(o=d)}}return n||(n=t.getAttribute("stop-color")||"rgb(0,0,0)"),o||(o=t.getAttribute("stop-opacity")),n=new r.Color(n),i=n.getAlpha(),o=isNaN(parseFloat(o))?1:parseFloat(o),o*=i*e,{offset:c,color:n.toRgb(),opacity:o}}function e(t){return{x1:t.getAttribute("x1")||0,y1:t.getAttribute("y1")||0,x2:t.getAttribute("x2")||"100%",y2:t.getAttribute("y2")||0}}function n(t){return{x1:t.getAttribute("fx")||t.getAttribute("cx")||"50%",y1:t.getAttribute("fy")||t.getAttribute("cy")||"50%",r1:0,x2:t.getAttribute("cx")||"50%",y2:t.getAttribute("cy")||"50%",r2:t.getAttribute("r")||"50%"}}var i=r.util.object.clone;function o(t,e,n,r){var i,o;Object.keys(e).forEach((function(t){i=e[t],"Infinity"===i?o=1:"-Infinity"===i?o=0:(o=parseFloat(e[t],10),"string"===typeof i&&/^(\d+\.\d+)%|(\d+)%$/.test(i)&&(o*=.01,"pixels"===r&&("x1"!==t&&"x2"!==t&&"r2"!==t||(o*=n.viewBoxWidth||n.width),"y1"!==t&&"y2"!==t||(o*=n.viewBoxHeight||n.height)))),e[t]=o}))}r.Gradient=r.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(t){t||(t={}),t.coords||(t.coords={});var e,n=this;Object.keys(t).forEach((function(e){n[e]=t[e]})),this.id?this.id+="_"+r.Object.__uid++:this.id=r.Object.__uid++,e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.colorStops=t.colorStops.slice()},addColorStop:function(t){for(var e in t){var n=new r.Color(t[e]);this.colorStops.push({offset:parseFloat(e),color:n.toRgb(),opacity:n.getAlpha()})}return this},toObject:function(t){var e={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return r.util.populateWithProperties(this,e,t),e},toSVG:function(t,e){var n,o,a,s,c=i(this.coords,!0),l=(e=e||{},i(this.colorStops,!0)),u=c.r1>c.r2,h=this.gradientTransform?this.gradientTransform.concat():r.iMatrix.concat(),d=-this.offsetX,f=-this.offsetY,p=!!e.additionalTransform,g="pixels"===this.gradientUnits?"userSpaceOnUse":"objectBoundingBox";if(l.sort((function(t,e){return t.offset-e.offset})),"objectBoundingBox"===g?(d/=t.width,f/=t.height):(d+=t.width/2,f+=t.height/2),"path"===t.type&&"percentage"!==this.gradientUnits&&(d-=t.pathOffset.x,f-=t.pathOffset.y),h[4]-=d,h[5]-=f,s='id="SVGID_'+this.id+'" gradientUnits="'+g+'"',s+=' gradientTransform="'+(p?e.additionalTransform+" ":"")+r.util.matrixToSVG(h)+'" ',"linear"===this.type?a=["<linearGradient ",s,' x1="',c.x1,'" y1="',c.y1,'" x2="',c.x2,'" y2="',c.y2,'">\n']:"radial"===this.type&&(a=["<radialGradient ",s,' cx="',u?c.x1:c.x2,'" cy="',u?c.y1:c.y2,'" r="',u?c.r1:c.r2,'" fx="',u?c.x2:c.x1,'" fy="',u?c.y2:c.y1,'">\n']),"radial"===this.type){if(u)for(l=l.concat(),l.reverse(),n=0,o=l.length;n<o;n++)l[n].offset=1-l[n].offset;var v=Math.min(c.r1,c.r2);if(v>0){var m=Math.max(c.r1,c.r2),b=v/m;for(n=0,o=l.length;n<o;n++)l[n].offset+=b*(1-l[n].offset)}}for(n=0,o=l.length;n<o;n++){var y=l[n];a.push("<stop ",'offset="',100*y.offset+"%",'" style="stop-color:',y.color,"undefined"!==typeof y.opacity?";stop-opacity: "+y.opacity:";",'"/>\n')}return a.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),a.join("")},toLive:function(t){var e,n,i,o=r.util.object.clone(this.coords);if(this.type){for("linear"===this.type?e=t.createLinearGradient(o.x1,o.y1,o.x2,o.y2):"radial"===this.type&&(e=t.createRadialGradient(o.x1,o.y1,o.r1,o.x2,o.y2,o.r2)),n=0,i=this.colorStops.length;n<i;n++){var a=this.colorStops[n].color,s=this.colorStops[n].opacity,c=this.colorStops[n].offset;"undefined"!==typeof s&&(a=new r.Color(a).setAlpha(s).toRgba()),e.addColorStop(c,a)}return e}}}),r.util.object.extend(r.Gradient,{fromElement:function(i,a,s,c){var l=parseFloat(s)/(/%$/.test(s)?100:1);l=l<0?0:l>1?1:l,isNaN(l)&&(l=1);var u,h,d,f,p=i.getElementsByTagName("stop"),g="userSpaceOnUse"===i.getAttribute("gradientUnits")?"pixels":"percentage",v=i.getAttribute("gradientTransform")||"",m=[],b=0,y=0;for("linearGradient"===i.nodeName||"LINEARGRADIENT"===i.nodeName?(u="linear",h=e(i)):(u="radial",h=n(i)),d=p.length;d--;)m.push(t(p[d],l));f=r.parseTransformAttribute(v),o(a,h,c,g),"pixels"===g&&(b=-a.left,y=-a.top);var S=new r.Gradient({id:i.getAttribute("id"),type:u,coords:h,colorStops:m,gradientUnits:g,gradientTransform:f,offsetX:b,offsetY:y});return S}})}(),function(){"use strict";var t=r.util.toFixed;r.Pattern=r.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(t,e){if(t||(t={}),this.id=r.Object.__uid++,this.setOptions(t),!t.source||t.source&&"string"!==typeof t.source)e&&e(this);else{var n=this;this.source=r.util.createImage(),r.util.loadImage(t.source,(function(t,r){n.source=t,e&&e(n,r)}),null,this.crossOrigin)}},toObject:function(e){var n,i,o=r.Object.NUM_FRACTION_DIGITS;return"string"===typeof this.source.src?n=this.source.src:"object"===typeof this.source&&this.source.toDataURL&&(n=this.source.toDataURL()),i={type:"pattern",source:n,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:t(this.offsetX,o),offsetY:t(this.offsetY,o),patternTransform:this.patternTransform?this.patternTransform.concat():null},r.util.populateWithProperties(this,i,e),i},toSVG:function(t){var e="function"===typeof this.source?this.source():this.source,n=e.width/t.width,r=e.height/t.height,i=this.offsetX/t.width,o=this.offsetY/t.height,a="";return"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat||(r=1,o&&(r+=Math.abs(o))),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat||(n=1,i&&(n+=Math.abs(i))),e.src?a=e.src:e.toDataURL&&(a=e.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+i+'" y="'+o+'" width="'+n+'" height="'+r+'">\n<image x="0" y="0" width="'+e.width+'" height="'+e.height+'" xlink:href="'+a+'"></image>\n</pattern>\n'},setOptions:function(t){for(var e in t)this[e]=t[e]},toLive:function(t){var e=this.source;if(!e)return"";if("undefined"!==typeof e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}})}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.toFixed;e.Shadow?e.warn("fabric.Shadow is already defined."):(e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(t){for(var n in"string"===typeof t&&(t=this._parseShadow(t)),t)this[n]=t[n];this.id=e.Object.__uid++},_parseShadow:function(t){var n=t.trim(),r=e.Shadow.reOffsetsAndBlur.exec(n)||[],i=n.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:i.trim(),offsetX:parseFloat(r[1],10)||0,offsetY:parseFloat(r[2],10)||0,blur:parseFloat(r[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(t){var r=40,i=40,o=e.Object.NUM_FRACTION_DIGITS,a=e.util.rotateVector({x:this.offsetX,y:this.offsetY},e.util.degreesToRadians(-t.angle)),s=20,c=new e.Color(this.color);return t.width&&t.height&&(r=100*n((Math.abs(a.x)+this.blur)/t.width,o)+s,i=100*n((Math.abs(a.y)+this.blur)/t.height,o)+s),t.flipX&&(a.x*=-1),t.flipY&&(a.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+i+'%" height="'+(100+2*i)+'%" x="-'+r+'%" width="'+(100+2*r)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+n(this.blur?this.blur/2:0,o)+'"></feGaussianBlur>\n\t<feOffset dx="'+n(a.x,o)+'" dy="'+n(a.y,o)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+c.toRgb()+'" flood-opacity="'+c.getAlpha()+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var t={},n=e.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach((function(e){this[e]!==n[e]&&(t[e]=this[e])}),this),t}}),e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/)}(e),function(){"use strict";if(r.StaticCanvas)r.warn("fabric.StaticCanvas is already defined.");else{var t=r.util.object.extend,e=r.util.getElementOffset,n=r.util.removeFromArray,i=r.util.toFixed,o=r.util.transformPoint,a=r.util.invertTransform,s=r.util.getNodeCanvas,c=r.util.createCanvasElement,l=new Error("Could not initialize `canvas` element");r.StaticCanvas=r.util.createClass(r.CommonMethods,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:r.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(t,e){var n=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this.interactive||this._initRetinaScaling(),e.overlayImage&&this.setOverlayImage(e.overlayImage,n),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,n),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,n),e.overlayColor&&this.setOverlayColor(e.overlayColor,n),this.calcOffset()},_isRetinaScaling:function(){return r.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,r.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var t=r.devicePixelRatio;this.__initRetinaScaling(t,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(t,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(t,e,n){e.setAttribute("width",this.width*t),e.setAttribute("height",this.height*t),n.scale(t,t)},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,n){return this.__setBgOverlayImage("overlayImage",t,e,n)},setBackgroundImage:function(t,e,n){return this.__setBgOverlayImage("backgroundImage",t,e,n)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},__setBgOverlayImage:function(t,e,n,i){return"string"===typeof e?r.util.loadImage(e,(function(e,o){if(e){var a=new r.Image(e,i);this[t]=a,a.canvas=this}n&&n(e,o)}),this,i&&i.crossOrigin):(i&&e.setOptions(i),this[t]=e,e&&(e.canvas=this),n&&n(e,!1)),this},__setBgOverlayColor:function(t,e,n){return this[t]=e,this._initGradient(e,t),this._initPattern(e,t,n),this},_createCanvasElement:function(){var t=c();if(!t)throw l;if(t.style||(t.style={}),"undefined"===typeof t.getContext)throw l;return t},_initOptions:function(t){var e=this.lowerCanvasEl;this._setOptions(t),this.width=this.width||parseInt(e.width,10)||0,this.height=this.height||parseInt(e.height,10)||0,this.lowerCanvasEl.style&&(e.width=this.width,e.height=this.height,e.style.width=this.width+"px",e.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){t&&t.getContext?this.lowerCanvasEl=t:this.lowerCanvasEl=r.util.getById(t)||this._createCanvasElement(),r.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var n;for(var r in e=e||{},t)n=t[r],e.cssOnly||(this._setBackstoreDimension(r,t[r]),n+="px",this.hasLostContext=!0),e.backstoreOnly||this._setCssDimension(r,n);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),e.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(t){var e,n,r,i=this._activeObject,o=this.backgroundImage,a=this.overlayImage;for(this.viewportTransform=t,n=0,r=this._objects.length;n<r;n++)e=this._objects[n],e.group||e.setCoords(!0);return i&&i.setCoords(),o&&o.setCoords(!0),a&&a.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(t,e){var n=t,r=this.viewportTransform.slice(0);t=o(t,a(this.viewportTransform)),r[0]=e,r[3]=e;var i=o(t,r);return r[4]+=n.x-i.x,r[5]+=n.y-i.y,this.setViewportTransform(r)},setZoom:function(t){return this.zoomToPoint(new r.Point(0,0),t),this},absolutePan:function(t){var e=this.viewportTransform.slice(0);return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)},relativePan:function(t){return this.absolutePan(new r.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.fire("object:removed",{target:t}),t.fire("removed"),delete t.canvas},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var t=this.contextContainer;return this.renderCanvas(t,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=r.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var t={},e=this.width,n=this.height,i=a(this.viewportTransform);return t.tl=o({x:0,y:0},i),t.br=o({x:e,y:n},i),t.tr=new r.Point(t.br.x,t.tl.y),t.bl=new r.Point(t.tl.x,t.br.y),this.vptCoords=t,t},cancelRequestedRender:function(){this.isRendering&&(r.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(t,e){var n=this.viewportTransform,i=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(t),r.util.setImageSmoothing(t,this.imageSmoothingEnabled),this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(t,e),t.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),i&&(i.canvas=this,i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t)),this._renderOverlay(t),this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.fire("after:render",{ctx:t})},drawClipPathOnCanvas:function(t){var e=this.viewportTransform,n=this.clipPath;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.globalCompositeOperation="destination-in",n.transform(t),t.scale(1/n.zoomX,1/n.zoomY),t.drawImage(n._cacheCanvas,-n.cacheTranslationX,-n.cacheTranslationY),t.restore()},_renderObjects:function(t,e){var n,r;for(n=0,r=e.length;n<r;++n)e[n]&&e[n].render(t)},_renderBackgroundOrOverlay:function(t,e){var n=this[e+"Color"],r=this[e+"Image"],i=this.viewportTransform,o=this[e+"Vpt"];if(n||r){if(n){t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=n.toLive?n.toLive(t,this):n,o&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),t.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);var a=n.gradientTransform||n.patternTransform;a&&t.transform(a[0],a[1],a[2],a[3],a[4],a[5]),t.fill(),t.restore()}r&&(t.save(),o&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),r.render(t),t.restore())}},_renderBackground:function(t){this._renderBackgroundOrOverlay(t,"background")},_renderOverlay:function(t){this._renderBackgroundOrOverlay(t,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},centerObjectH:function(t){return this._centerObject(t,new r.Point(this.getCenter().left,t.getCenterPoint().y))},centerObjectV:function(t){return this._centerObject(t,new r.Point(t.getCenterPoint().x,this.getCenter().top))},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new r.Point(e.left,e.top))},viewportCenterObject:function(t){var e=this.getVpCenter();return this._centerObject(t,e)},viewportCenterObjectH:function(t){var e=this.getVpCenter();return this._centerObject(t,new r.Point(e.x,t.getCenterPoint().y)),this},viewportCenterObjectV:function(t){var e=this.getVpCenter();return this._centerObject(t,new r.Point(t.getCenterPoint().x,e.y))},getVpCenter:function(){var t=this.getCenter(),e=a(this.viewportTransform);return o({x:t.left,y:t.top},e)},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,n){var i=this.clipPath,o={version:r.version,objects:this._toObjects(e,n)};return i&&!i.excludeFromExport&&(o.clipPath=this._toObject(this.clipPath,e,n)),t(o,this.__serializeBgOverlay(e,n)),r.util.populateWithProperties(this,o,n),o},_toObjects:function(t,e){return this._objects.filter((function(t){return!t.excludeFromExport})).map((function(n){return this._toObject(n,t,e)}),this)},_toObject:function(t,e,n){var r;this.includeDefaultValues||(r=t.includeDefaultValues,t.includeDefaultValues=!1);var i=t[e](n);return this.includeDefaultValues||(t.includeDefaultValues=r),i},__serializeBgOverlay:function(t,e){var n={},r=this.backgroundImage,i=this.overlayImage,o=this.backgroundColor,a=this.overlayColor;return o&&o.toObject?o.excludeFromExport||(n.background=o.toObject(e)):o&&(n.background=o),a&&a.toObject?a.excludeFromExport||(n.overlay=a.toObject(e)):a&&(n.overlay=a),r&&!r.excludeFromExport&&(n.backgroundImage=this._toObject(r,t,e)),i&&!i.excludeFromExport&&(n.overlayImage=this._toObject(i,t,e)),n},svgViewportTransformation:!0,toSVG:function(t,e){t||(t={}),t.reviver=e;var n=[];return this._setSVGPreamble(n,t),this._setSVGHeader(n,t),this.clipPath&&n.push('<g clip-path="url(#'+this.clipPath.clipPathId+')" >\n'),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",e),this._setSVGObjects(n,e),this.clipPath&&n.push("</g>\n"),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",e),n.push("</svg>"),n.join("")},_setSVGPreamble:function(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(t,e){var n,o=e.width||this.width,a=e.height||this.height,s='viewBox="0 0 '+this.width+" "+this.height+'" ',c=r.Object.NUM_FRACTION_DIGITS;e.viewBox?s='viewBox="'+e.viewBox.x+" "+e.viewBox.y+" "+e.viewBox.width+" "+e.viewBox.height+'" ':this.svgViewportTransformation&&(n=this.viewportTransform,s='viewBox="'+i(-n[4]/n[0],c)+" "+i(-n[5]/n[3],c)+" "+i(this.width/n[0],c)+" "+i(this.height/n[3],c)+'" '),t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',o,'" ','height="',a,'" ',s,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",r.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(e),"</defs>\n")},createSVGClipPathMarkup:function(t){var e=this.clipPath;return e?(e.clipPathId="CLIPPATH_"+r.Object.__uid++,'<clipPath id="'+e.clipPathId+'" >\n'+this.clipPath.toClipPathSVG(t.reviver)+"</clipPath>\n"):""},createSVGRefElementsMarkup:function(){var t=this,e=["background","overlay"].map((function(e){var n=t[e+"Color"];if(n&&n.toLive){var i=t[e+"Vpt"],o=t.viewportTransform,a={width:t.width/(i?o[0]:1),height:t.height/(i?o[3]:1)};return n.toSVG(a,{additionalTransform:i?r.util.matrixToSVG(o):""})}}));return e.join("")},createSVGFontFacesMarkup:function(){var t,e,n,i,o,a,s,c,l,u="",h={},d=r.fontPaths,f=[];for(this._objects.forEach((function t(e){f.push(e),e._objects&&e._objects.forEach(t)})),c=0,l=f.length;c<l;c++)if(t=f[c],e=t.fontFamily,-1!==t.type.indexOf("text")&&!h[e]&&d[e]&&(h[e]=!0,t.styles))for(o in n=t.styles,n)for(s in i=n[o],i)a=i[s],e=a.fontFamily,!h[e]&&d[e]&&(h[e]=!0);for(var p in h)u+=["\t\t@font-face {\n","\t\t\tfont-family: '",p,"';\n","\t\t\tsrc: url('",d[p],"');\n","\t\t}\n"].join("");return u&&(u=['\t<style type="text/css">',"<![CDATA[\n",u,"]]>","</style>\n"].join("")),u},_setSVGObjects:function(t,e){var n,r,i,o=this._objects;for(r=0,i=o.length;r<i;r++)n=o[r],n.excludeFromExport||this._setSVGObject(t,n,e)},_setSVGObject:function(t,e,n){t.push(e.toSVG(n))},_setSVGBgOverlayImage:function(t,e,n){this[e]&&!this[e].excludeFromExport&&this[e].toSVG&&t.push(this[e].toSVG(n))},_setSVGBgOverlayColor:function(t,e){var n=this[e+"Color"],i=this.viewportTransform,o=this.width,a=this.height;if(n)if(n.toLive){var s=n.repeat,c=r.util.invertTransform(i),l=this[e+"Vpt"],u=l?r.util.matrixToSVG(c):"";t.push('<rect transform="'+u+" translate(",o/2,",",a/2,')"',' x="',n.offsetX-o/2,'" y="',n.offsetY-a/2,'" ','width="',"repeat-y"===s||"no-repeat"===s?n.source.width:o,'" height="',"repeat-x"===s||"no-repeat"===s?n.source.height:a,'" fill="url(#SVGID_'+n.id+')"',"></rect>\n")}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',"></rect>\n")},sendToBack:function(t){if(!t)return this;var e,r,i,o=this._activeObject;if(t===o&&"activeSelection"===t.type)for(i=o._objects,e=i.length;e--;)r=i[e],n(this._objects,r),this._objects.unshift(r);else n(this._objects,t),this._objects.unshift(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(t){if(!t)return this;var e,r,i,o=this._activeObject;if(t===o&&"activeSelection"===t.type)for(i=o._objects,e=0;e<i.length;e++)r=i[e],n(this._objects,r),this._objects.push(r);else n(this._objects,t),this._objects.push(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(t,e){if(!t)return this;var r,i,o,a,s,c=this._activeObject,l=0;if(t===c&&"activeSelection"===t.type)for(s=c._objects,r=0;r<s.length;r++)i=s[r],o=this._objects.indexOf(i),o>0+l&&(a=o-1,n(this._objects,i),this._objects.splice(a,0,i)),l++;else o=this._objects.indexOf(t),0!==o&&(a=this._findNewLowerIndex(t,o,e),n(this._objects,t),this._objects.splice(a,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(t,e,n){var r,i;if(n)for(r=e,i=e-1;i>=0;--i){var o=t.intersectsWithObject(this._objects[i])||t.isContainedWithinObject(this._objects[i])||this._objects[i].isContainedWithinObject(t);if(o){r=i;break}}else r=e-1;return r},bringForward:function(t,e){if(!t)return this;var r,i,o,a,s,c=this._activeObject,l=0;if(t===c&&"activeSelection"===t.type)for(s=c._objects,r=s.length;r--;)i=s[r],o=this._objects.indexOf(i),o<this._objects.length-1-l&&(a=o+1,n(this._objects,i),this._objects.splice(a,0,i)),l++;else o=this._objects.indexOf(t),o!==this._objects.length-1&&(a=this._findNewUpperIndex(t,o,e),n(this._objects,t),this._objects.splice(a,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(t,e,n){var r,i,o;if(n)for(r=e,i=e+1,o=this._objects.length;i<o;++i){var a=t.intersectsWithObject(this._objects[i])||t.isContainedWithinObject(this._objects[i])||this._objects[i].isContainedWithinObject(t);if(a){r=i;break}}else r=e+1;return r},moveTo:function(t,e){return n(this._objects,t),this._objects.splice(e,0,t),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(r.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject((function(t){t.dispose&&t.dispose(),r.runningAnimations&&r.runningAnimations.cancelByTarget(t)})),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),r.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),r.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),t(r.StaticCanvas.prototype,r.Observable),t(r.StaticCanvas.prototype,r.Collection),t(r.StaticCanvas.prototype,r.DataURLExporter),t(r.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=c();if(!e||!e.getContext)return null;var n=e.getContext("2d");if(!n)return null;switch(t){case"setLineDash":return"undefined"!==typeof n.setLineDash;default:return null}}}),r.StaticCanvas.prototype.toJSON=r.StaticCanvas.prototype.toObject,r.isLikelyNode&&(r.StaticCanvas.prototype.createPNGStream=function(){var t=s(this.lowerCanvasEl);return t&&t.createPNGStream()},r.StaticCanvas.prototype.createJPEGStream=function(t){var e=s(this.lowerCanvasEl);return e&&e.createJPEGStream(t)})}}(),r.BaseBrush=r.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(t){t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,t.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(t){var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},_setShadow:function(){if(this.shadow){var t=this.canvas,e=this.shadow,n=t.contextTop,i=t.getZoom();t&&t._isRetinaScaling()&&(i*=r.devicePixelRatio),n.shadowColor=e.color,n.shadowBlur=e.blur*i,n.shadowOffsetX=e.offsetX*i,n.shadowOffsetY=e.offsetY*i}},needsFullRender:function(){var t=new r.Color(this.color);return t.getAlpha()<1||!!this.shadow},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0},_isOutSideCanvas:function(t){return t.x<0||t.x>this.canvas.getWidth()||t.y<0||t.y>this.canvas.getHeight()}}),function(){r.PencilBrush=r.util.createClass(r.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(t){this.canvas=t,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(t,e,n){var r=e.midPointFrom(n);return t.quadraticCurveTo(e.x,e.y,r.x,r.y),r},onMouseDown:function(t,e){this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],this._prepareForDrawing(t),this._captureDrawingPath(t),this._render())},onMouseMove:function(t,e){if(this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],(!0!==this.limitedToCanvasSize||!this._isOutSideCanvas(t))&&this._captureDrawingPath(t)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var n=this._points,r=n.length,i=this.canvas.contextTop;this._saveAndTransform(i),this.oldEnd&&(i.beginPath(),i.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(i,n[r-2],n[r-1],!0),i.stroke(),i.restore()}},onMouseUp:function(t){return!this.canvas._isMainEvent(t.e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(t){var e=new r.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){return!(this._points.length>1&&t.eq(this._points[this._points.length-1]))&&(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(t),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(t){var e=new r.Point(t.x,t.y);return this._addPoint(e)},_render:function(t){var e,n,i=this._points[0],o=this._points[1];if(t=t||this.canvas.contextTop,this._saveAndTransform(t),t.beginPath(),2===this._points.length&&i.x===o.x&&i.y===o.y){var a=this.width/1e3;i=new r.Point(i.x,i.y),o=new r.Point(o.x,o.y),i.x-=a,o.x+=a}for(t.moveTo(i.x,i.y),e=1,n=this._points.length;e<n;e++)this._drawSegment(t,i,o),i=this._points[e],o=this._points[e+1];t.lineTo(i.x,i.y),t.stroke(),t.restore()},convertPointsToSVGPath:function(t){var e=this.width/1e3;return r.util.getSmoothPathFromPoints(t,e)},_isEmptySVGPath:function(t){var e=r.util.joinPath(t);return"M 0 0 Q 0 0 0 0 L 0 0"===e},createPath:function(t){var e=new r.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new r.Shadow(this.shadow)),e},decimatePoints:function(t,e){if(t.length<=2)return t;var n,r,i=this.canvas.getZoom(),o=Math.pow(e/i,2),a=t.length-1,s=t[0],c=[s];for(n=1;n<a-1;n++)r=Math.pow(s.x-t[n].x,2)+Math.pow(s.y-t[n].y,2),r>=o&&(s=t[n],c.push(s));return c.push(t[a]),c},_finalizeAndAddPath:function(){var t=this.canvas.contextTop;t.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var e=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(e))this.canvas.requestRenderAll();else{var n=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:n}),this.canvas.add(n),this.canvas.requestRenderAll(),n.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:n})}}})}(),r.CircleBrush=r.util.createClass(r.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),n=this.canvas.contextTop;this._saveAndTransform(n),this.dot(n,e),n.restore()},dot:function(t,e){t.fillStyle=e.fill,t.beginPath(),t.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),t.closePath(),t.fill()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},_render:function(){var t,e,n=this.canvas.contextTop,r=this.points;for(this._saveAndTransform(n),t=0,e=r.length;t<e;t++)this.dot(n,r[t]);n.restore()},onMouseMove:function(t){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(t)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(t),this._render()):this.drawDot(t))},onMouseUp:function(){var t,e,n=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var i=[];for(t=0,e=this.points.length;t<e;t++){var o=this.points[t],a=new r.Circle({radius:o.radius,left:o.x,top:o.y,originX:"center",originY:"center",fill:o.fill});this.shadow&&(a.shadow=new r.Shadow(this.shadow)),i.push(a)}var s=new r.Group(i);s.canvas=this.canvas,this.canvas.fire("before:path:created",{path:s}),this.canvas.add(s),this.canvas.fire("path:created",{path:s}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=n,this.canvas.requestRenderAll()},addPoint:function(t){var e=new r.Point(t.x,t.y),n=r.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,i=new r.Color(this.color).setAlpha(r.util.getRandomInt(0,100)/100).toRgba();return e.radius=n,e.fill=i,this.points.push(e),e}}),r.SprayBrush=r.util.createClass(r.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseMove:function(t){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(t)||(this.addSprayChunk(t),this.render(this.sprayChunkPoints))},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],n=0,i=this.sprayChunks.length;n<i;n++)for(var o=this.sprayChunks[n],a=0,s=o.length;a<s;a++){var c=new r.Rect({width:o[a].width,height:o[a].width,left:o[a].x+1,top:o[a].y+1,originX:"center",originY:"center",fill:this.color});e.push(c)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var l=new r.Group(e);this.shadow&&l.set("shadow",new r.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:l}),this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},_getOptimizedRects:function(t){var e,n,r,i={};for(n=0,r=t.length;n<r;n++)e=t[n].left+""+t[n].top,i[e]||(i[e]=t[n]);var o=[];for(e in i)o.push(i[e]);return o},render:function(t){var e,n,r=this.canvas.contextTop;for(r.fillStyle=this.color,this._saveAndTransform(r),e=0,n=t.length;e<n;e++){var i=t[e];"undefined"!==typeof i.opacity&&(r.globalAlpha=i.opacity),r.fillRect(i.x,i.y,i.width,i.width)}r.restore()},_render:function(){var t,e,n=this.canvas.contextTop;for(n.fillStyle=this.color,this._saveAndTransform(n),t=0,e=this.sprayChunks.length;t<e;t++)this.render(this.sprayChunks[t]);n.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];var e,n,i,o,a=this.width/2;for(o=0;o<this.density;o++){e=r.util.getRandomInt(t.x-a,t.x+a),n=r.util.getRandomInt(t.y-a,t.y+a),i=this.dotWidthVariance?r.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var s=new r.Point(e,n);s.width=i,this.randomOpacity&&(s.opacity=r.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(s)}this.sprayChunks.push(this.sprayChunkPoints)}}),r.PatternBrush=r.util.createClass(r.PencilBrush,{getPatternSrc:function(){var t=20,e=5,n=r.util.createCanvasElement(),i=n.getContext("2d");return n.width=n.height=t+e,i.fillStyle=this.color,i.beginPath(),i.arc(t/2,t/2,t/2,0,2*Math.PI,!1),i.closePath(),i.fill(),n},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(t){return t.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(t){this.callSuper("_setBrushStyles",t),t.strokeStyle=this.getPattern(t)},createPath:function(t){var e=this.callSuper("createPath",t),n=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new r.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-n.x,offsetY:-n.y}),e}}),function(){var t=r.util.getPointer,e=r.util.degreesToRadians,n=r.util.isTouchEvent;for(var i in r.Canvas=r.util.createClass(r.StaticCanvas,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=r.PencilBrush&&new r.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var t,e,n,r=this.getActiveObjects();if(r.length>0&&!this.preserveObjectStacking){e=[],n=[];for(var i=0,o=this._objects.length;i<o;i++)t=this._objects[i],-1===r.indexOf(t)?e.push(t):n.push(t);r.length>1&&(this._activeObject._objects=n),e.push.apply(e,n)}else e=this._objects;return e},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var t=this.contextContainer;return this.renderCanvas(t,this._chooseObjectsToRender()),this},renderTopLayer:function(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()},renderTop:function(){var t=this.contextTop;return this.clearContext(t),this.renderTopLayer(t),this.fire("after:render"),this},_normalizePointer:function(t,e){var n=t.calcTransformMatrix(),i=r.util.invertTransform(n),o=this.restorePointerVpt(e);return r.util.transformPoint(o,i)},isTargetTransparent:function(t,e,n){if(t.shouldCache()&&t._cacheCanvas&&t!==this._activeObject){var i=this._normalizePointer(t,{x:e,y:n}),o=Math.max(t.cacheTranslationX+i.x*t.zoomX,0),a=Math.max(t.cacheTranslationY+i.y*t.zoomY,0),s=r.util.isTransparent(t._cacheContext,Math.round(o),Math.round(a),this.targetFindTolerance);return s}var c=this.contextCache,l=t.selectionBackgroundColor,u=this.viewportTransform;t.selectionBackgroundColor="",this.clearContext(c),c.save(),c.transform(u[0],u[1],u[2],u[3],u[4],u[5]),t.render(c),c.restore(),t.selectionBackgroundColor=l;s=r.util.isTransparent(c,e,n,this.targetFindTolerance);return s},_isSelectionKeyPressed:function(t){var e=!1;return e="[object Array]"===Object.prototype.toString.call(this.selectionKey)?!!this.selectionKey.find((function(e){return!0===t[e]})):t[this.selectionKey],e},_shouldClearSelection:function(t,e){var n=this.getActiveObjects(),r=this._activeObject;return!e||e&&r&&n.length>1&&-1===n.indexOf(e)&&r!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&r&&r!==e},_shouldCenterTransform:function(t,e,n){var r;if(t)return"scale"===e||"scaleX"===e||"scaleY"===e||"resizing"===e?r=this.centeredScaling||t.centeredScaling:"rotate"===e&&(r=this.centeredRotation||t.centeredRotation),r?!n:n},_getOriginFromCorner:function(t,e){var n={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?n.x="right":"mr"!==e&&"tr"!==e&&"br"!==e||(n.x="left"),"tl"===e||"mt"===e||"tr"===e?n.y="bottom":"bl"!==e&&"mb"!==e&&"br"!==e||(n.y="top"),n},_getActionFromCorner:function(t,e,n,r){if(!e||!t)return"drag";var i=r.controls[e];return i.getActionName(n,i,r)},_setupCurrentTransform:function(t,n,i){if(n){var o=this.getPointer(t),a=n.__corner,s=n.controls[a],c=i&&a?s.getActionHandler(t,n,s):r.controlsUtils.dragHandler,l=this._getActionFromCorner(i,a,t,n),u=this._getOriginFromCorner(n,a),h=t[this.centeredKey],d={target:n,action:l,actionHandler:c,corner:a,scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,offsetX:o.x-n.left,offsetY:o.y-n.top,originX:u.x,originY:u.y,ex:o.x,ey:o.y,lastX:o.x,lastY:o.y,theta:e(n.angle),width:n.width*n.scaleX,shiftKey:t.shiftKey,altKey:h,original:r.util.saveObjectTransform(n)};this._shouldCenterTransform(n,l,h)&&(d.originX="center",d.originY="center"),d.original.originX=u.x,d.original.originY=u.y,this._currentTransform=d,this._beforeTransform(t)}},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_drawSelection:function(t){var e=this._groupSelector,n=new r.Point(e.ex,e.ey),i=r.util.transformPoint(n,this.viewportTransform),o=new r.Point(e.ex+e.left,e.ey+e.top),a=r.util.transformPoint(o,this.viewportTransform),s=Math.min(i.x,a.x),c=Math.min(i.y,a.y),l=Math.max(i.x,a.x),u=Math.max(i.y,a.y),h=this.selectionLineWidth/2;this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(s,c,l-s,u-c)),this.selectionLineWidth&&this.selectionBorderColor&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,s+=h,c+=h,l-=h,u-=h,r.Object.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(s,c,l-s,u-c))},findTarget:function(t,e){if(!this.skipTargetFind){var r,i,o=!0,a=this.getPointer(t,o),s=this._activeObject,c=this.getActiveObjects(),l=n(t),u=c.length>1&&!e||1===c.length;if(this.targets=[],u&&s._findTargetCorner(a,l))return s;if(c.length>1&&!e&&s===this._searchPossibleTargets([s],a))return s;if(1===c.length&&s===this._searchPossibleTargets([s],a)){if(!this.preserveObjectStacking)return s;r=s,i=this.targets,this.targets=[]}var h=this._searchPossibleTargets(this._objects,a);return t[this.altSelectionKey]&&h&&r&&h!==r&&(h=r,this.targets=i),h}},_checkTarget:function(t,e,n){if(e&&e.visible&&e.evented&&e.containsPoint(t)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;var r=this.isTargetTransparent(e,n.x,n.y);if(!r)return!0}},_searchPossibleTargets:function(t,e){var n,i,o=t.length;while(o--){var a=t[o],s=a.group?this._normalizePointer(a.group,e):e;if(this._checkTarget(s,a,e)){n=t[o],n.subTargetCheck&&n instanceof r.Group&&(i=this._searchPossibleTargets(n._objects,e),i&&this.targets.push(i));break}}return n},restorePointerVpt:function(t){return r.util.transformPoint(t,r.util.invertTransform(this.viewportTransform))},getPointer:function(e,n){if(this._absolutePointer&&!n)return this._absolutePointer;if(this._pointer&&n)return this._pointer;var r,i=t(e),o=this.upperCanvasEl,a=o.getBoundingClientRect(),s=a.width||0,c=a.height||0;s&&c||("top"in a&&"bottom"in a&&(c=Math.abs(a.top-a.bottom)),"right"in a&&"left"in a&&(s=Math.abs(a.right-a.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,n||(i=this.restorePointerVpt(i));var l=this.getRetinaScaling();return 1!==l&&(i.x/=l,i.y/=l),r=0===s||0===c?{width:1,height:1}:{width:o.width/s,height:o.height/c},{x:i.x*r.width,y:i.y*r.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),e=this.lowerCanvasEl,n=this.upperCanvasEl;n?n.className="":(n=this._createCanvasElement(),this.upperCanvasEl=n),r.util.addClass(n,"upper-canvas "+t),this.wrapperEl.appendChild(n),this._copyCanvasStyle(e,n),this._applyCanvasStyle(n),this.contextTop=n.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=r.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),r.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),r.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.width||t.width,n=this.height||t.height;r.util.setStyle(t,{position:"absolute",width:e+"px",height:n+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),t.width=e,t.height=n,r.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var t=this._activeObject;return t?"activeSelection"===t.type&&t._objects?t._objects.slice(0):[t]:[]},_onObjectRemoved:function(t){t===this._activeObject&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared",{target:t}),t.fire("deselected")),t===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",t)},_fireSelectionEvents:function(t,e){var n=!1,r=this.getActiveObjects(),i=[],o=[];t.forEach((function(t){-1===r.indexOf(t)&&(n=!0,t.fire("deselected",{e:e,target:t}),o.push(t))})),r.forEach((function(r){-1===t.indexOf(r)&&(n=!0,r.fire("selected",{e:e,target:r}),i.push(r))})),t.length>0&&r.length>0?n&&this.fire("selection:updated",{e:e,selected:i,deselected:o}):r.length>0?this.fire("selection:created",{e:e,selected:i}):t.length>0&&this.fire("selection:cleared",{e:e,deselected:o})},setActiveObject:function(t,e){var n=this.getActiveObjects();return this._setActiveObject(t,e),this._fireSelectionEvents(n,e),this},_setActiveObject:function(t,e){return this._activeObject!==t&&(!!this._discardActiveObject(e,t)&&(!t.onSelect({e:e})&&(this._activeObject=t,!0)))},_discardActiveObject:function(t,e){var n=this._activeObject;if(n){if(n.onDeselect({e:t,object:e}))return!1;this._activeObject=null}return!0},discardActiveObject:function(t){var e=this.getActiveObjects(),n=this.getActiveObject();return e.length&&this.fire("before:selection:cleared",{target:n,e:t}),this._discardActiveObject(t),this._fireSelectionEvents(e,t),this},dispose:function(){var t=this.wrapperEl;return this.removeListeners(),t.removeChild(this.upperCanvasEl),t.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(t){r.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this)),t.parentNode&&t.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,r.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(t){var e=this._activeObject;e&&e._renderControls(t)},_toObject:function(t,e,n){var r=this._realizeGroupTransformOnObject(t),i=this.callSuper("_toObject",t,e,n);return this._unwindGroupTransformOnObject(t,r),i},_realizeGroupTransformOnObject:function(t){if(t.group&&"activeSelection"===t.group.type&&this._activeObject===t.group){var e=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],n={};return e.forEach((function(e){n[e]=t[e]})),r.util.addTransformToObject(t,this._activeObject.calcOwnMatrix()),n}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},_setSVGObject:function(t,e,n){var r=this._realizeGroupTransformOnObject(e);this.callSuper("_setSVGObject",t,e,n),this._unwindGroupTransformOnObject(e,r)},setViewportTransform:function(t){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),r.StaticCanvas.prototype.setViewportTransform.call(this,t)}}),r.StaticCanvas)"prototype"!==i&&(r.Canvas[i]=r.StaticCanvas[i])}(),function(){var t=r.util.addListener,e=r.util.removeListener,n=3,i=2,o=1,a={passive:!1};function s(t,e){return t.button&&t.button===e-1}r.util.object.extend(r.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(t,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(t,e){var n=this.upperCanvasEl,i=this._getEventPrefix();t(r.window,"resize",this._onResize),t(n,i+"down",this._onMouseDown),t(n,i+"move",this._onMouseMove,a),t(n,i+"out",this._onMouseOut),t(n,i+"enter",this._onMouseEnter),t(n,"wheel",this._onMouseWheel),t(n,"contextmenu",this._onContextMenu),t(n,"dblclick",this._onDoubleClick),t(n,"dragover",this._onDragOver),t(n,"dragenter",this._onDragEnter),t(n,"dragleave",this._onDragLeave),t(n,"drop",this._onDrop),this.enablePointerEvents||t(n,"touchstart",this._onTouchStart,a),"undefined"!==typeof eventjs&&e in eventjs&&(eventjs[e](n,"gesture",this._onGesture),eventjs[e](n,"drag",this._onDrag),eventjs[e](n,"orientation",this._onOrientationChange),eventjs[e](n,"shake",this._onShake),eventjs[e](n,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(e,"remove");var t=this._getEventPrefix();e(r.document,t+"up",this._onMouseUp),e(r.document,"touchend",this._onTouchEnd,a),e(r.document,t+"move",this._onMouseMove,a),e(r.document,"touchmove",this._onMouseMove,a)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t){this.__onMouseWheel(t)},_onMouseOut:function(t){var e=this._hoveredTarget;this.fire("mouse:out",{target:e,e:t}),this._hoveredTarget=null,e&&e.fire("mouseout",{e:t});var n=this;this._hoveredTargets.forEach((function(r){n.fire("mouse:out",{target:e,e:t}),r&&e.fire("mouseout",{e:t})})),this._hoveredTargets=[],this._iTextInstances&&this._iTextInstances.forEach((function(t){t.isEditing&&t.hiddenTextarea.focus()}))},_onMouseEnter:function(t){this._currentTransform||this.findTarget(t)||(this.fire("mouse:over",{target:null,e:t}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onDragOver:function(t){t.preventDefault();var e=this._simpleEventHandler("dragover",t);this._fireEnterLeaveEvents(e,t)},_onDrop:function(t){return this._simpleEventHandler("drop:before",t),this._simpleEventHandler("drop",t)},_onContextMenu:function(t){return this.stopContextMenu&&(t.stopPropagation(),t.preventDefault()),!1},_onDoubleClick:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"dblclick"),this._resetTransformEventData(t)},getPointerId:function(t){var e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1},_isMainEvent:function(t){return!0===t.isPrimary||!1!==t.isPrimary&&("touchend"===t.type&&0===t.touches.length||(!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId))},_onTouchStart:function(n){n.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(n)),this.__onMouseDown(n),this._resetTransformEventData();var i=this.upperCanvasEl,o=this._getEventPrefix();t(r.document,"touchend",this._onTouchEnd,a),t(r.document,"touchmove",this._onMouseMove,a),e(i,o+"down",this._onMouseDown)},_onMouseDown:function(n){this.__onMouseDown(n),this._resetTransformEventData();var i=this.upperCanvasEl,o=this._getEventPrefix();e(i,o+"move",this._onMouseMove,a),t(r.document,o+"up",this._onMouseUp),t(r.document,o+"move",this._onMouseMove,a)},_onTouchEnd:function(n){if(!(n.touches.length>0)){this.__onMouseUp(n),this._resetTransformEventData(),this.mainTouchId=null;var i=this._getEventPrefix();e(r.document,"touchend",this._onTouchEnd,a),e(r.document,"touchmove",this._onMouseMove,a);var o=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((function(){t(o.upperCanvasEl,i+"down",o._onMouseDown),o._willAddMouseDown=0}),400)}},_onMouseUp:function(n){this.__onMouseUp(n),this._resetTransformEventData();var i=this.upperCanvasEl,o=this._getEventPrefix();this._isMainEvent(n)&&(e(r.document,o+"up",this._onMouseUp),e(r.document,o+"move",this._onMouseMove,a),t(i,o+"move",this._onMouseMove,a))},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t){var e=this._activeObject;return!!(!!e!==!!t||e&&t&&e!==t)||(e&&e.isEditing,!1)},__onMouseUp:function(t){var e,a=this._currentTransform,c=this._groupSelector,l=!1,u=!c||0===c.left&&0===c.top;if(this._cacheTransformEventData(t),e=this._target,this._handleEvent(t,"up:before"),s(t,n))this.fireRightClick&&this._handleEvent(t,"up",n,u);else{if(s(t,i))return this.fireMiddleClick&&this._handleEvent(t,"up",i,u),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(t);else if(this._isMainEvent(t)){if(a&&(this._finalizeCurrentTransform(t),l=a.actionPerformed),!u){var h=e===this._activeObject;this._maybeGroupObjects(t),l||(l=this._shouldRender(e)||!h&&e===this._activeObject)}var d,f;if(e){if(d=e._findTargetCorner(this.getPointer(t,!0),r.util.isTouchEvent(t)),e.selectable&&e!==this._activeObject&&"up"===e.activeOn)this.setActiveObject(e,t),l=!0;else{var p=e.controls[d],g=p&&p.getMouseUpHandler(t,e,p);g&&(f=this.getPointer(t),g(t,a,f.x,f.y))}e.isMoving=!1}if(a&&(a.target!==e||a.corner!==d)){var v=a.target&&a.target.controls[a.corner],m=v&&v.getMouseUpHandler(t,e,p);f=f||this.getPointer(t),m&&m(t,a,f.x,f.y)}this._setCursorFromEvent(t,e),this._handleEvent(t,"up",o,u),this._groupSelector=null,this._currentTransform=null,e&&(e.__corner=0),l?this.requestRenderAll():u||this.renderTop()}}},_simpleEventHandler:function(t,e){var n=this.findTarget(e),r=this.targets,i={e:e,target:n,subTargets:r};if(this.fire(t,i),n&&n.fire(t,i),!r)return n;for(var o=0;o<r.length;o++)r[o].fire(t,i);return n},_handleEvent:function(t,e,n,r){var i=this._target,a=this.targets||[],s={e:t,target:i,subTargets:a,button:n||o,isClick:r||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};"up"===e&&(s.currentTarget=this.findTarget(t),s.currentSubTargets=this.targets),this.fire("mouse:"+e,s),i&&i.fire("mouse"+e,s);for(var c=0;c<a.length;c++)a[c].fire("mouse"+e,s)},_finalizeCurrentTransform:function(t){var e=this._currentTransform,n=e.target,r={e:t,target:n,transform:e,action:e.action};n._scaling&&(n._scaling=!1),n.setCoords(),(e.actionPerformed||this.stateful&&n.hasStateChanged())&&this._fire("modified",r)},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(t).requestRenderAll();var e=this.getPointer(t);this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down")},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=this.getPointer(t);this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")},_onMouseUpInDrawingMode:function(t){var e=this.getPointer(t);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:t,pointer:e}),this._handleEvent(t,"up")},__onMouseDown:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"down:before");var e=this._target;if(s(t,n))this.fireRightClick&&this._handleEvent(t,"down",n);else if(s(t,i))this.fireMiddleClick&&this._handleEvent(t,"down",i);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(t);else if(this._isMainEvent(t)&&!this._currentTransform){var o=this._pointer;this._previousPointer=o;var a=this._shouldRender(e),c=this._shouldGroup(t,e);if(this._shouldClearSelection(t,e)?this.discardActiveObject(t):c&&(this._handleGrouping(t,e),e=this._activeObject),!this.selection||e&&(e.selectable||e.isEditing||e===this._activeObject)||(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),e){var l=e===this._activeObject;e.selectable&&"down"===e.activeOn&&this.setActiveObject(e,t);var u=e._findTargetCorner(this.getPointer(t,!0),r.util.isTouchEvent(t));if(e.__corner=u,e===this._activeObject&&(u||!c)){this._setupCurrentTransform(t,e,l);var h=e.controls[u],d=(o=this.getPointer(t),h&&h.getMouseDownHandler(t,e,h));d&&d(t,this._currentTransform,o.x,o.y)}}this._handleEvent(t,"down"),(a||c)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(t){this._resetTransformEventData(),this._pointer=this.getPointer(t,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)||null},_beforeTransform:function(t){var e=this._currentTransform;this.stateful&&e.target.saveState(),this.fire("before:transform",{e:t,transform:e})},__onMouseMove:function(t){var e,n;if(this._handleEvent(t,"move:before"),this._cacheTransformEventData(t),this.isDrawingMode)this._onMouseMoveInDrawingMode(t);else if(this._isMainEvent(t)){var r=this._groupSelector;r?(n=this._absolutePointer,r.left=n.x-r.ex,r.top=n.y-r.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t)||null,this._setCursorFromEvent(t,e),this._fireOverOutEvents(e,t)),this._handleEvent(t,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(t,e){var n=this._hoveredTarget,r=this._hoveredTargets,i=this.targets,o=Math.max(r.length,i.length);this.fireSyntheticInOutEvents(t,e,{oldTarget:n,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var a=0;a<o;a++)this.fireSyntheticInOutEvents(i[a],e,{oldTarget:r[a],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(t,e){var n=this._draggedoverTarget,r=this._hoveredTargets,i=this.targets,o=Math.max(r.length,i.length);this.fireSyntheticInOutEvents(t,e,{oldTarget:n,evtOut:"dragleave",evtIn:"dragenter"});for(var a=0;a<o;a++)this.fireSyntheticInOutEvents(i[a],e,{oldTarget:r[a],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=t},fireSyntheticInOutEvents:function(t,e,n){var r,i,o,a,s=n.oldTarget,c=s!==t,l=n.canvasEvtIn,u=n.canvasEvtOut;c&&(r={e:e,target:t,previousTarget:s},i={e:e,target:s,nextTarget:t}),a=t&&c,o=s&&c,o&&(u&&this.fire(u,i),s.fire(n.evtOut,i)),a&&(l&&this.fire(l,r),t.fire(n.evtIn,r))},__onMouseWheel:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()},_transformObject:function(t){var e=this.getPointer(t),n=this._currentTransform;n.reset=!1,n.shiftKey=t.shiftKey,n.altKey=t[this.centeredKey],this._performTransformAction(t,n,e),n.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(t,e,n){var r=n.x,i=n.y,o=e.action,a=!1,s=e.actionHandler;s&&(a=s(t,e,r,i)),"drag"===o&&a&&(e.target.isMoving=!0,this.setCursor(e.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||a},_fire:r.controlsUtils.fireEvent,_setCursorFromEvent:function(t,e){if(!e)return this.setCursor(this.defaultCursor),!1;var n=e.hoverCursor||this.hoverCursor,r=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,i=(!r||!r.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));i?this.setCursor(this.getCornerCursor(i,e,t)):(e.subTargetCheck&&this.targets.concat().reverse().map((function(t){n=t.hoverCursor||n})),this.setCursor(n))},getCornerCursor:function(t,e,n){var r=e.controls[t];return r.cursorStyleHandler(n,r,e)}})}(),function(){var t=Math.min,e=Math.max;r.util.object.extend(r.Canvas.prototype,{_shouldGroup:function(t,e){var n=this._activeObject;return n&&this._isSelectionKeyPressed(t)&&e&&e.selectable&&this.selection&&(n!==e||"activeSelection"===n.type)&&!e.onSelect({e:t})},_handleGrouping:function(t,e){var n=this._activeObject;n.__corner||(e!==n||(e=this.findTarget(t,!0),e&&e.selectable))&&(n&&"activeSelection"===n.type?this._updateActiveSelection(e,t):this._createActiveSelection(e,t))},_updateActiveSelection:function(t,e){var n=this._activeObject,r=n._objects.slice(0);n.contains(t)?(n.removeWithUpdate(t),this._hoveredTarget=t,this._hoveredTargets=this.targets.concat(),1===n.size()&&this._setActiveObject(n.item(0),e)):(n.addWithUpdate(t),this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(r,e)},_createActiveSelection:function(t,e){var n=this.getActiveObjects(),r=this._createGroup(t);this._hoveredTarget=r,this._setActiveObject(r,e),this._fireSelectionEvents(n,e)},_createGroup:function(t){var e=this._objects,n=e.indexOf(this._activeObject)<e.indexOf(t),i=n?[this._activeObject,t]:[t,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new r.ActiveSelection(i,{canvas:this})},_groupSelectedObjects:function(t){var e,n=this._collectObjects(t);1===n.length?this.setActiveObject(n[0],t):n.length>1&&(e=new r.ActiveSelection(n.reverse(),{canvas:this}),this.setActiveObject(e,t))},_collectObjects:function(n){for(var i,o=[],a=this._groupSelector.ex,s=this._groupSelector.ey,c=a+this._groupSelector.left,l=s+this._groupSelector.top,u=new r.Point(t(a,c),t(s,l)),h=new r.Point(e(a,c),e(s,l)),d=!this.selectionFullyContained,f=a===c&&s===l,p=this._objects.length;p--;)if(i=this._objects[p],i&&i.selectable&&i.visible&&(d&&i.intersectsWithRect(u,h,!0)||i.isContainedWithinRect(u,h,!0)||d&&i.containsPoint(u,null,!0)||d&&i.containsPoint(h,null,!0))&&(o.push(i),f))break;return o.length>1&&(o=o.filter((function(t){return!t.onSelect({e:n})}))),o},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){r.util.object.extend(r.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",n=t.quality||1,i=(t.multiplier||1)*(t.enableRetinaScaling?this.getRetinaScaling():1),o=this.toCanvasElement(i,t);return r.util.toDataURL(o,e,n)},toCanvasElement:function(t,e){t=t||1,e=e||{};var n=(e.width||this.width)*t,i=(e.height||this.height)*t,o=this.getZoom(),a=this.width,s=this.height,c=o*t,l=this.viewportTransform,u=(l[4]-(e.left||0))*t,h=(l[5]-(e.top||0))*t,d=this.interactive,f=[c,0,0,c,u,h],p=this.enableRetinaScaling,g=r.util.createCanvasElement(),v=this.contextTop;return g.width=n,g.height=i,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=f,this.width=n,this.height=i,this.calcViewportBoundaries(),this.renderCanvas(g.getContext("2d"),this._objects),this.viewportTransform=l,this.width=a,this.height=s,this.calcViewportBoundaries(),this.interactive=d,this.enableRetinaScaling=p,this.contextTop=v,g}})}(),r.util.object.extend(r.StaticCanvas.prototype,{loadFromJSON:function(t,e,n){if(t){var i="string"===typeof t?JSON.parse(t):r.util.object.clone(t),o=this,a=i.clipPath,s=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete i.clipPath,this._enlivenObjects(i.objects,(function(t){o.clear(),o._setBgOverlay(i,(function(){a?o._enlivenObjects([a],(function(n){o.clipPath=n[0],o.__setupCanvas.call(o,i,t,s,e)})):o.__setupCanvas.call(o,i,t,s,e)}))}),n),this}},__setupCanvas:function(t,e,n,r){var i=this;e.forEach((function(t,e){i.insertAt(t,e)})),this.renderOnAddRemove=n,delete t.objects,delete t.backgroundImage,delete t.overlayImage,delete t.background,delete t.overlay,this._setOptions(t),this.renderAll(),r&&r()},_setBgOverlay:function(t,e){var n={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(t.backgroundImage||t.overlayImage||t.background||t.overlay){var r=function(){n.backgroundImage&&n.overlayImage&&n.backgroundColor&&n.overlayColor&&e&&e()};this.__setBgOverlay("backgroundImage",t.backgroundImage,n,r),this.__setBgOverlay("overlayImage",t.overlayImage,n,r),this.__setBgOverlay("backgroundColor",t.background,n,r),this.__setBgOverlay("overlayColor",t.overlay,n,r)}else e&&e()},__setBgOverlay:function(t,e,n,i){var o=this;if(!e)return n[t]=!0,void(i&&i());"backgroundImage"===t||"overlayImage"===t?r.util.enlivenObjects([e],(function(e){o[t]=e[0],n[t]=!0,i&&i()})):this["set"+r.util.string.capitalize(t,!0)](e,(function(){n[t]=!0,i&&i()}))},_enlivenObjects:function(t,e,n){t&&0!==t.length?r.util.enlivenObjects(t,(function(t){e&&e(t)}),null,n):e&&e([])},_toDataURL:function(t,e){this.clone((function(n){e(n.toDataURL(t))}))},_toDataURLWithMultiplier:function(t,e,n){this.clone((function(r){n(r.toDataURLWithMultiplier(t,e))}))},clone:function(t,e){var n=JSON.stringify(this.toJSON(e));this.cloneWithoutData((function(e){e.loadFromJSON(n,(function(){t&&t(e)}))}))},cloneWithoutData:function(t){var e=r.util.createCanvasElement();e.width=this.width,e.height=this.height;var n=new r.Canvas(e);this.backgroundImage?(n.setBackgroundImage(this.backgroundImage.src,(function(){n.renderAll(),t&&t(n)})),n.backgroundImageOpacity=this.backgroundImageOpacity,n.backgroundImageStretch=this.backgroundImageStretch):t&&t(n)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,r=e.util.object.clone,i=e.util.toFixed,o=e.util.string.capitalize,a=e.util.degreesToRadians,s=!e.isLikelyNode,c=2;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:s,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(t){t&&this.setOptions(t)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(t){var n=e.perfLimitSizeTotal,r=t.width,i=t.height,o=e.maxCacheSideLimit,a=e.minCacheSideLimit;if(r<=o&&i<=o&&r*i<=n)return r<a&&(t.width=a),i<a&&(t.height=a),t;var s=r/i,c=e.util.limitDimsByArea(s,n),l=e.util.capValue,u=l(a,c.x,o),h=l(a,c.y,o);return r>u&&(t.zoomX/=r/u,t.width=u,t.capped=!0),i>h&&(t.zoomY/=i/h,t.height=h,t.capped=!0),t},_getCacheCanvasDimensions:function(){var t=this.getTotalObjectScaling(),e=this._getTransformedDimensions(0,0),n=e.x*t.scaleX/this.scaleX,r=e.y*t.scaleY/this.scaleY;return{width:n+c,height:r+c,zoomX:t.scaleX,zoomY:t.scaleY,x:n,y:r}},_updateCacheCanvas:function(){var t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){var n=t._currentTransform.target,r=t._currentTransform.action;if(this===n&&r.slice&&"scale"===r.slice(0,5))return!1}var i,o,a=this._cacheCanvas,s=this._limitCacheSize(this._getCacheCanvasDimensions()),c=e.minCacheSideLimit,l=s.width,u=s.height,h=s.zoomX,d=s.zoomY,f=l!==this.cacheWidth||u!==this.cacheHeight,p=this.zoomX!==h||this.zoomY!==d,g=f||p,v=0,m=0,b=!1;if(f){var y=this._cacheCanvas.width,S=this._cacheCanvas.height,w=l>y||u>S,E=(l<.9*y||u<.9*S)&&y>c&&S>c;b=w||E,w&&!s.capped&&(l>c||u>c)&&(v=.1*l,m=.1*u)}return this instanceof e.Text&&this.path&&(g=!0,b=!0,v+=this.getHeightOfLine(0)*this.zoomX,m+=this.getHeightOfLine(0)*this.zoomY),!!g&&(b?(a.width=Math.ceil(l+v),a.height=Math.ceil(u+m)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,a.width,a.height)),i=s.x/2,o=s.y/2,this.cacheTranslationX=Math.round(a.width/2-i)+i,this.cacheTranslationY=Math.round(a.height/2-o)+o,this.cacheWidth=l,this.cacheHeight=u,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(h,d),this.zoomX=h,this.zoomY=d,!0)},setOptions:function(t){this._setOptions(t),this._initGradient(t.fill,"fill"),this._initGradient(t.stroke,"stroke"),this._initPattern(t.fill,"fill"),this._initPattern(t.stroke,"stroke")},transform:function(t){var e=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,n=this.calcTransformMatrix(!e);t.transform(n[0],n[1],n[2],n[3],n[4],n[5])},toObject:function(t){var n=e.Object.NUM_FRACTION_DIGITS,r={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:i(this.left,n),top:i(this.top,n),width:i(this.width,n),height:i(this.height,n),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:i(this.strokeWidth,n),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:i(this.strokeMiterLimit,n),scaleX:i(this.scaleX,n),scaleY:i(this.scaleY,n),angle:i(this.angle,n),flipX:this.flipX,flipY:this.flipY,opacity:i(this.opacity,n),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:i(this.skewX,n),skewY:i(this.skewY,n)};return this.clipPath&&!this.clipPath.excludeFromExport&&(r.clipPath=this.clipPath.toObject(t),r.clipPath.inverted=this.clipPath.inverted,r.clipPath.absolutePositioned=this.clipPath.absolutePositioned),e.util.populateWithProperties(this,r,t),this.includeDefaultValues||(r=this._removeDefaultValues(r)),r},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var n=e.util.getKlass(t.type).prototype,r=n.stateProperties;return r.forEach((function(e){if("left"!==e&&"top"!==e){t[e]===n[e]&&delete t[e];var r="[object Array]"===Object.prototype.toString.call(t[e])&&"[object Array]"===Object.prototype.toString.call(n[e]);r&&0===t[e].length&&0===n[e].length&&delete t[e]}})),t},toString:function(){return"#<fabric."+o(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var t=e.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(t.scaleX),scaleY:Math.abs(t.scaleY)}},getTotalObjectScaling:function(){var t=this.getObjectScaling(),e=t.scaleX,n=t.scaleY;if(this.canvas){var r=this.canvas.getZoom(),i=this.canvas.getRetinaScaling();e*=r*i,n*=r*i}return{scaleX:e,scaleY:n}},getObjectOpacity:function(){var t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t},_set:function(t,n){var r="scaleX"===t||"scaleY"===t,i=this[t]!==n,o=!1;return r&&(n=this._constrainScale(n)),"scaleX"===t&&n<0?(this.flipX=!this.flipX,n*=-1):"scaleY"===t&&n<0?(this.flipY=!this.flipY,n*=-1):"shadow"!==t||!n||n instanceof e.Shadow?"dirty"===t&&this.group&&this.group.set("dirty",n):n=new e.Shadow(n),this[t]=n,i&&(o=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(t)>-1?(this.dirty=!0,o&&this.group.set("dirty",!0)):o&&this.stateProperties.indexOf(t)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||!this.width&&!this.height&&0===this.strokeWidth||!this.visible},render:function(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(t),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),t.restore())},renderCache:function(t){t=t||{},this._cacheCanvas||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,t.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth},hasFill:function(){return this.fill&&"transparent"!==this.fill},needsItsOwnCache:function(){return!("stroke"!==this.paintFirst||!this.hasFill()||!this.hasStroke()||"object"!==typeof this.shadow)||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawClipPathOnCache:function(t,n){if(t.save(),n.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",n.absolutePositioned){var r=e.util.invertTransform(this.calcTransformMatrix());t.transform(r[0],r[1],r[2],r[3],r[4],r[5])}n.transform(t),t.scale(1/n.zoomX,1/n.zoomY),t.drawImage(n._cacheCanvas,-n.cacheTranslationX,-n.cacheTranslationY),t.restore()},drawObject:function(t,e){var n=this.fill,r=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this._render(t),this._drawClipPath(t,this.clipPath),this.fill=n,this.stroke=r},_drawClipPath:function(t,e){e&&(e.canvas=this.canvas,e.shouldCache(),e._transformDone=!0,e.renderCache({forClipping:!0}),this.drawClipPathOnCache(t,e))},drawCacheOnCanvas:function(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(t){if(this.isNotVisible())return!1;if(this._cacheCanvas&&!t&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&!t){var e=this.cacheWidth/this.zoomX,n=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-e/2,-n/2,e,n)}return!0}return!1},_renderBackground:function(t){if(this.backgroundColor){var e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}},_setOpacity:function(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity},_setStrokeStyles:function(t,e){var n=e.stroke;n&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,n.toLive?"percentage"===n.gradientUnits||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(t,n):(t.strokeStyle=n.toLive(t,this),this._applyPatternGradientTransform(t,n)):t.strokeStyle=e.stroke)},_setFillStyles:function(t,e){var n=e.fill;n&&(n.toLive?(t.fillStyle=n.toLive(t,this),this._applyPatternGradientTransform(t,e.fill)):t.fillStyle=n)},_setClippingProperties:function(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"},_setLineDash:function(t,e){e&&0!==e.length&&(1&e.length&&e.push.apply(e,e),t.setLineDash(e))},_renderControls:function(t,n){var r,i,o,s=this.getViewportTransform(),c=this.calcTransformMatrix();n=n||{},i="undefined"!==typeof n.hasBorders?n.hasBorders:this.hasBorders,o="undefined"!==typeof n.hasControls?n.hasControls:this.hasControls,c=e.util.multiplyTransformMatrices(s,c),r=e.util.qrDecompose(c),t.save(),t.translate(r.translateX,r.translateY),t.lineWidth=1*this.borderScaleFactor,this.group||(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(r.angle-=180),t.rotate(a(this.group?r.angle:this.angle)),n.forActiveSelection||this.group?i&&this.drawBordersInGroup(t,r,n):i&&this.drawBorders(t,n),o&&this.drawControls(t,n),t.restore()},_setShadow:function(t){if(this.shadow){var n,r=this.shadow,i=this.canvas,o=i&&i.viewportTransform[0]||1,a=i&&i.viewportTransform[3]||1;n=r.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),i&&i._isRetinaScaling()&&(o*=e.devicePixelRatio,a*=e.devicePixelRatio),t.shadowColor=r.color,t.shadowBlur=r.blur*e.browserShadowBlurConstant*(o+a)*(n.scaleX+n.scaleY)/4,t.shadowOffsetX=r.offsetX*o*n.scaleX,t.shadowOffsetY=r.offsetY*a*n.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_applyPatternGradientTransform:function(t,e){if(!e||!e.toLive)return{offsetX:0,offsetY:0};var n=e.gradientTransform||e.patternTransform,r=-this.width/2+e.offsetX||0,i=-this.height/2+e.offsetY||0;return"percentage"===e.gradientUnits?t.transform(this.width,0,0,this.height,r,i):t.transform(1,0,0,1,r,i),n&&t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:r,offsetY:i}},_renderPaintInOrder:function(t){"stroke"===this.paintFirst?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))},_render:function(){},_renderFill:function(t){this.fill&&(t.save(),this._setFillStyles(t,this),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore())},_renderStroke:function(t){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform&&this.group){var e=this.getObjectScaling();t.scale(1/e.scaleX,1/e.scaleY)}else this.strokeUniform&&t.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(t,this.strokeDashArray),this._setStrokeStyles(t,this),t.stroke(),t.restore()}},_applyPatternForTransformedGradient:function(t,n){var r,i=this._limitCacheSize(this._getCacheCanvasDimensions()),o=e.util.createCanvasElement(),a=this.canvas.getRetinaScaling(),s=i.x/this.scaleX/a,c=i.y/this.scaleY/a;o.width=s,o.height=c,r=o.getContext("2d"),r.beginPath(),r.moveTo(0,0),r.lineTo(s,0),r.lineTo(s,c),r.lineTo(0,c),r.closePath(),r.translate(s/2,c/2),r.scale(i.zoomX/this.scaleX/a,i.zoomY/this.scaleY/a),this._applyPatternGradientTransform(r,n),r.fillStyle=n.toLive(t),r.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(a*this.scaleX/i.zoomX,a*this.scaleY/i.zoomY),t.strokeStyle=r.createPattern(o,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var t=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",t.scaleX),this.set("scaleY",t.scaleY),this.angle=t.angle,this.skewX=t.skewX,this.skewY=0}},_removeTransformMatrix:function(t){var n=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),n=e.util.transformPoint(n,this.transformMatrix)),this.transformMatrix=null,t&&(this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this.cropX=t.cropX,this.cropY=t.cropY,n.x+=t.offsetLeft,n.y+=t.offsetTop,this.width=t.width,this.height=t.height),this.setPositionByOrigin(n,"center","center")},clone:function(t,n){var r=this.toObject(n);this.constructor.fromObject?this.constructor.fromObject(r,t):e.Object._fromObject("Object",r,t)},cloneAsImage:function(t,n){var r=this.toCanvasElement(n);return t&&t(new e.Image(r)),this},toCanvasElement:function(t){t||(t={});var n=e.util,r=n.saveObjectTransform(this),i=this.group,o=this.shadow,a=Math.abs,s=(t.multiplier||1)*(t.enableRetinaScaling?e.devicePixelRatio:1);delete this.group,t.withoutTransform&&n.resetObjectTransform(this),t.withoutShadow&&(this.shadow=null);var c,l,u,h,d=e.util.createCanvasElement(),f=this.getBoundingRect(!0,!0),p=this.shadow,g={x:0,y:0};p&&(l=p.blur,c=p.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),g.x=2*Math.round(a(p.offsetX)+l)*a(c.scaleX),g.y=2*Math.round(a(p.offsetY)+l)*a(c.scaleY)),u=f.width+g.x,h=f.height+g.y,d.width=Math.ceil(u),d.height=Math.ceil(h);var v=new e.StaticCanvas(d,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===t.format&&(v.backgroundColor="#fff"),this.setPositionByOrigin(new e.Point(v.width/2,v.height/2),"center","center");var m=this.canvas;v.add(this);var b=v.toCanvasElement(s||1,t);return this.shadow=o,this.set("canvas",m),i&&(this.group=i),this.set(r).setCoords(),v._objects=[],v.dispose(),v=null,b},toDataURL:function(t){return t||(t={}),e.util.toDataURL(this.toCanvasElement(t),t.format||"png",t.quality||1)},isType:function(t){return this.type===t},complexity:function(){return 1},toJSON:function(t){return this.toObject(t)},rotate:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(t,n){n=n||this.canvas.getPointer(t);var r=new e.Point(n.x,n.y),i=this._getLeftTopCoords();return this.angle&&(r=e.util.rotatePoint(r,i,a(-this.angle))),{x:r.x-i.x,y:r.y-i.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){e.runningAnimations&&e.runningAnimations.cancelByTarget(this)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),n(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object.ENLIVEN_PROPS=["clipPath"],e.Object._fromObject=function(t,n,i,o){var a=e[t];n=r(n,!0),e.util.enlivenPatterns([n.fill,n.stroke],(function(t){"undefined"!==typeof t[0]&&(n.fill=t[0]),"undefined"!==typeof t[1]&&(n.stroke=t[1]),e.util.enlivenObjectEnlivables(n,n,(function(){var t=o?new a(n[o],n):new a(n);i&&i(t)}))}))},e.Object.__uid=0)}(e),function(){var t=r.util.degreesToRadians,e={left:-.5,center:0,right:.5},n={top:-.5,center:0,bottom:.5};r.util.object.extend(r.Object.prototype,{translateToGivenOrigin:function(t,i,o,a,s){var c,l,u,h=t.x,d=t.y;return"string"===typeof i?i=e[i]:i-=.5,"string"===typeof a?a=e[a]:a-=.5,c=a-i,"string"===typeof o?o=n[o]:o-=.5,"string"===typeof s?s=n[s]:s-=.5,l=s-o,(c||l)&&(u=this._getTransformedDimensions(),h=t.x+c*u.x,d=t.y+l*u.y),new r.Point(h,d)},translateToCenterPoint:function(e,n,i){var o=this.translateToGivenOrigin(e,n,i,"center","center");return this.angle?r.util.rotatePoint(o,e,t(this.angle)):o},translateToOriginPoint:function(e,n,i){var o=this.translateToGivenOrigin(e,"center","center",n,i);return this.angle?r.util.rotatePoint(o,e,t(this.angle)):o},getCenterPoint:function(){var t=new r.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var n=this.getCenterPoint();return this.translateToOriginPoint(n,t,e)},toLocalPoint:function(e,n,i){var o,a,s=this.getCenterPoint();return o="undefined"!==typeof n&&"undefined"!==typeof i?this.translateToGivenOrigin(s,"center","center",n,i):new r.Point(this.left,this.top),a=new r.Point(e.x,e.y),this.angle&&(a=r.util.rotatePoint(a,s,-t(this.angle))),a.subtractEquals(o)},setPositionByOrigin:function(t,e,n){var r=this.translateToCenterPoint(t,e,n),i=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",i.x),this.set("top",i.y)},adjustPosition:function(n){var i,o,a=t(this.angle),s=this.getScaledWidth(),c=r.util.cos(a)*s,l=r.util.sin(a)*s;i="string"===typeof this.originX?e[this.originX]:this.originX-.5,o="string"===typeof n?e[n]:n-.5,this.left+=c*(o-i),this.top+=l*(o-i),this.setCoords(),this.originX=n},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function t(t){return[new r.Point(t.tl.x,t.tl.y),new r.Point(t.tr.x,t.tr.y),new r.Point(t.br.x,t.br.y),new r.Point(t.bl.x,t.bl.y)]}var e=r.util,n=e.degreesToRadians,i=e.multiplyTransformMatrices,o=e.transformPoint;e.object.extend(r.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(t,e){return e?t?this.calcACoords():this.calcLineCoords():(this.aCoords&&this.lineCoords||this.setCoords(!0),t?this.aCoords:this.lineCoords)},getCoords:function(e,n){return t(this._getCoords(e,n))},intersectsWithRect:function(t,e,n,i){var o=this.getCoords(n,i),a=r.Intersection.intersectPolygonRectangle(o,t,e);return"Intersection"===a.status},intersectsWithObject:function(t,e,n){var i=r.Intersection.intersectPolygonPolygon(this.getCoords(e,n),t.getCoords(e,n));return"Intersection"===i.status||t.isContainedWithinObject(this,e,n)||this.isContainedWithinObject(t,e,n)},isContainedWithinObject:function(t,e,n){for(var r=this.getCoords(e,n),i=e?t.aCoords:t.lineCoords,o=0,a=t._getImageLines(i);o<4;o++)if(!t.containsPoint(r[o],a))return!1;return!0},isContainedWithinRect:function(t,e,n,r){var i=this.getBoundingRect(n,r);return i.left>=t.x&&i.left+i.width<=e.x&&i.top>=t.y&&i.top+i.height<=e.y},containsPoint:function(t,e,n,r){var i=this._getCoords(n,r),o=(e=e||this._getImageLines(i),this._findCrossPoints(t,e));return 0!==o&&o%2===1},isOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,n=this.canvas.vptCoords.br,r=this.getCoords(!0,t);return!!r.some((function(t){return t.x<=n.x&&t.x>=e.x&&t.y<=n.y&&t.y>=e.y}))||(!!this.intersectsWithRect(e,n,!0,t)||this._containsCenterOfCanvas(e,n,t))},_containsCenterOfCanvas:function(t,e,n){var r={x:(t.x+e.x)/2,y:(t.y+e.y)/2};return!!this.containsPoint(r,null,!0,n)},isPartiallyOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,n=this.canvas.vptCoords.br;if(this.intersectsWithRect(e,n,!0,t))return!0;var r=this.getCoords(!0,t).every((function(t){return(t.x>=n.x||t.x<=e.x)&&(t.y>=n.y||t.y<=e.y)}));return r&&this._containsCenterOfCanvas(e,n,t)},_getImageLines:function(t){var e={topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}};return e},_findCrossPoints:function(t,e){var n,r,i,o,a,s,c=0;for(var l in e)if(s=e[l],!(s.o.y<t.y&&s.d.y<t.y)&&!(s.o.y>=t.y&&s.d.y>=t.y)&&(s.o.x===s.d.x&&s.o.x>=t.x?a=s.o.x:(n=0,r=(s.d.y-s.o.y)/(s.d.x-s.o.x),i=t.y-n*t.x,o=s.o.y-r*s.o.x,a=-(i-o)/(n-r)),a>=t.x&&(c+=1),2===c))break;return c},getBoundingRect:function(t,n){var r=this.getCoords(t,n);return e.makeBoundingBoxFromPoints(r)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:0===t?1e-4:t},scale:function(t){return this._set("scaleX",t),this._set("scaleY",t),this.setCoords()},scaleToWidth:function(t,e){var n=this.getBoundingRect(e).width/this.getScaledWidth();return this.scale(t/this.width/n)},scaleToHeight:function(t,e){var n=this.getBoundingRect(e).height/this.getScaledHeight();return this.scale(t/this.height/n)},calcLineCoords:function(){var t=this.getViewportTransform(),r=this.padding,i=n(this.angle),a=e.cos(i),s=e.sin(i),c=a*r,l=s*r,u=c+l,h=c-l,d=this.calcACoords(),f={tl:o(d.tl,t),tr:o(d.tr,t),bl:o(d.bl,t),br:o(d.br,t)};return r&&(f.tl.x-=h,f.tl.y-=u,f.tr.x+=u,f.tr.y-=h,f.bl.x-=u,f.bl.y+=h,f.br.x+=h,f.br.y+=u),f},calcOCoords:function(){var t=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),n=this.getViewportTransform(),r=i(n,e),o=i(r,t),a=(o=i(o,[1/n[0],0,0,1/n[3],0,0]),this._calculateCurrentDimensions()),s={};return this.forEachControl((function(t,e,n){s[e]=t.positionHandler(a,o,n)})),s},calcACoords:function(){var t=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),n=i(e,t),r=this._getTransformedDimensions(),a=r.x/2,s=r.y/2;return{tl:o({x:-a,y:-s},n),tr:o({x:a,y:-s},n),bl:o({x:-a,y:s},n),br:o({x:a,y:s},n)}},setCoords:function(t){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),t||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return e.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var t=this.getCenterPoint();return[1,0,0,1,t.x,t.y]},transformMatrixKey:function(t){var e="_",n="";return!t&&this.group&&(n=this.group.transformMatrixKey(t)+e),n+this.top+e+this.left+e+this.scaleX+e+this.scaleY+e+this.skewX+e+this.skewY+e+this.angle+e+this.originX+e+this.originY+e+this.width+e+this.height+e+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(t){var e=this.calcOwnMatrix();if(t||!this.group)return e;var n=this.transformMatrixKey(t),r=this.matrixCache||(this.matrixCache={});return r.key===n?r.value:(this.group&&(e=i(this.group.calcTransformMatrix(!1),e)),r.key=n,r.value=e,e)},calcOwnMatrix:function(){var t=this.transformMatrixKey(!0),n=this.ownMatrixCache||(this.ownMatrixCache={});if(n.key===t)return n.value;var r=this._calcTranslateMatrix(),i={angle:this.angle,translateX:r[4],translateY:r[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return n.key=t,n.value=e.composeMatrix(i),n.value},_getNonTransformedDimensions:function(){var t=this.strokeWidth,e=this.width+t,n=this.height+t;return{x:e,y:n}},_getTransformedDimensions:function(t,n){"undefined"===typeof t&&(t=this.skewX),"undefined"===typeof n&&(n=this.skewY);var r,i,o,a=0===t&&0===n;if(this.strokeUniform?(i=this.width,o=this.height):(r=this._getNonTransformedDimensions(),i=r.x,o=r.y),a)return this._finalizeDimensions(i*this.scaleX,o*this.scaleY);var s=e.sizeAfterTransform(i,o,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:t,skewY:n});return this._finalizeDimensions(s.x,s.y)},_finalizeDimensions:function(t,e){return this.strokeUniform?{x:t+this.strokeWidth,y:e+this.strokeWidth}:{x:t,y:e}},_calculateCurrentDimensions:function(){var t=this.getViewportTransform(),e=this._getTransformedDimensions(),n=o(e,t,!0);return n.scalarAdd(2*this.padding)}})}(),r.util.object.extend(r.Object.prototype,{sendToBack:function(){return this.group?r.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?r.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?r.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas&&this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?r.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas&&this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group&&"activeSelection"!==this.group.type?r.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas&&this.canvas.moveTo(this,t),this}}),function(){function t(t,e){if(e){if(e.toLive)return t+": url(#SVGID_"+e.id+"); ";var n=new r.Color(e),i=t+": "+n.toRgb()+"; ",o=n.getAlpha();return 1!==o&&(i+=t+"-opacity: "+o.toString()+"; "),i}return t+": none; "}var e=r.util.toFixed;r.util.object.extend(r.Object.prototype,{getSvgStyles:function(e){var n=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",i=this.strokeDashArray?this.strokeDashArray.join(" "):"none",o=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",s=this.strokeLineJoin?this.strokeLineJoin:"miter",c=this.strokeMiterLimit?this.strokeMiterLimit:"4",l="undefined"!==typeof this.opacity?this.opacity:"1",u=this.visible?"":" visibility: hidden;",h=e?"":this.getSvgFilter(),d=t("fill",this.fill),f=t("stroke",this.stroke);return[f,"stroke-width: ",r,"; ","stroke-dasharray: ",i,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",o,"; ","stroke-linejoin: ",s,"; ","stroke-miterlimit: ",c,"; ",d,"fill-rule: ",n,"; ","opacity: ",l,";",h,u].join("")},getSvgSpanStyles:function(e,n){var r="; ",i=e.fontFamily?"font-family: "+(-1===e.fontFamily.indexOf("'")&&-1===e.fontFamily.indexOf('"')?"'"+e.fontFamily+"'":e.fontFamily)+r:"",o=e.strokeWidth?"stroke-width: "+e.strokeWidth+r:"",a=(i=i,e.fontSize?"font-size: "+e.fontSize+"px"+r:""),s=e.fontStyle?"font-style: "+e.fontStyle+r:"",c=e.fontWeight?"font-weight: "+e.fontWeight+r:"",l=e.fill?t("fill",e.fill):"",u=e.stroke?t("stroke",e.stroke):"",h=this.getSvgTextDecoration(e),d=e.deltaY?"baseline-shift: "+-e.deltaY+"; ":"";return h&&(h="text-decoration: "+h+r),[u,o,i,a,s,c,h,l,d,n?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(t){return["overline","underline","line-through"].filter((function(e){return t[e.replace("-","")]})).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(t,e){var n=t?this.calcTransformMatrix():this.calcOwnMatrix(),i='transform="'+r.util.matrixToSVG(n);return i+(e||"")+'" '},_setSVGBg:function(t){if(this.backgroundColor){var n=r.Object.NUM_FRACTION_DIGITS;t.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',e(-this.width/2,n),'" y="',e(-this.height/2,n),'" width="',e(this.width,n),'" height="',e(this.height,n),'"></rect>\n')}},toSVG:function(t){return this._createBaseSVGMarkup(this._toSVG(t),{reviver:t})},toClipPathSVG:function(t){return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(t),{reviver:t})},_createBaseClipPathSVGMarkup:function(t,e){e=e||{};var n=e.reviver,r=e.additionalTransform||"",i=[this.getSvgTransform(!0,r),this.getSvgCommons()].join(""),o=t.indexOf("COMMON_PARTS");return t[o]=i,n?n(t.join("")):t.join("")},_createBaseSVGMarkup:function(t,e){e=e||{};var n,i,o=e.noStyle,a=e.reviver,s=o?"":'style="'+this.getSvgStyles()+'" ',c=e.withShadow?'style="'+this.getSvgFilter()+'" ':"",l=this.clipPath,u=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",h=l&&l.absolutePositioned,d=this.stroke,f=this.fill,p=this.shadow,g=[],v=t.indexOf("COMMON_PARTS"),m=e.additionalTransform;return l&&(l.clipPathId="CLIPPATH_"+r.Object.__uid++,i='<clipPath id="'+l.clipPathId+'" >\n'+l.toClipPathSVG(a)+"</clipPath>\n"),h&&g.push("<g ",c,this.getSvgCommons()," >\n"),g.push("<g ",this.getSvgTransform(!1),h?"":c+this.getSvgCommons()," >\n"),n=[s,u,o?"":this.addPaintOrder()," ",m?'transform="'+m+'" ':""].join(""),t[v]=n,f&&f.toLive&&g.push(f.toSVG(this)),d&&d.toLive&&g.push(d.toSVG(this)),p&&g.push(p.toSVG(this)),l&&g.push(i),g.push(t.join("")),g.push("</g>\n"),h&&g.push("</g>\n"),a?a(g.join("")):g.join("")},addPaintOrder:function(){return"fill"!==this.paintFirst?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var t=r.util.object.extend,e="stateProperties";function n(e,n,r){var i={},o=!0;r.forEach((function(t){i[t]=e[t]})),t(e[n],i,o)}function i(t,e,n){if(t===e)return!0;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var r=0,o=t.length;r<o;r++)if(!i(t[r],e[r]))return!1;return!0}if(t&&"object"===typeof t){var a,s=Object.keys(t);if(!e||"object"!==typeof e||!n&&s.length!==Object.keys(e).length)return!1;for(r=0,o=s.length;r<o;r++)if(a=s[r],"canvas"!==a&&"group"!==a&&!i(t[a],e[a]))return!1;return!0}}r.util.object.extend(r.Object.prototype,{hasStateChanged:function(t){t=t||e;var n="_"+t;return Object.keys(this[n]).length<this[t].length||!i(this[n],this,!0)},saveState:function(t){var r=t&&t.propertySet||e,i="_"+r;return this[i]?(n(this,i,this[r]),t&&t.stateProperties&&n(this,i,t.stateProperties),this):this.setupState(t)},setupState:function(t){t=t||{};var n=t.propertySet||e;return t.propertySet=n,this["_"+n]={},this.saveState(t),this}})}(),function(){var t=r.util.degreesToRadians;r.util.object.extend(r.Object.prototype,{_findTargetCorner:function(t,e){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var n,r,i,o=t.x,a=t.y,s=Object.keys(this.oCoords),c=s.length-1;for(this.__corner=0;c>=0;c--)if(i=s[c],this.isControlVisible(i)&&(r=this._getImageLines(e?this.oCoords[i].touchCorner:this.oCoords[i].corner),n=this._findCrossPoints({x:o,y:a},r),0!==n&&n%2===1))return this.__corner=i,i;return!1},forEachControl:function(t){for(var e in this.controls)t(this.controls[e],e,this)},_setCornerCoords:function(){var t=this.oCoords;for(var e in t){var n=this.controls[e];t[e].corner=n.calcCornerCoords(this.angle,this.cornerSize,t[e].x,t[e].y,!1),t[e].touchCorner=n.calcCornerCoords(this.angle,this.touchCornerSize,t[e].x,t[e].y,!0)}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var n=this.getCenterPoint(),r=this._calculateCurrentDimensions(),i=this.canvas.viewportTransform;return e.translate(n.x,n.y),e.scale(1/i[0],1/i[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-r.x/2,-r.y/2,r.x,r.y),e.restore(),this},drawBorders:function(t,e){e=e||{};var n=this._calculateCurrentDimensions(),r=this.borderScaleFactor,i=n.x+r,o=n.y+r,a="undefined"!==typeof e.hasControls?e.hasControls:this.hasControls,s=!1;return t.save(),t.strokeStyle=e.borderColor||this.borderColor,this._setLineDash(t,e.borderDashArray||this.borderDashArray),t.strokeRect(-i/2,-o/2,i,o),a&&(t.beginPath(),this.forEachControl((function(e,n,r){e.withConnection&&e.getVisibility(r,n)&&(s=!0,t.moveTo(e.x*i,e.y*o),t.lineTo(e.x*i+e.offsetX,e.y*o+e.offsetY))})),s&&t.stroke()),t.restore(),this},drawBordersInGroup:function(t,e,n){n=n||{};var i=r.util.sizeAfterTransform(this.width,this.height,e),o=this.strokeWidth,a=this.strokeUniform,s=this.borderScaleFactor,c=i.x+o*(a?this.canvas.getZoom():e.scaleX)+s,l=i.y+o*(a?this.canvas.getZoom():e.scaleY)+s;return t.save(),this._setLineDash(t,n.borderDashArray||this.borderDashArray),t.strokeStyle=n.borderColor||this.borderColor,t.strokeRect(-c/2,-l/2,c,l),t.restore(),this},drawControls:function(t,e){e=e||{},t.save();var n,i,o=this.canvas.getRetinaScaling();return t.setTransform(o,0,0,o,0,0),t.strokeStyle=t.fillStyle=e.cornerColor||this.cornerColor,this.transparentCorners||(t.strokeStyle=e.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(t,e.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(n=this.group.calcTransformMatrix()),this.forEachControl((function(o,a,s){i=s.oCoords[a],o.getVisibility(s,a)&&(n&&(i=r.util.transformPoint(i,n)),o.render(t,i.x,i.y,e,s))})),t.restore(),this},isControlVisible:function(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)},setControlVisible:function(t,e){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=e,this},setControlsVisibility:function(t){for(var e in t||(t={}),t)this.setControlVisible(e,t[e]);return this},onDeselect:function(){},onSelect:function(){}})}(),r.util.object.extend(r.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){e=e||{};var n=function(){},i=e.onComplete||n,o=e.onChange||n,a=this;return r.util.animate({target:this,startValue:t.left,endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(e){t.set("left",e),a.requestRenderAll(),o()},onComplete:function(){t.setCoords(),i()}})},fxCenterObjectV:function(t,e){e=e||{};var n=function(){},i=e.onComplete||n,o=e.onChange||n,a=this;return r.util.animate({target:this,startValue:t.top,endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(e){t.set("top",e),a.requestRenderAll(),o()},onComplete:function(){t.setCoords(),i()}})},fxRemove:function(t,e){e=e||{};var n=function(){},i=e.onComplete||n,o=e.onChange||n,a=this;return r.util.animate({target:this,startValue:t.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(e){t.set("opacity",e),a.requestRenderAll(),o()},onComplete:function(){a.remove(t),i()}})}}),r.util.object.extend(r.Object.prototype,{animate:function(){if(arguments[0]&&"object"===typeof arguments[0]){var t,e,n=[],r=[];for(t in arguments[0])n.push(t);for(var i=0,o=n.length;i<o;i++)t=n[i],e=i!==o-1,r.push(this._animate(t,arguments[0][t],arguments[1],e));return r}return this._animate.apply(this,arguments)},_animate:function(t,e,n,i){var o,a=this;e=e.toString(),n=n?r.util.object.clone(n):{},~t.indexOf(".")&&(o=t.split("."));var s=a.colorProperties.indexOf(t)>-1||o&&a.colorProperties.indexOf(o[1])>-1,c=o?this.get(o[0])[o[1]]:this.get(t);"from"in n||(n.from=c),s||(e=~e.indexOf("=")?c+parseFloat(e.replace("=","")):parseFloat(e));var l={target:this,startValue:n.from,endValue:e,byValue:n.by,easing:n.easing,duration:n.duration,abort:n.abort&&function(t,e,r){return n.abort.call(a,t,e,r)},onChange:function(e,r,s){o?a[o[0]][o[1]]=e:a.set(t,e),i||n.onChange&&n.onChange(e,r,s)},onComplete:function(t,e,r){i||(a.setCoords(),n.onComplete&&n.onComplete(t,e,r))}};return s?r.util.animateColor(l.startValue,l.endValue,l.duration,l):r.util.animate(l)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,r=e.util.object.clone,i={x1:1,x2:1,y1:1,y2:1};function o(t,e){var n=t.origin,r=t.axis1,i=t.axis2,o=t.dimension,a=e.nearest,s=e.center,c=e.farthest;return function(){switch(this.get(n)){case a:return Math.min(this.get(r),this.get(i));case s:return Math.min(this.get(r),this.get(i))+.5*this.get(o);case c:return Math.max(this.get(r),this.get(i))}}}e.Line?e.warn("fabric.Line is already defined"):(e.Line=e.util.createClass(e.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:e.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(t,e){t||(t=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this.callSuper("_set",t,e),"undefined"!==typeof i[t]&&this._setWidthHeight(),this},_getLeftToOriginX:o({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:o({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t){t.beginPath();var e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.lineWidth=this.strokeWidth;var n=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=n},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(t){return n(this.callSuper("toObject",t),this.calcLinePoints())},_getNonTransformedDimensions:function(){var t=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(t.y-=this.strokeWidth),0===this.height&&(t.x-=this.strokeWidth)),t},calcLinePoints:function(){var t=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1,n=t*this.width*.5,r=e*this.height*.5,i=t*this.width*-.5,o=e*this.height*-.5;return{x1:n,x2:i,y1:r,y2:o}},_toSVG:function(){var t=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',t.x1,'" y1="',t.y1,'" x2="',t.x2,'" y2="',t.y2,'" />\n']}}),e.Line.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),e.Line.fromElement=function(t,r,i){i=i||{};var o=e.parseAttributes(t,e.Line.ATTRIBUTE_NAMES),a=[o.x1||0,o.y1||0,o.x2||0,o.y2||0];r(new e.Line(a,n(o,i)))},e.Line.fromObject=function(t,n){function i(t){delete t.points,n&&n(t)}var o=r(t,!0);o.points=[t.x1,t.y1,t.x2,t.y2],e.Object._fromObject("Line",o,i,"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.degreesToRadians;function r(t){return"radius"in t&&t.radius>=0}e.Circle?e.warn("fabric.Circle is already defined."):(e.Circle=e.util.createClass(e.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:e.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(t))},_toSVG:function(){var t,r=0,i=0,o=(this.endAngle-this.startAngle)%360;if(0===o)t=["<circle ","COMMON_PARTS",'cx="'+r+'" cy="'+i+'" ','r="',this.radius,'" />\n'];else{var a=n(this.startAngle),s=n(this.endAngle),c=this.radius,l=e.util.cos(a)*c,u=e.util.sin(a)*c,h=e.util.cos(s)*c,d=e.util.sin(s)*c,f=o>180?"1":"0";t=['<path d="M '+l+" "+u," A "+c+" "+c," 0 ",+f+" 1"," "+h+" "+d,'" ',"COMMON_PARTS"," />\n"]}return t},_render:function(t){t.beginPath(),t.arc(0,0,this.radius,n(this.startAngle),n(this.endAngle),!1),this._renderPaintInOrder(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){return this.radius=t,this.set("width",2*t).set("height",2*t)}}),e.Circle.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),e.Circle.fromElement=function(t,n){var i=e.parseAttributes(t,e.Circle.ATTRIBUTE_NAMES);if(!r(i))throw new Error("value of `r` attribute is required and can not be negative");i.left=(i.left||0)-i.radius,i.top=(i.top||0)-i.radius,n(new e.Circle(i))},e.Circle.fromObject=function(t,n){e.Object._fromObject("Circle",t,n)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Triangle?e.warn("fabric.Triangle is already defined"):(e.Triangle=e.util.createClass(e.Object,{type:"triangle",width:100,height:100,_render:function(t){var e=this.width/2,n=this.height/2;t.beginPath(),t.moveTo(-e,n),t.lineTo(0,-n),t.lineTo(e,n),t.closePath(),this._renderPaintInOrder(t)},_toSVG:function(){var t=this.width/2,e=this.height/2,n=[-t+" "+e,"0 "+-e,t+" "+e].join(",");return["<polygon ","COMMON_PARTS",'points="',n,'" />']}}),e.Triangle.fromObject=function(t,n){return e.Object._fromObject("Triangle",t,n)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=2*Math.PI;e.Ellipse?e.warn("fabric.Ellipse is already defined."):(e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this.set("rx",t&&t.rx||0),this.set("ry",t&&t.ry||0)},_set:function(t,e){switch(this.callSuper("_set",t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" />\n']},_render:function(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,n,!1),t.restore(),this._renderPaintInOrder(t)}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(t,n){var r=e.parseAttributes(t,e.Ellipse.ATTRIBUTE_NAMES);r.left=(r.left||0)-r.rx,r.top=(r.top||0)-r.ry,n(new e.Ellipse(r))},e.Ellipse.fromObject=function(t,n){e.Object._fromObject("Ellipse",t,n)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend;e.Rect?e.warn("fabric.Rect is already defined"):(e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t){var e=this.rx?Math.min(this.rx,this.width/2):0,n=this.ry?Math.min(this.ry,this.height/2):0,r=this.width,i=this.height,o=-this.width/2,a=-this.height/2,s=0!==e||0!==n,c=.4477152502;t.beginPath(),t.moveTo(o+e,a),t.lineTo(o+r-e,a),s&&t.bezierCurveTo(o+r-c*e,a,o+r,a+c*n,o+r,a+n),t.lineTo(o+r,a+i-n),s&&t.bezierCurveTo(o+r,a+i-c*n,o+r-c*e,a+i,o+r-e,a+i),t.lineTo(o+e,a+i),s&&t.bezierCurveTo(o+c*e,a+i,o,a+i-c*n,o,a+i-n),t.lineTo(o,a+n),s&&t.bezierCurveTo(o,a+c*n,o+c*e,a,o+e,a),t.closePath(),this._renderPaintInOrder(t)},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},_toSVG:function(){var t=-this.width/2,e=-this.height/2;return["<rect ","COMMON_PARTS",'x="',t,'" y="',e,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,'" />\n']}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(t,r,i){if(!t)return r(null);i=i||{};var o=e.parseAttributes(t,e.Rect.ATTRIBUTE_NAMES);o.left=o.left||0,o.top=o.top||0,o.height=o.height||0,o.width=o.width||0;var a=new e.Rect(n(i?e.util.object.clone(i):{},o));a.visible=a.visible&&a.width>0&&a.height>0,r(a)},e.Rect.fromObject=function(t,n){return e.Object._fromObject("Rect",t,n)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,r=e.util.array.min,i=e.util.array.max,o=e.util.toFixed,a=e.util.projectStrokeOnPoints;e.Polyline?e.warn("fabric.Polyline is already defined"):(e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:e.Object.prototype.cacheProperties.concat("points"),initialize:function(t,e){e=e||{},this.points=t||[],this.callSuper("initialize",e),this._setPositionDimensions(e)},_projectStrokeOnPoints:function(){return a(this.points,this,!0)},_setPositionDimensions:function(t){var e,n=this._calcDimensions(t),r=this.exactBoundingBox?this.strokeWidth:0;this.width=n.width-r,this.height=n.height-r,t.fromSVG||(e=this.translateToGivenOrigin({x:n.left-this.strokeWidth/2+r/2,y:n.top-this.strokeWidth/2+r/2},"left","top",this.originX,this.originY)),"undefined"===typeof t.left&&(this.left=t.fromSVG?n.left:e.x),"undefined"===typeof t.top&&(this.top=t.fromSVG?n.top:e.y),this.pathOffset={x:n.left+this.width/2+r/2,y:n.top+this.height/2+r/2}},_calcDimensions:function(){var t=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,e=r(t,"x")||0,n=r(t,"y")||0,o=i(t,"x")||0,a=i(t,"y")||0,s=o-e,c=a-n;return{left:e,top:n,width:s,height:c}},toObject:function(t){return n(this.callSuper("toObject",t),{points:this.points.concat()})},_toSVG:function(){for(var t=[],n=this.pathOffset.x,r=this.pathOffset.y,i=e.Object.NUM_FRACTION_DIGITS,a=0,s=this.points.length;a<s;a++)t.push(o(this.points[a].x-n,i),",",o(this.points[a].y-r,i)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',t.join(""),'" />\n']},commonRender:function(t){var e,n=this.points.length,r=this.pathOffset.x,i=this.pathOffset.y;if(!n||isNaN(this.points[n-1].y))return!1;t.beginPath(),t.moveTo(this.points[0].x-r,this.points[0].y-i);for(var o=0;o<n;o++)e=this.points[o],t.lineTo(e.x-r,e.y-i);return!0},_render:function(t){this.commonRender(t)&&this._renderPaintInOrder(t)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElementGenerator=function(t){return function(r,i,o){if(!r)return i(null);o||(o={});var a=e.parsePointsAttribute(r.getAttribute("points")),s=e.parseAttributes(r,e[t].ATTRIBUTE_NAMES);s.fromSVG=!0,i(new e[t](a,n(s,o)))}},e.Polyline.fromElement=e.Polyline.fromElementGenerator("Polyline"),e.Polyline.fromObject=function(t,n){return e.Object._fromObject("Polyline",t,n,"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.projectStrokeOnPoints;e.Polygon?e.warn("fabric.Polygon is already defined"):(e.Polygon=e.util.createClass(e.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return n(this.points,this)},_render:function(t){this.commonRender(t)&&(t.closePath(),this._renderPaintInOrder(t))}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=e.Polyline.fromElementGenerator("Polygon"),e.Polygon.fromObject=function(t,n){e.Object._fromObject("Polygon",t,n,"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.array.min,r=e.util.array.max,i=e.util.object.extend,o=e.util.object.clone,a=Object.prototype.toString,s=e.util.toFixed;e.Path?e.warn("fabric.Path is already defined"):(e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(t,e){e=o(e||{}),delete e.path,this.callSuper("initialize",e),this._setPath(t||[],e)},_setPath:function(t,n){var r="[object Array]"===a.call(t);this.path=e.util.makePathSimpler(r?t:e.util.parsePath(t)),e.Polyline.prototype._setPositionDimensions.call(this,n||{})},_renderPathCommands:function(t){var e,n=0,r=0,i=0,o=0,a=0,s=0,c=-this.pathOffset.x,l=-this.pathOffset.y;t.beginPath();for(var u=0,h=this.path.length;u<h;++u)switch(e=this.path[u],e[0]){case"L":i=e[1],o=e[2],t.lineTo(i+c,o+l);break;case"M":i=e[1],o=e[2],n=i,r=o,t.moveTo(i+c,o+l);break;case"C":i=e[5],o=e[6],a=e[3],s=e[4],t.bezierCurveTo(e[1]+c,e[2]+l,a+c,s+l,i+c,o+l);break;case"Q":t.quadraticCurveTo(e[1]+c,e[2]+l,e[3]+c,e[4]+l),i=e[3],o=e[4],a=e[1],s=e[2];break;case"z":case"Z":i=n,o=r,t.closePath();break}},_render:function(t){this._renderPathCommands(t),this._renderPaintInOrder(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){return i(this.callSuper("toObject",t),{path:this.path.map((function(t){return t.slice()}))})},toDatalessObject:function(t){var e=this.toObject(["sourcePath"].concat(t));return e.sourcePath&&delete e.path,e},_toSVG:function(){var t=e.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',t,'" stroke-linecap="round" ',"/>\n"]},_getOffsetTransform:function(){var t=e.Object.NUM_FRACTION_DIGITS;return" translate("+s(-this.pathOffset.x,t)+", "+s(-this.pathOffset.y,t)+")"},toClipPathSVG:function(t){var e=this._getOffsetTransform();return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})},toSVG:function(t){var e=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var t,i,o=[],a=[],s=0,c=0,l=0,u=0,h=0,d=this.path.length;h<d;++h){switch(t=this.path[h],t[0]){case"L":l=t[1],u=t[2],i=[];break;case"M":l=t[1],u=t[2],s=l,c=u,i=[];break;case"C":i=e.util.getBoundsOfCurve(l,u,t[1],t[2],t[3],t[4],t[5],t[6]),l=t[5],u=t[6];break;case"Q":i=e.util.getBoundsOfCurve(l,u,t[1],t[2],t[1],t[2],t[3],t[4]),l=t[3],u=t[4];break;case"z":case"Z":l=s,u=c;break}i.forEach((function(t){o.push(t.x),a.push(t.y)})),o.push(l),a.push(u)}var f=n(o)||0,p=n(a)||0,g=r(o)||0,v=r(a)||0,m=g-f,b=v-p;return{left:f,top:p,width:m,height:b}}}),e.Path.fromObject=function(t,n){if("string"===typeof t.sourcePath){var r=t.sourcePath;e.loadSVGFromURL(r,(function(e){var r=e[0];r.setOptions(t),n&&n(r)}))}else e.Object._fromObject("Path",t,n,"path")},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(t,n,r){var o=e.parseAttributes(t,e.Path.ATTRIBUTE_NAMES);o.fromSVG=!0,n(new e.Path(o.d,i(o,r)))})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.array.min,r=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(t,e,n){e=e||{},this._objects=[],n&&this.callSuper("initialize",e),this._objects=t||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;if(n)this._updateObjectsACoords();else{var i=e&&e.centerPoint;void 0!==e.originX&&(this.originX=e.originX),void 0!==e.originY&&(this.originY=e.originY),i||this._calcBounds(),this._updateObjectsCoords(i),delete e.centerPoint,this.callSuper("initialize",e)}this.setCoords()},_updateObjectsACoords:function(){for(var t=!0,e=this._objects.length;e--;)this._objects[e].setCoords(t)},_updateObjectsCoords:function(t){t=t||this.getCenterPoint();for(var e=this._objects.length;e--;)this._updateObjectCoords(this._objects[e],t)},_updateObjectCoords:function(t,e){var n=t.left,r=t.top,i=!0;t.set({left:n-e.x,top:r-e.y}),t.group=this,t.setCoords(i)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){var n=!!this.group;return this._restoreObjectsState(),e.util.resetObjectTransform(this),t&&(n&&e.util.removeTransformFromObject(t,this.group.calcTransformMatrix()),this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,n?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(t){this.dirty=!0,t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){this.dirty=!0,delete t.group},_set:function(t,n){var r=this._objects.length;if(this.useSetOnGroup)while(r--)this._objects[r].setOnGroup(t,n);if("canvas"===t)while(r--)this._objects[r]._set(t,n);e.Object.prototype._set.call(this,t,n)},toObject:function(t){var n=this.includeDefaultValues,r=this._objects.filter((function(t){return!t.excludeFromExport})).map((function(e){var r=e.includeDefaultValues;e.includeDefaultValues=n;var i=e.toObject(t);return e.includeDefaultValues=r,i})),i=e.Object.prototype.toObject.call(this,t);return i.objects=r,i},toDatalessObject:function(t){var n,r=this.sourcePath;if(r)n=r;else{var i=this.includeDefaultValues;n=this._objects.map((function(e){var n=e.includeDefaultValues;e.includeDefaultValues=i;var r=e.toDatalessObject(t);return e.includeDefaultValues=n,r}))}var o=e.Object.prototype.toDatalessObject.call(this,t);return o.objects=n,o},render:function(t){this._transformDone=!0,this.callSuper("render",t),this._transformDone=!1},shouldCache:function(){var t=e.Object.prototype.shouldCache.call(this);if(t)for(var n=0,r=this._objects.length;n<r;n++)if(this._objects[n].willDrawShadow())return this.ownCaching=!1,!1;return t},willDrawShadow:function(){if(e.Object.prototype.willDrawShadow.call(this))return!0;for(var t=0,n=this._objects.length;t<n;t++)if(this._objects[t].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(t){for(var e=0,n=this._objects.length;e<n;e++)this._objects[e].render(t);this._drawClipPath(t,this.clipPath)},isCacheDirty:function(t){if(this.callSuper("isCacheDirty",t))return!0;if(!this.statefullCache)return!1;for(var e=0,n=this._objects.length;e<n;e++)if(this._objects[e].isCacheDirty(!0)){if(this._cacheCanvas){var r=this.cacheWidth/this.zoomX,i=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-r/2,-i/2,r,i)}return!0}return!1},_restoreObjectsState:function(){var t=this.calcOwnMatrix();return this._objects.forEach((function(n){e.util.addTransformToObject(n,t),delete n.group,n.setCoords()})),this},destroy:function(){return this._objects.forEach((function(t){t.set("dirty",!0)})),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject((function(t){t.dispose&&t.dispose()})),this._objects=[]},toActiveSelection:function(){if(this.canvas){var t=this._objects,n=this.canvas;this._objects=[];var r=this.toObject();delete r.objects;var i=new e.ActiveSelection([]);return i.set(r),i.type="activeSelection",n.remove(this),t.forEach((function(t){t.group=i,t.dirty=!0,n.add(t)})),i.canvas=n,i._objects=t,n._activeObject=i,i.setCoords(),i}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var t=!0;return this.forEachObject((function(e){e.setCoords(t)})),this},_calcBounds:function(t){for(var e,n,r,i,o=[],a=[],s=["tr","br","bl","tl"],c=0,l=this._objects.length,u=s.length;c<l;++c){for(e=this._objects[c],r=e.calcACoords(),i=0;i<u;i++)n=s[i],o.push(r[n].x),a.push(r[n].y);e.aCoords=r}this._getBounds(o,a,t)},_getBounds:function(t,i,o){var a=new e.Point(n(t),n(i)),s=new e.Point(r(t),r(i)),c=a.y||0,l=a.x||0,u=s.x-a.x||0,h=s.y-a.y||0;this.width=u,this.height=h,o||this.setPositionByOrigin({x:l,y:c},"left","top")},_toSVG:function(t){for(var e=["<g ","COMMON_PARTS"," >\n"],n=0,r=this._objects.length;n<r;n++)e.push("\t\t",this._objects[n].toSVG(t));return e.push("</g>\n"),e},getSvgStyles:function(){var t="undefined"!==typeof this.opacity&&1!==this.opacity?"opacity: "+this.opacity+";":"",e=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),e].join("")},toClipPathSVG:function(t){for(var e=[],n=0,r=this._objects.length;n<r;n++)e.push("\t",this._objects[n].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(e,{reviver:t})}}),e.Group.fromObject=function(t,n){var r=t.objects,i=e.util.object.clone(t,!0);delete i.objects,"string"!==typeof r?e.util.enlivenObjects(r,(function(r){var i=e.util.object.clone(t,!0);delete i.objects,e.util.enlivenObjectEnlivables(t,i,(function(){n&&n(new e.Group(r,i,!0))}))})):e.loadSVGFromURL(r,(function(o){var a=e.util.groupSVGElements(o,t,r);a.set(i),n&&n(a)}))})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(t,n){n=n||{},this._objects=t||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;n.originX&&(this.originX=n.originX),n.originY&&(this.originY=n.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,n),this.setCoords()},toGroup:function(){var t=this._objects.concat();this._objects=[];var n=e.Object.prototype.toObject.call(this),r=new e.Group([]);if(delete n.type,r.set(n),t.forEach((function(t){t.canvas.remove(t),t.group=r})),r._objects=t,!this.canvas)return r;var i=this.canvas;return i.add(r),i._activeObject=r,r.setCoords(),r},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(t,e,n){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",t,e),n=n||{},"undefined"===typeof n.hasControls&&(n.hasControls=!1),n.forActiveSelection=!0;for(var r=0,i=this._objects.length;r<i;r++)this._objects[r]._renderControls(t,n);t.restore()}}),e.ActiveSelection.fromObject=function(t,n){e.util.enlivenObjects(t.objects,(function(r){delete t.objects,n&&n(new e.ActiveSelection(r,t,!0))}))})}(e),function(t){"use strict";var e=r.util.object.extend;t.fabric||(t.fabric={}),t.fabric.Image?r.warn("fabric.Image is already defined."):(r.Image=r.util.createClass(r.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:r.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:r.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(t,e){e||(e={}),this.filters=[],this.cacheKey="texture"+r.Object.__uid++,this.callSuper("initialize",e),this._initElement(t,e)},getElement:function(){return this._element||{}},setElement:function(t,e){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=t,this._originalElement=t,this._initConfig(e),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(t){var e=r.filterBackend;e&&e.evictCachesForKey&&e.evictCachesForKey(t)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(t){r.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var t=this.getElement();return{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}},_stroke:function(t){if(this.stroke&&0!==this.strokeWidth){var e=this.width/2,n=this.height/2;t.beginPath(),t.moveTo(-e,-n),t.lineTo(e,-n),t.lineTo(e,n),t.lineTo(-e,n),t.lineTo(-e,-n),t.closePath()}},toObject:function(t){var n=[];this.filters.forEach((function(t){t&&n.push(t.toObject())}));var r=e(this.callSuper("toObject",["cropX","cropY"].concat(t)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:n});return this.resizeFilter&&(r.resizeFilter=this.resizeFilter.toObject()),r},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var t,e=[],n=[],i=this._element,o=-this.width/2,a=-this.height/2,s="",c="";if(!i)return[];if(this.hasCrop()){var l=r.Object.__uid++;e.push('<clipPath id="imageCrop_'+l+'">\n','\t<rect x="'+o+'" y="'+a+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),s=' clip-path="url(#imageCrop_'+l+')" '}if(this.imageSmoothing||(c='" image-rendering="optimizeSpeed'),n.push("\t<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',o-this.cropX,'" y="',a-this.cropY,'" width="',i.width||i.naturalWidth,'" height="',i.height||i.height,c,'"',s,"></image>\n"),this.stroke||this.strokeDashArray){var u=this.fill;this.fill=null,t=["\t<rect ",'x="',o,'" y="',a,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'],this.fill=u}return e="fill"!==this.paintFirst?e.concat(t,n):e.concat(n,t),e},getSrc:function(t){var e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src"):e.src:this.src||""},setSrc:function(t,e,n){return r.util.loadImage(t,(function(t,r){this.setElement(t,n),this._setWidthHeight(),e&&e(this,r)}),this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var t=this.resizeFilter,e=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),i=n.scaleX,o=n.scaleY,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||i>e&&o>e)return this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,void(this._lastScaleY=o);r.filterBackend||(r.filterBackend=r.initFilterBackend());var s=r.util.createCanvasElement(),c=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,l=a.width,u=a.height;s.width=l,s.height=u,this._element=s,this._lastScaleX=t.scaleX=i,this._lastScaleY=t.scaleY=o,r.filterBackend.applyFilters([t],a,l,u,this._element,c),this._filterScalingX=s.width/this._originalElement.width,this._filterScalingY=s.height/this._originalElement.height},applyFilters:function(t){if(t=t||this.filters||[],t=t.filter((function(t){return t&&!t.isNeutralState()})),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===t.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var e=this._originalElement,n=e.naturalWidth||e.width,i=e.naturalHeight||e.height;if(this._element===this._originalElement){var o=r.util.createCanvasElement();o.width=n,o.height=i,this._element=o,this._filteredEl=o}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,i),this._lastScaleX=1,this._lastScaleY=1;return r.filterBackend||(r.filterBackend=r.initFilterBackend()),r.filterBackend.applyFilters(t,this._originalElement,n,i,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(t){r.util.setImageSmoothing(t,this.imageSmoothing),!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)},drawCacheOnCanvas:function(t){r.util.setImageSmoothing(t,this.imageSmoothing),r.Object.prototype.drawCacheOnCanvas.call(this,t)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(t){var e=this._element;if(e){var n=this._filterScalingX,r=this._filterScalingY,i=this.width,o=this.height,a=Math.min,s=Math.max,c=s(this.cropX,0),l=s(this.cropY,0),u=e.naturalWidth||e.width,h=e.naturalHeight||e.height,d=c*n,f=l*r,p=a(i*n,u-d),g=a(o*r,h-f),v=-i/2,m=-o/2,b=a(i,u/n-c),y=a(o,h/r-l);e&&t.drawImage(e,d,f,p,g,v,m,b,y)}},_needsResize:function(){var t=this.getTotalObjectScaling();return t.scaleX!==this._lastScaleX||t.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(t,e){this.setElement(r.util.getById(t),e),r.util.addClass(this.getElement(),r.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t)},_initFilters:function(t,e){t&&t.length?r.util.enlivenObjects(t,(function(t){e&&e(t)}),"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){t||(t={});var e=this.getElement();this.width=t.width||e.naturalWidth||e.width||0,this.height=t.height||e.naturalHeight||e.height||0},parsePreserveAspectRatioAttribute:function(){var t,e=r.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),n=this._element.width,i=this._element.height,o=1,a=1,s=0,c=0,l=0,u=0,h=this.width,d=this.height,f={width:h,height:d};return!e||"none"===e.alignX&&"none"===e.alignY?(o=h/n,a=d/i):("meet"===e.meetOrSlice&&(o=a=r.util.findScaleToFit(this._element,f),t=(h-n*o)/2,"Min"===e.alignX&&(s=-t),"Max"===e.alignX&&(s=t),t=(d-i*a)/2,"Min"===e.alignY&&(c=-t),"Max"===e.alignY&&(c=t)),"slice"===e.meetOrSlice&&(o=a=r.util.findScaleToCover(this._element,f),t=n-h/o,"Mid"===e.alignX&&(l=t/2),"Max"===e.alignX&&(l=t),t=i-d/a,"Mid"===e.alignY&&(u=t/2),"Max"===e.alignY&&(u=t),n=h/o,i=d/a)),{width:n,height:i,scaleX:o,scaleY:a,offsetLeft:s,offsetTop:c,cropX:l,cropY:u}}}),r.Image.CSS_CANVAS="canvas-img",r.Image.prototype.getSvgSrc=r.Image.prototype.getSrc,r.Image.fromObject=function(t,e){var n=r.util.object.clone(t);r.util.loadImage(n.src,(function(t,i){i?e&&e(null,!0):r.Image.prototype._initFilters.call(n,n.filters,(function(i){n.filters=i||[],r.Image.prototype._initFilters.call(n,[n.resizeFilter],(function(i){n.resizeFilter=i[0],r.util.enlivenObjectEnlivables(n,n,(function(){var i=new r.Image(t,n);e(i,!1)}))}))}))}),null,n.crossOrigin)},r.Image.fromURL=function(t,e,n){r.util.loadImage(t,(function(t,i){e&&e(new r.Image(t,n),i)}),null,n&&n.crossOrigin)},r.Image.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),r.Image.fromElement=function(t,n,i){var o=r.parseAttributes(t,r.Image.ATTRIBUTE_NAMES);r.Image.fromURL(o["xlink:href"],n,e(i?r.util.object.clone(i):{},o))})}(e),r.util.object.extend(r.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.angle%360;return t>0?90*Math.round((t-1)/90):90*Math.round(t/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(t){t=t||{};var e=function(){},n=t.onComplete||e,i=t.onChange||e,o=this;return r.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(t){o.rotate(t),i()},onComplete:function(){o.setCoords(),n()}})}}),r.util.object.extend(r.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){"use strict";function t(t,e){var n="precision "+e+" float;\nvoid main(){}",r=t.createShader(t.FRAGMENT_SHADER);return t.shaderSource(r,n),t.compileShader(r),!!t.getShaderParameter(r,t.COMPILE_STATUS)}function e(t){t&&t.tileSize&&(this.tileSize=t.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}r.isWebglSupported=function(e){if(r.isLikelyNode)return!1;e=e||r.WebglFilterBackend.prototype.tileSize;var n=document.createElement("canvas"),i=n.getContext("webgl")||n.getContext("experimental-webgl"),o=!1;if(i){r.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),o=r.maxTextureSize>=e;for(var a=["highp","mediump","lowp"],s=0;s<3;s++)if(t(i,a[s])){r.webGlPrecision=a[s];break}}return this.isSupported=o,o},r.WebglFilterBackend=e,e.prototype={tileSize:2048,resources:{},setupGLContext:function(t,e){this.dispose(),this.createWebGLCanvas(t,e),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(t,e)},chooseFastestCopyGLTo2DMethod:function(t,e){var n,i="undefined"!==typeof window.performance;try{new ImageData(1,1),n=!0}catch(g){n=!1}var o="undefined"!==typeof ArrayBuffer,a="undefined"!==typeof Uint8ClampedArray;if(i&&n&&o&&a){var l=r.util.createCanvasElement(),u=new ArrayBuffer(t*e*4);if(r.forceGLPutImageData)return this.imageBuffer=u,void(this.copyGLTo2D=c);var h,d,f,p={imageBuffer:u,destinationWidth:t,destinationHeight:e,targetCanvas:l};l.width=t,l.height=e,h=window.performance.now(),s.call(p,this.gl,p),d=window.performance.now()-h,h=window.performance.now(),c.call(p,this.gl,p),f=window.performance.now()-h,d>f?(this.imageBuffer=u,this.copyGLTo2D=c):this.copyGLTo2D=s}},createWebGLCanvas:function(t,e){var n=r.util.createCanvasElement();n.width=t,n.height=e;var i={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},o=n.getContext("webgl",i);o||(o=n.getContext("experimental-webgl",i)),o&&(o.clearColor(0,0,0,0),this.canvas=n,this.gl=o)},applyFilters:function(t,e,n,r,i,o){var s,c=this.gl;o&&(s=this.getCachedTexture(o,e));var l={originalWidth:e.width||e.originalWidth,originalHeight:e.height||e.originalHeight,sourceWidth:n,sourceHeight:r,destinationWidth:n,destinationHeight:r,context:c,sourceTexture:this.createTexture(c,n,r,!s&&e),targetTexture:this.createTexture(c,n,r),originalTexture:s||this.createTexture(c,n,r,!s&&e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},u=c.createFramebuffer();return c.bindFramebuffer(c.FRAMEBUFFER,u),t.forEach((function(t){t&&t.applyTo(l)})),a(l),this.copyGLTo2D(c,l),c.bindTexture(c.TEXTURE_2D,null),c.deleteTexture(l.sourceTexture),c.deleteTexture(l.targetTexture),c.deleteFramebuffer(u),i.getContext("2d").setTransform(1,0,0,1,0,0),l},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(t,e,n,r){var i=t.createTexture();return t.bindTexture(t.TEXTURE_2D,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,n,0,t.RGBA,t.UNSIGNED_BYTE,null),i},getCachedTexture:function(t,e){if(this.textureCache[t])return this.textureCache[t];var n=this.createTexture(this.gl,e.width,e.height,e);return this.textureCache[t]=n,n},evictCachesForKey:function(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])},copyGLTo2D:s,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var t=this.gl,e={renderer:"",vendor:""};if(!t)return e;var n=t.getExtension("WEBGL_debug_renderer_info");if(n){var r=t.getParameter(n.UNMASKED_RENDERER_WEBGL),i=t.getParameter(n.UNMASKED_VENDOR_WEBGL);r&&(e.renderer=r.toLowerCase()),i&&(e.vendor=i.toLowerCase())}return this.gpuInfo=e,e}}}(),function(){"use strict";var t=function(){};function e(){}r.Canvas2dFilterBackend=e,e.prototype={evictCachesForKey:t,dispose:t,clearWebGLCaches:t,resources:{},applyFilters:function(t,e,n,r,i){var o=i.getContext("2d");o.drawImage(e,0,0,n,r);var a=o.getImageData(0,0,n,r),s=o.getImageData(0,0,n,r),c={sourceWidth:n,sourceHeight:r,imageData:a,originalEl:e,originalImageData:s,canvasEl:i,ctx:o,filterBackend:this};return t.forEach((function(t){t.applyTo(c)})),c.imageData.width===n&&c.imageData.height===r||(i.width=c.imageData.width,i.height=c.imageData.height),o.putImageData(c.imageData,0,0),c}}}(),r.Image=r.Image||{},r.Image.filters=r.Image.filters||{},r.Image.filters.BaseFilter=r.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},createProgram:function(t,e,n){e=e||this.fragmentSource,n=n||this.vertexSource,"highp"!==r.webGlPrecision&&(e=e.replace(/precision highp float/g,"precision "+r.webGlPrecision+" float"));var i=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(i,n),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+t.getShaderInfoLog(i));var o=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(o,e),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+t.getShaderInfoLog(o));var a=t.createProgram();if(t.attachShader(a,i),t.attachShader(a,o),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+t.getProgramInfoLog(a));var s=this.getAttributeLocations(t,a),c=this.getUniformLocations(t,a)||{};return c.uStepW=t.getUniformLocation(a,"uStepW"),c.uStepH=t.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:s,uniformLocations:c}},getAttributeLocations:function(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(t,e,n){var r=e.aPosition,i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)},_setupFrameBuffer:function(t){var e,n,r=t.context;t.passes>1?(e=t.destinationWidth,n=t.destinationHeight,t.sourceWidth===e&&t.sourceHeight===n||(r.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(r,e,n)),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t.targetTexture,0)):(r.bindFramebuffer(r.FRAMEBUFFER,null),r.finish())},_swapTextures:function(t){t.passes--,t.pass++;var e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e},isNeutralState:function(){var t=this.mainParameter,e=r.Image.filters[this.type].prototype;if(t){if(Array.isArray(e[t])){for(var n=e[t].length;n--;)if(this[t][n]!==e[t][n])return!1;return!0}return e[t]===this[t]}return!1},applyTo:function(t){t.webgl?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},retrieveShader:function(t){return t.programCache.hasOwnProperty(this.type)||(t.programCache[this.type]=this.createProgram(t.context)),t.programCache[this.type]},applyToWebGL:function(t){var e=t.context,n=this.retrieveShader(t);0===t.pass&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(n.program),this.sendAttributeData(e,n.attributeLocations,t.aPosition),e.uniform1f(n.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(n.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,n.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(t,e,n){t.activeTexture(n),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)},unbindAdditionalTexture:function(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(t){this[this.mainParameter]=t},sendUniformData:function(){},createHelpLayer:function(t){if(!t.helpLayer){var e=document.createElement("canvas");e.width=t.sourceWidth,e.height=t.sourceHeight,t.helpLayer=e}},toObject:function(){var t={type:this.type},e=this.mainParameter;return e&&(t[e]=this[e]),t},toJSON:function(){return this.toObject()}}),r.Image.filters.BaseFilter.fromObject=function(t,e){var n=new r.Image.filters[t.type](t);return e&&e(n),n},function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.ColorMatrix=r(n.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(t){this.callSuper("initialize",t),this.matrix=this.matrix.slice(0)},applyTo2d:function(t){var e,n,r,i,o,a=t.imageData,s=a.data,c=s.length,l=this.matrix,u=this.colorsOnly;for(o=0;o<c;o+=4)e=s[o],n=s[o+1],r=s[o+2],u?(s[o]=e*l[0]+n*l[1]+r*l[2]+255*l[4],s[o+1]=e*l[5]+n*l[6]+r*l[7]+255*l[9],s[o+2]=e*l[10]+n*l[11]+r*l[12]+255*l[14]):(i=s[o+3],s[o]=e*l[0]+n*l[1]+r*l[2]+i*l[3]+255*l[4],s[o+1]=e*l[5]+n*l[6]+r*l[7]+i*l[8]+255*l[9],s[o+2]=e*l[10]+n*l[11]+r*l[12]+i*l[13]+255*l[14],s[o+3]=e*l[15]+n*l[16]+r*l[17]+i*l[18]+255*l[19])},getUniformLocations:function(t,e){return{uColorMatrix:t.getUniformLocation(e,"uColorMatrix"),uConstants:t.getUniformLocation(e,"uConstants")}},sendUniformData:function(t,e){var n=this.matrix,r=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],i=[n[4],n[9],n[14],n[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,r),t.uniform4fv(e.uConstants,i)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Brightness=r(n.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(t){if(0!==this.brightness){var e,n=t.imageData,r=n.data,i=r.length,o=Math.round(255*this.brightness);for(e=0;e<i;e+=4)r[e]=r[e]+o,r[e+1]=r[e+1]+o,r[e+2]=r[e+2]+o}},getUniformLocations:function(t,e){return{uBrightness:t.getUniformLocation(e,"uBrightness")}},sendUniformData:function(t,e){t.uniform1f(e.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,r=e.Image.filters,i=e.util.createClass;r.Convolute=i(r.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(t){var e=Math.sqrt(this.matrix.length),n=this.type+"_"+e+"_"+(this.opaque?1:0),r=this.fragmentSource[n];return t.programCache.hasOwnProperty(n)||(t.programCache[n]=this.createProgram(t.context,r)),t.programCache[n]},applyTo2d:function(t){var e,n,r,i,o,a,s,c,l,u,h,d,f,p=t.imageData,g=p.data,v=this.matrix,m=Math.round(Math.sqrt(v.length)),b=Math.floor(m/2),y=p.width,S=p.height,w=t.ctx.createImageData(y,S),E=w.data,C=this.opaque?1:0;for(h=0;h<S;h++)for(u=0;u<y;u++){for(o=4*(h*y+u),e=0,n=0,r=0,i=0,f=0;f<m;f++)for(d=0;d<m;d++)s=h+f-b,a=u+d-b,s<0||s>=S||a<0||a>=y||(c=4*(s*y+a),l=v[f*m+d],e+=g[c]*l,n+=g[c+1]*l,r+=g[c+2]*l,C||(i+=g[c+3]*l));E[o]=e,E[o+1]=n,E[o+2]=r,E[o+3]=C?g[o+3]:i}t.imageData=w},getUniformLocations:function(t,e){return{uMatrix:t.getUniformLocation(e,"uMatrix"),uOpaque:t.getUniformLocation(e,"uOpaque"),uHalfSize:t.getUniformLocation(e,"uHalfSize"),uSize:t.getUniformLocation(e,"uSize")}},sendUniformData:function(t,e){t.uniform1fv(e.uMatrix,this.matrix)},toObject:function(){return n(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Grayscale=r(n.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(t){var e,n,r=t.imageData,i=r.data,o=i.length,a=this.mode;for(e=0;e<o;e+=4)"average"===a?n=(i[e]+i[e+1]+i[e+2])/3:"lightness"===a?n=(Math.min(i[e],i[e+1],i[e+2])+Math.max(i[e],i[e+1],i[e+2]))/2:"luminosity"===a&&(n=.21*i[e]+.72*i[e+1]+.07*i[e+2]),i[e]=n,i[e+1]=n,i[e+2]=n},retrieveShader:function(t){var e=this.type+"_"+this.mode;if(!t.programCache.hasOwnProperty(e)){var n=this.fragmentSource[this.mode];t.programCache[e]=this.createProgram(t.context,n)}return t.programCache[e]},getUniformLocations:function(t,e){return{uMode:t.getUniformLocation(e,"uMode")}},sendUniformData:function(t,e){var n=1;t.uniform1i(e.uMode,n)},isNeutralState:function(){return!1}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Invert=r(n.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(t){var e,n=t.imageData,r=n.data,i=r.length;for(e=0;e<i;e+=4)r[e]=255-r[e],r[e+1]=255-r[e+1],r[e+2]=255-r[e+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(t,e){return{uInvert:t.getUniformLocation(e,"uInvert")}},sendUniformData:function(t,e){t.uniform1i(e.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,r=e.Image.filters,i=e.util.createClass;r.Noise=i(r.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(t){if(0!==this.noise){var e,n,r=t.imageData,i=r.data,o=i.length,a=this.noise;for(e=0,o=i.length;e<o;e+=4)n=(.5-Math.random())*a,i[e]+=n,i[e+1]+=n,i[e+2]+=n}},getUniformLocations:function(t,e){return{uNoise:t.getUniformLocation(e,"uNoise"),uSeed:t.getUniformLocation(e,"uSeed")}},sendUniformData:function(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())},toObject:function(){return n(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Pixelate=r(n.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(t){var e,n,r,i,o,a,s,c,l,u,h,d=t.imageData,f=d.data,p=d.height,g=d.width;for(n=0;n<p;n+=this.blocksize)for(r=0;r<g;r+=this.blocksize)for(e=4*n*g+4*r,i=f[e],o=f[e+1],a=f[e+2],s=f[e+3],u=Math.min(n+this.blocksize,p),h=Math.min(r+this.blocksize,g),c=n;c<u;c++)for(l=r;l<h;l++)e=4*c*g+4*l,f[e]=i,f[e+1]=o,f[e+2]=a,f[e+3]=s},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(t,e){return{uBlocksize:t.getUniformLocation(e,"uBlocksize"),uStepW:t.getUniformLocation(e,"uStepW"),uStepH:t.getUniformLocation(e,"uStepH")}},sendUniformData:function(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,r=e.Image.filters,i=e.util.createClass;r.RemoveColor=i(r.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(t){var n,r,i,o,a=t.imageData,s=a.data,c=255*this.distance,l=new e.Color(this.color).getSource(),u=[l[0]-c,l[1]-c,l[2]-c],h=[l[0]+c,l[1]+c,l[2]+c];for(n=0;n<s.length;n+=4)r=s[n],i=s[n+1],o=s[n+2],r>u[0]&&i>u[1]&&o>u[2]&&r<h[0]&&i<h[1]&&o<h[2]&&(s[n+3]=0)},getUniformLocations:function(t,e){return{uLow:t.getUniformLocation(e,"uLow"),uHigh:t.getUniformLocation(e,"uHigh")}},sendUniformData:function(t,n){var r=new e.Color(this.color).getSource(),i=parseFloat(this.distance),o=[0+r[0]/255-i,0+r[1]/255-i,0+r[2]/255-i,1],a=[r[0]/255+i,r[1]/255+i,r[2]/255+i,1];t.uniform4fv(n.uLow,o),t.uniform4fv(n.uHigh,a)},toObject:function(){return n(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),e.Image.filters.RemoveColor.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass,i={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var o in i)n[o]=r(n.ColorMatrix,{type:o,matrix:i[o],mainParameter:!1,colorsOnly:!0}),e.Image.filters[o].fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric,n=e.Image.filters,r=e.util.createClass;n.BlendColor=r(n.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(t){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[t]+"}\n}"},retrieveShader:function(t){var e,n=this.type+"_"+this.mode;return t.programCache.hasOwnProperty(n)||(e=this.buildSource(this.mode),t.programCache[n]=this.createProgram(t.context,e)),t.programCache[n]},applyTo2d:function(t){var n,r,i,o,a,s,c,l=t.imageData,u=l.data,h=u.length,d=1-this.alpha;c=new e.Color(this.color).getSource(),n=c[0]*this.alpha,r=c[1]*this.alpha,i=c[2]*this.alpha;for(var f=0;f<h;f+=4)switch(o=u[f],a=u[f+1],s=u[f+2],this.mode){case"multiply":u[f]=o*n/255,u[f+1]=a*r/255,u[f+2]=s*i/255;break;case"screen":u[f]=255-(255-o)*(255-n)/255,u[f+1]=255-(255-a)*(255-r)/255,u[f+2]=255-(255-s)*(255-i)/255;break;case"add":u[f]=o+n,u[f+1]=a+r,u[f+2]=s+i;break;case"diff":case"difference":u[f]=Math.abs(o-n),u[f+1]=Math.abs(a-r),u[f+2]=Math.abs(s-i);break;case"subtract":u[f]=o-n,u[f+1]=a-r,u[f+2]=s-i;break;case"darken":u[f]=Math.min(o,n),u[f+1]=Math.min(a,r),u[f+2]=Math.min(s,i);break;case"lighten":u[f]=Math.max(o,n),u[f+1]=Math.max(a,r),u[f+2]=Math.max(s,i);break;case"overlay":u[f]=n<128?2*o*n/255:255-2*(255-o)*(255-n)/255,u[f+1]=r<128?2*a*r/255:255-2*(255-a)*(255-r)/255,u[f+2]=i<128?2*s*i/255:255-2*(255-s)*(255-i)/255;break;case"exclusion":u[f]=n+o-2*n*o/255,u[f+1]=r+a-2*r*a/255,u[f+2]=i+s-2*i*s/255;break;case"tint":u[f]=n+o*d,u[f+1]=r+a*d,u[f+2]=i+s*d}},getUniformLocations:function(t,e){return{uColor:t.getUniformLocation(e,"uColor")}},sendUniformData:function(t,n){var r=new e.Color(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,t.uniform4fv(n.uColor,r)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendColor.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric,n=e.Image.filters,r=e.util.createClass;n.BlendImage=r(n.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(t){var e=this.type+"_"+this.mode,n=this.fragmentSource[this.mode];return t.programCache.hasOwnProperty(e)||(t.programCache[e]=this.createProgram(t.context,n)),t.programCache[e]},applyToWebGL:function(t){var e=t.context,n=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,n,e.TEXTURE1),this.callSuper("applyToWebGL",t),this.unbindAdditionalTexture(e,e.TEXTURE1)},createTexture:function(t,e){return t.getCachedTexture(e.cacheKey,e._element)},calculateMatrix:function(){var t=this.image,e=t._element.width,n=t._element.height;return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/n,1]},applyTo2d:function(t){var n,r,i,o,a,s,c,l,u,h,d,f=t.imageData,p=t.filterBackend.resources,g=f.data,v=g.length,m=f.width,b=f.height,y=this.image;p.blendImage||(p.blendImage=e.util.createCanvasElement()),u=p.blendImage,h=u.getContext("2d"),u.width!==m||u.height!==b?(u.width=m,u.height=b):h.clearRect(0,0,m,b),h.setTransform(y.scaleX,0,0,y.scaleY,y.left,y.top),h.drawImage(y._element,0,0,m,b),d=h.getImageData(0,0,m,b).data;for(var S=0;S<v;S+=4)switch(a=g[S],s=g[S+1],c=g[S+2],l=g[S+3],n=d[S],r=d[S+1],i=d[S+2],o=d[S+3],this.mode){case"multiply":g[S]=a*n/255,g[S+1]=s*r/255,g[S+2]=c*i/255,g[S+3]=l*o/255;break;case"mask":g[S+3]=o;break}},getUniformLocations:function(t,e){return{uTransformMatrix:t.getUniformLocation(e,"uTransformMatrix"),uImage:t.getUniformLocation(e,"uImage")}},sendUniformData:function(t,e){var n=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,n)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendImage.fromObject=function(t,n){e.Image.fromObject(t.image,(function(r){var i=e.util.object.clone(t);i.image=r,n(new e.Image.filters.BlendImage(i))}))}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=Math.pow,r=Math.floor,i=Math.sqrt,o=Math.abs,a=Math.round,s=Math.sin,c=Math.ceil,l=e.Image.filters,u=e.util.createClass;l.Resize=u(l.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(t,e){return{uDelta:t.getUniformLocation(e,"uDelta"),uTaps:t.getUniformLocation(e,"uTaps")}},sendUniformData:function(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)},retrieveShader:function(t){var e=this.getFilterWindow(),n=this.type+"_"+e;if(!t.programCache.hasOwnProperty(n)){var r=this.generateShader(e);t.programCache[n]=this.createProgram(t.context,r)}return t.programCache[n]},getFilterWindow:function(){var t=this.tempScale;return Math.ceil(this.lanczosLobes/t)},getTaps:function(){for(var t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,n=this.getFilterWindow(),r=new Array(n),i=1;i<=n;i++)r[i-1]=t(i*e);return r},generateShader:function(t){for(var e=new Array(t),n=this.fragmentSourceTOP,r=1;r<=t;r++)e[r-1]=r+".0 * uDelta";return n+="uniform float uTaps["+t+"];\n",n+="void main() {\n",n+="  vec4 color = texture2D(uTexture, vTexCoord);\n",n+="  float sum = 1.0;\n",e.forEach((function(t,e){n+="  color += texture2D(uTexture, vTexCoord + "+t+") * uTaps["+e+"];\n",n+="  color += texture2D(uTexture, vTexCoord - "+t+") * uTaps["+e+"];\n",n+="  sum += 2.0 * uTaps["+e+"];\n"})),n+="  gl_FragColor = color / sum;\n",n+="}",n},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(t){t.webgl?(t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceHeight=t.destinationHeight):this.applyTo2d(t)},isNeutralState:function(){return 1===this.scaleX&&1===this.scaleY},lanczosCreate:function(t){return function(e){if(e>=t||e<=-t)return 0;if(e<1.1920929e-7&&e>-1.1920929e-7)return 1;e*=Math.PI;var n=e/t;return s(e)/e*s(n)/n}},applyTo2d:function(t){var e=t.imageData,n=this.scaleX,r=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/r;var i,o=e.width,s=e.height,c=a(o*n),l=a(s*r);"sliceHack"===this.resizeType?i=this.sliceByTwo(t,o,s,c,l):"hermite"===this.resizeType?i=this.hermiteFastResize(t,o,s,c,l):"bilinear"===this.resizeType?i=this.bilinearFiltering(t,o,s,c,l):"lanczos"===this.resizeType&&(i=this.lanczosResize(t,o,s,c,l)),t.imageData=i},sliceByTwo:function(t,n,i,o,a){var s,c,l=t.imageData,u=.5,h=!1,d=!1,f=n*u,p=i*u,g=e.filterBackend.resources,v=0,m=0,b=n,y=0;g.sliceByTwo||(g.sliceByTwo=document.createElement("canvas")),s=g.sliceByTwo,(s.width<1.5*n||s.height<i)&&(s.width=1.5*n,s.height=i),c=s.getContext("2d"),c.clearRect(0,0,1.5*n,i),c.putImageData(l,0,0),o=r(o),a=r(a);while(!h||!d)n=f,i=p,o<r(f*u)?f=r(f*u):(f=o,h=!0),a<r(p*u)?p=r(p*u):(p=a,d=!0),c.drawImage(s,v,m,n,i,b,y,f,p),v=b,m=y,y+=p;return c.getImageData(v,m,o,a)},lanczosResize:function(t,e,a,s,l){function u(t){var c,x,O,_,T,k,I,P,j,M,D;for(E.x=(t+.5)*g,C.x=r(E.x),c=0;c<l;c++){for(E.y=(c+.5)*v,C.y=r(E.y),T=0,k=0,I=0,P=0,j=0,x=C.x-y;x<=C.x+y;x++)if(!(x<0||x>=e)){M=r(1e3*o(x-E.x)),w[M]||(w[M]={});for(var R=C.y-S;R<=C.y+S;R++)R<0||R>=a||(D=r(1e3*o(R-E.y)),w[M][D]||(w[M][D]=p(i(n(M*m,2)+n(D*b,2))/1e3)),O=w[M][D],O>0&&(_=4*(R*e+x),T+=O,k+=O*h[_],I+=O*h[_+1],P+=O*h[_+2],j+=O*h[_+3]))}_=4*(c*s+t),f[_]=k/T,f[_+1]=I/T,f[_+2]=P/T,f[_+3]=j/T}return++t<s?u(t):d}var h=t.imageData.data,d=t.ctx.createImageData(s,l),f=d.data,p=this.lanczosCreate(this.lanczosLobes),g=this.rcpScaleX,v=this.rcpScaleY,m=2/this.rcpScaleX,b=2/this.rcpScaleY,y=c(g*this.lanczosLobes/2),S=c(v*this.lanczosLobes/2),w={},E={},C={};return u(0)},bilinearFiltering:function(t,e,n,i,o){var a,s,c,l,u,h,d,f,p,g,v,m,b,y=0,S=this.rcpScaleX,w=this.rcpScaleY,E=4*(e-1),C=t.imageData,x=C.data,O=t.ctx.createImageData(i,o),_=O.data;for(d=0;d<o;d++)for(f=0;f<i;f++)for(u=r(S*f),h=r(w*d),p=S*f-u,g=w*d-h,b=4*(h*e+u),v=0;v<4;v++)a=x[b+v],s=x[b+4+v],c=x[b+E+v],l=x[b+E+4+v],m=a*(1-p)*(1-g)+s*p*(1-g)+c*g*(1-p)+l*p*g,_[y++]=m;return O},hermiteFastResize:function(t,e,n,a,s){for(var l=this.rcpScaleX,u=this.rcpScaleY,h=c(l/2),d=c(u/2),f=t.imageData,p=f.data,g=t.ctx.createImageData(a,s),v=g.data,m=0;m<s;m++)for(var b=0;b<a;b++){for(var y=4*(b+m*a),S=0,w=0,E=0,C=0,x=0,O=0,_=0,T=(m+.5)*u,k=r(m*u);k<(m+1)*u;k++)for(var I=o(T-(k+.5))/d,P=(b+.5)*l,j=I*I,M=r(b*l);M<(b+1)*l;M++){var D=o(P-(M+.5))/h,R=i(j+D*D);R>1&&R<-1||(S=2*R*R*R-3*R*R+1,S>0&&(D=4*(M+k*e),_+=S*p[D+3],E+=S,p[D+3]<255&&(S=S*p[D+3]/250),C+=S*p[D],x+=S*p[D+1],O+=S*p[D+2],w+=S))}v[y]=C/w,v[y+1]=x/w,v[y+2]=O/w,v[y+3]=_/E}return g},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Contrast=r(n.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(t){if(0!==this.contrast){var e,n=t.imageData,r=n.data,i=r.length,o=Math.floor(255*this.contrast),a=259*(o+255)/(255*(259-o));for(e=0;e<i;e+=4)r[e]=a*(r[e]-128)+128,r[e+1]=a*(r[e+1]-128)+128,r[e+2]=a*(r[e+2]-128)+128}},getUniformLocations:function(t,e){return{uContrast:t.getUniformLocation(e,"uContrast")}},sendUniformData:function(t,e){t.uniform1f(e.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Saturation=r(n.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(t){if(0!==this.saturation){var e,n,r=t.imageData,i=r.data,o=i.length,a=-this.saturation;for(e=0;e<o;e+=4)n=Math.max(i[e],i[e+1],i[e+2]),i[e]+=n!==i[e]?(n-i[e])*a:0,i[e+1]+=n!==i[e+1]?(n-i[e+1])*a:0,i[e+2]+=n!==i[e+2]?(n-i[e+2])*a:0}},getUniformLocations:function(t,e){return{uSaturation:t.getUniformLocation(e,"uSaturation")}},sendUniformData:function(t,e){t.uniform1f(e.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Vibrance=r(n.BaseFilter,{type:"Vibrance",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uVibrance;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat max = max(color.r, max(color.g, color.b));\nfloat avg = (color.r + color.g + color.b) / 3.0;\nfloat amt = (abs(max - avg) * 2.0) * uVibrance;\ncolor.r += max != color.r ? (max - color.r) * amt : 0.00;\ncolor.g += max != color.g ? (max - color.g) * amt : 0.00;\ncolor.b += max != color.b ? (max - color.b) * amt : 0.00;\ngl_FragColor = color;\n}",vibrance:0,mainParameter:"vibrance",applyTo2d:function(t){if(0!==this.vibrance){var e,n,r,i,o=t.imageData,a=o.data,s=a.length,c=-this.vibrance;for(e=0;e<s;e+=4)n=Math.max(a[e],a[e+1],a[e+2]),r=(a[e]+a[e+1]+a[e+2])/3,i=2*Math.abs(n-r)/255*c,a[e]+=n!==a[e]?(n-a[e])*i:0,a[e+1]+=n!==a[e+1]?(n-a[e+1])*i:0,a[e+2]+=n!==a[e+2]?(n-a[e+2])*i:0}},getUniformLocations:function(t,e){return{uVibrance:t.getUniformLocation(e,"uVibrance")}},sendUniformData:function(t,e){t.uniform1f(e.uVibrance,-this.vibrance)}}),e.Image.filters.Vibrance.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Blur=r(n.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(t){t.webgl?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},applyTo2d:function(t){t.imageData=this.simpleBlur(t)},simpleBlur:function(t){var n,r,i=t.filterBackend.resources,o=t.imageData.width,a=t.imageData.height;i.blurLayer1||(i.blurLayer1=e.util.createCanvasElement(),i.blurLayer2=e.util.createCanvasElement()),n=i.blurLayer1,r=i.blurLayer2,n.width===o&&n.height===a||(r.width=n.width=o,r.height=n.height=a);var s,c,l,u,h=n.getContext("2d"),d=r.getContext("2d"),f=15,p=.06*this.blur*.5;for(h.putImageData(t.imageData,0,0),d.clearRect(0,0,o,a),u=-f;u<=f;u++)s=(Math.random()-.5)/4,c=u/f,l=p*c*o+s,d.globalAlpha=1-Math.abs(c),d.drawImage(n,l,s),h.drawImage(r,0,0),d.globalAlpha=1,d.clearRect(0,0,r.width,r.height);for(u=-f;u<=f;u++)s=(Math.random()-.5)/4,c=u/f,l=p*c*a+s,d.globalAlpha=1-Math.abs(c),d.drawImage(n,s,l),h.drawImage(r,0,0),d.globalAlpha=1,d.clearRect(0,0,r.width,r.height);t.ctx.drawImage(n,0,0);var g=t.ctx.getImageData(0,0,n.width,n.height);return h.globalAlpha=1,h.clearRect(0,0,n.width,n.height),g},getUniformLocations:function(t,e){return{delta:t.getUniformLocation(e,"uDelta")}},sendUniformData:function(t,e){var n=this.chooseRightDelta();t.uniform2fv(e.delta,n)},chooseRightDelta:function(){var t,e=1,n=[0,0];return this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio),t=e*this.blur*.12,this.horizontal?n[0]=t:n[1]=t,n}}),n.Blur.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Gamma=r(n.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(t){this.gamma=[1,1,1],n.BaseFilter.prototype.initialize.call(this,t)},applyTo2d:function(t){var e,n=t.imageData,r=n.data,i=this.gamma,o=r.length,a=1/i[0],s=1/i[1],c=1/i[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),e=0,o=256;e<o;e++)this.rVals[e]=255*Math.pow(e/255,a),this.gVals[e]=255*Math.pow(e/255,s),this.bVals[e]=255*Math.pow(e/255,c);for(e=0,o=r.length;e<o;e+=4)r[e]=this.rVals[r[e]],r[e+1]=this.gVals[r[e+1]],r[e+2]=this.bVals[r[e+2]]},getUniformLocations:function(t,e){return{uGamma:t.getUniformLocation(e,"uGamma")}},sendUniformData:function(t,e){t.uniform3fv(e.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Composed=r(n.BaseFilter,{type:"Composed",subFilters:[],initialize:function(t){this.callSuper("initialize",t),this.subFilters=this.subFilters.slice(0)},applyTo:function(t){t.passes+=this.subFilters.length-1,this.subFilters.forEach((function(e){e.applyTo(t)}))},toObject:function(){return e.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map((function(t){return t.toObject()}))})},isNeutralState:function(){return!this.subFilters.some((function(t){return!t.isNeutralState()}))}}),e.Image.filters.Composed.fromObject=function(t,n){var r=t.subFilters||[],i=r.map((function(t){return new e.Image.filters[t.type](t)})),o=new e.Image.filters.Composed({subFilters:i});return n&&n(o),o}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.HueRotation=r(n.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var t=this.rotation*Math.PI,n=e.util.cos(t),r=e.util.sin(t),i=1/3,o=Math.sqrt(i)*r,a=1-n;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=n+a/3,this.matrix[1]=i*a-o,this.matrix[2]=i*a+o,this.matrix[5]=i*a+o,this.matrix[6]=n+i*a,this.matrix[7]=i*a-o,this.matrix[10]=i*a-o,this.matrix[11]=i*a+o,this.matrix[12]=n+i*a},isNeutralState:function(t){return this.calculateMatrix(),n.BaseFilter.prototype.isNeutralState.call(this,t)},applyTo:function(t){this.calculateMatrix(),n.BaseFilter.prototype.applyTo.call(this,t)}}),e.Image.filters.HueRotation.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.clone;if(e.Text)e.warn("fabric.Text is already defined");else{var r="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:e.Object.prototype.stateProperties.concat(r),cacheProperties:e.Object.prototype.cacheProperties.concat(r),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(t,e){this.styles=e&&e.styles||{},this.text=t,this.__skipDimension=!0,this.callSuper("initialize",e),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var t=this.path;t&&(t.segmentsInfo=e.util.getPathSegmentsInfo(t.path))},getMeasuringContext:function(){return e._measuringContext||(e._measuringContext=this.canvas&&this.canvas.contextCache||e.util.createCanvasElement().getContext("2d")),e._measuringContext},_splitText:function(){var t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var t,e,n,r,i,o,a,s=0,c=this._textLines.length;s<c;s++)if(("justify"===this.textAlign||s!==c-1&&!this.isEndOfWrapping(s))&&(r=0,i=this._textLines[s],e=this.getLineWidth(s),e<this.width&&(a=this.textLines[s].match(this._reSpacesAndTabs)))){n=a.length,t=(this.width-e)/n;for(var l=0,u=i.length;l<=u;l++)o=this.__charBounds[s][l],this._reSpaceAndTab.test(i[l])?(o.width+=t,o.kernedWidth+=t,o.left+=r,r+=t):o.left+=r}},isEndOfWrapping:function(t){return t===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var t=this.callSuper("_getCacheCanvasDimensions"),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t},_render:function(t){var e=this.path;e&&!e.isNotVisible()&&e._render(t),this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")},_renderText:function(t){"stroke"===this.paintFirst?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))},_setTextStyles:function(t,e,n){if(t.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":t.textBaseline="middle";break;case"ascender":t.textBaseline="top";break;case"descender":t.textBaseline="bottom";break}t.font=this._getFontDeclaration(e,n)},calcTextWidth:function(){for(var t=this.getLineWidth(0),e=1,n=this._textLines.length;e<n;e++){var r=this.getLineWidth(e);r>t&&(t=r)}return t},_renderTextLine:function(t,e,n,r,i,o){this._renderChars(t,e,n,r,i,o)},_renderTextLinesBackground:function(t){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var e,n,r,i,o,a,s,c=t.fillStyle,l=this._getLeftOffset(),u=this._getTopOffset(),h=0,d=0,f=this.path,p=0,g=this._textLines.length;p<g;p++)if(e=this.getHeightOfLine(p),this.textBackgroundColor||this.styleHas("textBackgroundColor",p)){r=this._textLines[p],n=this._getLineLeftOffset(p),d=0,h=0,i=this.getValueOfPropertyAt(p,0,"textBackgroundColor");for(var v=0,m=r.length;v<m;v++)o=this.__charBounds[p][v],a=this.getValueOfPropertyAt(p,v,"textBackgroundColor"),f?(t.save(),t.translate(o.renderLeft,o.renderTop),t.rotate(o.angle),t.fillStyle=a,a&&t.fillRect(-o.width/2,-e/this.lineHeight*(1-this._fontSizeFraction),o.width,e/this.lineHeight),t.restore()):a!==i?(s=l+n+h,"rtl"===this.direction&&(s=this.width-s-d),t.fillStyle=i,i&&t.fillRect(s,u,d,e/this.lineHeight),h=o.left,d=o.width,i=a):d+=o.kernedWidth;a&&!f&&(s=l+n+h,"rtl"===this.direction&&(s=this.width-s-d),t.fillStyle=a,t.fillRect(s,u,d,e/this.lineHeight)),u+=e}else u+=e;t.fillStyle=c,this._removeShadow(t)}},getFontCache:function(t){var n=t.fontFamily.toLowerCase();e.charWidthsCache[n]||(e.charWidthsCache[n]={});var r=e.charWidthsCache[n],i=t.fontStyle.toLowerCase()+"_"+(t.fontWeight+"").toLowerCase();return r[i]||(r[i]={}),r[i]},_measureChar:function(t,e,n,r){var i,o,a,s,c=this.getFontCache(e),l=this._getFontDeclaration(e),u=this._getFontDeclaration(r),h=n+t,d=l===u,f=e.fontSize/this.CACHE_FONT_SIZE;if(n&&void 0!==c[n]&&(a=c[n]),void 0!==c[t]&&(s=i=c[t]),d&&void 0!==c[h]&&(o=c[h],s=o-a),void 0===i||void 0===a||void 0===o){var p=this.getMeasuringContext();this._setTextStyles(p,e,!0)}return void 0===i&&(s=i=p.measureText(t).width,c[t]=i),void 0===a&&d&&n&&(a=p.measureText(n).width,c[n]=a),d&&void 0===o&&(o=p.measureText(h).width,c[h]=o,s=o-a),{width:i*f,kernedWidth:s*f}},getHeightOfChar:function(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")},measureLine:function(t){var e=this._measureLine(t);return 0!==this.charSpacing&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e},_measureLine:function(t){var n,r,i,o,a,s,c=0,l=this._textLines[t],u=0,h=new Array(l.length),d=0,f=this.path,p="right"===this.pathSide;for(this.__charBounds[t]=h,n=0;n<l.length;n++)r=l[n],o=this._getGraphemeBox(r,t,n,i),h[n]=o,c+=o.kernedWidth,i=r;if(h[n]={left:o?o.left+o.width:0,width:0,kernedWidth:0,height:this.fontSize},f){switch(s=f.segmentsInfo[f.segmentsInfo.length-1].length,a=e.util.getPointOnPath(f.path,0,f.segmentsInfo),a.x+=f.pathOffset.x,a.y+=f.pathOffset.y,this.textAlign){case"left":d=p?s-c:0;break;case"center":d=(s-c)/2;break;case"right":d=p?0:s-c;break}for(d+=this.pathStartOffset*(p?-1:1),n=p?l.length-1:0;p?n>=0:n<l.length;p?n--:n++)o=h[n],d>s?d%=s:d<0&&(d+=s),this._setGraphemeOnPath(d,o,a),d+=o.kernedWidth}return{width:c,numOfSpaces:u}},_setGraphemeOnPath:function(t,n,r){var i=t+n.kernedWidth/2,o=this.path,a=e.util.getPointOnPath(o.path,i,o.segmentsInfo);n.renderLeft=a.x-r.x,n.renderTop=a.y-r.y,n.angle=a.angle+("right"===this.pathSide?Math.PI:0)},_getGraphemeBox:function(t,e,n,r,i){var o,a=this.getCompleteStyleDeclaration(e,n),s=r?this.getCompleteStyleDeclaration(e,n-1):{},c=this._measureChar(t,a,r,s),l=c.kernedWidth,u=c.width;0!==this.charSpacing&&(o=this._getWidthOfCharSpacing(),u+=o,l+=o);var h={width:u,left:0,height:a.fontSize,kernedWidth:l,deltaY:a.deltaY};if(n>0&&!i){var d=this.__charBounds[e][n-1];h.left=d.left+d.width+c.kernedWidth-c.width}return h},getHeightOfLine:function(t){if(this.__lineHeights[t])return this.__lineHeights[t];for(var e=this._textLines[t],n=this.getHeightOfChar(t,0),r=1,i=e.length;r<i;r++)n=Math.max(this.getHeightOfChar(t,r),n);return this.__lineHeights[t]=n*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var t,e=0,n=0,r=this._textLines.length;n<r;n++)t=this.getHeightOfLine(n),e+=n===r-1?t/this.lineHeight:t;return e},_getLeftOffset:function(){return"ltr"===this.direction?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(t,e){t.save();for(var n=0,r=this._getLeftOffset(),i=this._getTopOffset(),o=0,a=this._textLines.length;o<a;o++){var s=this.getHeightOfLine(o),c=s/this.lineHeight,l=this._getLineLeftOffset(o);this._renderTextLine(e,t,this._textLines[o],r+l,i+n+c,o),n+=s}t.restore()},_renderTextFill:function(t){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(t,"fillText")},_renderTextStroke:function(t){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())},_renderChars:function(t,e,n,r,i,o){var a,s,c,l,u,h=this.getHeightOfLine(o),d=-1!==this.textAlign.indexOf("justify"),f="",p=0,g=this.path,v=!d&&0===this.charSpacing&&this.isEmptyStyles(o)&&!g,m="ltr"===this.direction,b="ltr"===this.direction?1:-1,y=e.canvas.getAttribute("dir");if(e.save(),y!==this.direction&&(e.canvas.setAttribute("dir",m?"ltr":"rtl"),e.direction=m?"ltr":"rtl",e.textAlign=m?"left":"right"),i-=h*this._fontSizeFraction/this.lineHeight,v)return this._renderChar(t,e,o,0,n.join(""),r,i,h),void e.restore();for(var S=0,w=n.length-1;S<=w;S++)l=S===w||this.charSpacing||g,f+=n[S],c=this.__charBounds[o][S],0===p?(r+=b*(c.kernedWidth-c.width),p+=c.width):p+=c.kernedWidth,d&&!l&&this._reSpaceAndTab.test(n[S])&&(l=!0),l||(a=a||this.getCompleteStyleDeclaration(o,S),s=this.getCompleteStyleDeclaration(o,S+1),l=this._hasStyleChanged(a,s)),l&&(g?(e.save(),e.translate(c.renderLeft,c.renderTop),e.rotate(c.angle),this._renderChar(t,e,o,S,f,-p/2,0,h),e.restore()):(u=r,this._renderChar(t,e,o,S,f,u,i,h)),f="",a=s,r+=b*p,p=0);e.restore()},_applyPatternGradientTransformText:function(t){var n,r=e.util.createCanvasElement(),i=this.width+this.strokeWidth,o=this.height+this.strokeWidth;return r.width=i,r.height=o,n=r.getContext("2d"),n.beginPath(),n.moveTo(0,0),n.lineTo(i,0),n.lineTo(i,o),n.lineTo(0,o),n.closePath(),n.translate(i/2,o/2),n.fillStyle=t.toLive(n),this._applyPatternGradientTransform(n,t),n.fill(),n.createPattern(r,"no-repeat")},handleFiller:function(t,e,n){var r,i;return n.toLive?"percentage"===n.gradientUnits||n.gradientTransform||n.patternTransform?(r=-this.width/2,i=-this.height/2,t.translate(r,i),t[e]=this._applyPatternGradientTransformText(n),{offsetX:r,offsetY:i}):(t[e]=n.toLive(t,this),this._applyPatternGradientTransform(t,n)):(t[e]=n,{offsetX:0,offsetY:0})},_setStrokeStyles:function(t,e){return t.lineWidth=e.strokeWidth,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",e.stroke)},_setFillStyles:function(t,e){return this.handleFiller(t,"fillStyle",e.fill)},_renderChar:function(t,e,n,r,i,o,a){var s,c,l=this._getStyleDeclaration(n,r),u=this.getCompleteStyleDeclaration(n,r),h="fillText"===t&&u.fill,d="strokeText"===t&&u.stroke&&u.strokeWidth;(d||h)&&(e.save(),h&&(s=this._setFillStyles(e,u)),d&&(c=this._setStrokeStyles(e,u)),e.font=this._getFontDeclaration(u),l&&l.textBackgroundColor&&this._removeShadow(e),l&&l.deltaY&&(a+=l.deltaY),h&&e.fillText(i,o-s.offsetX,a-s.offsetY),d&&e.strokeText(i,o-c.offsetX,a-c.offsetY),e.restore())},setSuperscript:function(t,e){return this._setScript(t,e,this.superscript)},setSubscript:function(t,e){return this._setScript(t,e,this.subscript)},_setScript:function(t,e,n){var r=this.get2DCursorLocation(t,!0),i=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"fontSize"),o=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"deltaY"),a={fontSize:i*n.size,deltaY:o+i*n.baseline};return this.setSelectionStyles(a,t,e),this},_hasStyleChanged:function(t,e){return t.fill!==e.fill||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth||t.fontSize!==e.fontSize||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.deltaY!==e.deltaY},_hasStyleChangedForSvg:function(t,e){return this._hasStyleChanged(t,e)||t.overline!==e.overline||t.underline!==e.underline||t.linethrough!==e.linethrough},_getLineLeftOffset:function(t){var e=this.getLineWidth(t),n=this.width-e,r=this.textAlign,i=this.direction,o=0,a=this.isEndOfWrapping(t);return"justify"===r||"justify-center"===r&&!a||"justify-right"===r&&!a||"justify-left"===r&&!a?0:("center"===r&&(o=n/2),"right"===r&&(o=n),"justify-center"===r&&(o=n/2),"justify-right"===r&&(o=n),"rtl"===i&&(o-=n),o)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var t=this._forceClearCache;return t||(t=this.hasStateChanged("_dimensionAffectingProps")),t&&(this.dirty=!0,this._forceClearCache=!1),t},getLineWidth:function(t){if(void 0!==this.__lineWidths[t])return this.__lineWidths[t];var e=this.measureLine(t),n=e.width;return this.__lineWidths[t]=n,n},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(t,e,n){var r=this._getStyleDeclaration(t,e);return r&&"undefined"!==typeof r[n]?r[n]:this[n]},_renderTextDecoration:function(t,e){if(this[e]||this.styleHas(e)){for(var n,r,i,o,a,s,c,l,u,h,d,f,p,g,v,m,b=this._getLeftOffset(),y=this._getTopOffset(),S=this.path,w=this._getWidthOfCharSpacing(),E=this.offsets[e],C=0,x=this._textLines.length;C<x;C++)if(n=this.getHeightOfLine(C),this[e]||this.styleHas(e,C)){c=this._textLines[C],g=n/this.lineHeight,o=this._getLineLeftOffset(C),h=0,d=0,l=this.getValueOfPropertyAt(C,0,e),m=this.getValueOfPropertyAt(C,0,"fill"),u=y+g*(1-this._fontSizeFraction),r=this.getHeightOfChar(C,0),a=this.getValueOfPropertyAt(C,0,"deltaY");for(var O=0,_=c.length;O<_;O++)if(f=this.__charBounds[C][O],p=this.getValueOfPropertyAt(C,O,e),v=this.getValueOfPropertyAt(C,O,"fill"),i=this.getHeightOfChar(C,O),s=this.getValueOfPropertyAt(C,O,"deltaY"),S&&p&&v)t.save(),t.fillStyle=m,t.translate(f.renderLeft,f.renderTop),t.rotate(f.angle),t.fillRect(-f.kernedWidth/2,E*i+s,f.kernedWidth,this.fontSize/15),t.restore();else if((p!==l||v!==m||i!==r||s!==a)&&d>0){var T=b+o+h;"rtl"===this.direction&&(T=this.width-T-d),l&&m&&(t.fillStyle=m,t.fillRect(T,u+E*r+a,d,this.fontSize/15)),h=f.left,d=f.width,l=p,m=v,r=i,a=s}else d+=f.kernedWidth;T=b+o+h;"rtl"===this.direction&&(T=this.width-T-d),t.fillStyle=v,p&&v&&t.fillRect(T,u+E*r+a,d-w,this.fontSize/15),y+=n}else y+=n;this._removeShadow(t)}},_getFontDeclaration:function(t,n){var r=t||this,i=this.fontFamily,o=e.Text.genericFonts.indexOf(i.toLowerCase())>-1,a=void 0===i||i.indexOf("'")>-1||i.indexOf(",")>-1||i.indexOf('"')>-1||o?r.fontFamily:'"'+r.fontFamily+'"';return[e.isLikelyNode?r.fontWeight:r.fontStyle,e.isLikelyNode?r.fontStyle:r.fontWeight,n?this.CACHE_FONT_SIZE+"px":r.fontSize+"px",a].join(" ")},render:function(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",t)))},_splitTextIntoLines:function(t){for(var n=t.split(this._reNewline),r=new Array(n.length),i=["\n"],o=[],a=0;a<n.length;a++)r[a]=e.util.string.graphemeSplit(n[a]),o=o.concat(r[a],i);return o.pop(),{_unwrappedLines:r,lines:n,graphemeText:o,graphemeLines:r}},toObject:function(t){var e=r.concat(t),i=this.callSuper("toObject",e);return i.styles=n(this.styles,!0),i.path&&(i.path=this.path.toObject()),i},set:function(t,e){this.callSuper("set",t,e);var n=!1,r=!1;if("object"===typeof t)for(var i in t)"path"===i&&this.setPathInfo(),n=n||-1!==this._dimensionAffectingProps.indexOf(i),r=r||"path"===i;else n=-1!==this._dimensionAffectingProps.indexOf(t),r="path"===t;return r&&this.setPathInfo(),n&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(t,r,i){if(!t)return r(null);var o=e.parseAttributes(t,e.Text.ATTRIBUTE_NAMES),a=o.textAnchor||"left";if(i=e.util.object.extend(i?n(i):{},o),i.top=i.top||0,i.left=i.left||0,o.textDecoration){var s=o.textDecoration;-1!==s.indexOf("underline")&&(i.underline=!0),-1!==s.indexOf("overline")&&(i.overline=!0),-1!==s.indexOf("line-through")&&(i.linethrough=!0),delete i.textDecoration}"dx"in o&&(i.left+=o.dx),"dy"in o&&(i.top+=o.dy),"fontSize"in i||(i.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE);var c="";"textContent"in t?c=t.textContent:"firstChild"in t&&null!==t.firstChild&&"data"in t.firstChild&&null!==t.firstChild.data&&(c=t.firstChild.data),c=c.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var l=i.strokeWidth;i.strokeWidth=0;var u=new e.Text(c,i),h=u.getScaledHeight()/u.height,d=(u.height+u.strokeWidth)*u.lineHeight-u.height,f=d*h,p=u.getScaledHeight()+f,g=0;"center"===a&&(g=u.getScaledWidth()/2),"right"===a&&(g=u.getScaledWidth()),u.set({left:u.left-g,top:u.top-(p-u.fontSize*(.07+u._fontSizeFraction))/u.lineHeight,strokeWidth:"undefined"!==typeof l?l:1}),r(u)},e.Text.fromObject=function(t,r){var i=n(t),o=t.path;return delete i.path,e.Object._fromObject("Text",i,(function(t){o?e.Object._fromObject("Path",o,(function(e){t.set("path",e),r(t)}),"path"):r(t)}),"text")},e.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],e.util.createAccessors&&e.util.createAccessors(e.Text)}}(e),function(){r.util.object.extend(r.Text.prototype,{isEmptyStyles:function(t){if(!this.styles)return!0;if("undefined"!==typeof t&&!this.styles[t])return!0;var e="undefined"===typeof t?this.styles:{line:this.styles[t]};for(var n in e)for(var r in e[n])for(var i in e[n][r])return!1;return!0},styleHas:function(t,e){if(!this.styles||!t||""===t)return!1;if("undefined"!==typeof e&&!this.styles[e])return!1;var n="undefined"===typeof e?this.styles:{0:this.styles[e]};for(var r in n)for(var i in n[r])if("undefined"!==typeof n[r][i][t])return!0;return!1},cleanStyle:function(t){if(!this.styles||!t||""===t)return!1;var e,n,r=this.styles,i=0,o=!0,a=0;for(var s in r){for(var c in e=0,r[s]){var l=r[s][c],u=l.hasOwnProperty(t);i++,u?(n?l[t]!==n&&(o=!1):n=l[t],l[t]===this[t]&&delete l[t]):o=!1,0!==Object.keys(l).length?e++:delete r[s][c]}0===e&&delete r[s]}for(var h=0;h<this._textLines.length;h++)a+=this._textLines[h].length;o&&i===a&&(this[t]=n,this.removeStyle(t))},removeStyle:function(t){if(this.styles&&t&&""!==t){var e,n,r,i=this.styles;for(n in i){for(r in e=i[n],e)delete e[r][t],0===Object.keys(e[r]).length&&delete e[r];0===Object.keys(e).length&&delete i[n]}}},_extendStyles:function(t,e){var n=this.get2DCursorLocation(t);this._getLineStyle(n.lineIndex)||this._setLineStyle(n.lineIndex),this._getStyleDeclaration(n.lineIndex,n.charIndex)||this._setStyleDeclaration(n.lineIndex,n.charIndex,{}),r.util.object.extend(this._getStyleDeclaration(n.lineIndex,n.charIndex),e)},get2DCursorLocation:function(t,e){"undefined"===typeof t&&(t=this.selectionStart);for(var n=e?this._unwrappedTextLines:this._textLines,r=n.length,i=0;i<r;i++){if(t<=n[i].length)return{lineIndex:i,charIndex:t};t-=n[i].length+this.missingNewlineOffset(i)}return{lineIndex:i-1,charIndex:n[i-1].length<t?n[i-1].length:t}},getSelectionStyles:function(t,e,n){"undefined"===typeof t&&(t=this.selectionStart||0),"undefined"===typeof e&&(e=this.selectionEnd||t);for(var r=[],i=t;i<e;i++)r.push(this.getStyleAtPosition(i,n));return r},getStyleAtPosition:function(t,e){var n=this.get2DCursorLocation(t),r=e?this.getCompleteStyleDeclaration(n.lineIndex,n.charIndex):this._getStyleDeclaration(n.lineIndex,n.charIndex);return r||{}},setSelectionStyles:function(t,e,n){"undefined"===typeof e&&(e=this.selectionStart||0),"undefined"===typeof n&&(n=this.selectionEnd||e);for(var r=e;r<n;r++)this._extendStyles(r,t);return this._forceClearCache=!0,this},_getStyleDeclaration:function(t,e){var n=this.styles&&this.styles[t];return n?n[e]:null},getCompleteStyleDeclaration:function(t,e){for(var n,r=this._getStyleDeclaration(t,e)||{},i={},o=0;o<this._styleProperties.length;o++)n=this._styleProperties[o],i[n]="undefined"===typeof r[n]?this[n]:r[n];return i},_setStyleDeclaration:function(t,e,n){this.styles[t][e]=n},_deleteStyleDeclaration:function(t,e){delete this.styles[t][e]},_getLineStyle:function(t){return!!this.styles[t]},_setLineStyle:function(t){this.styles[t]={}},_deleteLineStyle:function(t){delete this.styles[t]}})}(),function(){function t(t){t.textDecoration&&(t.textDecoration.indexOf("underline")>-1&&(t.underline=!0),t.textDecoration.indexOf("line-through")>-1&&(t.linethrough=!0),t.textDecoration.indexOf("overline")>-1&&(t.overline=!0),delete t.textDecoration)}r.IText=r.util.createClass(r.Text,r.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(t,e){this.callSuper("initialize",t,e),this.initBehavior()},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(t){this.clearContextTop(),this.callSuper("render",t),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(t){this.callSuper("_render",t)},clearContextTop:function(t){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var e=this.canvas.contextTop,n=this.canvas.viewportTransform;e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(e),this._clearTextArea(e),t||e.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var t=this._getCursorBoundaries(),e=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(t,e):this.renderSelection(t,e),e.restore()}},_clearTextArea:function(t){var e=this.width+4,n=this.height+4;t.clearRect(-e/2,-n/2,e,n)},_getCursorBoundaries:function(t){"undefined"===typeof t&&(t=this.selectionStart);var e=this._getLeftOffset(),n=this._getTopOffset(),r=this._getCursorBoundariesOffsets(t);return{left:e,top:n,leftOffset:r.left,topOffset:r.top}},_getCursorBoundariesOffsets:function(t){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var e,n,r,i,o=0,a=0,s=this.get2DCursorLocation(t);r=s.charIndex,n=s.lineIndex;for(var c=0;c<n;c++)o+=this.getHeightOfLine(c);e=this._getLineLeftOffset(n);var l=this.__charBounds[n][r];return l&&(a=l.left),0!==this.charSpacing&&r===this._textLines[n].length&&(a-=this._getWidthOfCharSpacing()),i={top:o,left:e+(a>0?a:0)},"rtl"===this.direction&&(i.left*=-1),this.cursorOffsetCache=i,this.cursorOffsetCache},renderCursor:function(t,e){var n=this.get2DCursorLocation(),r=n.lineIndex,i=n.charIndex>0?n.charIndex-1:0,o=this.getValueOfPropertyAt(r,i,"fontSize"),a=this.scaleX*this.canvas.getZoom(),s=this.cursorWidth/a,c=t.topOffset,l=this.getValueOfPropertyAt(r,i,"deltaY");c+=(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-o*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(t,e),e.fillStyle=this.cursorColor||this.getValueOfPropertyAt(r,i,"fill"),e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,e.fillRect(t.left+t.leftOffset-s/2,c+t.top+l,s,o)},renderSelection:function(t,e){for(var n=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,r=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,i=-1!==this.textAlign.indexOf("justify"),o=this.get2DCursorLocation(n),a=this.get2DCursorLocation(r),s=o.lineIndex,c=a.lineIndex,l=o.charIndex<0?0:o.charIndex,u=a.charIndex<0?0:a.charIndex,h=s;h<=c;h++){var d=this._getLineLeftOffset(h)||0,f=this.getHeightOfLine(h),p=0,g=0,v=0;if(h===s&&(g=this.__charBounds[s][l].left),h>=s&&h<c)v=i&&!this.isEndOfWrapping(h)?this.width:this.getLineWidth(h)||5;else if(h===c)if(0===u)v=this.__charBounds[c][u].left;else{var m=this._getWidthOfCharSpacing();v=this.__charBounds[c][u-1].left+this.__charBounds[c][u-1].width-m}p=f,(this.lineHeight<1||h===c&&this.lineHeight>1)&&(f/=this.lineHeight);var b=t.left+d+g,y=v-g,S=f,w=0;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",S=1,w=f):e.fillStyle=this.selectionColor,"rtl"===this.direction&&(b=this.width-b-y),e.fillRect(b,t.top+t.topOffset+w,y,S),t.topOffset+=p}},getCurrentCharFontSize:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")},getCurrentCharColor:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fill")},_getCurrentCharIndex:function(){var t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}}),r.IText.fromObject=function(e,n){if(t(e),e.styles)for(var i in e.styles)for(var o in e.styles[i])t(e.styles[i][o]);r.Object._fromObject("IText",e,n,"text")}}(),function(){var t=r.util.object.clone;r.util.object.extend(r.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var t=this;this.on("added",(function(){var e=t.canvas;e&&(e._hasITextHandlers||(e._hasITextHandlers=!0,t._initCanvasHandlers(e)),e._iTextInstances=e._iTextInstances||[],e._iTextInstances.push(t))}))},initRemovedHandler:function(){var t=this;this.on("removed",(function(){var e=t.canvas;e&&(e._iTextInstances=e._iTextInstances||[],r.util.removeFromArray(e._iTextInstances,t),0===e._iTextInstances.length&&(e._hasITextHandlers=!1,t._removeCanvasHandlers(e)))}))},_initCanvasHandlers:function(t){t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach((function(t){t.__isMousedown=!1}))},t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,e,n,r){var i;return i={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",e,{duration:n,onComplete:function(){i.isAborted||t[r]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return i.isAborted}}),i},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout((function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")}),100)},initDelayedCursor:function(t){var e=this,n=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout((function(){e._tick()}),n)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState,e=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&e&&e.clearContext(e.contextTop||e.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(t){var e=0,n=t-1;if(this._reSpace.test(this._text[n]))while(this._reSpace.test(this._text[n]))e++,n--;while(/\S/.test(this._text[n])&&n>-1)e++,n--;return t-e},findWordBoundaryRight:function(t){var e=0,n=t;if(this._reSpace.test(this._text[n]))while(this._reSpace.test(this._text[n]))e++,n++;while(/\S/.test(this._text[n])&&n<this._text.length)e++,n++;return t+e},findLineBoundaryLeft:function(t){var e=0,n=t-1;while(!/\n/.test(this._text[n])&&n>-1)e++,n--;return t-e},findLineBoundaryRight:function(t){var e=0,n=t;while(!/\n/.test(this._text[n])&&n<this._text.length)e++,n++;return t+e},searchWordBoundary:function(t,e){var n=this._text,i=this._reSpace.test(n[t])?t-1:t,o=n[i],a=r.reNonWord;while(!a.test(o)&&i>0&&i<n.length)i+=e,o=n[i];return a.test(o)&&(i+=1===e?0:1),i},selectWord:function(t){t=t||this.selectionStart;var e=this.searchWordBoundary(t,-1),n=this.searchWordBoundary(t,1);this.selectionStart=e,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var e=this.findLineBoundaryLeft(t),n=this.findLineBoundaryRight(t);return this.selectionStart=e,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(t){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach((function(t){t.selected=!1,t.isEditing&&t.exitEditing()}))},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){if(this.__isMousedown&&this.isEditing){var e=this.getSelectionStartFromPointer(t.e),n=this.selectionStart,r=this.selectionEnd;(e===this.__selectionStartOnMouseDown&&n!==r||n!==e&&r!==e)&&(e>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=e):(this.selectionStart=e,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===n&&this.selectionEnd===r||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(t,e,n){var i=n.slice(0,t),o=r.util.string.graphemeSplit(i).length;if(t===e)return{selectionStart:o,selectionEnd:o};var a=n.slice(t,e),s=r.util.string.graphemeSplit(a).length;return{selectionStart:o,selectionEnd:o+s}},fromGraphemeToStringSelection:function(t,e,n){var r=n.slice(0,t),i=r.join("").length;if(t===e)return{selectionStart:i,selectionEnd:i};var o=n.slice(t,e),a=o.join("").length;return{selectionStart:i,selectionEnd:i+a}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var t=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),n=this.get2DCursorLocation(t),i=n.lineIndex,o=n.charIndex,a=this.getValueOfPropertyAt(i,o,"fontSize")*this.lineHeight,s=e.leftOffset,c=this.calcTransformMatrix(),l={x:e.left+s,y:e.top+e.topOffset+a},u=this.canvas.getRetinaScaling(),h=this.canvas.upperCanvasEl,d=h.width/u,f=h.height/u,p=d-a,g=f-a,v=h.clientWidth/d,m=h.clientHeight/f;return l=r.util.transformPoint(l,c),l=r.util.transformPoint(l,this.canvas.viewportTransform),l.x*=v,l.y*=m,l.x<0&&(l.x=0),l.x>p&&(l.x=p),l.y<0&&(l.y=0),l.y>g&&(l.y=g),l.x+=this.canvas._offset.left,l.y+=this.canvas._offset.top,{left:l.x+"px",top:l.y+"px",fontSize:a+"px",charHeight:a}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text,e=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},removeStyleFromTo:function(t,e){var n,r,i=this.get2DCursorLocation(t,!0),o=this.get2DCursorLocation(e,!0),a=i.lineIndex,s=i.charIndex,c=o.lineIndex,l=o.charIndex;if(a!==c){if(this.styles[a])for(n=s;n<this._unwrappedTextLines[a].length;n++)delete this.styles[a][n];if(this.styles[c])for(n=l;n<this._unwrappedTextLines[c].length;n++)r=this.styles[c][n],r&&(this.styles[a]||(this.styles[a]={}),this.styles[a][s+n-l]=r);for(n=a+1;n<=c;n++)delete this.styles[n];this.shiftLineStyles(c,a-c)}else if(this.styles[a]){r=this.styles[a];var u,h,d=l-s;for(n=s;n<l;n++)delete r[n];for(h in this.styles[a])u=parseInt(h,10),u>=l&&(r[u-d]=r[h],delete r[h])}},shiftLineStyles:function(e,n){var r=t(this.styles);for(var i in this.styles){var o=parseInt(i,10);o>e&&(this.styles[o+n]=r[o],r[o-n]||delete this.styles[o])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(e,n,r,i){var o,a={},s=!1,c=this._unwrappedTextLines[e].length===n;for(var l in r||(r=1),this.shiftLineStyles(e,r),this.styles[e]&&(o=this.styles[e][0===n?n:n-1]),this.styles[e]){var u=parseInt(l,10);u>=n&&(s=!0,a[u-n]=this.styles[e][l],c&&0===n||delete this.styles[e][l])}var h=!1;s&&!c&&(this.styles[e+r]=a,h=!0),h&&r--;while(r>0)i&&i[r-1]?this.styles[e+r]={0:t(i[r-1])}:o?this.styles[e+r]={0:t(o)}:delete this.styles[e+r],r--;this._forceClearCache=!0},insertCharStyleObject:function(e,n,r,i){this.styles||(this.styles={});var o=this.styles[e],a=o?t(o):{};for(var s in r||(r=1),a){var c=parseInt(s,10);c>=n&&(o[c+r]=a[c],a[c-r]||delete o[c])}if(this._forceClearCache=!0,i)while(r--)Object.keys(i[r]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][n+r]=t(i[r]));else if(o){var l=o[n?n-1:1];while(l&&r--)this.styles[e][n+r]=t(l)}},insertNewStyleBlock:function(t,e,n){for(var r=this.get2DCursorLocation(e,!0),i=[0],o=0,a=0;a<t.length;a++)"\n"===t[a]?(o++,i[o]=0):i[o]++;i[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,i[0],n),n=n&&n.slice(i[0]+1)),o&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+i[0],o);for(a=1;a<o;a++)i[a]>0?this.insertCharStyleObject(r.lineIndex+a,0,i[a],n):n&&this.styles[r.lineIndex+a]&&n[0]&&(this.styles[r.lineIndex+a][0]=n[0]),n=n&&n.slice(i[a]+1);i[a]>0&&this.insertCharStyleObject(r.lineIndex+a,0,i[a],n)},setSelectionStartEndWithShift:function(t,e,n){n<=t?(e===t?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=n):n>t&&n<e?"right"===this._selectionDirection?this.selectionEnd=n:this.selectionStart=n:(e===t?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=e),this.selectionEnd=n)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),r.util.object.extend(r.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(t){if(this.canvas){this.__newClickTime=+new Date;var e=t.pointer;this.isTripleClick(e)&&(this.fire("tripleclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(t){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(t.e))},tripleClickHandler:function(t){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(t.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(t){if(this.__isMousedown=!1,!(!this.editable||this.group||t.transform&&t.transform.actionPerformed||t.e.button&&1!==t.e.button)){if(this.canvas){var e=this.canvas._activeObject;if(e&&e!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t),n=this.selectionStart,r=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(n,r,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(t){for(var e,n,r=this.getLocalPointer(t),i=0,o=0,a=0,s=0,c=0,l=0,u=this._textLines.length;l<u;l++){if(!(a<=r.y))break;a+=this.getHeightOfLine(l)*this.scaleY,c=l,l>0&&(s+=this._textLines[l-1].length+this.missingNewlineOffset(l-1))}e=this._getLineLeftOffset(c),o=e*this.scaleX,n=this._textLines[c],"rtl"===this.direction&&(r.x=this.width*this.scaleX-r.x+o);for(var h=0,d=n.length;h<d;h++){if(i=o,o+=this.__charBounds[c][h].kernedWidth*this.scaleX,!(o<=r.x))break;s++}return this._getNewSelectionStartFromOffset(r,i,o,s,d)},_getNewSelectionStartFromOffset:function(t,e,n,r,i){var o=t.x-e,a=n-t.x,s=a>o||a<0?0:1,c=r+s;return this.flipX&&(c=i-c),c>this._text.length&&(c=this._text.length),c}}),r.util.object.extend(r.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=r.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var t=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+t.top+"; left: "+t.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; paddingｰtop: "+t.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):r.document.body.appendChild(this.hiddenTextarea),r.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),r.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),r.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),r.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),r.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),r.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),r.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),r.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),r.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(r.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing){var e="rtl"===this.direction?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown)||!t.ctrlKey&&!t.metaKey)return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(t){var e=this.fromPaste;if(this.fromPaste=!1,t&&t.stopPropagation(),this.isEditing){var n,i,o,a,s,c=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,l=this._text.length,u=c.length,h=u-l,d=this.selectionStart,f=this.selectionEnd,p=d!==f;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var g=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),v=d>g.selectionStart;p?(n=this._text.slice(d,f),h+=f-d):u<l&&(n=v?this._text.slice(f+h,f):this._text.slice(d,d-h)),i=c.slice(g.selectionEnd-h,g.selectionEnd),n&&n.length&&(i.length&&(o=this.getSelectionStyles(d,d+1,!1),o=i.map((function(){return o[0]}))),p?(a=d,s=f):v?(a=f-n.length,s=f):(a=f,s=f+n.length),this.removeStyleFromTo(a,s)),i.length&&(e&&i.join("")===r.copiedText&&!r.disableStyleCopyPaste&&(o=r.copiedTextStyle),this.insertNewStyleBlock(i,d,o)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(t){this.compositionStart=t.target.selectionStart,this.compositionEnd=t.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(r.copiedText=this.getSelectedText(),r.disableStyleCopyPaste?r.copiedTextStyle=null:r.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(t){return t&&t.clipboardData||r.window.clipboardData},_getWidthBeforeCursor:function(t,e){var n,r=this._getLineLeftOffset(t);return e>0&&(n=this.__charBounds[t][e-1],r+=n.left+n.width),r},getDownCursorOffset:function(t,e){var n=this._getSelectionForOffset(t,e),r=this.get2DCursorLocation(n),i=r.lineIndex;if(i===this._textLines.length-1||t.metaKey||34===t.keyCode)return this._text.length-n;var o=r.charIndex,a=this._getWidthBeforeCursor(i,o),s=this._getIndexOnLine(i+1,a),c=this._textLines[i].slice(o);return c.length+s+1+this.missingNewlineOffset(i)},_getSelectionForOffset:function(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(t,e){var n=this._getSelectionForOffset(t,e),r=this.get2DCursorLocation(n),i=r.lineIndex;if(0===i||t.metaKey||33===t.keyCode)return-n;var o=r.charIndex,a=this._getWidthBeforeCursor(i,o),s=this._getIndexOnLine(i-1,a),c=this._textLines[i].slice(0,o),l=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+s-c.length+(1-l)},_getIndexOnLine:function(t,e){for(var n,r,i=this._textLines[t],o=this._getLineLeftOffset(t),a=o,s=0,c=0,l=i.length;c<l;c++)if(n=this.__charBounds[t][c].width,a+=n,a>e){r=!0;var u=a-n,h=a,d=Math.abs(u-e),f=Math.abs(h-e);s=f<d?c:c-1;break}return r||(s=i.length-1),s},moveCursorDown:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)},moveCursorUp:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",t)},_moveCursorUpOrDown:function(t,e){var n="get"+t+"CursorOffset",r=this[n](e,"right"===this._selectionDirection);e.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),0!==r&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(t){var e="left"===this._selectionDirection?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),0!==t},moveCursorWithoutShift:function(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),0!==t},moveCursorLeft:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",t)},_move:function(t,e,n){var r;if(t.altKey)r=this["findWordBoundary"+n](this[e]);else{if(!t.metaKey&&35!==t.keyCode&&36!==t.keyCode)return this[e]+="Left"===n?-1:1,!0;r=this["findLineBoundary"+n](this[e])}if(void 0!==typeof r&&this[e]!==r)return this[e]=r,!0},_moveLeft:function(t,e){return this._move(t,e,"Left")},_moveRight:function(t,e){return this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(t){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(t,"selectionStart")):void 0},moveCursorRight:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)},_moveCursorLeftOrRight:function(t,e){var n="moveCursor"+t+"With";this._currentCursorOpacity=1,e.shiftKey?n+="Shift":n+="outShift",this[n](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(t){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(t,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(t){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(t,e){"undefined"===typeof e&&(e=t+1),this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(t,e,n,i){"undefined"===typeof i&&(i=n),i>n&&this.removeStyleFromTo(n,i);var o=r.util.string.graphemeSplit(t);this.insertNewStyleBlock(o,n,e),this._text=[].concat(this._text.slice(0,n),o,this._text.slice(i)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var t=r.util.toFixed,e=/  +/g;r.util.object.extend(r.Text.prototype,{_toSVG:function(){var t=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(t.textTop,t.textLeft);return this._wrapSVGTextAndBg(e)},toSVG:function(t){return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(t){var e=!0,n=this.getSvgTextDecoration(this);return[t.textBgRects.join(""),'\t\t<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",n?'text-decoration="'+n+'" ':"",'style="',this.getSvgStyles(e),'"',this.addPaintOrder()," >",t.textSpans.join(""),"</text>\n"]},_getSVGTextAndBg:function(t,e){var n,r=[],i=[],o=t;this._setSVGBg(i);for(var a=0,s=this._textLines.length;a<s;a++)n=this._getLineLeftOffset(a),(this.textBackgroundColor||this.styleHas("textBackgroundColor",a))&&this._setSVGTextLineBg(i,a,e+n,o),this._setSVGTextLineText(r,a,e+n,o),o+=this.getHeightOfLine(a);return{textSpans:r,textBgRects:i}},_createTextCharSpan:function(n,i,o,a){var s=n!==n.trim()||n.match(e),c=this.getSvgSpanStyles(i,s),l=c?'style="'+c+'"':"",u=i.deltaY,h="",d=r.Object.NUM_FRACTION_DIGITS;return u&&(h=' dy="'+t(u,d)+'" '),['<tspan x="',t(o,d),'" y="',t(a,d),'" ',h,l,">",r.util.string.escapeXml(n),"</tspan>"].join("")},_setSVGTextLineText:function(t,e,n,r){var i,o,a,s,c,l=this.getHeightOfLine(e),u=-1!==this.textAlign.indexOf("justify"),h="",d=0,f=this._textLines[e];r+=l*(1-this._fontSizeFraction)/this.lineHeight;for(var p=0,g=f.length-1;p<=g;p++)c=p===g||this.charSpacing,h+=f[p],a=this.__charBounds[e][p],0===d?(n+=a.kernedWidth-a.width,d+=a.width):d+=a.kernedWidth,u&&!c&&this._reSpaceAndTab.test(f[p])&&(c=!0),c||(i=i||this.getCompleteStyleDeclaration(e,p),o=this.getCompleteStyleDeclaration(e,p+1),c=this._hasStyleChangedForSvg(i,o)),c&&(s=this._getStyleDeclaration(e,p)||{},t.push(this._createTextCharSpan(h,s,n,r)),h="",i=o,n+=d,d=0)},_pushTextBgRect:function(e,n,i,o,a,s){var c=r.Object.NUM_FRACTION_DIGITS;e.push("\t\t<rect ",this._getFillAttributes(n),' x="',t(i,c),'" y="',t(o,c),'" width="',t(a,c),'" height="',t(s,c),'"></rect>\n')},_setSVGTextLineBg:function(t,e,n,r){for(var i,o,a=this._textLines[e],s=this.getHeightOfLine(e)/this.lineHeight,c=0,l=0,u=this.getValueOfPropertyAt(e,0,"textBackgroundColor"),h=0,d=a.length;h<d;h++)i=this.__charBounds[e][h],o=this.getValueOfPropertyAt(e,h,"textBackgroundColor"),o!==u?(u&&this._pushTextBgRect(t,u,n+l,r,c,s),l=i.left,c=i.width,u=o):c+=i.kernedWidth;o&&this._pushTextBgRect(t,o,n+l,r,c,s)},_getFillAttributes:function(t){var e=t&&"string"===typeof t?new r.Color(t):"";return e&&e.getSource()&&1!==e.getAlpha()?'opacity="'+e.getAlpha()+'" fill="'+e.setAlpha(1).toRgb()+'"':'fill="'+t+'"'},_getSVGLineTopOffset:function(t){for(var e=0,n=0,r=0;r<t;r++)e+=this.getHeightOfLine(r);return n=this.getHeightOfLine(r),{lineTop:e,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(t){var e=r.Object.prototype.getSvgStyles.call(this,t);return e+" white-space: pre;"}})}(),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:e.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(t){for(var e=0,n=0,r=0,i={},o=0;o<t.graphemeLines.length;o++)"\n"===t.graphemeText[r]&&o>0?(n=0,r++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[r])&&o>0&&(n++,r++),i[o]={line:e,offset:n},r+=t.graphemeLines[o].length,n+=t.graphemeLines[o].length;return i},styleHas:function(t,n){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[n];r&&(n=r.line)}return e.Text.prototype.styleHas.call(this,t,n)},isEmptyStyles:function(t){if(!this.styles)return!0;var e,n,r=0,i=t+1,o=!1,a=this._styleMap[t],s=this._styleMap[t+1];for(var c in a&&(t=a.line,r=a.offset),s&&(i=s.line,o=i===t,e=s.offset),n="undefined"===typeof t?this.styles:{line:this.styles[t]},n)for(var l in n[c])if(l>=r&&(!o||l<e))for(var u in n[c][l])return!1;return!0},_getStyleDeclaration:function(t,e){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[t];if(!n)return null;t=n.line,e=n.offset+e}return this.callSuper("_getStyleDeclaration",t,e)},_setStyleDeclaration:function(t,e,n){var r=this._styleMap[t];t=r.line,e=r.offset+e,this.styles[t][e]=n},_deleteStyleDeclaration:function(t,e){var n=this._styleMap[t];t=n.line,e=n.offset+e,delete this.styles[t][e]},_getLineStyle:function(t){var e=this._styleMap[t];return!!this.styles[e.line]},_setLineStyle:function(t){var e=this._styleMap[t];this.styles[e.line]={}},_wrapText:function(t,e){var n,r=[];for(this.isWrapping=!0,n=0;n<t.length;n++)r=r.concat(this._wrapLine(t[n],n,e));return this.isWrapping=!1,r},_measureWord:function(t,e,n){var r,i=0,o=!0;n=n||0;for(var a=0,s=t.length;a<s;a++){var c=this._getGraphemeBox(t[a],e,a+n,r,o);i+=c.kernedWidth,r=t[a]}return i},_wrapLine:function(t,n,r,i){var o=0,a=this.splitByGrapheme,s=[],c=[],l=a?e.util.string.graphemeSplit(t):t.split(this._wordJoiners),u="",h=0,d=a?"":" ",f=0,p=0,g=0,v=!0,m=this._getWidthOfCharSpacing();i=i||0;0===l.length&&l.push([]),r-=i;for(var b=0;b<l.length;b++)u=a?l[b]:e.util.string.graphemeSplit(l[b]),f=this._measureWord(u,n,h),h+=u.length,o+=p+f-m,o>r&&!v?(s.push(c),c=[],o=f,v=!0):o+=m,v||a||c.push(d),c=c.concat(u),p=a?0:this._measureWord([d],n,h),h++,v=!1,f>g&&(g=f);return b&&s.push(c),g+i>this.dynamicMinWidth&&(this.dynamicMinWidth=g-m+i),s},isEndOfWrapping:function(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line},missingNewlineOffset:function(t){return this.splitByGrapheme?this.isEndOfWrapping(t)?1:0:1},_splitTextIntoLines:function(t){for(var n=e.Text.prototype._splitTextIntoLines.call(this,t),r=this._wrapText(n.lines,this.width),i=new Array(r.length),o=0;o<r.length;o++)i[o]=r[o].join("");return n.lines=i,n.graphemeLines=r,n},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var t={};for(var e in this._styleMap)this._textLines[e]&&(t[this._styleMap[e].line]=1);for(var e in this.styles)t[e]||delete this.styles[e]},toObject:function(t){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(t))}}),e.Textbox.fromObject=function(t,n){return e.Object._fromObject("Textbox",t,n,"text")}}(e),function(){var t=r.controlsUtils,e=t.scaleSkewCursorStyleHandler,n=t.scaleCursorStyleHandler,i=t.scalingEqually,o=t.scalingYOrSkewingX,a=t.scalingXOrSkewingY,s=t.scaleOrSkewActionName,c=r.Object.prototype.controls;if(c.ml=new r.Control({x:-.5,y:0,cursorStyleHandler:e,actionHandler:a,getActionName:s}),c.mr=new r.Control({x:.5,y:0,cursorStyleHandler:e,actionHandler:a,getActionName:s}),c.mb=new r.Control({x:0,y:.5,cursorStyleHandler:e,actionHandler:o,getActionName:s}),c.mt=new r.Control({x:0,y:-.5,cursorStyleHandler:e,actionHandler:o,getActionName:s}),c.tl=new r.Control({x:-.5,y:-.5,cursorStyleHandler:n,actionHandler:i}),c.tr=new r.Control({x:.5,y:-.5,cursorStyleHandler:n,actionHandler:i}),c.bl=new r.Control({x:-.5,y:.5,cursorStyleHandler:n,actionHandler:i}),c.br=new r.Control({x:.5,y:.5,cursorStyleHandler:n,actionHandler:i}),c.mtr=new r.Control({x:0,y:-.5,actionHandler:t.rotationWithSnapping,cursorStyleHandler:t.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),r.Textbox){var l=r.Textbox.prototype.controls={};l.mtr=c.mtr,l.tr=c.tr,l.br=c.br,l.tl=c.tl,l.bl=c.bl,l.mt=c.mt,l.mb=c.mb,l.mr=new r.Control({x:.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"}),l.ml=new r.Control({x:-.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"})}}()}).call(this,n("b639").Buffer)},"7b4d":function(t,e,n){"use strict";var r=n("3fb5"),i=n("7577"),o=n("f91e"),a=n("df09"),s=n("ca34");function c(t){if(!c.enabled())throw new Error("Transport created when disabled");i.call(this,t,"/eventsource",o,a)}r(c,i),c.enabled=function(){return!!s},c.transportName="eventsource",c.roundTrips=2,t.exports=c},"7bca":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.PublisherSpeakingEvent=void 0;var i=n("8733"),o=function(t){function e(e,n,r,i){var o=t.call(this,!1,e,n)||this;return o.type=n,o.connection=r,o.streamId=i,o}return r(e,t),e.prototype.callDefaultBehavior=function(){},e}(i.Event);e.PublisherSpeakingEvent=o},"7c20":function(t,e,n){"use strict";(function(e){var r=n("ada0").EventEmitter,i=n("3fb5"),o=n("930c"),a=n("c282"),s=n("9f3a"),c=n("c529"),l=function(){};function u(t,n){var i=this;r.call(this);var u=function(){var e=i.ifr=new s(c.transportName,n,t);e.once("message",(function(t){if(t){var e;try{e=o.parse(t)}catch(a){return l("bad json",t),i.emit("finish"),void i.close()}var n=e[0],r=e[1];i.emit("finish",n,r)}i.close()})),e.once("close",(function(){i.emit("finish"),i.close()}))};e.document.body?u():a.attachEvent("load",u)}i(u,r),u.enabled=function(){return s.enabled()},u.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},t.exports=u}).call(this,n("c8ba"))},8140:function(t,e){function n(){var t={};this.forEach=function(e){for(var n in t){var r=t[n];for(var i in r)e(r[i])}},this.get=function(e,n){var r=t[n];if(void 0!=r)return r[e]},this.remove=function(e,n){var r=t[n];if(void 0!=r){for(var i in delete r[e],r)return!1;delete t[n]}},this.set=function(e,n,r){if(void 0==e)return this.remove(n,r);var i=t[r];void 0==i&&(t[r]=i={}),i[n]=e}}n.prototype.pop=function(t,e){var n=this.get(t,e);if(void 0!=n)return this.remove(t,e),n},t.exports=n},"84fc":function(t,e,n){"use strict";var r,i=n("930c"),o=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,a=function(t){var e,n={},r=[];for(e=0;e<65536;e++)r.push(String.fromCharCode(e));return t.lastIndex=0,r.join("").replace(t,(function(t){return n[t]="\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4),""})),t.lastIndex=0,n};t.exports={quote:function(t){var e=i.stringify(t);return o.lastIndex=0,o.test(e)?(r||(r=a(o)),e.replace(o,(function(t){return r[t]}))):e}}},8545:function(t,e,n){t.exports=n.p+"img/clip_dark.f9fe510f.svg"},"857a":function(t,e,n){var r=n("e330"),i=n("1d80"),o=n("577e"),a=/"/g,s=r("".replace);t.exports=function(t,e,n,r){var c=o(i(t)),l="<"+e;return""!==n&&(l+=" "+n+'="'+s(o(r),a,"&quot;")+'"'),l+">"+c+"</"+e+">"}},"85ad":function(t,e,n){"use strict";n("16f9")},8733:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Event=void 0;var r=function(){function t(t,e,n){this.hasBeenPrevented=!1,this.cancelable=t,this.target=e,this.type=n}return t.prototype.isDefaultPrevented=function(){return this.hasBeenPrevented},t.prototype.preventDefault=function(){this.callDefaultBehavior=function(){},this.hasBeenPrevented=!0},t}();e.Event=r},"89bc":function(t,e,n){"use strict";var r=n("ada0").EventEmitter,i=n("3fb5"),o=n("930c"),a=n("d5e5"),s=function(){};function c(t,e){r.call(this);var n=this,i=+new Date;this.xo=new e("GET",t),this.xo.once("finish",(function(t,e){var r,c;if(200===t){if(c=+new Date-i,e)try{r=o.parse(e)}catch(l){s("bad json",e)}a.isObject(r)||(r={})}n.emit("finish",r,c),n.removeAllListeners()}))}i(c,r),c.prototype.close=function(){this.removeAllListeners(),this.xo.close()},t.exports=c},"8aa5":function(t,e,n){"use strict";var r=n("6547").charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},9084:function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"protocol",(function(){return Fi})),n.d(r,"PacketType",(function(){return Ui})),n.d(r,"Encoder",(function(){return Wi})),n.d(r,"Decoder",(function(){return zi}));n("caad"),n("2532"),n("4c53");var i=n("7a23"),o=function(t){return Object(i["pushScopeId"])("data-v-1414b85b"),t=t(),Object(i["popScopeId"])(),t},a={class:"study-base-page"},s={id:"main-container",class:"mx-4"},c={key:0,id:"session"},l=o((function(){return Object(i["createElementVNode"])("div",{id:"session-header"},null,-1)})),u={id:"video-container"},h={class:"user-video-wrapper d-flex overflow-auto"},d={class:"video-box position-relative"},f={key:0},p=["stream-manager"],g={class:"video-box position-relative"},v={key:0,class:"mute-icon-container text-start"},m=["onClick"],b=["onClick"],y=["onClick"],S={class:"control-buttons-container"};function w(t,e,n,r,o,w){var E=Object(i["resolveComponent"])("Sidebar"),C=Object(i["resolveComponent"])("user-video"),x=Object(i["resolveComponent"])("font-awesome-icon"),O=Object(i["resolveComponent"])("KanbanBoard"),_=Object(i["resolveComponent"])("MainScreen"),T=Object(i["resolveComponent"])("WhiteBoard"),k=Object(i["resolveComponent"])("Memo"),I=Object(i["resolveComponent"])("ControlButtons");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",a,[Object(i["createVNode"])(E,{onShowScreenmode:e[0]||(e[0]=function(t){return w.showScreenMode(t)}),onStartScreenSharing:w.startScreenSharing,onStopScreenSharing:w.stopScreenSharing,onToggleSidebar:r.toggleSidebar,screenMode:o.screenMode,isScreenShared:o.isScreenShared},null,8,["onStartScreenSharing","onStopScreenSharing","onToggleSidebar","screenMode","isScreenShared"]),Object(i["createElementVNode"])("div",{class:"contents",style:Object(i["normalizeStyle"])({"margin-left":r.sidebarWidth})},[Object(i["createElementVNode"])("div",s,[o.session?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",c,[l,Object(i["createElementVNode"])("div",u,[Object(i["createElementVNode"])("div",h,[Object(i["createElementVNode"])("div",d,[o.publisher?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",f,[Object(i["createVNode"])(C,{id:"my-video","stream-manager":o.publisher,isSpeak:o.isSpeakList.includes(o.publisher.stream.connection.connectionId)},null,8,["stream-manager","isSpeak"])])):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("div",{class:"stream-btn-container",onClick:e[3]||(e[3]=Object(i["withModifiers"])((function(t){return w.updateMainVideoStreamManager(o.publisher)}),["self"]))},[Object(i["createElementVNode"])("button",{class:"btn btn-primary mx-1 stream-onoff-btn",onClick:e[1]||(e[1]=function(t){return w.videoOnOff(o.publisher)})},[Object(i["createVNode"])(x,{icon:["fas",o.publisher&&o.publisher.stream.videoActive?"video":"video-slash"],class:Object(i["normalizeClass"])({"font-red":!(o.publisher&&o.publisher.stream.videoActive)})},null,8,["icon","class"])]),Object(i["createElementVNode"])("button",{class:"btn btn-primary mx-1 stream-onoff-btn",onClick:e[2]||(e[2]=function(e){return w.audioOnOff(t.sub)})},[Object(i["createVNode"])(x,{class:Object(i["normalizeClass"])(["icon",{"font-red":!(o.publisher&&o.publisher.stream.audioActive)}]),icon:["fas",o.publisher&&o.publisher.stream.audioActive?"microphone":"microphone-slash"]},null,8,["icon","class"])])])]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(o.subscribers,(function(t){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:t.stream.connection.connectionId,"stream-manager":t},[Object(i["createElementVNode"])("div",g,[Object(i["createVNode"])(C,{"stream-manager":t,isSpeak:o.isSpeakList.includes(t.stream.connection.connectionId)},null,8,["stream-manager","isSpeak"]),"SCREEN"!==t.stream.typeOfVideo?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",v,[t.stream.videoActive?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createBlock"])(x,{key:0,icon:["fas","video-slash"],class:"font-red ms-2 mt-2"})),t.stream.audioActive?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createBlock"])(x,{key:1,icon:["fas","microphone-slash"],class:"font-red ms-2 mt-2"}))])):Object(i["createCommentVNode"])("",!0),t?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:1,class:"stream-btn-container",onClick:Object(i["withModifiers"])((function(e){return w.updateMainVideoStreamManager(t)}),["self"])},["SCREEN"!==t.stream.typeOfVideo?(Object(i["openBlock"])(),Object(i["createElementBlock"])("button",{key:0,class:"btn btn-primary mx-1 stream-onoff-btn",onClick:function(e){return w.toggleVideoSub(t)}},[Object(i["createVNode"])(x,{icon:["fas",t.muteVideo?"video-slash":"video"],class:Object(i["normalizeClass"])({"font-red":t.muteVideo})},null,8,["icon","class"])],8,b)):Object(i["createCommentVNode"])("",!0),"SCREEN"!==t.stream.typeOfVideo?(Object(i["openBlock"])(),Object(i["createElementBlock"])("button",{key:1,class:"btn btn-primary mx-1 stream-onoff-btn",onClick:function(e){return w.toggleAudioSub(t)}},[Object(i["createVNode"])(x,{icon:["fas",t.muteAudio?"microphone-slash":"microphone"],class:Object(i["normalizeClass"])({"font-red":t.muteAudio})},null,8,["icon","class"])],8,y)):Object(i["createCommentVNode"])("",!0)],8,m)):Object(i["createCommentVNode"])("",!0)])],8,p)})),128))])])])):Object(i["createCommentVNode"])("",!0)]),4===o.screenMode?(Object(i["openBlock"])(),Object(i["createBlock"])(O,{key:0,onIsEditPermit:e[4]||(e[4]=function(t){return w.isEditPermit(t)}),editPermit:o.editPermit,ref:"kanbanBoard"},null,8,["editPermit"])):1===o.screenMode?(Object(i["openBlock"])(),Object(i["createBlock"])(_,{key:1,streamManager:o.mainStreamManager,onDeleteMainVideoStreamManager:w.deleteMainVideoStreamManager},null,8,["streamManager","onDeleteMainVideoStreamManager"])):2===o.screenMode?(Object(i["openBlock"])(),Object(i["createBlock"])(T,{key:2})):3===o.screenMode?(Object(i["openBlock"])(),Object(i["createBlock"])(k,{key:3})):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("div",S,[Object(i["createVNode"])(I,{class:"control-buttons",onShowScreenmode:e[5]||(e[5]=function(t){return w.showScreenMode(t)}),onStartScreenSharing:w.startScreenSharing,onStopScreenSharing:w.stopScreenSharing,onToggleSidebar:r.toggleSidebar,screenMode:o.screenMode,isScreenShared:o.isScreenShared},null,8,["onStartScreenSharing","onStopScreenSharing","onToggleSidebar","screenMode","isScreenShared"])])],4)])}n("a434"),n("d3b7"),n("e9c4"),n("99af");var E=function(t){return Object(i["pushScopeId"])("data-v-752e2842"),t=t(),Object(i["popScopeId"])(),t},C={class:"row"},x={class:"home-buttons"},O={class:"control-buttons"},_={class:"icon-container"},T=E((function(){return Object(i["createElementVNode"])("i",{class:"fas fa-angle-double-left icon"},null,-1)})),k=[T],I={key:0,class:"col-10 sidebar-main"};function P(t,e,n,r,o,a){var s=Object(i["resolveComponent"])("font-awesome-icon"),c=Object(i["resolveComponent"])("SidebarFile"),l=Object(i["resolveComponent"])("SidebarChat"),u=Object(i["resolveComponent"])("SidebarMemberView");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"sidebar",style:Object(i["normalizeStyle"])({width:r.sidebarWidth})},[Object(i["createElementVNode"])("div",C,[Object(i["createElementVNode"])("div",x,[Object(i["createElementVNode"])("div",{class:"icon-container",onClick:e[0]||(e[0]=function(){return r.onClickExitIcon&&r.onClickExitIcon.apply(r,arguments)})},[Object(i["createVNode"])(s,{class:"icon",icon:["fas","home"]})])]),Object(i["createElementVNode"])("div",O,[Object(i["createElementVNode"])("div",{class:"icon-container",onClick:e[1]||(e[1]=function(){return r.onClickFileIcon&&r.onClickFileIcon.apply(r,arguments)}),tabindex:"0","data-bs-container":"body","data-bs-trigger":"hover","data-bs-toggle":"popover","data-bs-placement":"right","data-bs-content":"파일공유"},[Object(i["createVNode"])(s,{class:Object(i["normalizeClass"])(["icon",{"font-active":r.state.isFile}]),icon:["fas","paperclip"]},null,8,["class"])]),Object(i["createElementVNode"])("div",{class:"icon-container",onClick:e[2]||(e[2]=function(){return r.onClickChatIcon&&r.onClickChatIcon.apply(r,arguments)}),tabindex:"0","data-bs-container":"body","data-bs-trigger":"hover","data-bs-toggle":"popover","data-bs-placement":"right","data-bs-content":"채팅"},[Object(i["createVNode"])(s,{class:Object(i["normalizeClass"])(["icon",{"font-active":r.state.isChat}]),icon:["fas","comment"]},null,8,["class"])]),Object(i["createElementVNode"])("div",{class:"icon-container",onClick:e[3]||(e[3]=function(){return r.onClickMemberIcon&&r.onClickMemberIcon.apply(r,arguments)}),tabindex:"0","data-bs-container":"body","data-bs-trigger":"hover","data-bs-toggle":"popover","data-bs-placement":"right","data-bs-content":"유저목록"},[Object(i["createVNode"])(s,{class:Object(i["normalizeClass"])(["icon",{"font-active":r.state.isMemberList}]),icon:["fas","user-friends"]},null,8,["class"])]),Object(i["createElementVNode"])("div",_,[Object(i["createElementVNode"])("span",{class:Object(i["normalizeClass"])(["collapse-icon",{"rotate-180":r.state.collapsed}]),onClick:e[4]||(e[4]=function(){return r.toggleSidebar&&r.toggleSidebar.apply(r,arguments)})},k,2)])]),r.state.collapsed?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",I,[Object(i["createElementVNode"])("div",null,[r.state.isFile?(Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:0})):Object(i["createCommentVNode"])("",!0),r.state.isChat?(Object(i["openBlock"])(),Object(i["createBlock"])(l,{key:1})):Object(i["createCommentVNode"])("",!0),r.state.isMemberList?(Object(i["openBlock"])(),Object(i["createBlock"])(u,{key:2,members:r.state.memberList},null,8,["members"])):Object(i["createCommentVNode"])("",!0)])]))])],4)}n("159b"),n("a630"),n("3ca3");var j=function(t){return Object(i["pushScopeId"])("data-v-cfd36800"),t=t(),Object(i["popScopeId"])(),t},M={class:"chatDiv"},D=j((function(){return Object(i["createElementVNode"])("p",{class:"title"},"💬 채팅 ",-1)})),R={key:0,style:{"font-size":"12px","background-color":"#9EABCB","border-radius":"10px",padding:"10px 5px","text-align":"center",opacity:"0.9","margin-top":"20px"}},A=j((function(){return Object(i["createElementVNode"])("p",{style:{"margin-bottom":"5px"}},"스터디의 채팅 기록이 없습니다 !",-1)})),N=j((function(){return Object(i["createElementVNode"])("p",{style:{"margin-bottom":"5px"}},"스터디원들과 자유롭게 대화해보세요 💙",-1)})),L=[A,N],B={key:1,class:"init-btn"},V=j((function(){return Object(i["createElementVNode"])("hr",null,null,-1)})),F={class:"chat-input",id:"chat-input"},U={class:"inputText"};function W(t,e,n,r,o,a){var s=Object(i["resolveComponent"])("loading"),c=Object(i["resolveComponent"])("SidebarChatMessage");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createVNode"])(s,{active:r.state.loading,"onUpdate:active":e[0]||(e[0]=function(t){return r.state.loading=t}),"can-cancel":!1,"is-full-page":!1,height:o.height,width:o.width,color:o.color,loader:o.loader,"background-color":o.bgColor,opacity:o.opacity,"lock-scroll":!1,class:"vld-overlay",style:Object(i["normalizeStyle"])(r.state.loading?"-webkit-backdrop-filter: blur(2px); backdrop-filter: blur(2px);":"")},null,8,["active","height","width","color","loader","background-color","opacity","style"]),Object(i["createElementVNode"])("div",M,[D,Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("div",{class:"chat-body",id:"chat-body",onScroll:e[2]||(e[2]=function(){return r.scrollMove&&r.scrollMove.apply(r,arguments)})},[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(r.state.chatList,(function(t,e){return Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:e,chat:t,prev:[0==e?null:r.state.chatList[e-1]]},null,8,["chat","prev"])})),128)),r.state.isNull?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",R,L)):Object(i["createCommentVNode"])("",!0),r.state.isScrollInit?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",B,[Object(i["createElementVNode"])("button",{class:"btn-primary button",onClick:e[1]||(e[1]=function(){return r.scrollInit&&r.scrollInit.apply(r,arguments)})},"↓")])):Object(i["createCommentVNode"])("",!0)],32),V,Object(i["createElementVNode"])("div",F,[Object(i["createElementVNode"])("div",U,[Object(i["withDirectives"])(Object(i["createElementVNode"])("textarea",{"onUpdate:modelValue":e[3]||(e[3]=function(t){return r.state.message=t}),id:"message",type:"text",onKeydown:e[4]||(e[4]=Object(i["withKeys"])(Object(i["withModifiers"])((function(){return r.sendMessage&&r.sendMessage.apply(r,arguments)}),["exact","prevent"]),["enter"]))},null,544),[[i["vModelText"],r.state.message]])])])])])],64)}function z(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function G(t){if(Array.isArray(t))return z(t)}n("a4d3"),n("e01a"),n("d28b"),n("ddb0");function H(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}n("fb6a"),n("b0c0"),n("ac1f"),n("00b4");function Y(t,e){if(t){if("string"===typeof t)return z(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(t,e):void 0}}n("d9e2");function X(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function q(t){return G(t)||H(t)||Y(t)||X()}var $=n("1da1"),J=(n("96cf"),n("c6e1")),K=n.n(J),Z=n("cc7d"),Q=n.n(Z),tt={key:0,class:"dateLine"},et={class:"chat"},nt={key:0,class:"chat-my-message"},rt={class:"chat-my-message-time"},it=["innerHTML"],ot={key:1,class:"chat-other-message"},at={key:0,class:"chat-other-content1"},st=["src"],ct={class:"chat-other-nickname"},lt={class:"chat-other-content2"},ut=["innerHTML"],ht={class:"chat-other-message-time"};function dt(t,e,r,o,a,s){var c,l,u,h,d,f,p,g;return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[s.isDateConfirm()?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",tt,Object(i["toDisplayString"])(s.yymmdd),1)),Object(i["createElementVNode"])("div",et,[(null===(c=r.chat)||void 0===c?void 0:c.memberId)==this.getUserInfo.memberId?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",nt,[Object(i["createElementVNode"])("p",rt,Object(i["toDisplayString"])(s.hhmm),1),Object(i["createElementVNode"])("p",{class:"my-content",innerHTML:s.checkUrlContent(null===(l=r.chat)||void 0===l?void 0:l.content)},null,8,it)])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ot,[(null===(u=r.chat)||void 0===u?void 0:u.memberId)!=(null===(h=r.prev[0])||void 0===h?void 0:h.memberId)?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",at,[Object(i["createElementVNode"])("img",{src:null!==(d=r.chat)&&void 0!==d&&d.imgUrl?null===(f=r.chat)||void 0===f?void 0:f.imgUrl:n("348c"),alt:"","aria-expanded":"false"},null,8,st),Object(i["createElementVNode"])("p",ct,Object(i["toDisplayString"])(null===(p=r.chat)||void 0===p?void 0:p.nickname),1)])):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("div",lt,[Object(i["createElementVNode"])("p",{class:"other-content",innerHTML:s.checkUrlContent(null===(g=r.chat)||void 0===g?void 0:g.content)},null,8,ut),Object(i["createElementVNode"])("p",ht,Object(i["toDisplayString"])(s.hhmm),1)])]))])])}var ft=n("5530"),pt=(n("1276"),n("5319"),n("5502")),gt=n("5a0c"),vt=n.n(gt),mt={nane:"",props:{chat:Object,prev:Array},components:{},data:function(){return{sampleData:"",isSame:!1,isFirst:!0,todayDate:vt()().format("YY/MM/DD"),todayTime:vt()().format("hh:mm A")}},computed:Object(ft["a"])(Object(ft["a"])({},Object(pt["c"])(["getUserInfo"])),{},{yymmdd:function(){var t,e=null===(t=this.chat)||void 0===t?void 0:t.createdAt;if(""==e)return"";var n=(e||"").split(" "),r="";return r+=n[0],r},hhmm:function(){var t,e,n,r,i=((null===(t=this.prev[0])||void 0===t?void 0:t.createdAt)||"").split(" "),o="";o+=i[1]+" ",o+=i[2];var a=((null===(e=this.chat)||void 0===e?void 0:e.createdAt)||"").split(" "),s="";return s+=a[1]+" ",s+=a[2],o==s&&(null===(n=this.prev[0])||void 0===n?void 0:n.memberId)==(null===(r=this.chat)||void 0===r?void 0:r.memberId)?null:s}}),methods:{isDateConfirm:function(){var t,e,n=((null===(t=this.prev[0])||void 0===t?void 0:t.createdAt)||"").split(" "),r="";r+=n[0];var i=((null===(e=this.chat)||void 0===e?void 0:e.createdAt)||"").split(" "),o="";return o+=i[0],null!=r&&r==o},checkUrlContent:function(t){var e=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi,n=t.replace(e,'<a href="$&" target="_blank">$&</a>');return n}},created:function(){null==this.prev&&(this.isFirst=!1)}},bt=(n("b14f"),n("6b0d")),yt=n.n(bt);const St=yt()(mt,[["render",dt],["__scopeId","data-v-2e099d3e"]]);var wt=St,Et=n("a1e9"),Ct=n("5c40"),xt=n("6c02"),Ot=n("4bfb"),_t=n("9062"),Tt=n.n(_t),kt=(n("e40d"),{name:"App",data:function(){return{loader:"dots",color:"#F5CEC7",bgColor:"#1E304F",height:80,width:80,opacity:.2,lockScroll:!0}},components:{SidebarChatMessage:wt,Loading:Tt.a},setup:function(){var t,e,n=Object(pt["e"])(),r=Object(xt["c"])();n.dispatch("GET_CHAT_LIST",{studyId:r.params.studyId,index:0});var i=Object(Et["q"])({message:"",userInfo:n.getters.getUserInfo,chatList:[],recvList:[],init:!0,isNull:!1,recv:!1,loaded:!1,loading:!1,isTop:!1,isNoScroll:!1,isScrollInit:!1,prevScrollHeight:0,storeScrollHeight:0,element:Object(Ct["q"])((function(){return document.getElementById("chat-body")}))});function o(){return a.apply(this,arguments)}function a(){return a=Object($["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:Object(Ot["e"])(r.params.studyId,i.recvList.length,(function(t){n.dispatch("GET_CHAT_LIST",{studyId:r.params.studyId,index:i.recvList.length}).then((function(){for(var e=t.data.data.length,n=0;n<e;n++)i.recvList.push(t.data.data[n]);e<15&&(i.isNoScroll=!0),i.chatList=q(i.recvList).reverse(),i.loaded=!0,0==i.chatList.length?i.isNull=!0:i.isNull=!1}))}),(function(t){console.log(t)}));case 1:case"end":return t.stop()}}),t)}))),a.apply(this,arguments)}function s(){i.loading=!0,setTimeout((function(){i.loading=!1}),1500)}function c(){return l.apply(this,arguments)}function l(){return l=Object($["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i.prevScrollHeight=i.element.scrollHeight-i.element.scrollTop,0!=i.element.scrollTop||i.isNoScroll){t.next=4;break}return t.next=4,o();case 4:i.storeScrollHeight<i.prevScrollHeight&&0!=i.storeScrollHeight&&(i.isScrollInit=!0);case 5:case"end":return t.stop()}}),t)}))),l.apply(this,arguments)}function u(){i.element.scrollTop=i.element.scrollHeight,i.isScrollInit=!1,i.prevScrollHeight=0}function h(t){13===t.keyCode&&""!==this.userName&&""!==i.message&&(d(),i.message="")}function d(){if(e&&e.connected){var t={studyId:r.params.studyId,memberId:i.userInfo.memberId,imgUrl:i.userInfo.profileImg,nickname:i.userInfo.nickname,content:i.message,created:vt()().format("YY/MM/DD hh:mm A")};e.send("/receive",JSON.stringify(t),{}),i.isNull=!1,setTimeout((function(){var t=document.getElementById("chat-body");t.scrollTop=t.scrollHeight}),0)}}function f(){return p.apply(this,arguments)}function p(){return p=Object($["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o();case 2:v();case 3:case"end":return t.stop()}}),t)}))),p.apply(this,arguments)}function g(){var n="".concat("https://i6a501.p.ssafy.io","/api/ws");t=new Q.a(n,{transports:["websocket","xhr-streaming","xhr-polling"]}),e=K.a.over(t),e.connect({},(function(t){e.connected=!0,console.log("소켓 연결 성공",t),f()}),(function(t){console.log("소켓 연결 실패",t),e.connected=!1}))}function v(){e.subscribe("/send/"+r.params.studyId,(function(t){i.recvList.unshift(JSON.parse(t.body)),i.chatList.push(JSON.parse(t.body)),i.recv=!0,i.isNull=!1,setTimeout((function(){var t=document.getElementById("chat-body");t.scrollTop=t.scrollHeight}),0)}))}return Object(Ct["ub"])((function(){(i.init||i.recv)&&(i.init=!1,i.recv=!1,i.element.scrollTop=i.element.scrollHeight),i.loaded&&(i.loaded=!1,0==i.element.scrollTop?i.element.scrollTop=i.element.scrollHeight-i.prevScrollHeight:i.element.scrollTop=i.element.scrollHeight,i.prevScrollHeight=i.element.scrollHeight),i.storeScrollHeight<i.prevScrollHeight&&0!=i.storeScrollHeight&&(i.isScrollInit=!0)})),g(),{state:i,scrollMove:c,scrollInit:u,sendMessage:h,loadingCall:s}},created:function(){this.init=!0,this.loadingCall()}});n("67c3");const It=yt()(kt,[["render",W],["__scopeId","data-v-cfd36800"]]);var Pt=It,jt=n("2c42"),Mt=n.n(jt),Dt=n("1c8c"),Rt=n.n(Dt),At=n("8545"),Nt=n.n(At),Lt=n("b797"),Bt=n.n(Lt),Vt=function(t){return Object(i["pushScopeId"])("data-v-0a313e70"),t=t(),Object(i["popScopeId"])(),t},Ft={class:"fileDiv"},Ut=Vt((function(){return Object(i["createElementVNode"])("p",{class:"title"},"📑 첨부 파일 목록",-1)})),Wt={class:"file-body"},zt={class:"card"},Gt={key:0},Ht={class:"card-body-data col-9"},Yt={class:"card-body-data-name","text-truncate":""},Xt={class:"card-body-data-size","text-truncate":""},qt={class:"card-body-data-createdAt","text-truncate":""},$t={class:"card-body-buttons col-3"},Jt=["onClick"],Kt=["onClick"],Zt={key:1},Qt=Vt((function(){return Object(i["createElementVNode"])("div",{class:"card-body-none"},[Object(i["createElementVNode"])("div",{class:"card-body-none-data"},[Object(i["createElementVNode"])("p",{class:"card-body-none-data-name"},"등록된 파일이 없습니다.")])],-1)})),te=[Qt],ee={key:0,class:"progress"},ne=["aria-valuenow"],re={enctype:"multipart/form-data"},ie={class:"file-info","text-truncate":""},oe=Vt((function(){return Object(i["createElementVNode"])("img",{class:"file-type",src:Nt.a,alt:""},null,-1)})),ae=["onClick"],se={class:"file-submit"};function ce(t,e,n,r,o,a){var s=Object(i["resolveComponent"])("DropZone");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ft,[Ut,Object(i["createElementVNode"])("div",Wt,[Object(i["createElementVNode"])("div",zt,[r.state.fileList?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Gt,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(r.state.fileList,(function(t){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"card-body",key:t.memberId},[Object(i["createElementVNode"])("div",Ht,[Object(i["createElementVNode"])("p",Yt,[Object(i["createElementVNode"])("b",null,Object(i["toDisplayString"])(t.originName),1)]),Object(i["createElementVNode"])("p",Xt,"size | "+Object(i["toDisplayString"])(r.convertFileSize(t.fileSize)),1),Object(i["createElementVNode"])("p",qt,"createdAt | "+Object(i["toDisplayString"])(t.createdAt),1)]),Object(i["createElementVNode"])("div",$t,[Object(i["createElementVNode"])("img",{class:"file-item-icon",src:Mt.a,onClick:function(e){return r.onClickDownloadFile(t.fileId,t.originName)}},null,8,Jt),Object(i["createElementVNode"])("img",{class:"file-item-icon",src:Rt.a,onClick:function(e){return r.onClickDeleteFile(t.fileId)}},null,8,Kt)])])})),128))])):Object(i["createCommentVNode"])("",!0),0==r.state.fileList?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Zt,te)):Object(i["createCommentVNode"])("",!0)])]),r.isVisiableFileUploadPercent?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ee,[Object(i["createElementVNode"])("div",{class:"progress-bar",role:"progressbar",style:Object(i["normalizeStyle"])("width: ".concat(r.state.uploadFilePercent,"%")),"aria-valuenow":r.state.uploadFilePercent,"aria-valuemin":"0","aria-valuemax":"100"},null,12,ne)])):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("form",re,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(r.dropzoneFiles,(function(t,e){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:t.id,class:"file-item"},[Object(i["createElementVNode"])("span",ie,[oe,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(t.name),1)]),Object(i["createElementVNode"])("img",{class:"file-type",onClick:function(t){return r.onClickCancelFile(e)},src:Rt.a,alt:""},null,8,ae)])})),128)),Object(i["createElementVNode"])("div",se,[Object(i["createElementVNode"])("img",{class:"file-submit-icon",onClick:e[0]||(e[0]=function(){return r.onClickUploadFile&&r.onClickUploadFile.apply(r,arguments)}),src:Bt.a,alt:""}),Object(i["createElementVNode"])("span",{class:"file-submit-name",onClick:e[1]||(e[1]=function(){return r.onClickUploadFile&&r.onClickUploadFile.apply(r,arguments)})},"submit")]),Object(i["createVNode"])(s,{onDrop:Object(i["withModifiers"])(r.drop,["prevent"]),onChange:r.selectedFile},null,8,["onDrop","onChange"])])])}n("b680"),n("2b3d"),n("9861");var le=n("ec16"),ue=n("25eb"),he=n.n(ue),de=function(t){return Object(i["pushScopeId"])("data-v-2412141a"),t=t(),Object(i["popScopeId"])(),t},fe={for:"dropzoneFile"},pe=de((function(){return Object(i["createElementVNode"])("span",{id:"title"},"Drag & Drop",-1)})),ge=de((function(){return Object(i["createElementVNode"])("p",null,"or select files from device",-1)})),ve=de((function(){return Object(i["createElementVNode"])("img",{src:he.a,alt:""},null,-1)})),me=de((function(){return Object(i["createElementVNode"])("p",null,"max. size : 30MB / upload : 5",-1)})),be=[pe,ge,ve,me],ye=de((function(){return Object(i["createElementVNode"])("input",{type:"file",multiple:"",id:"dropzoneFile",class:"dropzoneFile"},null,-1)}));function Se(t,e,n,r,o,a){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("label",fe,[Object(i["createElementVNode"])("div",{onDragenter:e[0]||(e[0]=Object(i["withModifiers"])((function(){return r.toggleActive&&r.toggleActive.apply(r,arguments)}),["prevent"])),onDragleave:e[1]||(e[1]=Object(i["withModifiers"])((function(){return r.toggleActive&&r.toggleActive.apply(r,arguments)}),["prevent"])),onDragover:e[2]||(e[2]=Object(i["withModifiers"])((function(){}),["prevent"])),onDrop:e[3]||(e[3]=Object(i["withModifiers"])((function(){return r.toggleActive&&r.toggleActive.apply(r,arguments)}),["prevent"])),class:Object(i["normalizeClass"])([{"active-dropzone":r.active},"dropzone"])},be,34)]),ye])}var we={name:"SidebarFileDropzone",setup:function(){var t=Object(i["ref"])(!1),e=function(){t.value=!t.value};return{active:t,toggleActive:e}}};n("6c671");const Ee=yt()(we,[["render",Se],["__scopeId","data-v-2412141a"]]);var Ce=Ee,xe={name:"SidebarFile",components:{DropZone:Ce},setup:function(){var t=Object(pt["e"])(),e=Object(xt["c"])();t.dispatch("GET_FILE_LIST",e.params.studyId);var n=Object(i["reactive"])({fileList:Object(i["computed"])((function(){return t.state.study.fileList})),uploadFilePercent:Object(i["computed"])((function(){return t.state.study.fileUploadPercent}))});t.watch((function(t){return t.study.fileUploadPercent}),(function(t,e){0==n.uploadFilePercent||t>=e?r.value=!0:r.value=!1}));var r=Object(i["ref"])(!1),o=Object(i["ref"])([]),a=Object(i["ref"])(!1),s=Object(i["ref"])(0),c=Object(le["a"])(),l=c.notifyDanger,u=c.notifySuccess,h=function(t){return t<1024?"".concat(t,"B"):t<1048576?"".concat((t/1024).toFixed(1),"KB"):"".concat((t/1048576).toFixed(1),"MB")},d=Object(i["ref"])([]),f=function(t){for(var e=0;e<t.dataTransfer.files.length;e++)d.value.push(t.dataTransfer.files[e])},p=function(){for(var t=document.querySelector(".dropzoneFile").files,e=0;e<t.length;e++)d.value.push(t[e])},g=function(t){d.value.splice(t,1)},v=function(){var n=Object($["a"])(regeneratorRuntime.mark((function n(r){var i,o,a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r.preventDefault(),0!==d.value.length){n.next=6;break}return l("첨부한 파일이 없습니다."),n.abrupt("return");case 6:if(!(0!==d.value.length&&d.value.length>5)){n.next=11;break}return l("최대 5개까지 첨부할 수 있습니다."),n.abrupt("return");case 11:if(!(0!==d.value.length&&d.value.length<=5)){n.next=28;break}i=0,o=new FormData,a=0;case 15:if(!(a<d.value.length)){n.next=24;break}if(i+=d.value[a].size,!(i>31457280)){n.next=20;break}return l("최대 30MB만큼만 첨부할 수 있습니다."),n.abrupt("return");case 20:o.append("files",d.value[a]);case 21:a++,n.next=15;break;case 24:return t.commit("SET_FILE_UPLOAD_PERCENT_INIT"),s={studyId:e.params.studyId,uploadFileData:o,success:function(n){switch(n.data.code){case 200:u("스터디 파일 업로드 성공");break;case 400:l("스터디 파일 업로드 실패");break}d.value=[],o="",t.dispatch("GET_FILE_LIST",e.params.studyId)},fail:function(t){console.log(t),l("서버에 문제가 발생했습니다.😥")}},n.next=28,t.dispatch("UPLOAD_FILE",s);case 28:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),m=function(){var n=Object($["a"])(regeneratorRuntime.mark((function n(r,i){var o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.commit("SET_FILE_UPLOAD_PERCENT_INIT"),o={studyId:e.params.studyId,fileId:r,success:function(t){var e=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=e,n.setAttribute("download",i),document.body.appendChild(n),n.click()},fail:function(t){console.log(t),l("서버에 문제가 발생했습니다.😰")}},t.dispatch("DOWNLOAD_FILE",o);case 3:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}(),b=function(n){Object(Ot["c"])(e.params.studyId,n,(function(n){switch(n.data.code){case 200:u("스터디 파일 삭제 성공");break;case 400:l("스터디 파일 삭제 실패");break}t.dispatch("GET_FILE_LIST",e.params.studyId)}),(function(t){console.log(t),l("서버에 문제가 발생했습니다.😰")}))};return{state:n,dropzoneFiles:d,drop:f,selectedFile:p,onClickCancelFile:g,onClickUploadFile:v,onClickDownloadFile:m,onClickDeleteFile:b,convertFileSize:h,isVisiableFileUploadPercent:r,filesArray:o,uploading:a,percentage:s}}};n("21a2");const Oe=yt()(xe,[["render",ce],["__scopeId","data-v-0a313e70"]]);var _e=Oe,Te=function(t){return Object(i["pushScopeId"])("data-v-0b7dd200"),t=t(),Object(i["popScopeId"])(),t},ke={class:"memberDiv"},Ie=Te((function(){return Object(i["createElementVNode"])("p",{class:"title"},"👥 회원 목록",-1)})),Pe={class:"member-body"},je={key:0},Me={class:"col-3"},De=["src","fit"],Re={class:"col-7"},Ae={key:0},Ne={key:1};function Le(t,e,r,o,a,s){var c=Object(i["resolveComponent"])("loading");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createVNode"])(c,{active:o.state.loading,"onUpdate:active":e[0]||(e[0]=function(t){return o.state.loading=t}),"can-cancel":!1,"is-full-page":!1,height:a.height,width:a.width,color:a.color,loader:a.loader,"background-color":a.bgColor,opacity:a.opacity,"lock-scroll":!1,class:"vld-overlay",style:Object(i["normalizeStyle"])(o.state.loading?"-webkit-backdrop-filter: blur(2px); backdrop-filter: blur(2px);":"")},null,8,["active","height","width","color","loader","background-color","opacity","style"]),Object(i["createElementVNode"])("div",ke,[Ie,Object(i["createElementVNode"])("div",Pe,[r.members.length?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",je,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(o.state.list,(function(e){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"row",key:e.memberId},[Object(i["createElementVNode"])("div",Me,[Object(i["createElementVNode"])("img",{src:e.imgUrl?e.imgUrl:n("348c"),fit:t.fit,class:"profile-img"},null,8,De)]),Object(i["createElementVNode"])("div",Re,[Object(i["createElementVNode"])("p",{class:"nickname",style:Object(i["normalizeStyle"])(o.state.userInfo.memberId==e.memberId?"color:#ffe8e8":"")},[Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(e.nickname)+" ",1),o.state.userInfo.memberId==e.memberId?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Ae,"(나)")):Object(i["createCommentVNode"])("",!0)],4),Object(i["createElementVNode"])("p",{class:"goal",style:Object(i["normalizeStyle"])(o.state.userInfo.memberId==e.memberId?"color:#ffe8e8":"")},Object(i["toDisplayString"])(e.goal),5)])])})),128))])):Object(i["createCommentVNode"])("",!0),0===r.members.length?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ne," 스터디 회원 목록을 불러오지 못했습니다. ")):Object(i["createCommentVNode"])("",!0)])])],64)}var Be={data:function(){return{loader:"dots",color:"#F5CEC7",bgColor:"#1E304F",height:80,width:80,opacity:.2,lockScroll:!0}},components:{Loading:Tt.a},props:{members:Array},setup:function(t){var e=Object(pt["e"])(),n=Object(Et["q"])({loading:!1,userInfo:e.getters.getUserInfo,list:Array});function r(){n.loading=!0,setTimeout((function(){n.loading=!1}),1500)}function i(){n.list=t.members;for(var e=0;e<n.list.length;e++)if(n.list[e].memberId==n.userInfo.memberId){var r=[n.list[e],n.list[0]];n.list[0]=r[0],n.list[e]=r[1]}else n.list[e]=t.members[e]}return{loadingCall:r,state:n,memberRange:i}},created:function(){this.loadingCall(),this.memberRange()},mounted:function(){},unmounted:function(){},methods:{}};n("a267");const Ve=yt()(Be,[["render",Le],["__scopeId","data-v-0b7dd200"]]);var Fe=Ve,Ue=n("7b17"),We={name:"Sidebar",components:{SidebarChat:Pt,SidebarFile:_e,SidebarMemberView:Fe},setup:function(t,e){var n=e.emit,r=Object(pt["e"])(),o=Object(xt["c"])(),a=Object(xt["d"])();r.dispatch("GET_MEMBER_LIST",o.params.studyId);var s=Object(i["reactive"])({memberList:Object(i["computed"])((function(){return r.state.study.memberList})),isChat:!1,isMemberList:!1,isFile:!1,collapsed:!0,recvList:[],chatLog:[]}),c=22,l=4,u=Object(i["computed"])((function(){return"".concat(s.collapsed?l:c,"vw")})),h=function(){s.collapsed=!s.collapsed,s.collapsed?(s.isChat=!1,s.isMemberList=!1,s.isFile=!1):f(),n("toggleSidebar",u.value)},d=function(){s.isFile||(s.isChat=!1,s.isMemberList=!1),s.collapsed&&(s.collapsed=!1),!s.collapsed&&s.isFile&&(s.collapsed=!0),s.isFile=!s.isFile,n("toggleSidebar",u.value)},f=function(){s.isChat||(s.isFile=!1,s.isMemberList=!1),s.collapsed&&(s.collapsed=!1),!s.collapsed&&s.isChat&&(s.collapsed=!0),s.isChat=!s.isChat,n("toggleSidebar",u.value)},p=function(){s.isMemberList||(s.isFile=!1,s.isChat=!1),s.collapsed&&(s.collapsed=!1),!s.collapsed&&s.isMemberList&&(s.collapsed=!0),s.isMemberList=!s.isMemberList,n("toggleSidebar",u.value),Object(Ot["g"])(o.params.studyId,(function(t){200===t.data.code&&r.dispatch("GET_MEMBER_LIST",o.params.studyId)}),(function(t){console.log(t)}))},g=function(){a.push({name:"StudyDetail",params:{studyId:o.params.studyId}})};return{state:s,toggleSidebar:h,sidebarWidth:u,onClickChatIcon:f,onClickMemberIcon:p,onClickFileIcon:d,onClickExitIcon:g}},mounted:function(){Array.from(document.querySelectorAll('[data-bs-toggle="popover"]')).forEach((function(t){return new Ue["b"](t)}))}};n("4c6a");const ze=yt()(We,[["render",P],["__scopeId","data-v-752e2842"]]);var Ge=ze,He=function(t){return Object(i["pushScopeId"])("data-v-28d887e9"),t=t(),Object(i["popScopeId"])(),t},Ye={class:"kanbanboard"},Xe={class:"kanbanboard-header text-end mx-3"},qe=He((function(){return Object(i["createElementVNode"])("div",{class:"kanbanboard-title"},[Object(i["createElementVNode"])("h1",null,"Todo List")],-1)})),$e={key:0,class:"kanban-button"},Je=Object(i["createTextVNode"])(" 수정하기 "),Ke=Object(i["createTextVNode"])(" 불러오기 "),Ze={key:1,class:"d-flex flex-row-reverse align-items-center kanban-button"},Qe=Object(i["createTextVNode"])(" 저장하기 "),tn={class:"btn btn-outline-primary btn-primary",disabled:""},en=Object(i["createTextVNode"])(" 수정중 "),nn={class:"kanban-wrapper d-flex justify-content-center"},rn={class:"text-start mb-1"},on={class:"overflow-auto my-2",style:{height:"40vh"}},an={key:0},sn={class:"list-group-item rounded mt-1 p-3 kanban-card"},cn={key:1},ln=["onClick","disabled"];function un(t,e,n,r,o,a){var s=Object(i["resolveComponent"])("font-awesome-icon"),c=Object(i["resolveComponent"])("KanbanBoardCard"),l=Object(i["resolveComponent"])("draggable"),u=Object(i["resolveComponent"])("KanbanBoardModal"),h=Object(i["resolveComponent"])("KanbanBoardCreateModal"),d=Object(i["resolveComponent"])("KanbanWarningModal");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("div",Ye,[Object(i["createElementVNode"])("div",Xe,[qe,n.editPermit?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ze,[Object(i["createElementVNode"])("button",{class:"btn btn-primary",onClick:e[2]||(e[2]=function(){return r.onClickSaveBtn&&r.onClickSaveBtn.apply(r,arguments)})},[Qe,Object(i["createVNode"])(s,{class:"icon",icon:["fas","save"]})]),Object(i["createElementVNode"])("button",tn,[en,Object(i["createVNode"])(s,{class:"icon",icon:["fas","pen"]})])])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",$e,[Object(i["createElementVNode"])("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=function(){return r.onClickEditBtn&&r.onClickEditBtn.apply(r,arguments)})},[Je,Object(i["createVNode"])(s,{class:"icon ms-2",icon:["fas","pen"]})]),Object(i["createElementVNode"])("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=function(){return r.onClickRefreshBtn&&r.onClickRefreshBtn.apply(r,arguments)})},[Ke,Object(i["createVNode"])(s,{class:"icon ms-2",icon:["fas","sync-alt"]})])]))]),Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("div",nn,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(r.kanbanBoard,(function(t){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:t.taskId,class:"task-column"},[Object(i["createElementVNode"])("p",rn,[Object(i["createElementVNode"])("span",{class:Object(i["normalizeClass"])(["taskname px-2 py-1 user-select-none",{"bg-grey":1===t.taskId,"bg-pink":2===t.taskId,"bg-purple":3===t.taskId}])},Object(i["toDisplayString"])(t.taskName),3)]),Object(i["createElementVNode"])("div",on,[n.editPermit?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",an,[Object(i["createVNode"])(l,{class:"list-group",list:t.kanban,"item-key":"kanbanId",group:"task","ghost-class":"ghost"},{item:Object(i["withCtx"])((function(n){var o=n.element;return[Object(i["createElementVNode"])("div",sn,[Object(i["createVNode"])(c,{task:o,taskId:t.taskId,class:"align-items-center text-start",onOnClickCard:e[3]||(e[3]=function(t){return r.selectedTask.value=t})},null,8,["task","taskId"])])]})),_:2},1032,["list"])])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",cn,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(t.kanban,(function(n){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:n.kanbanId,class:"list-group-item rounded mt-1 p-3 kanban-card"},[Object(i["createVNode"])(c,{task:n,taskId:t.taskId,class:"align-items-center text-start",onOnClickCard:e[4]||(e[4]=function(t){return r.selectedTask.value=t})},null,8,["task","taskId"])])})),128))]))]),Object(i["createElementVNode"])("button",{class:Object(i["normalizeClass"])(["mt-auto btn",{"bg-grey":1===t.taskId,"bg-pink":2===t.taskId,"bg-purple":3===t.taskId}]),"data-bs-toggle":"modal","data-bs-target":"#kanbanCardCreateModal",onClick:function(e){return r.statusId=t.taskId},disabled:!n.editPermit}," 추가하기 ",10,ln)])})),128))])])]),Object(i["createVNode"])(u,{selectedTask:r.selectedTask,editPermit:n.editPermit,onUpdateTask:e[5]||(e[5]=function(t){return r.updateTask(t)}),onDeleteTask:e[6]||(e[6]=function(t){return r.deleteTask(t)})},null,8,["selectedTask","editPermit"]),Object(i["createVNode"])(h,{taskId:r.statusId,onCreateTask:e[7]||(e[7]=function(t){return r.createTask(t)})},null,8,["taskId"]),Object(i["createVNode"])(d,{edittingUser:r.edittingUser,onIsEditPermit:e[8]||(e[8]=function(t){return r.isEditPermit(t)})},null,8,["edittingUser"])])}n("c740");var hn={class:"mb-0"};function dn(t,e,n,r,o,a){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{onClick:e[0]||(e[0]=function(){return r.onClickCard&&r.onClickCard.apply(r,arguments)}),class:"user-select-none overflow-hidden","data-bs-toggle":"modal","data-bs-target":"#kanbanCardUpdateModal"},[Object(i["createElementVNode"])("p",hn,Object(i["toDisplayString"])(n.task.content),1)])}n("a9e3");var fn={name:"KanbanBoardCard",components:{},props:{task:Object,taskId:Number},emits:["onClickCard"],setup:function(t,e){var n=e.emit,r=function(){n("onClickCard",{content:t.task.content,kanbanId:t.task.kanbanId,taskId:t.taskId})};return{onClickCard:r}}};n("f3c7");const pn=yt()(fn,[["render",dn],["__scopeId","data-v-2aabc472"]]);var gn=pn,vn={class:"modal-dialog modal-dialog-centered modal-md"},mn={class:"modal-content"},bn={key:1,class:"modal-body"},yn={class:"modal-footer"};function Sn(t,e,n,r,o,a){var s=Object(i["resolveComponent"])("font-awesome-icon");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"modal fade",id:"kanbanCardUpdateModal",tabindex:"-1","aria-labelledby":"kanbanCardUpdateModalLabel","aria-hidden":"true",onClick:e[7]||(e[7]=Object(i["withModifiers"])((function(){return r.closeInput&&r.closeInput.apply(r,arguments)}),["self"]))},[Object(i["createElementVNode"])("div",vn,[Object(i["createElementVNode"])("div",mn,[r.state.isEdit?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",bn,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{type:"text",ref:"inputForm",class:"form-control",maxlength:"100",minlength:"1","onUpdate:modelValue":e[1]||(e[1]=function(t){return r.state.task.value.content=t}),onKeyup:e[2]||(e[2]=Object(i["withKeys"])((function(){return r.closeInput&&r.closeInput.apply(r,arguments)}),["enter"])),onBlur:e[3]||(e[3]=function(){return r.closeInput&&r.closeInput.apply(r,arguments)})},null,544),[[i["vModelText"],r.state.task.value.content]])])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:0,class:"modal-body text-break text-start",onClick:e[0]||(e[0]=function(){return r.openInput&&r.openInput.apply(r,arguments)})},Object(i["toDisplayString"])(n.selectedTask.value?n.selectedTask.value.content:""),1)),Object(i["createElementVNode"])("div",yn,[n.editPermit?(Object(i["openBlock"])(),Object(i["createElementBlock"])("button",{key:0,type:"button",class:"btn btn-primary btn-sm",onClick:e[4]||(e[4]=function(){return r.openInput&&r.openInput.apply(r,arguments)})},[Object(i["createVNode"])(s,{icon:["fas","pen"]})])):Object(i["createCommentVNode"])("",!0),n.editPermit?(Object(i["openBlock"])(),Object(i["createElementBlock"])("button",{key:1,type:"button",class:"btn btn-primary btn-sm",onClick:e[5]||(e[5]=function(){return r.onClickDelete&&r.onClickDelete.apply(r,arguments)}),"data-bs-dismiss":"modal"},[Object(i["createVNode"])(s,{icon:["fas","trash-alt"]})])):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("button",{type:"button",class:"btn btn-primary btn-sm","data-bs-dismiss":"modal",onClick:e[6]||(e[6]=function(){return r.closeInput&&r.closeInput.apply(r,arguments)})},[Object(i["createVNode"])(s,{icon:["fas","times"]})])])])])])}var wn={name:"KanbanBoardModal",components:{},props:{selectedTask:Object,editPermit:Boolean},emits:["updateTask","deleteTask"],setup:function(t,e){var n=e.emit,r=Object(le["a"])(),o=r.notifyDanger,a=Object(i["reactive"])({isEdit:!1,task:t.selectedTask}),s=function(){if(a.isEdit=!1,a.task.value.content){n("updateTask",a.task);var t=document.getElementById("kanbanCardUpdateModal"),e=Ue["a"].getInstance(t);e.hide()}else o("입력 값이 없습니다.😥")},c=Object(i["ref"])(null),l=function(){t.editPermit&&(a.isEdit=!0,setTimeout((function(){return c.value.focus()}),0))},u=function(){n("deleteTask",a.task)};return{state:a,closeInput:s,openInput:l,onClickDelete:u,inputForm:c}}};n("194a");const En=yt()(wn,[["render",Sn],["__scopeId","data-v-30481866"]]);var Cn=En,xn={class:"modal-dialog modal-dialog-centered modal-md"},On={class:"modal-content"},_n={class:"modal-body"},Tn={class:"modal-footer"};function kn(t,e,n,r,o,a){var s=Object(i["resolveComponent"])("font-awesome-icon");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"modal fade",id:"kanbanCardCreateModal",tabindex:"-1","aria-labelledby":"kanbanCardCreateModalLabel","aria-hidden":"true",onClick:e[4]||(e[4]=Object(i["withModifiers"])((function(){return r.onCloseModal&&r.onCloseModal.apply(r,arguments)}),["self"]))},[Object(i["createElementVNode"])("div",xn,[Object(i["createElementVNode"])("div",On,[Object(i["createElementVNode"])("div",_n,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{type:"text",ref:"inputForm","onUpdate:modelValue":e[0]||(e[0]=function(t){return r.state.content=t}),onKeypress:e[1]||(e[1]=Object(i["withKeys"])((function(){return r.onClickCreate&&r.onClickCreate.apply(r,arguments)}),["enter"])),class:"form-control",maxlength:"100",minlength:"1"},null,544),[[i["vModelText"],r.state.content]])]),Object(i["createElementVNode"])("div",Tn,[Object(i["createElementVNode"])("button",{type:"button",class:"btn btn-primary btn-sm",onClick:e[2]||(e[2]=function(){return r.onClickCreate&&r.onClickCreate.apply(r,arguments)}),"data-bs-dismiss":"modal"},[Object(i["createVNode"])(s,{icon:["fas","check"]})]),Object(i["createElementVNode"])("button",{type:"button",class:"btn btn-primary btn-sm","data-bs-dismiss":"modal",onClick:e[3]||(e[3]=function(){return r.onCloseModal&&r.onCloseModal.apply(r,arguments)})},[Object(i["createVNode"])(s,{icon:["fas","times"]})])])])])])}var In={name:"KanbanBoardCreateModal",components:{},props:{taskId:Number},emits:["createTask"],setup:function(t,e){var n=e.emit,r=Object(le["a"])(),o=r.notifyDanger,a=Object(i["reactive"])({content:""}),s=function(){a.content=""},c=function(){a.content?n("createTask",{taskId:t.taskId,content:a.content,kanbanId:Date.now()}):o("입력 값이 없습니다.😥"),a.content="";var e=document.getElementById("kanbanCardCreateModal"),r=Ue["a"].getInstance(e);r.hide()};return{state:a,onCloseModal:s,onClickCreate:c}}};n("4b91");const Pn=yt()(In,[["render",kn],["__scopeId","data-v-07e53066"]]);var jn=Pn,Mn={class:"modal fade",id:"KanbanWarningModal",tabindex:"-1","aria-labelledby":"KanbanWarningModalLabel","aria-hidden":"true"},Dn={class:"modal-dialog modal-dialog-centered modal-md"},Rn={class:"modal-content"},An=Object(i["createElementVNode"])("div",{class:"modal-header"},[Object(i["createElementVNode"])("h5",{class:"modal-title",id:"KanbanWarningModalLabel"},"칸반 보드 수정 불가!")],-1),Nn={class:"modal-body"},Ln={class:"fs-5 fw-bold"},Bn=Object(i["createTextVNode"])(" 님이 수정 중입니다. "),Vn=Object(i["createElementVNode"])("p",null," 수정 권한을 가져오면 수정 중이던 내용이 손상될 수 있습니다. ",-1),Fn=Object(i["createElementVNode"])("p",null," 그래도 가져오시겠습니까? ",-1),Un={class:"modal-footer"},Wn=Object(i["createElementVNode"])("button",{type:"button",class:"btn btn-primary btn-sm","data-bs-dismiss":"modal"},"닫기",-1);function zn(t,e,n,r,o,a){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Mn,[Object(i["createElementVNode"])("div",Dn,[Object(i["createElementVNode"])("div",Rn,[An,Object(i["createElementVNode"])("div",Nn,[Object(i["createElementVNode"])("span",Ln,Object(i["toDisplayString"])(n.edittingUser),1),Bn]),Vn,Fn,Object(i["createElementVNode"])("div",Un,[Object(i["createElementVNode"])("button",{type:"button",class:"btn btn-danger btn-sm","data-bs-dismiss":"modal",onClick:e[0]||(e[0]=function(){return r.onClickTakePermit&&r.onClickTakePermit.apply(r,arguments)})},"가져오기"),Wn])])])])}var Gn={name:"KanbanWarningModal",props:{edittingUser:String},components:{},setup:function(t,e){var n=e.emit,r=Object(xt["c"])(),i=function(){var t=Object($["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(Ot["k"])(r.params.studyId,(function(t){200===t.data.code?n("isEditPermit",!0):console.log("에러 발생")}),(function(t){console.log(t)}));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{onClickTakePermit:i}}};const Hn=yt()(Gn,[["render",zn]]);var Yn=Hn,Xn=n("b76a"),qn=n.n(Xn),$n={name:"KanbanBoard",props:{editPermit:Boolean},components:{KanbanBoardCard:gn,KanbanBoardModal:Cn,KanbanBoardCreateModal:jn,draggable:qn.a,KanbanWarningModal:Yn},setup:function(t,e){var n=e.emit,r=Object(xt["c"])(),o=Object(pt["e"])(),a=Object(i["computed"])((function(){return o.state.study.studyInfo.kanbanBoard})),s=Object(i["ref"])(null),c=Object(i["ref"])({}),l=function(t){a.value[t.value.taskId-1].kanban.forEach((function(e){e.kanbanId===t.value.kanbanId&&(e.content=t.value.content)}))},u=function(t){var e=a.value[t.value.taskId-1].kanban.findIndex((function(e){return e.kanbanId===t.value.kanbanId}));a.value[t.value.taskId-1].kanban.splice(e,1)},h=Object(i["ref"])(""),d=function(){var t=document.getElementById("KanbanWarningModal"),e=Ue["a"].getOrCreateInstance(t);e.show()},f=function(){var t=Object($["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=function(){return new Promise((function(t){o.dispatch("GET_STUDY_INFO",r.params.studyId),t()}))},t.next=3,e();case 3:Object(Ot["a"])(r.params.studyId,(function(t){200===t.data.code?n("isEditPermit",!0):400===t.data.code&&(h.value=t.data.data.nickname,d(),n("isEditPermit",!1))}),(function(t){console.log(t)}));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),p=Object(le["a"])(),g=p.notifySuccess,v=p.notifyDanger,m=function(){var t=r.params.studyId,e=[];a.value.forEach((function(n){var r=n.taskId;n.kanban.forEach((function(n){e.push({studyId:t,taskId:r,content:n.content})}))})),Object(Ot["l"])(e,t,(function(e){200===e.data.code?(o.dispatch("GET_STUDY_INFO",t),g("칸반 보드 저장 완료!")):401===e.data.code&&v("수정 권한 없음!")}),(function(t){console.log(t)})),n("isEditPermit",!1)},b=function(){o.dispatch("GET_STUDY_INFO",r.params.studyId)},y=function(t){var e=t.taskId;a.value[e-1].kanban.push({content:t.content,kanbanId:t.kanbanId})},S=function(t){n("isEditPermit",t)};return Object(i["onBeforeUnmount"])((function(){t.editPermit&&m()})),{kanbanBoard:a,selectedTask:c,updateTask:l,onClickEditBtn:f,onClickSaveBtn:m,onClickRefreshBtn:b,deleteTask:u,statusId:s,createTask:y,edittingUser:h,isEditPermit:S}}};n("6567");const Jn=yt()($n,[["render",un],["__scopeId","data-v-28d887e9"]]);var Kn=Jn,Zn={class:"screenshare"},Qn={id:"main-video"},tr={key:0,class:"background"};function er(t,e,n,r,o,a){var s=Object(i["resolveComponent"])("user-video");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("div",Zn,[Object(i["createElementVNode"])("div",Qn,[Object(i["createVNode"])(s,{"stream-manager":n.streamManager,mainStream:!0,onDblclick:e[0]||(e[0]=function(e){return t.$emit("deleteMainVideoStreamManager")})},null,8,["stream-manager"])])]),n.streamManager?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",tr))])}var nr={key:0,id:"UserVideo"},rr={class:"user-name"};function ir(t,e,n,r,o,a){var s=Object(i["resolveComponent"])("OvVideo");return n.streamManager?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",nr,[Object(i["createVNode"])(s,{"stream-manager":n.streamManager,isSpeak:n.isSpeak,mainStream:n.mainStream},null,8,["stream-manager","isSpeak","mainStream"]),Object(i["createElementVNode"])("p",rr,Object(i["toDisplayString"])(a.clientData),1)])):Object(i["createCommentVNode"])("",!0)}var or=["poster"],ar=["poster"];function sr(t,e,n,r,o,a){return n.mainStream?(Object(i["openBlock"])(),Object(i["createElementBlock"])("video",{key:0,class:"main",autoplay:"",poster:a.defaultPosterSrc},null,8,or)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("video",{key:1,class:Object(i["normalizeClass"])(["sub",{"video-isSpeak":n.isSpeak}]),autoplay:"",poster:a.defaultPosterSrc},null,10,ar))}var cr={name:"OvVideo",props:{streamManager:Object,mainStream:Boolean,isSpeak:Boolean},computed:{defaultPosterSrc:function(){return"SCREEN"===this.streamManager.stream.typeOfVideo||this.streamManager.accessAllow?"":n("348c")}},mounted:function(){this.streamManager.addVideoElement(this.$el)},updated:function(){this.streamManager.addVideoElement(this.$el)}};n("3172");const lr=yt()(cr,[["render",sr],["__scopeId","data-v-79cec500"]]);var ur=lr,hr={name:"UserVideo",components:{OvVideo:ur},props:{streamManager:Object,mainStream:Boolean,isSpeak:Boolean},computed:{clientData:function(){var t=this.getConnectionData(),e=t.clientData;return e}},methods:{getConnectionData:function(){var t=this.streamManager.stream.connection;return JSON.parse(t.data)}}};n("60fd");const dr=yt()(hr,[["render",ir],["__scopeId","data-v-38f95f04"]]);var fr=dr,pr={components:{UserVideo:fr},props:{streamManager:Object}};n("4be5");const gr=yt()(pr,[["render",er],["__scopeId","data-v-6a0803dc"]]);var vr=gr,mr=function(t){return Object(i["pushScopeId"])("data-v-fb4a2a6c"),t=t(),Object(i["popScopeId"])(),t},br={class:"whiteboard-wrapper"},yr={id:"whiteboard"},Sr={class:"btn-group",role:"group"},wr=mr((function(){return Object(i["createElementVNode"])("i",{class:"fas fa-mouse-pointer"},null,-1)})),Er=[wr],Cr=mr((function(){return Object(i["createElementVNode"])("i",{class:"fas fa-pen"},null,-1)})),xr=[Cr],Or=mr((function(){return Object(i["createElementVNode"])("i",{class:"fas fa-slash fa-rotate-90"},null,-1)})),_r=[Or],Tr=mr((function(){return Object(i["createElementVNode"])("i",{class:"far fa-square"},null,-1)})),kr=[Tr],Ir={class:"dropdown"},Pr=mr((function(){return Object(i["createElementVNode"])("button",{type:"button",class:"btn btn-primary dropdown-toggle","data-bs-toggle":"dropdown","aria-expanded":"false"},[Object(i["createElementVNode"])("i",{class:"fas fa-minus"})],-1)})),jr={class:"dropdown-menu"},Mr=mr((function(){return Object(i["createElementVNode"])("div",{class:"menu-label"},"Width (0 ~ 10)",-1)})),Dr={class:"dropdown"},Rr=mr((function(){return Object(i["createElementVNode"])("button",{type:"button",class:"btn btn-primary dropdown-toggle","data-bs-toggle":"dropdown","aria-expanded":"false"},[Object(i["createElementVNode"])("i",{class:"fas fa-tint"})],-1)})),Ar={class:"dropdown-menu"},Nr=mr((function(){return Object(i["createElementVNode"])("div",{class:"menu-label"},"Color",-1)})),Lr={class:"form-check form-check-inline"},Br=mr((function(){return Object(i["createElementVNode"])("div",{class:"color",style:{"background-color":"black"}},null,-1)})),Vr={class:"form-check form-check-inline"},Fr=mr((function(){return Object(i["createElementVNode"])("div",{class:"color",style:{"background-color":"red"}},null,-1)})),Ur={class:"form-check form-check-inline"},Wr=mr((function(){return Object(i["createElementVNode"])("div",{class:"color",style:{"background-color":"blue"}},null,-1)})),zr={class:"form-check form-check-inline"},Gr=mr((function(){return Object(i["createElementVNode"])("div",{class:"color",style:{"background-color":"green"}},null,-1)})),Hr={class:"form-check form-check-inline"},Yr=mr((function(){return Object(i["createElementVNode"])("div",{class:"color",style:{"background-color":"yellow"}},null,-1)})),Xr=mr((function(){return Object(i["createElementVNode"])("i",{class:"fas fa-undo"},null,-1)})),qr=[Xr],$r=mr((function(){return Object(i["createElementVNode"])("i",{class:"fas fa-redo"},null,-1)})),Jr=[$r],Kr=mr((function(){return Object(i["createElementVNode"])("i",{class:"fas fa-trash-alt"},null,-1)})),Zr=[Kr],Qr=mr((function(){return Object(i["createElementVNode"])("button",{type:"button",class:"btn btn-primary btn"},[Object(i["createElementVNode"])("i",{class:"fas fa-download"})],-1)})),ti=[Qr],ei=mr((function(){return Object(i["createElementVNode"])("canvas",{id:"canvas"},null,-1)}));function ni(t,e,n,r,o,a){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",br,[Object(i["createElementVNode"])("div",yr,[Object(i["createElementVNode"])("div",Sr,[Object(i["createElementVNode"])("button",{type:"button",class:Object(i["normalizeClass"])(["btn btn-primary btn",{active:o.isPointer}]),onClick:e[0]||(e[0]=function(t){return a.activateTool("pointer")})},Er,2),Object(i["createElementVNode"])("button",{type:"button",class:Object(i["normalizeClass"])(["btn btn-primary btn",{active:o.isPen}]),onClick:e[1]||(e[1]=function(t){return a.activateTool("pen")})},xr,2),Object(i["createElementVNode"])("button",{type:"button",class:Object(i["normalizeClass"])(["btn btn-primary btn",{active:o.isLine}]),onClick:e[2]||(e[2]=function(t){return a.activateTool("line")})},_r,2),Object(i["createElementVNode"])("button",{type:"button",class:Object(i["normalizeClass"])(["btn btn-primary btn",{active:o.isRect}]),onClick:e[3]||(e[3]=function(t){return a.activateTool("rect")})},kr,2),Object(i["createElementVNode"])("div",Ir,[Pr,Object(i["createElementVNode"])("div",jr,[Mr,Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{type:"range",class:"form-range",min:"0",max:"10",step:"1","onUpdate:modelValue":e[4]||(e[4]=function(t){return o.current.width=t}),onChange:e[5]||(e[5]=function(){return a.handleChangeWidth&&a.handleChangeWidth.apply(a,arguments)})},null,544),[[i["vModelText"],o.current.width]])])]),Object(i["createElementVNode"])("div",Dr,[Rr,Object(i["createElementVNode"])("div",Ar,[Nr,Object(i["createElementVNode"])("div",Lr,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{id:"black-radio",class:"form-check-input",type:"radio",value:"black","onUpdate:modelValue":e[6]||(e[6]=function(t){return o.current.color=t}),onChange:e[7]||(e[7]=function(){return a.handleChangeColor&&a.handleChangeColor.apply(a,arguments)})},null,544),[[i["vModelRadio"],o.current.color]]),Br]),Object(i["createElementVNode"])("div",Vr,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{id:"red-radio",class:"form-check-input",type:"radio",value:"red","onUpdate:modelValue":e[8]||(e[8]=function(t){return o.current.color=t}),onChange:e[9]||(e[9]=function(){return a.handleChangeColor&&a.handleChangeColor.apply(a,arguments)})},null,544),[[i["vModelRadio"],o.current.color]]),Fr]),Object(i["createElementVNode"])("div",Ur,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{id:"blue-radio",class:"form-check-input",type:"radio",value:"blue","onUpdate:modelValue":e[10]||(e[10]=function(t){return o.current.color=t}),onChange:e[11]||(e[11]=function(){return a.handleChangeColor&&a.handleChangeColor.apply(a,arguments)})},null,544),[[i["vModelRadio"],o.current.color]]),Wr]),Object(i["createElementVNode"])("div",zr,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{id:"green-radio",class:"form-check-input",type:"radio",value:"green","onUpdate:modelValue":e[12]||(e[12]=function(t){return o.current.color=t}),onChange:e[13]||(e[13]=function(){return a.handleChangeColor&&a.handleChangeColor.apply(a,arguments)})},null,544),[[i["vModelRadio"],o.current.color]]),Gr]),Object(i["createElementVNode"])("div",Hr,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{id:"yellow-radio",class:"form-check-input",type:"radio",value:"yellow","onUpdate:modelValue":e[14]||(e[14]=function(t){return o.current.color=t}),onChange:e[15]||(e[15]=function(){return a.handleChangeColor&&a.handleChangeColor.apply(a,arguments)})},null,544),[[i["vModelRadio"],o.current.color]]),Yr])])]),Object(i["createElementVNode"])("button",{type:"button",class:"btn btn-primary btn",onClick:e[16]||(e[16]=function(){return a.undo&&a.undo.apply(a,arguments)})},qr),Object(i["createElementVNode"])("button",{type:"button",class:"btn btn-primary btn",onClick:e[17]||(e[17]=function(){return a.redo&&a.redo.apply(a,arguments)})},Jr),Object(i["createElementVNode"])("button",{type:"button",class:"btn btn-primary btn",onClick:e[18]||(e[18]=function(){return a.clear&&a.clear.apply(a,arguments)})},Zr),Object(i["createElementVNode"])("a",{id:"download",onClick:e[19]||(e[19]=function(){return a.save&&a.save.apply(a,arguments)})},ti)]),ei])])}n("bf19");var ri=n("7a94"),ii=n("5317"),oi=n.n(ii);function ai(t,e="",n){let r=t;n=n||"undefined"!==typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"===typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(t="undefined"!==typeof n?n.protocol+"//"+t:"https://"+t),r=oi()(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=-1!==r.host.indexOf(":"),o=i?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port+e,r.href=r.protocol+"://"+o+(n&&n.port===r.port?"":":"+r.port),r}var si=n("c9eb"),ci=n.n(si),li=n("20a4"),ui=function(t){const e=t.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!e||ci.a))return new XMLHttpRequest}catch(n){}if(!e)try{return new(li["a"][["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(n){}},hi=n("af7f"),di=n("b19d"),fi=n("34ba"),pi=n("0299"),gi=n.n(pi),vi=n("4f2a"),mi=n.n(vi),bi=n("33e8");class yi extends fi["a"]{constructor(){super(...arguments),this.polling=!1}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(t++,this.once("pollComplete",(function(){--t||e()}))),this.writable||(t++,this.once("drain",(function(){--t||e()})))}else e()}poll(){this.polling=!0,this.doPoll(),this.emit("poll")}onData(t){const e=t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose(),!1;this.onPacket(t)};Object(bi["b"])(t,this.socket.binaryType).forEach(e),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,Object(bi["d"])(t,t=>{this.doWrite(t,()=>{this.writable=!0,this.emit("drain")})})}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let n="";!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=gi()()),this.supportsBinary||t.sid||(t.b64=1),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);const r=mi.a.encode(t),i=-1!==this.opts.hostname.indexOf(":");return e+"://"+(i?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}}function Si(){}const wi=function(){const t=new ui({xdomain:!1});return null!=t.responseType}();class Ei extends yi{constructor(t){if(super(t),"undefined"!==typeof location){const e="https:"===location.protocol;let n=location.port;n||(n=e?"443":"80"),this.xd="undefined"!==typeof location&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==e}const e=t&&t.forceBase64;this.supportsBinary=wi&&!e}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new Ci(this.uri(),t)}doWrite(t,e){const n=this.request({method:"POST",data:t});n.on("success",e),n.on("error",t=>{this.onError("xhr post error",t)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",t=>{this.onError("xhr poll error",t)}),this.pollXhr=t}}class Ci extends di["Emitter"]{constructor(t,e){super(),Object(hi["a"])(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.create()}create(){const t=Object(hi["b"])(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new ui(t);try{e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let t in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&e.setRequestHeader(t,this.opts.extraHeaders[t])}}catch(n){}if("POST"===this.method)try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(n){}try{e.setRequestHeader("Accept","*/*")}catch(n){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),e.onreadystatechange=()=>{4===e.readyState&&(200===e.status||1223===e.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"===typeof e.status?e.status:0)},0))},e.send(this.data)}catch(n){return void this.setTimeoutFn(()=>{this.onError(n)},0)}"undefined"!==typeof document&&(this.index=Ci.requestsCount++,Ci.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(t){this.emit("data",t),this.onSuccess()}onError(t){this.emit("error",t),this.cleanup(!0)}cleanup(t){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=Si,t)try{this.xhr.abort()}catch(e){}"undefined"!==typeof document&&delete Ci.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&this.onData(t)}abort(){this.cleanup()}}if(Ci.requestsCount=0,Ci.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",xi);else if("function"===typeof addEventListener){const t="onpagehide"in li["a"]?"pagehide":"unload";addEventListener(t,xi,!1)}function xi(){for(let t in Ci.requests)Ci.requests.hasOwnProperty(t)&&Ci.requests[t].abort()}var Oi=n("1f49");const _i={websocket:Oi["a"],polling:Ei};class Ti extends di["Emitter"]{constructor(t,e={}){super(),t&&"object"===typeof t&&(e=t,t=null),t?(t=oi()(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=oi()(e.host).host),Object(hi["a"])(this,e),this.secure=null!=e.secure?e.secure:"undefined"!==typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"===typeof this.opts.query&&(this.opts.query=mi.a.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"===typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){const e=ki(this.opts.query);e.EIO=bi["e"],e.transport=t,this.id&&(e.sid=this.id);const n=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new _i[t](n)}open(){let t;if(this.opts.rememberUpgrade&&Ti.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(e){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",()=>{this.onClose("transport close")})}probe(t){let e=this.createTransport(t),n=!1;Ti.priorWebsocketSuccess=!1;const r=()=>{n||(e.send([{type:"ping",data:"probe"}]),e.once("packet",t=>{if(!n)if("pong"===t.type&&"probe"===t.data){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;Ti.priorWebsocketSuccess="websocket"===e.name,this.transport.pause(()=>{n||"closed"!==this.readyState&&(l(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const t=new Error("probe error");t.transport=e.name,this.emitReserved("upgradeError",t)}}))};function i(){n||(n=!0,l(),e.close(),e=null)}const o=t=>{const n=new Error("probe error: "+t);n.transport=e.name,i(),this.emitReserved("upgradeError",n)};function a(){o("transport closed")}function s(){o("socket closed")}function c(t){e&&t.name!==e.name&&i()}const l=()=>{e.removeListener("open",r),e.removeListener("error",o),e.removeListener("close",a),this.off("close",s),this.off("upgrading",c)};e.once("open",r),e.once("error",o),e.once("close",a),this.once("close",s),this.once("upgrading",c),e.open()}onOpen(){if(this.readyState="open",Ti.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emitReserved("flush"))}write(t,e,n){return this.sendPacket("message",t,e,n),this}send(t,e,n){return this.sendPacket("message",t,e,n),this}sendPacket(t,e,n,r){if("function"===typeof e&&(r=e,e=void 0),"function"===typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;n=n||{},n.compress=!1!==n.compress;const i={type:t,data:e,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},n=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():t()}):this.upgrading?n():t()),this}onError(t){Ti.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"===typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let n=0;const r=t.length;for(;n<r;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}}function ki(t){const e={};for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}Ti.protocol=bi["e"];Ti.protocol;const Ii="function"===typeof ArrayBuffer,Pi=t=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,ji=Object.prototype.toString,Mi="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===ji.call(Blob),Di="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===ji.call(File);function Ri(t){return Ii&&(t instanceof ArrayBuffer||Pi(t))||Mi&&t instanceof Blob||Di&&t instanceof File}function Ai(t,e){if(!t||"object"!==typeof t)return!1;if(Array.isArray(t)){for(let e=0,n=t.length;e<n;e++)if(Ai(t[e]))return!0;return!1}if(Ri(t))return!0;if(t.toJSON&&"function"===typeof t.toJSON&&1===arguments.length)return Ai(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&Ai(t[n]))return!0;return!1}function Ni(t){const e=[],n=t.data,r=t;return r.data=Li(n,e),r.attachments=e.length,{packet:r,buffers:e}}function Li(t,e){if(!t)return t;if(Ri(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<t.length;r++)n[r]=Li(t[r],e);return n}if("object"===typeof t&&!(t instanceof Date)){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=Li(t[r],e));return n}return t}function Bi(t,e){return t.data=Vi(t.data,e),t.attachments=void 0,t}function Vi(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=Vi(t[n],e);else if("object"===typeof t)for(const n in t)t.hasOwnProperty(n)&&(t[n]=Vi(t[n],e));return t}const Fi=5;var Ui;(function(t){t[t["CONNECT"]=0]="CONNECT",t[t["DISCONNECT"]=1]="DISCONNECT",t[t["EVENT"]=2]="EVENT",t[t["ACK"]=3]="ACK",t[t["CONNECT_ERROR"]=4]="CONNECT_ERROR",t[t["BINARY_EVENT"]=5]="BINARY_EVENT",t[t["BINARY_ACK"]=6]="BINARY_ACK"})(Ui||(Ui={}));class Wi{encode(t){return t.type!==Ui.EVENT&&t.type!==Ui.ACK||!Ai(t)?[this.encodeAsString(t)]:(t.type=t.type===Ui.EVENT?Ui.BINARY_EVENT:Ui.BINARY_ACK,this.encodeAsBinary(t))}encodeAsString(t){let e=""+t.type;return t.type!==Ui.BINARY_EVENT&&t.type!==Ui.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data)),e}encodeAsBinary(t){const e=Ni(t),n=this.encodeAsString(e.packet),r=e.buffers;return r.unshift(n),r}}class zi extends di["Emitter"]{constructor(){super()}add(t){let e;if("string"===typeof t)e=this.decodeString(t),e.type===Ui.BINARY_EVENT||e.type===Ui.BINARY_ACK?(this.reconstructor=new Hi(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e);else{if(!Ri(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const n={type:Number(t.charAt(0))};if(void 0===Ui[n.type])throw new Error("unknown packet type "+n.type);if(n.type===Ui.BINARY_EVENT||n.type===Ui.BINARY_ACK){const r=e+1;while("-"!==t.charAt(++e)&&e!=t.length);const i=t.substring(r,e);if(i!=Number(i)||"-"!==t.charAt(e))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===t.charAt(e+1)){const r=e+1;while(++e){const n=t.charAt(e);if(","===n)break;if(e===t.length)break}n.nsp=t.substring(r,e)}else n.nsp="/";const r=t.charAt(e+1);if(""!==r&&Number(r)==r){const r=e+1;while(++e){const n=t.charAt(e);if(null==n||Number(n)!=n){--e;break}if(e===t.length)break}n.id=Number(t.substring(r,e+1))}if(t.charAt(++e)){const r=Gi(t.substr(e));if(!zi.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}static isPayloadValid(t,e){switch(t){case Ui.CONNECT:return"object"===typeof e;case Ui.DISCONNECT:return void 0===e;case Ui.CONNECT_ERROR:return"string"===typeof e||"object"===typeof e;case Ui.EVENT:case Ui.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case Ui.ACK:case Ui.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}function Gi(t){try{return JSON.parse(t)}catch(e){return!1}}class Hi{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=Bi(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Yi(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const Xi=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class qi extends di["Emitter"]{constructor(t,e,n){super(),this.connected=!1,this.disconnected=!0,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Yi(t,"open",this.onopen.bind(this)),Yi(t,"packet",this.onpacket.bind(this)),Yi(t,"error",this.onerror.bind(this)),Yi(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io["_reconnecting"]||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(Xi.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');e.unshift(t);const n={type:Ui.EVENT,data:e,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"===typeof e[e.length-1]){const t=this.ids++,r=e.pop();this._registerAckCallback(t,r),n.id=t}const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,i=this.flags.volatile&&(!r||!this.connected);return i||(this.connected?this.packet(n):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(t,e){const n=this.flags.timeout;if(void 0===n)return void(this.acks[t]=e);const r=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&this.sendBuffer.splice(e,1);e.call(this,new Error("operation has timed out"))},n);this.acks[t]=(...t)=>{this.io.clearTimeoutFn(r),e.apply(this,[null,...t])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth(t=>{this.packet({type:Ui.CONNECT,data:t})}):this.packet({type:Ui.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t){this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",t)}onpacket(t){const e=t.nsp===this.nsp;if(e)switch(t.type){case Ui.CONNECT:if(t.data&&t.data.sid){const e=t.data.sid;this.onconnect(e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ui.EVENT:this.onevent(t);break;case Ui.BINARY_EVENT:this.onevent(t);break;case Ui.ACK:this.onack(t);break;case Ui.BINARY_ACK:this.onack(t);break;case Ui.DISCONNECT:this.ondisconnect();break;case Ui.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e);break}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const n of e)n.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let n=!1;return function(...r){n||(n=!0,e.packet({type:Ui.ACK,id:t,data:r}))}}onack(t){const e=this.acks[t.id];"function"===typeof e&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>this.packet(t)),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io["_destroy"](this)}disconnect(){return this.connected&&this.packet({type:Ui.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}var $i=n("0b64"),Ji=n.n($i);class Ki extends di["Emitter"]{constructor(t,e){var n;super(),this.nsps={},this.subs=[],t&&"object"===typeof t&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,Object(hi["a"])(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=e.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new Ji.a({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const i=e.parser||r;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Ti(this.uri,this.opts);const e=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=Yi(e,"open",(function(){n.onopen(),t&&t()})),i=Yi(e,"error",e=>{n.cleanup(),n._readyState="closed",this.emitReserved("error",e),t?t(e):n.maybeReconnectOnOpen()});if(!1!==this._timeout){const t=this._timeout;0===t&&r();const n=this.setTimeoutFn(()=>{r(),e.close(),e.emit("error",new Error("timeout"))},t);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}return this.subs.push(r),this.subs.push(i),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Yi(t,"ping",this.onping.bind(this)),Yi(t,"data",this.ondata.bind(this)),Yi(t,"error",this.onerror.bind(this)),Yi(t,"close",this.onclose.bind(this)),Yi(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,e){let n=this.nsps[t];return n||(n=new qi(this,t,e),this.nsps[t]=n),n}_destroy(t){const e=Object.keys(this.nsps);for(const n of e){const t=this.nsps[n];if(t.active)return}this._close()}_packet(t){const e=this.encoder.encode(t);for(let n=0;n<e.length;n++)this.engine.write(e[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open(e=>{e?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()}))},e);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Zi={};function Qi(t,e){"object"===typeof t&&(e=t,t=void 0),e=e||{};const n=ai(t,e.path||"/socket.io"),r=n.source,i=n.id,o=n.path,a=Zi[i]&&o in Zi[i]["nsps"],s=e.forceNew||e["force new connection"]||!1===e.multiplex||a;let c;return s?c=new Ki(r,e):(Zi[i]||(Zi[i]=new Ki(r,e)),c=Zi[i]),n.query&&!e.query&&(e.query=n.queryKey),c.socket(n.path,e)}Object.assign(Qi,{Manager:Ki,Socket:qi,io:Qi,connect:Qi});var to={data:function(){return{socket:null,context:null,isPointer:!1,isPen:!0,isLine:!1,isRect:!1,isMouseDown:!1,line:null,rect:null,startCoord:{x:null,y:null},current:{width:2,color:"black"},snapshotIndex:-1,snapshotList:[],studyId:this.$route.params.studyId}},mounted:function(){var t=this;this.canvas=new ri["fabric"].Canvas("canvas",{isDrawingMode:!0}),this.context=this.canvas.getContext("2d"),window.addEventListener("resize",this.onResize,!1),this.onResize(),this.canvas.selectionFullyContained=!1,this.handleChangeWidth(),this.handleChangeColor(),this.pushSnapshot(),this.socket=Qi.connect(this.urlForSocket(),{secure:!0}),this.socket.on("connect",(function(){t.socket.emit("join",t.studyId)})),this.socket.on("send-data",(function(e){t.receiveCanvas(e)})),this.listenToCanvasEvents()},beforeUnmount:function(){this.socket.disconnect()},methods:{activateTool:function(t){switch(this.isPointer=!1,this.isPen=!1,this.isLine=!1,this.isRect=!1,this.canvas.selection="pointer"===t,this.toggleObjectsSelectable("pointer"===t),this.canvas.isDrawingMode="pen"===t,t){case"pointer":this.isPointer=!0;break;case"pen":this.isPen=!0;break;case"line":this.isLine=!0;break;case"rect":this.isRect=!0;break}},toggleObjectsSelectable:function(t){this.canvas.discardActiveObject(),this.canvas.forEachObject((function(e){e.selectable=t,e.evented=t})),this.canvas.renderAll()},urlForSocket:function(){return"https://i6a501.p.ssafy.io"},sendCanvas:function(){var t=this.canvas.toJSON();this.socket.emit("send-data",{studyId:this.studyId,canvas:t})},receiveCanvas:function(t){t&&t.canvas&&(this.canvas.loadFromJSON(t.canvas,this.canvas.renderAll.bind(this.canvas)),this.toggleObjectsSelectable(this.isPointer))},listenToCanvasEvents:function(){this.listenToMouseDown(),this.listenToMouseMove(),this.listenToMouseUp(),this.listenToObjectModified()},listenToMouseDown:function(){var t=this;this.canvas.on("mouse:down",(function(e){if(t.isMouseDown=!0,!t.isPen){if(t.isLine){var n=t.canvas.getPointer(e.e),r=[n.x,n.y,n.x,n.y];t.line=new ri["fabric"].Line(r,{strokeWidth:Number(t.current.width),stroke:t.current.color,selectable:!1,evented:!1}),t.canvas.add(t.line)}else if(t.isRect){var i=t.canvas.getPointer(e.e);t.startCoord.x=i.x,t.startCoord.y=i.y,t.rect=new ri["fabric"].Rect({left:i.x,top:i.y,height:0,width:0,fill:"transparent",stroke:t.current.color,strokeWidth:Number(t.current.width),borderScaleFactor:1,selectable:!1,evented:!1}),t.canvas.add(t.rect)}t.canvas.renderAll()}}))},listenToMouseMove:function(){var t=this;this.canvas.on("mouse:move",(function(e){if(t.isMouseDown){if(t.isLine){var n=t.canvas.getPointer(e.e);t.line.set({x2:n.x,y2:n.y}),t.line.setCoords()}else if(t.isRect){var r=t.canvas.getPointer(e.e);t.rect.set({left:Math.min(t.startCoord.x,r.x),top:Math.min(t.startCoord.y,r.y)}),t.rect.set({height:Math.abs(r.y-t.startCoord.y),width:Math.abs(r.x-t.startCoord.x)}),t.rect.setCoords()}t.canvas.renderAll()}}))},listenToMouseUp:function(){var t=this;this.canvas.on("mouse:up",(function(){t.isMouseDown=!1,t.isPointer||(t.canvas.renderAll(),t.pushSnapshot(),t.sendCanvas())}))},listenToObjectModified:function(){var t=this;this.canvas.on("object:modified",(function(){t.pushSnapshot(),t.sendCanvas()}))},handleChangeWidth:function(){this.canvas.freeDrawingBrush.width=Number(this.current.width)},handleChangeColor:function(){var t=this.canvas.freeDrawingBrush;t.color=this.current.color,t.getPatternSrc&&(t.source=t.getPatternSrc.call(t))},pushSnapshot:function(){this.snapshotIndex++,this.snapshotList.length!==this.snapshotIndex&&(this.snapshotList=this.snapshotList.splice(0,this.snapshotIndex)),this.snapshotList.push(JSON.stringify(this.canvas.toJSON()))},undo:function(){0!==this.snapshotIndex&&(this.snapshotIndex--,this.canvas.loadFromJSON(JSON.parse(this.snapshotList[this.snapshotIndex]),this.canvas.renderAll.bind(this.canvas)),this.toggleObjectsSelectable(this.isPointer)),this.sendCanvas()},redo:function(){this.snapshotIndex<this.snapshotList.length-1&&(this.snapshotIndex++,this.canvas.loadFromJSON(JSON.parse(this.snapshotList[this.snapshotIndex]),this.canvas.renderAll.bind(this.canvas)),this.toggleObjectsSelectable(this.isPointer)),this.sendCanvas()},clear:function(){this.canvas.clear(),this.pushSnapshot(),this.sendCanvas()},save:function(){var t=document.getElementById("canvas").toDataURL("image/png",1).replace("image/png","image/octet-stream"),e=document.getElementById("download");e.download="my_image.png",e.href=t},onResize:function(){var t=document.getElementById("canvas").parentElement.parentElement;this.canvas.setWidth(t.offsetWidth),this.canvas.setHeight(t.offsetHeight)}}};n("b78e");const eo=yt()(to,[["render",ni],["__scopeId","data-v-fb4a2a6c"]]);var no=eo,ro=function(t){return Object(i["pushScopeId"])("data-v-7aafa3a8"),t=t(),Object(i["popScopeId"])(),t},io={class:"memo-board-wrapper"},oo={class:"memo-board position-relative overflow-hidden",id:"memoContainer"},ao=ro((function(){return Object(i["createElementVNode"])("span",null,"타인에게 보이지 않는 개인 공간입니다.",-1)})),so={key:0,class:"btn-container"},co={key:1,class:"btn-container"},lo=["onClick"];function uo(t,e,n,r,o,a){var s=Object(i["resolveComponent"])("font-awesome-icon"),c=Object(i["resolveComponent"])("Moveable"),l=Object(i["resolveComponent"])("MemoModal"),u=Object(i["resolveDirective"])("dragscroll");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createElementVNode"])("div",io,[Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",oo,[ao,o.isEditting?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",so,[Object(i["createElementVNode"])("button",{class:"btn btn-primary ms-2 shadow",onClick:e[0]||(e[0]=function(){return a.onClickCreateBtn&&a.onClickCreateBtn.apply(a,arguments)})},[Object(i["createVNode"])(s,{icon:["fas","plus"]})]),Object(i["createElementVNode"])("button",{class:"btn btn-primary ms-2 shadow",onClick:e[1]||(e[1]=function(){return a.onClickDelete&&a.onClickDelete.apply(a,arguments)})},[Object(i["createVNode"])(s,{icon:["fas","trash-alt"]})]),Object(i["createElementVNode"])("button",{class:"btn btn-primary ms-2 shadow",onClick:e[2]||(e[2]=function(){return a.onClickSaveBtn&&a.onClickSaveBtn.apply(a,arguments)})},[Object(i["createVNode"])(s,{icon:["fas","save"]})])])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",co,[Object(i["createElementVNode"])("button",{class:"btn btn-primary shadow",onClick:e[3]||(e[3]=function(t){return o.isEditting=!0})},[Object(i["createVNode"])(s,{icon:["fas","edit"]})])])),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(t.memoList,(function(t,n){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:n,class:Object(i["normalizeClass"])(["postit user-select-none position-absolute m-0 py-3 px-3 text-start",["target"+n,o.colorList[t.color]]]),style:Object(i["normalizeStyle"])({"z-index":t.zIndex,transform:t.transform}),onDblclick:e[4]||(e[4]=function(){return a.onDblClick&&a.onDblClick.apply(a,arguments)}),onClick:function(t){return a.handleSelectedMemo(n)}},Object(i["toDisplayString"])(t.content),47,lo)})),128)),-1!==t.selectedIdx&&o.isEditting?(Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:2,className:"moveable",draggable:!0,target:[".target"+t.selectedIdx],rotatable:!0,scalable:!0,snappable:!0,origin:!1,bounds:{position:"absolute",left:10,right:o.containerWidth-10,top:10,bottom:o.containerHeight-10},onDrag:a.onDrag,onScale:a.onScale,onRotate:a.onRotate,onRenderEnd:e[5]||(e[5]=function(e){return a.handleRenderEnd(t.selectedIdx,e)})},null,8,["target","bounds","onDrag","onScale","onRotate"])):Object(i["createCommentVNode"])("",!0)])),[[u,void 0,"nochilddrag"]])]),o.isEditting?(Object(i["openBlock"])(),Object(i["createBlock"])(l,{key:0})):Object(i["createCommentVNode"])("",!0)],64)}function ho(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.map((function(e){return e.split(" ").map((function(e){return e?""+t+e:""})).join(" ")})).join(" ")}function fo(t,e){return e.replace(/([^}{]*){/gm,(function(e,n){return n.replace(/\.([^{,\s\d.]+)/g,"."+t+"$1")+"{"}))}function po(t,e){return function(n){n&&(t[e]=n)}}function go(t,e,n){return function(r){r&&(t[e][n]=r)}}function vo(t,e){return function(n){var r=n.prototype;t.forEach((function(t){e(r,t)}))}}function mo(t,e){return void 0===e&&(e={}),function(n,r){t.forEach((function(t){var i=e[t]||t;i in n||(n[i]=function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var o=(e=this[r])[t].apply(e,n);return o===this[r]?this:o})}))}}var bo=function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,e){var n=this.keys,r=this.values,i=n.indexOf(t),o=-1===i?n.length:i;n[o]=t,r[o]=e},t}(),yo=function(){function t(){this.object={}}var e=t.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,e){this.object[t]=e},t}(),So="function"===typeof Map,wo=function(){function t(){}var e=t.prototype;return e.connect=function(t,e){this.prev=t,this.next=e,t&&(t.next=this),e&&(e.prev=this)},e.disconnect=function(){var t=this.prev,e=this.next;t&&(t.next=e),e&&(e.prev=t)},e.getIndex=function(){var t=this,e=-1;while(t)t=t.prev,++e;return e},t}();function Eo(t,e){var n=[],r=[];return t.forEach((function(t){var e=t[0],i=t[1],o=new wo;n[e]=o,r[i]=o})),n.forEach((function(t,e){t.connect(n[e-1])})),t.filter((function(t,n){return!e[n]})).map((function(t,e){var i=t[0],o=t[1];if(i===o)return[0,0];var a=n[i],s=r[o-1],c=a.getIndex();a.disconnect(),s?a.connect(s,s.next):a.connect(void 0,n[0]);var l=a.getIndex();return[c,l]}))}var Co=function(){function t(t,e,n,r,i,o,a,s){this.prevList=t,this.list=e,this.added=n,this.removed=r,this.changed=i,this.maintained=o,this.changedBeforeAdded=a,this.fixed=s}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=Eo(this.changedBeforeAdded,this.fixed),e=this.changed,n=[];this.cacheOrdered=t.filter((function(t,r){var i=t[0],o=t[1],a=e[r],s=a[0],c=a[1];if(i!==o)return n.push([s,c]),!0})),this.cachePureChanged=n},t}();function xo(t,e,n){var r=So?Map:n?yo:bo,i=n||function(t){return t},o=[],a=[],s=[],c=t.map(i),l=e.map(i),u=new r,h=new r,d=[],f=[],p={},g=[],v=0,m=0;return c.forEach((function(t,e){u.set(t,e)})),l.forEach((function(t,e){h.set(t,e)})),c.forEach((function(t,e){var n=h.get(t);"undefined"===typeof n?(++m,a.push(e)):p[n]=m})),l.forEach((function(t,e){var n=u.get(t);"undefined"===typeof n?(o.push(e),++v):(s.push([n,e]),m=p[e]||0,d.push([n-m,e-v]),f.push(e===n),n!==e&&g.push([n,e]))})),a.reverse(),new Co(t,e,o,a,g,s,d,f)}var Oo=function(){function t(t,e){void 0===t&&(t=[]),this.findKeyCallback=e,this.list=[].slice.call(t)}var e=t.prototype;return e.update=function(t){var e=[].slice.call(t),n=xo(this.list,e,this.findKeyCallback);return this.list=e,n},t}(),_o=Oo,To="function",ko="object",Io="string",Po="number",jo="undefined",Mo=(typeof document!==jo&&document,[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}]),Do=1e-7,Ro={cm:function(t){return 96*t/2.54},mm:function(t){return 96*t/254},in:function(t){return 96*t},pt:function(t){return 96*t/72},pc:function(t){return 96*t/6},"%":function(t,e){return t*e/100},vw:function(t,e){return void 0===e&&(e=window.innerWidth),t/100*e},vh:function(t,e){return void 0===e&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return void 0===e&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return void 0===e&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};function Ao(t,e,n,r){return(t*r+e*n)/(n+r)}function No(t){return typeof t===jo}function Lo(t){return t&&typeof t===ko}function Bo(t){return Array.isArray(t)}function Vo(t){return typeof t===Io}function Fo(t){return typeof t===Po}function Uo(t){return typeof t===To}function Wo(t,e){var n=""===t||" "==t,r=""===e||" "==e;return r&&n||t===e}function zo(t,e,n,r,i){var o=Go(t,e,n);return o?n:Ho(t,e,n+1,r,i)}function Go(t,e,n){if(!t.ignore)return null;var r=e.slice(Math.max(n-3,0),n+3).join("");return new RegExp(t.ignore).exec(r)}function Ho(t,e,n,r,i){for(var o,a=function(n){var a=e[n].trim();if(a===t.close&&!Go(t,e,n))return{value:n};var s=n,c=ea(i,(function(t){var e=t.open;return e===a}));if(c&&(s=zo(c,e,n,r,i)),-1===s)return o=n,"break";n=s,o=n},s=n;s<r;++s){var c=a(s);if(s=o,"object"===typeof c)return c.value;if("break"===c)break}return-1}function Yo(t,e){var n=Vo(e)?{separator:e}:e,r=n.separator,i=void 0===r?",":r,o=n.isSeparateFirst,a=n.isSeparateOnlyOpenClose,s=n.isSeparateOpenClose,c=void 0===s?a:s,l=n.openCloseCharacters,u=void 0===l?Mo:l,h=u.map((function(t){var e=t.open,n=t.close;return e===n?e:e+"|"+n})).join("|"),d="(\\s*"+i+"\\s*|"+h+"|\\s+)",f=new RegExp(d,"g"),p=t.split(f).filter(Boolean),g=p.length,v=[],m=[];function b(){return!!m.length&&(v.push(m.join("")),m=[],!0)}for(var y,S=function(t){var e=p[t].trim(),n=t,r=ea(u,(function(t){var n=t.open;return n===e})),s=ea(u,(function(t){var n=t.close;return n===e}));if(r){if(n=zo(r,p,t,g,u),-1!==n&&c)return b()&&o?(y=t,"break"):(v.push(p.slice(t,n+1).join("")),t=n,o?(y=t,"break"):(y=t,"continue"))}else{if(s&&!Go(s,p,t))throw new Error("invalid format: "+s.close);if(Wo(e,i)&&!a)return b(),o?(y=t,"break"):(y=t,"continue")}-1===n&&(n=g-1),m.push(p.slice(t,n+1).join("")),t=n,y=t},w=0;w<g;++w){var E=S(w);if(w=y,"break"===E)break}return m.length&&v.push(m.join("")),v}function Xo(t){return Yo(t,"")}function qo(t){return Yo(t,",")}function $o(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function Jo(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var n=e[1],r=e[2],i=e[3];return{prefix:n,unit:i,value:parseFloat(r)}}function Ko(t){return t.replace(/[\s-_]([a-z])/g,(function(t,e){return e.toUpperCase()}))}function Zo(t,e){return void 0===e&&(e="-"),t.replace(/([a-z])([A-Z])/g,(function(t,n,r){return""+n+e+r.toLowerCase()}))}function Qo(){return Date.now?Date.now():(new Date).getTime()}function ta(t,e,n){void 0===n&&(n=-1);for(var r=t.length,i=0;i<r;++i)if(e(t[i],i,t))return i;return n}function ea(t,e,n){var r=ta(t,e);return r>-1?t[r]:n}function na(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in e)e.push(n);return e}function ra(t,e){var n=Jo(t),r=n.value,i=n.unit;if(Lo(e)){var o=e[i];if(o){if(Uo(o))return o(r);if(Ro[i])return Ro[i](r,o)}}else if("%"===i)return r*e/100;return Ro[i]?Ro[i](r):r}function ia(t,e,n){return Math.max(e,Math.min(t,n))}function oa(t,e,n){return[[fa(e[0],Do),fa(e[0]*t[1]/t[0],Do)],[fa(e[1]*t[0]/t[1],Do),fa(e[1],Do)]].filter((function(t){return t.every((function(t,r){return n?t<=e[r]:t>=e[r]}))}))[0]||t}function aa(t,e,n,r){if(!r)return t.map((function(t,r){return ia(t,e[r],n[r])}));var i=t[0],o=t[1],a=oa(t,e,!1),s=a[0],c=a[1],l=oa(t,n,!0),u=l[0],h=l[1];return i<s||o<c?(i=s,o=c):(i>u||o>h)&&(i=u,o=h),[i,o]}function sa(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return n}function ca(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return e?n/e:0}function la(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.atan2(r,n);return i>=0?i:i+2*Math.PI}function ua(t){return[0,1].map((function(e){return ca(t.map((function(t){return t[e]})))}))}function ha(t){var e=ua(t),n=la(e,t[0]),r=la(e,t[1]);return n<r&&r-n<Math.PI||n>r&&r-n<-Math.PI?1:-1}function da(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function fa(t,e){return e?Math.round(t/e)*e:t}function pa(t,e){return t.forEach((function(n,r){t[r]=fa(t[r],e)})),t}function ga(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function va(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function ma(t,e){if(t.classList)t.classList.remove(e);else{var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ")}}function ba(t,e,n,r){t.addEventListener(e,n,r)}function ya(t,e,n,r){t.removeEventListener(e,n,r)}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Sa=function(t,e){return Sa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Sa(t,e)};function wa(t,e){function n(){this.constructor=t}Sa(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Ea=function(){return Ea=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Ea.apply(this,arguments)};function Ca(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function xa(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function Oa(t,e){if(t===e)return!1;for(var n in t)if(!(n in e))return!0;for(var n in e)if(t[n]!==e[n])return!0;return!1}function _a(t,e){var n=Object.keys(t),r=Object.keys(e),i=xo(n,r,(function(t){return t})),o={},a={},s={};return i.added.forEach((function(t){var n=r[t];o[n]=e[n]})),i.removed.forEach((function(e){var r=n[e];a[r]=t[r]})),i.maintained.forEach((function(r){var i=r[0],o=n[i],a=[t[o],e[o]];t[o]!==e[o]&&(s[o]=a)})),{added:o,removed:a,changed:s}}function Ta(t){t.forEach((function(t){t()}))}function ka(t){var e=0;return t.map((function(t){return null==t?"$compat"+ ++e:""+t}))}function Ia(t,e,n,r){if(Vo(t)||Fo(t))return new Va("text_"+t,e,n,r,null,{});var i="string"===typeof t.type?Fa:t.type.prototype.render?Ha:za;return new i(t.type,e,n,r,t.ref,t.props)}function Pa(t){var e=[];return t.forEach((function(t){e=e.concat(Bo(t)?Pa(t):t)})),e}function ja(t){var e=t.className,n=Ca(t,["className"]);return null!=e&&(n.class=e),delete n.style,delete n.children,n}function Ma(t,e){if(!e)return t;for(var n in e)No(t[n])&&(t[n]=e[n]);return t}function Da(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=e||{},o=i.key,a=i.ref,s=Ca(i,["key","ref"]);return{type:t,key:o,ref:a,props:Ea(Ea({},s),{children:Pa(n).filter((function(t){return null!=t&&!1!==t}))})}}var Ra=function(){function t(t,e,n,r,i,o){void 0===o&&(o={}),this.type=t,this.key=e,this.index=n,this.container=r,this.ref=i,this.props=o,this._providers=[]}var e=t.prototype;return e._should=function(t,e){return!0},e._update=function(t,e,n,r){if(this.base&&!Vo(e)&&!r&&!this._should(e.props,n))return!1;this.original=e,this._setState(n);var i=this.props;return Vo(e)||(this.props=e.props,this.ref=e.ref),this._render(t,this.base?i:{},n),!0},e._mounted=function(){var t=this.ref;t&&t(this.base)},e._setState=function(t){},e._updated=function(){var t=this.ref;t&&t(this.base)},e._destroy=function(){var t=this.ref;t&&t(null)},t}();function Aa(t,e,n){var r=_a(t,e),i=r.added,o=r.removed,a=r.changed;for(var s in i)n.setAttribute(s,i[s]);for(var s in a)n.setAttribute(s,a[s][1]);for(var s in o)n.removeAttribute(s)}function Na(t,e,n){var r=_a(t,e),i=r.added,o=r.removed,a=r.changed;for(var s in o)n.removeEventListener(s);for(var s in i)n.addEventListener(s,i[s]);for(var s in a)n.removeEventListener(s),n.addEventListener(s,a[s][1]);for(var s in o)n.removeEventListener(s)}function La(t,e,n){var r=n.style,i=_a(t,e),o=i.added,a=i.removed,s=i.changed;for(var c in o){var l=Zo(c,"-");r.setProperty?r.setProperty(l,o[c]):r[l]=o[c]}for(var c in s){l=Zo(c,"-");r.setProperty?r.setProperty(l,s[c][1]):r[l]=s[c][1]}for(var c in a){l=Zo(c,"-");r.removeProperty?r.removeProperty(l):r[l]=""}}function Ba(t){var e={},n={};for(var r in t)0===r.indexOf("on")?n[r.replace("on","").toLowerCase()]=t[r]:e[r]=t[r];return{attributes:e,events:n}}var Va=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}wa(e,t);var n=e.prototype;return n._render=function(t){var e=this,n=!this.base;return n&&(this.base=document.createTextNode(this.type.replace("text_",""))),t.push((function(){n?e._mounted():e._updated()})),!0},n._unmount=function(){this.base.parentNode.removeChild(this.base)},e}(Ra),Fa=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.events={},e._isSVG=!1,e}wa(e,t);var n=e.prototype;return n.addEventListener=function(t,e){var n=this.events;n[t]=function(t){t.nativeEvent=t,e(t)},this.base.addEventListener(t,n[t])},n.removeEventListener=function(t){var e=this.events;this.base.removeEventListener(t,e[t]),delete e[t]},n._should=function(t){return Oa(this.props,t)},n._render=function(t,e){var n=this,r=!this.base;if(r){var i=this._hasSVG();this._isSVG=i;var o=this.props.portalContainer;if(!o){var a=this.type;o=i?document.createElementNS("http://www.w3.org/2000/svg",a):document.createElement(a)}this.base=o}Za(this,this._providers,this.props.children,t,null);var s=this.base,c=Ba(e),l=c.attributes,u=c.events,h=Ba(this.props),d=h.attributes,f=h.events;return Aa(ja(l),ja(d),s),Na(u,f,this),La(e.style||{},this.props.style||{},s),t.push((function(){r?n._mounted():n._updated()})),!0},n._unmount=function(){var t=this.events,e=this.base;for(var n in t)e.removeEventListener(n,t[n]);this._providers.forEach((function(t){t._unmount()})),this.events={},this.props.portalContainer||e.parentNode.removeChild(e)},n._hasSVG=function(){if(this._isSVG||"svg"===this.type)return!0;var t=Ua(this.container);return t&&"ownerSVGElement"in t},e}(Ra);function Ua(t){if(!t)return null;var e=t.base;return e instanceof Node?e:Ua(t.container)}function Wa(t){if(!t)return null;if(t instanceof Node)return t;var e=t.$_provider._providers;return e.length?Wa(e[0].base):null}var za=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}wa(e,t);var n=e.prototype;return n._render=function(t){var e=this.type(this.props);return Za(this,this._providers,e?[e]:[],t),!0},n._unmount=function(){this._providers.forEach((function(t){t._unmount()}))},e}(Ra),Ga=function(t){function e(e){var n=t.call(this,"container","container",0,null)||this;return n.base=e,n}wa(e,t);var n=e.prototype;return n._render=function(){return!0},n._unmount=function(){},e}(Ra),Ha=function(t){function e(e,n,r,i,o,a){return void 0===a&&(a={}),t.call(this,e,n,r,i,o,Ma(a,e.defaultProps))||this}wa(e,t);var n=e.prototype;return n._should=function(t,e){return this.base.shouldComponentUpdate(Ma(t,this.type.defaultProps),e||this.base.state)},n._render=function(t,e,n){var r=this;this.props=Ma(this.props,this.type.defaultProps);var i=!this.base;i?(this.base=new this.type(this.props),this.base.$_provider=this):this.base.props=this.props;var o=this.base,a=o.state,s=o.render();s&&s.props&&!s.props.children.length&&(s.props.children=this.props.children),Za(this,this._providers,s?[s]:[],t,n,null),t.push((function(){i?(r._mounted(),o.componentDidMount()):(r._updated(),o.componentDidUpdate(e,a))}))},n._setState=function(t){var e=this.base;e&&t&&(e.state=t)},n._unmount=function(){this._providers.forEach((function(t){t._unmount()})),clearTimeout(this.base.$_timer),this.base.componentWillUnmount()},e}(Ra),Ya=function(){function t(t){void 0===t&&(t={}),this.props=t,this.state={},this.$_timer=0,this.$_state={}}var e=t.prototype;return e.shouldComponentUpdate=function(t,e){return!0},e.render=function(){return null},e.setState=function(t,e,n){var r=this;this.$_timer||(this.$_state={}),clearTimeout(this.$_timer),this.$_timer=0,this.$_state=Ea(Ea({},this.$_state),t),n?this.$_setState(e,n):this.$_timer=setTimeout((function(){r.$_timer=0,r.$_setState(e,n)}))},e.forceUpdate=function(t){this.setState({},t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,e){},e.componentWillUnmount=function(){},e.$_setState=function(t,e){var n=[],r=this.$_provider,i=Za(r.container,[r],[r.original],n,Ea(Ea({},this.state),this.$_state),e);i&&(t&&n.push(t),Ta(n))},t}(),Xa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}wa(e,t);var n=e.prototype;return n.shouldComponentUpdate=function(t,e){return Oa(this.props,t)||Oa(this.state,e)},e}(Ya),qa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}wa(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this.props,e=t.element,n=t.container;this._portalProvider=new Ga(n),Qa(e,n,this._portalProvider)},n.componentDidUpdate=function(){var t=this.props,e=t.element,n=t.container;Qa(e,n,this._portalProvider)},n.componentWillUnmount=function(){var t=this.props.container;Qa(null,t,this._portalProvider),this._portalProvider=null},e}(Xa);function $a(t,e,n){var r=[];Za(t,t._providers,e,r,n),Ta(r)}function Ja(t,e){for(var n=t._providers,r=n.length,i=e.index+1;i<r;++i){var o=Wa(n[i].base);if(o)return o}return null}function Ka(t,e,n){var r=n.map((function(t){return Vo(t)?null:t.key})),i=ka(e.map((function(t){return t.key}))),o=ka(r),a=xo(i,o,(function(t){return t}));a.removed.forEach((function(t){e.splice(t,1)[0]._unmount()})),a.ordered.forEach((function(t){var n=t[0],r=t[1],i=e.splice(n,1)[0];e.splice(r,0,i);var o=Wa(i.base),a=Wa(e[r+1]&&e[r+1].base);o&&o.parentNode.insertBefore(o,a)})),a.added.forEach((function(i){e.splice(i,0,Ia(n[i],r[i],i,t))}));var s=a.maintained.filter((function(i){i[0];var o=i[1],a=n[o],s=e[o],c=Vo(a)?"text_"+a:a.type;return c!==s.type?(s._unmount(),e.splice(o,1,Ia(a,r[o],o,t)),!0):(s.index=o,!1)}));return xa(a.added,s.map((function(t){t[0];var e=t[1];return e})))}function Za(t,e,n,r,i,o){var a=Ka(t,e,n),s=e.filter((function(t,e){return t._update(r,n[e],i,o)})),c=Ua(t);return c&&a.reverse().forEach((function(n){var r=e[n],i=Wa(r.base);if(i&&c!==i&&!i.parentNode){var o=Ja(t,r);c.insertBefore(i,o)}})),s.length>0}function Qa(t,e,n){void 0===n&&(n=e.__REACT_COMPAT__);var r=!!n;return n||(n=new Ga(e)),$a(n,t?[t]:[]),r||(e.__REACT_COMPAT__=n),n}function ts(t,e,n){var r=e.__REACT_COMPAT__;t&&!r&&(e.innerHTML=""),Qa(t,e,r),n&&n()}function es(t,e){return Da(qa,{element:t,container:e})}var ns="simple-1.1.0";function rs(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return!0;return!1}function is(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return t[r];return null}function os(t){var e=t;if("undefined"===typeof e){if("undefined"===typeof navigator||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function as(t,e){try{return new RegExp(t,"g").exec(e)}catch(n){return null}}function ss(){if("undefined"===typeof navigator||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!(!e||!e.length)}function cs(t,e){var n=as("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return n?n[3]:""}function ls(t){return t.replace(/_/g,".")}function us(t,e){var n=null,r="-1";return rs(t,(function(t){var i=as("("+t.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!(!i||t.brand)&&(n=t,r=i[3]||"-1",t.versionAlias?r=t.versionAlias:t.versionTest&&(r=cs(t.versionTest.toLowerCase(),e)||r),r=ls(r),!0)})),{preset:n,version:r}}function hs(t,e){var n={brand:"",version:"-1"};return rs(t,(function(t){var r=ds(e,t);return!!r&&(n.brand=t.id,n.version=t.versionAlias||r.version,"-1"!==n.version)})),n}function ds(t,e){return is(t,(function(t){var n=t.brand;return as(""+e.test,n.toLowerCase())}))}var fs=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],ps=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],gs=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],vs=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],ms=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"mac os x",id:"mac"},{test:"android",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function bs(t){var e=navigator.userAgentData,n=(e.uaList||e.brands).slice(),r=e.mobile||!1,i=n[0],o={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!hs(vs,n).brand},a={name:"unknown",version:"-1",majorVersion:-1};o.webkit=!o.chromium&&rs(gs,(function(t){return ds(n,t)}));var s=hs(ps,n);if(o.chromium=!!s.brand,o.chromiumVersion=s.version,!o.chromium){var c=hs(gs,n);o.webkit=!!c.brand,o.webkitVersion=c.version}if(t){var l=t.platform.toLowerCase(),u=is(ms,(function(t){return new RegExp(""+t.test,"g").exec(l)}));a.name=u?u.id:l,a.version=t.platformVersion}var h=hs(fs,n);return h.brand&&(o.name=h.brand,o.version=t?t.uaFullVersion:h.version),"Linux armv8l"===navigator.platform?a.name="android":o.webkit&&(a.name=r?"ios":"mac"),"ios"===a.name&&o.webview&&(o.version="-1"),a.version=ls(a.version),o.version=ls(o.version),a.majorVersion=parseInt(a.version,10),o.majorVersion=parseInt(o.version,10),{browser:o,os:a,isMobile:r,isHints:!0}}function ys(t){var e=os(t),n=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:!!us(vs,e).preset,chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},o=us(fs,e),a=o.preset,s=o.version,c=us(ms,e),l=c.preset,u=c.version,h=us(ps,e);if(r.chromium=!!h.preset,r.chromiumVersion=h.version,!r.chromium){var d=us(gs,e);r.webkit=!!d.preset,r.webkitVersion=d.version}return l&&(i.name=l.id,i.version=u,i.majorVersion=parseInt(u,10)),a&&(r.name=a.id,r.version=s,r.webview&&"ios"===i.name&&"safari"!==r.name&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:n,isHints:!1}}function Ss(t){return"undefined"===typeof t&&ss()?bs():ys(t)}var ws=Ss;function Es(t,e,n,r,i,o){for(var a=0;a<i;++a){var s=n+a*i,c=r+a*i;t[s]+=t[c]*o,e[s]+=e[c]*o}}function Cs(t,e,n,r,i){for(var o=0;o<i;++o){var a=n+o*i,s=r+o*i,c=t[a],l=e[a];t[a]=t[s],t[s]=c,e[a]=e[s],e[s]=l}}function xs(t,e,n,r,i){for(var o=0;o<r;++o){var a=n+o*r;t[a]/=i,e[a]/=i}}function Os(t,e,n){void 0===n&&(n=Math.sqrt(t.length));for(var r=t.slice(),i=0;i<n;++i)r[i*n+e-1]=0,r[(e-1)*n+i]=0;return r[(e-1)*(n+1)]=1,r}function _s(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=t.slice(),r=Xs(e),i=0;i<e;++i){var o=e*i+i;if(!fa(n[o],Do))for(var a=i+1;a<e;++a)if(n[e*i+a]){Cs(n,r,i,a,e);break}if(!fa(n[o],Do))return[];xs(n,r,i,e,n[o]);for(a=0;a<e;++a){var s=a,c=a+i*e,l=n[c];fa(l,Do)&&i!==a&&Es(n,r,s,i,e,-l)}}return r}function Ts(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=[],r=0;r<e;++r)for(var i=0;i<e;++i)n[i*e+r]=t[e*r+i];return n}function ks(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=[],r=t[e*e-1],i=0;i<e-1;++i)n[i]=t[e*(e-1)+i]/r;return n[e-1]=0,n}function Is(t,e){for(var n=Xs(e),r=0;r<e-1;++r)n[e*(e-1)+r]=t[r]||0;return n}function Ps(t,e){for(var n=t.slice(),r=t.length;r<e-1;++r)n[r]=0;return n[e-1]=1,n}function js(t,e,n){if(void 0===e&&(e=Math.sqrt(t.length)),e===n)return t;for(var r=Xs(n),i=Math.min(e,n),o=0;o<i-1;++o){for(var a=0;a<i-1;++a)r[o*n+a]=t[o*e+a];r[(o+1)*n-1]=t[(o+1)*e-1],r[(n-1)*n+o]=t[(e-1)*e+o]}return r[n*n-1]=t[e*e-1],r}function Ms(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=Xs(t);return e.forEach((function(e){r=Ds(r,e,t)})),r}function Ds(t,e,n){void 0===n&&(n=Math.sqrt(t.length));var r=[],i=t.length/n,o=e.length/i;if(!i)return e;if(!o)return t;for(var a=0;a<n;++a)for(var s=0;s<o;++s){r[s*n+a]=0;for(var c=0;c<i;++c)r[s*n+a]+=t[c*n+a]*e[s*i+c]}return r}function Rs(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]+e[i];return r}function As(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]-e[i];return r}function Ns(t,e){return void 0===e&&(e=6===t.length),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function Ls(t,e){return void 0===e&&(e=9===t.length),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function Bs(t,e,n){void 0===n&&(n=e.length);var r=Ds(t,e,n),i=r[n-1];return r.map((function(t){return t/i}))}function Vs(t,e){return Ds(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function Fs(t,e){return Ds(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function Us(t,e){return Ds(t,Ys(e,4))}function Ws(t,e){var n=e[0],r=void 0===n?1:n,i=e[1],o=void 0===i?1:i,a=e[2],s=void 0===a?1:a;return Ds(t,[r,0,0,0,0,o,0,0,0,0,s,0,0,0,0,1],4)}function zs(t,e){return Bs(Ys(e,3),Ps(t,3))}function Gs(t,e){var n=e[0],r=void 0===n?0:n,i=e[1],o=void 0===i?0:i,a=e[2],s=void 0===a?0:a;return Ds(t,[1,0,0,0,0,1,0,0,0,0,1,0,r,o,s,1],4)}function Hs(t,e){return Ds(t,e,4)}function Ys(t,e){var n=Math.cos(t),r=Math.sin(t),i=Xs(e);return i[0]=n,i[1]=r,i[e]=-r,i[e+1]=n,i}function Xs(t){for(var e=t*t,n=[],r=0;r<e;++r)n[r]=r%(t+1)?0:1;return n}function qs(t,e){for(var n=Xs(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[(e+1)*i]=t[i];return n}function $s(t,e){for(var n=Xs(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[e*(e-1)+i]=t[i];return n}function Js(t,e,n,r,i,o,a,s){var c=t[0],l=t[1],u=e[0],h=e[1],d=n[0],f=n[1],p=r[0],g=r[1],v=i[0],m=i[1],b=o[0],y=o[1],S=a[0],w=a[1],E=s[0],C=s[1],x=[c,0,u,0,d,0,p,0,l,0,h,0,f,0,g,0,1,0,1,0,1,0,1,0,0,c,0,u,0,d,0,p,0,l,0,h,0,f,0,g,0,1,0,1,0,1,0,1,-v*c,-m*c,-b*u,-y*u,-S*d,-w*d,-E*p,-C*p,-v*l,-m*l,-b*h,-y*h,-S*f,-w*f,-E*g,-C*g],O=_s(x,8);if(!O.length)return[];var _=Ds(O,[v,m,b,y,S,w,E,C],8);return _[8]=1,js(Ts(_),3,4)}function Ks(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Zs(t){return tc(ec(t))}function Qs(t,e){var n=Bs(t,[e[0],e[1]||0,e[2]||0,1],4),r=n[3]||1;return[n[0]/r,n[1]/r,n[2]/r]}function tc(t){var e=Ks();return t.forEach((function(t){var n=t.matrixFunction,r=t.functionValue;n&&(e=n(e,r))})),e}function ec(t){var e=Bo(t)?t:Xo(t);return e.map((function(t){var e=$o(t),n=e.prefix,r=e.value,i=null,o=n,a="";if("translate"===n||"translateX"===n||"translate3d"===n){var s=qo(r).map((function(t){return parseFloat(t)})),c=s[0],l=s[1],u=void 0===l?0:l,h=s[2],d=void 0===h?0:h;i=Gs,a=[c,u,d]}else if("translateY"===n){u=parseFloat(r);i=Gs,a=[0,u,0]}else if("translateZ"===n){d=parseFloat(r);i=Gs,a=[0,0,d]}else if("scale"===n||"scale3d"===n){var f=qo(r).map((function(t){return parseFloat(t)})),p=f[0],g=f[1],v=void 0===g?p:g,m=f[2],b=void 0===m?1:m;i=Ws,a=[p,v,b]}else if("scaleX"===n){p=parseFloat(r);i=Ws,a=[p,1,1]}else if("scaleY"===n){v=parseFloat(r);i=Ws,a=[1,v,1]}else if("scaleZ"===n){b=parseFloat(r);i=Ws,a=[1,1,b]}else if("rotate"===n||"rotateZ"===n||"rotateX"===n||"rotateY"===n){var y=Jo(r),S=y.unit,w=y.value,E="rad"===S?w:w*Math.PI/180;"rotate"===n||"rotateZ"===n?(o="rotateZ",i=Us):"rotateX"===n?i=Vs:"rotateY"===n&&(i=Fs),a=E}else if("matrix3d"===n)i=Hs,a=qo(r).map((function(t){return parseFloat(t)}));else if("matrix"===n){var C=qo(r).map((function(t){return parseFloat(t)}));i=Hs,a=[C[0],C[1],0,0,C[2],C[3],0,0,0,0,1,0,C[4],C[5],0,1]}else o="";return{name:n,functionName:o,value:r,matrixFunction:i,functionValue:a}}))}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var nc=function(t,e){return nc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},nc(t,e)};function rc(t,e){function n(){this.constructor=t}nc(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var ic="function"===typeof Map?void 0:function(){var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}}(),oc=function(t){function e(e){return void 0===e&&(e=[]),t.call(this,e,ic)||this}return rc(e,t),e}(_o);function ac(t,e){return xo(t,e,ic)}var sc=oc;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function cc(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function lc(t){return t.length<3?0:Math.abs(sa(t.map((function(e,n){var r=t[n+1]||t[0];return e[0]*r[1]-r[0]*e[1]}))))/2}function uc(t,e){var n=e.width,r=e.height,i=e.left,o=e.top,a=hc(t),s=a.minX,c=a.minY,l=a.maxX,u=a.maxY,h=n/(l-s),d=r/(u-c);return t.map((function(t){return[i+(t[0]-s)*h,o+(t[1]-c)*d]}))}function hc(t){var e=t.map((function(t){return t[0]})),n=t.map((function(t){return t[1]}));return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,n),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,n)}}function dc(t,e,n){var r=t[0],i=t[1],o=hc(e),a=o.minX,s=o.minY,c=o.maxX,l=o.maxY,u=[[a,i],[c,i]],h=[[r,s],[r,l]],d=fc(u[0],u[1]),f=fc(h[0],h[1]),p=vc(e),g=[],v=[];return p.forEach((function(t){var e=fc(t[0],t[1]),n=gc(pc(d,e),[u,t]),o=gc(pc(f,e),[h,t]);1===n.length&&t[0][1]===i||g.push.apply(g,n),1===o.length&&t[0][0]===r||v.push.apply(v,o),e[0]||g.push.apply(g,n),e[1]||v.push.apply(v,o)})),!n&&(ta(g,(function(t){return t[0]===r}))>-1||ta(v,(function(t){return t[1]===i}))>-1)||!!(g.filter((function(t){return t[0]>r})).length%2&&v.filter((function(t){return t[1]>i})).length%2)}function fc(t,e){var n=t[0],r=t[1],i=e[0],o=e[1];if(n===i&&r===o)return[0,0,0];if(n===i)return[1,0,-n];if(r===o)return[0,1,-r];var a=(i-n)/(r-o),s=-n-a*r;return[1,a,s]}function pc(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2],c=0===n&&0===o,l=0===r&&0===a;if(c&&l)return[];if(c){var u=-i/r,h=-s/a;return u!==h?[]:[[-1/0,u],[1/0,u]]}if(l){var d=-i/n,f=-s/o;return d!==f?[]:[[d,-1/0],[d,1/0]]}if(0===n){var p=-i/r,g=-(a*p+s)/o;return[[g,p]]}if(0===o){p=-s/a,g=-(r*p+i)/n;return[[g,p]]}if(0===r){g=-i/n,p=-(o*g+s)/a;return[[g,p]]}if(0===a){g=-s/o,p=-(n*g+i)/r;return[[g,p]]}g=(r*s-a*i)/(a*n-r*o),p=-(n*g+i)/r;return[[g,p]]}function gc(t,e){var n=e.map((function(t){return[0,1].map((function(e){return[Math.min(t[0][e],t[1][e]),Math.max(t[0][e],t[1][e])]}))}));if(2===t.length){var r=t[0],i=r[0],o=r[1];if(i===t[1][0]){var a=Math.max.apply(Math,n.map((function(t){return t[1][0]}))),s=Math.min.apply(Math,n.map((function(t){return t[1][1]})));return a>s?[]:[[i,a],[i,s]]}if(o===t[1][1]){var c=Math.max.apply(Math,n.map((function(t){return t[0][0]}))),l=Math.min.apply(Math,n.map((function(t){return t[0][1]})));return c>l?[]:[[c,o],[l,o]]}}return t.filter((function(t){return n.every((function(e){return e[0][0]<=t[0]&&t[0]<=e[0][1]&&e[1][0]<=t[1]&&t[1]<=e[1][1]}))}))}function vc(t){return cc(t.slice(1),[t[0]]).map((function(e,n){return[t[n],e]}))}function mc(t,e){var n=t.slice(),r=e.slice();-1===ha(n)&&n.reverse(),-1===ha(r)&&r.reverse();var i=vc(n),o=vc(r),a=i.map((function(t){return fc(t[0],t[1])})),s=o.map((function(t){return fc(t[0],t[1])})),c=[];a.forEach((function(t,e){var n=i[e],a=[];s.forEach((function(r,i){var s=pc(t,r),c=gc(s,[n,o[i]]);a.push.apply(a,c.map((function(t){return{index1:e,index2:i,pos:t}})))})),a.sort((function(t,e){return da(n[0],t.pos)-da(n[0],e.pos)})),c.push.apply(c,a),dc(n[1],r)&&c.push({index1:e,index2:-1,pos:n[1]})})),o.forEach((function(t,e){if(dc(t[1],n)){var r=!1,i=ta(c,(function(t){var n=t.index2;return n===e?(r=!0,!1):!!r}));-1===i&&(r=!1,i=ta(c,(function(t){var n=t.index1,i=t.index2;return-1===n&&i+1===e?(r=!0,!1):!!r}))),-1===i?c.push({index1:-1,index2:e,pos:t[1]}):c.splice(i,0,{index1:-1,index2:e,pos:t[1]})}}));var l=c.map((function(t){var e=t.pos;return e})),u={};return l.filter((function(t){var e=t[0]+"x"+t[1];return!u[e]&&(u[e]=!0,!0)}))}function bc(t,e){var n=mc(t,e);return lc(n)}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var yc=function(){return yc=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},yc.apply(this,arguments)};function Sc(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var wc=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(Lo(t))for(var n in t)this.on(n,t[n]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(Lo(t))for(var n in t)this.off(n);else if(e){var r=this._events[t];if(r){var i=ta(r,(function(t){return t.listener===e}));i>-1&&r.splice(i,1)}}else this._events[t]=[];else this._events={};return this},e.once=function(t,e){var n=this;return e&&this._addEvent(t,e,{once:!0}),new Promise((function(e){n._addEvent(t,e,{once:!0})}))},e.emit=function(t,e){var n=this;void 0===e&&(e={});var r=this._events[t];if(!t||!r)return!0;var i=!1;return e.eventType=t,e.stop=function(){i=!0},e.currentTarget=this,Sc(r).forEach((function(r){r.listener(e),r.once&&n.off(t,r.listener)})),!i},e.trigger=function(t,e){return void 0===e&&(e={}),this.emit(t,e)},e._addEvent=function(t,e,n){var r=this._events;r[t]=r[t]||[];var i=r[t];i.push(yc({listener:e},n))},t}(),Ec=wc,Cc=function(t,e){return Cc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Cc(t,e)};function xc(t,e){function n(){this.constructor=t}Cc(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function Oc(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}var _c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startRect=null,e.startPos=[],e.prevTime=0,e.timer=0,e}xc(e,t);var n=e.prototype;return n.dragStart=function(t,e){var n=e.container,r=0,i=0,o=0,a=0;if(n===document.body)o=window.innerWidth,a=window.innerHeight;else{var s=n.getBoundingClientRect();r=s.top,i=s.left,o=s.width,a=s.height}this.startPos=[t.clientX,t.clientY],this.startRect={top:r,left:i,width:o,height:a}},n.drag=function(t,e){var n=this,r=t.clientX,i=t.clientY,o=e.container,a=e.threshold,s=void 0===a?0:a,c=e.throttleTime,l=void 0===c?0:c,u=e.getScrollPosition,h=void 0===u?Oc:u,d=this,f=d.startRect,p=d.startPos,g=Qo(),v=Math.max(l+this.prevTime-g,0),m=[0,0];if(f.top>i-s?(p[1]>f.top||i<p[1])&&(m[1]=-1):f.top+f.height<i+s&&(p[1]<f.top+f.height||i>p[1])&&(m[1]=1),f.left>r-s?(p[0]>f.left||r<p[0])&&(m[0]=-1):f.left+f.width<r+s&&(p[0]<f.left+f.width||r>p[0])&&(m[0]=1),clearTimeout(this.timer),!m[0]&&!m[1])return!1;if(v>0)return this.timer=window.setTimeout((function(){n.drag(t,e)}),v),!1;this.prevTime=g;var b=h({container:o,direction:m});this.trigger("scroll",{container:o,direction:m,inputEvent:t});var y=h({container:o,direction:m}),S=y[0]-b[0],w=y[1]-b[1];return!(!S&&!w)&&(this.trigger("move",{offsetX:m[0]?S:0,offsetY:m[1]?w:0,inputEvent:t}),l&&(this.timer=window.setTimeout((function(){n.drag(t,e)}),l)),!0)},n.dragEnd=function(){clearTimeout(this.timer)},e}(Ec),Tc=_c,kc=function(t,e){return kc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},kc(t,e)};function Ic(t,e){function n(){this.constructor=t}kc(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Pc=function(){return Pc=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Pc.apply(this,arguments)};function jc(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.atan2(r,n);return i>=0?i:i+2*Math.PI}function Mc(t){return jc([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function Dc(t){return t.touches&&t.touches.length>=2}function Rc(t){return t.touches?Lc(t.touches):[Bc(t)]}function Ac(t,e,n){var r=n.length,i=Vc(t,r),o=i.clientX,a=i.clientY,s=i.originalClientX,c=i.originalClientY,l=Vc(e,r),u=l.clientX,h=l.clientY,d=Vc(n,r),f=d.clientX,p=d.clientY,g=o-u,v=a-h,m=o-f,b=a-p;return{clientX:s,clientY:c,deltaX:g,deltaY:v,distX:m,distY:b}}function Nc(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function Lc(t){for(var e=Math.min(t.length,2),n=[],r=0;r<e;++r)n.push(Bc(t[r]));return n}function Bc(t){return{clientX:t.clientX,clientY:t.clientY}}function Vc(t,e){void 0===e&&(e=t.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=0;r<e;++r){var i=t[r];n.originalClientX+="originalClientX"in i?i.originalClientX:i.clientX,n.originalClientY+="originalClientY"in i?i.originalClientY:i.clientY,n.clientX+=i.clientX,n.clientY+=i.clientY}return e?{clientX:n.clientX/e,clientY:n.clientY/e,originalClientX:n.originalClientX/e,originalClientY:n.originalClientY/e}:n}var Fc=function(){function t(t){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=t,this.prevClients=t,this.length=t.length}var e=t.prototype;return e.addClients=function(t){void 0===t&&(t=this.prevClients);var e=this.getPosition(t),n=e.deltaX,r=e.deltaY;return this.movement+=Math.sqrt(n*n+r*r),this.prevClients=t,e},e.getAngle=function(t){return void 0===t&&(t=this.prevClients),Mc(t)},e.getRotation=function(t){return void 0===t&&(t=this.prevClients),Mc(t)-Mc(this.startClients)},e.getPosition=function(t){return Ac(t||this.prevClients,this.prevClients,this.startClients)},e.getPositions=function(t){void 0===t&&(t=this.prevClients);var e=this.prevClients;return this.startClients.map((function(n,r){return Ac([t[r]],[e[r]],[n])}))},e.getMovement=function(t){var e=this.movement;if(!t)return e;var n=Vc(t,this.length),r=Vc(this.prevClients,this.length),i=n.clientX-r.clientX,o=n.clientY-r.clientY;return Math.sqrt(i*i+o*o)+e},e.getDistance=function(t){return void 0===t&&(t=this.prevClients),Nc(t)},e.getScale=function(t){return void 0===t&&(t=this.prevClients),Nc(t)/Nc(this.startClients)},e.move=function(t,e){this.startClients.forEach((function(n){n.clientX-=t,n.clientY-=e})),this.prevClients.forEach((function(n){n.clientX-=t,n.clientY-=e}))},t}(),Uc=["textarea","input"],Wc=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;r.options={},r.flag=!1,r.pinchFlag=!1,r.datas={},r.isDrag=!1,r.isPinch=!1,r.isMouse=!1,r.isTouch=!1,r.clientStores=[],r.targets=[],r.prevTime=0,r.doubleFlag=!1,r.onDragStart=function(t,e){if(void 0===e&&(e=!0),r.flag||!1!==t.cancelable){var n=r.options,i=n.container,o=n.pinchOutside,a=n.preventRightClick,s=n.preventDefault,c=n.checkInput,l=r.isTouch,u=!r.flag;if(u){var h=document.activeElement,d=t.target,f=d.tagName.toLowerCase(),p=Uc.indexOf(f)>-1,g=d.isContentEditable;if(p||g){if(c||h===d)return!1;if(h&&g&&h.isContentEditable&&h.contains(d))return!1}else if((s||"touchstart"===t.type)&&h){var v=h.tagName;(h.isContentEditable||Uc.indexOf(v)>-1)&&h.blur()}if(r.clientStores=[new Fc(Rc(t))],r.flag=!0,r.isDrag=!1,r.datas={},a&&(3===t.which||2===t.button))return r.initDrag(),!1;r.doubleFlag=Qo()-r.prevTime<200;var m=r.emit("dragStart",Pc({datas:r.datas,inputEvent:t,isTrusted:e,isDouble:r.doubleFlag},r.getCurrentStore().getPosition()));!1===m&&r.initDrag(),r.flag&&s&&t.preventDefault()}if(!r.flag)return!1;var b=0;if(u&&l&&o&&(b=setTimeout((function(){ba(i,"touchstart",r.onDragStart,{passive:!1})}))),!u&&l&&o&&ya(i,"touchstart",r.onDragStart),r.flag&&Dc(t)){if(clearTimeout(b),u&&t.touches.length!==t.changedTouches.length)return;r.pinchFlag||r.onPinchStart(t)}}},r.onDrag=function(t,e){if(r.flag){var n=Rc(t),i=r.moveClients(n,t,!1);if(r.pinchFlag||i.deltaX||i.deltaY){var o=r.emit("drag",Pc({},i,{isScroll:!!e,inputEvent:t}));if(!1===o)return void r.stop()}r.pinchFlag&&r.onPinch(t,n),r.getCurrentStore().addClients(n)}},r.onDragEnd=function(t){if(r.flag){var e=r.options,n=e.pinchOutside,i=e.container;r.isTouch&&n&&ya(i,"touchstart",r.onDragStart),r.flag=!1;var o=r.getCurrentStore().getPosition(),a=Qo(),s=!r.isDrag&&r.doubleFlag;r.prevTime=r.isDrag||s?0:a,r.emit("dragEnd",Pc({datas:r.datas,isDouble:s,isDrag:r.isDrag,isClick:!r.isDrag,inputEvent:t},o)),r.pinchFlag&&r.onPinchEnd(t),r.clientStores=[]}},r.onBlur=function(){r.onDragEnd()};var i=[].concat(e);r.options=Pc({checkInput:!1,container:i.length>1?window:i[0],preventRightClick:!0,preventDefault:!0,checkWindowBlur:!1,pinchThreshold:0,events:["touch","mouse"]},n);var o=r.options,a=o.container,s=o.events,c=o.checkWindowBlur;if(r.isTouch=s.indexOf("touch")>-1,r.isMouse=s.indexOf("mouse")>-1,r.targets=i,r.isMouse&&(i.forEach((function(t){ba(t,"mousedown",r.onDragStart)})),ba(a,"mousemove",r.onDrag),ba(a,"mouseup",r.onDragEnd),ba(a,"contextmenu",r.onDragEnd)),c&&ba(window,"blur",r.onBlur),r.isTouch){var l={passive:!1};i.forEach((function(t){ba(t,"touchstart",r.onDragStart,l)})),ba(a,"touchmove",r.onDrag,l),ba(a,"touchend",r.onDragEnd,l),ba(a,"touchcancel",r.onDragEnd,l)}return r}Ic(e,t);var n=e.prototype;return n.stop=function(){this.isDrag=!1,this.flag=!1,this.clientStores=[],this.datas={}},n.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce((function(t,e){return t+e.movement}),0)},n.isDragging=function(){return this.isDrag},n.isFlag=function(){return this.flag},n.isPinchFlag=function(){return this.pinchFlag},n.isDoubleFlag=function(){return this.doubleFlag},n.isPinching=function(){return this.isPinch},n.scrollBy=function(t,e,n,r){void 0===r&&(r=!0),this.flag&&(this.clientStores[0].move(t,e),r&&this.onDrag(n,!0))},n.move=function(t,e){var n=t[0],r=t[1],i=this.getCurrentStore(),o=i.prevClients;return this.moveClients(o.map((function(t){var e=t.clientX,i=t.clientY;return{clientX:e+n,clientY:i+r,originalClientX:e,originalClientY:i}})),e,!0)},n.triggerDragStart=function(t){this.onDragStart(t,!1)},n.setEventDatas=function(t){var e=this.datas;for(var n in t)e[n]=t[n];return this},n.getEventDatas=function(){return this.datas},n.unset=function(){var t=this,e=this.targets,n=this.options.container;this.off(),ya(window,"blur",this.onBlur),this.isMouse&&(e.forEach((function(e){ya(e,"mousedown",t.onDragStart)})),ya(n,"mousemove",this.onDrag),ya(n,"mouseup",this.onDragEnd),ya(n,"contextmenu",this.onDragEnd)),this.isTouch&&(e.forEach((function(e){ya(e,"touchstart",t.onDragStart)})),ya(n,"touchstart",this.onDragStart),ya(n,"touchmove",this.onDrag),ya(n,"touchend",this.onDragEnd),ya(n,"touchcancel",this.onDragEnd))},n.onPinchStart=function(t){var e=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>e)){var n=new Fc(Rc(t));this.pinchFlag=!0,this.clientStores.splice(0,0,n);var r=this.emit("pinchStart",Pc({datas:this.datas,angle:n.getAngle(),touches:this.getCurrentStore().getPositions()},n.getPosition(),{inputEvent:t}));!1===r&&(this.pinchFlag=!1)}},n.onPinch=function(t,e){if(this.flag&&this.pinchFlag&&!(e.length<2)){var n=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",Pc({datas:this.datas,movement:this.getMovement(e),angle:n.getAngle(e),rotation:n.getRotation(e),touches:n.getPositions(e),scale:n.getScale(e),distance:n.getDistance(e)},n.getPosition(e),{inputEvent:t}))}},n.onPinchEnd=function(t){if(this.pinchFlag){var e=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var n=this.getCurrentStore();this.emit("pinchEnd",Pc({datas:this.datas,isPinch:e,touches:n.getPositions()},n.getPosition(),{inputEvent:t})),this.isPinch=!1,this.pinchFlag=!1}},n.initDrag=function(){this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1},n.getCurrentStore=function(){return this.clientStores[0]},n.moveClients=function(t,e,n){var r=this.getCurrentStore(),i=r[n?"addClients":"getPosition"](t);return this.isDrag=!0,Pc({datas:this.datas},i,{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:e})},e}(Ec),zc=Wc;function Gc(t){var e=5381,n=t.length;while(n)e=33*e^t.charCodeAt(--n);return e>>>0}var Hc=Gc;function Yc(t){return Hc(t).toString(36)}function Xc(t){if(t&&t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}function qc(t,e,n){return n.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/gm,(function(e,n){var r=n.trim();return(r?qo(r):[""]).map((function(e){var n=e.trim();return 0===n.indexOf("@")?n:n.indexOf(":global")>-1?n.replace(/\:global/g,""):n.indexOf(":host")>-1?""+n.replace(/\:host/g,"."+t):n?"."+t+" "+n:"."+t})).join(", ")+" {"}))}function $c(t,e,n,r){var i=document.createElement("style");return i.setAttribute("type","text/css"),i.setAttribute("data-styled-id",t),n.nonce&&i.setAttribute("nonce",n.nonce),i.innerHTML=qc(t,e,n),(r||document.head||document.body).appendChild(i),i}function Jc(t){var e,n="rCS"+Yc(t),r=0;return{className:n,inject:function(i,o){void 0===o&&(o={});var a,s=Xc(i),c=0===r;return(s||c)&&(a=$c(n,t,o,s)),c&&(e=a),s||++r,{destroy:function(){s?(i.removeChild(a),a=null):(r>0&&--r,0===r&&e&&(e.parentNode.removeChild(e),e=null))}}}}}var Kc=Jc,Zc=function(t,e){return Zc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Zc(t,e)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Qc(t,e){function n(){this.constructor=t}Zc(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var tl=function(){return tl=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},tl.apply(this,arguments)};function el(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}var nl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.injectResult=null,e.tag="div",e}Qc(e,t);var n=e.prototype;return n.render=function(){var t=this.props,e=t.className,n=void 0===e?"":e,r=(t.cspNonce,t.portalContainer),i=el(t,["className","cspNonce","portalContainer"]),o=this.injector.className,a=this.tag,s={};return(ns||"").indexOf("simple")>-1&&r&&(s={portalContainer:r}),Da(a,tl({ref:po(this,"element"),"data-styled-id":o,className:n+" "+o},s,i))},n.componentDidMount=function(){this.injectResult=this.injector.inject(this.element,{nonce:this.props.cspNonce})},n.componentWillUnmount=function(){this.injectResult.destroy(),this.injectResult=null},n.getElement=function(){return this.element},e}(Ya);function rl(t,e){var n=Kc(e);return function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.injector=n,r.tag=t,r}return Qc(r,e),r}(nl)}var il=rl,ol=function(t,e){return ol=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},ol(t,e)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function al(t,e){function n(){this.constructor=t}ol(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var sl=function(){return sl=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},sl.apply(this,arguments)};function cl(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function ll(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function ul(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function hl(t,e){var n;return sl({events:{},props:(n={},n[t]=Boolean,n),name:t},e)}function dl(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'+32*t+'px" height="'+32*t+'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate('+e+'deg);transform-origin: 16px 16px"></path></svg>'}function fl(t){var e=dl(1,t),n=dl(2,t),r=45*Math.round(t/45)%180,i="ns-resize";return 135===r?i="nwse-resize":45===r?i="nesw-resize":90===r&&(i="ew-resize"),"cursor:"+i+";cursor: url('"+e+"') 16 16, "+i+";cursor: -webkit-image-set(url('"+e+"') 1x, url('"+n+"') 2x) 16 16, "+i+";"}var pl=ws(),gl=pl.browser.webkit,vl=gl&&function(){var t="undefined"===typeof window?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return!!e&&parseFloat(e[1])<605}(),ml="moveable-",bl="\n{\n\tposition: absolute;\n\twidth: 1px;\n\theight: 1px;\n\tleft: 0;\n\ttop: 0;\n    z-index: 3000;\n    --moveable-color: #4af;\n    --zoom: 1;\n    --zoompx: 1px;\n    will-change: transform;\n}\n.control-box {\n    z-index: 0;\n}\n.line, .control {\n    position: absolute;\n\tleft: 0;\n    top: 0;\n    will-change: transform;\n}\n.control {\n\twidth: 14px;\n\theight: 14px;\n\tborder-radius: 50%;\n\tborder: 2px solid #fff;\n\tbox-sizing: border-box;\n    background: #4af;\n    background: var(--moveable-color);\n\tmargin-top: -7px;\n    margin-left: -7px;\n    border: 2px solid #fff;\n    z-index: 10;\n}\n.padding {\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    width: 100px;\n    height: 100px;\n    transform-origin: 0 0;\n}\n.line {\n\twidth: 1px;\n    height: 1px;\n    background: #4af;\n    background: var(--moveable-color);\n\ttransform-origin: 0px 50%;\n}\n.line.dashed {\n    box-sizing: border-box;\n    background: transparent;\n}\n.line.dashed.horizontal {\n    border-top: 1px dashed #4af;\n    border-top-color: #4af;\n    border-top-color: var(--moveable-color);\n}\n.line.dashed.vertical {\n    border-left: 1px dashed #4af;\n    border-left-color: #4af;\n    border-left-color: var(--moveable-color);\n}\n.line.vertical {\n    transform: translateX(-50%);\n}\n.line.horizontal {\n    transform: translateY(-50%);\n}\n.line.vertical.bold {\n    width: 2px;\n}\n.line.horizontal.bold {\n    height: 2px;\n}\n\n.control.origin {\n\tborder-color: #f55;\n\tbackground: #fff;\n\twidth: 12px;\n\theight: 12px;\n\tmargin-top: -6px;\n    margin-left: -6px;\n\tpointer-events: none;\n}\n"+[0,15,30,45,60,75,90,105,120,135,150,165].map((function(t){return'\n.direction[data-rotation="'+t+'"] {\n\t'+fl(t)+"\n}\n"})).join("\n")+"\n.group {\n    z-index: -1;\n}\n.area {\n    position: absolute;\n}\n.area-pieces {\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: none;\n}\n.area.avoid, .area.pass {\n    pointer-events: none;\n}\n.area.avoid+.area-pieces {\n    display: block;\n}\n.area-piece {\n    position: absolute;\n}\n\n"+(vl?':global svg *:before {\n\tcontent:"";\n\ttransform-origin: inherit;\n}':"")+"\n",yl=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],Sl=1e-4,wl=1e-7,El=1e-9,Cl=Math.pow(10,10),xl=-Cl,Ol=["n","w","s","e","nw","ne","sw","se"],_l={n:[0,1],s:[2,3],w:[2,0],e:[1,3],nw:[0],ne:[1],sw:[2],se:[3]},Tl={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},kl=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager"];function Il(t,e){return[t[0]*e[0],t[1]*e[1]]}function Pl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ho.apply(void 0,ul([ml],t))}function jl(t){if(!t||"none"===t)return[1,0,0,1,0,0];if(Lo(t))return t;var e=$o(t).value;return e.split(/s*,\s*/g).map((function(t){return parseFloat(t)}))}function Ml(t,e,n){return Ms(e,$s(n,e),t,$s(n.map((function(t){return-t})),e))}function Dl(t,e,n){if("%"===e){var r=Gl(t.ownerSVGElement);return r[n?"width":"height"]/100}return 1}function Rl(t){var e=Al(mu(t,":before"));return e.map((function(e,n){var r=Jo(e),i=r.value,o=r.unit;return i*Dl(t,o,0===n)}))}function Al(t){var e=t.transformOrigin;return e?e.split(" "):["0","0"]}function Nl(t,e,n){var r=document.body,i=!t||n?t:t.parentElement,o=t===e||i===e,a="relative";while(i&&i!==r){e===i&&(o=!0);var s=mu(i),c=s.transform;if(a=s.position,"svg"===i.tagName.toLowerCase()||"static"!==a||c&&"none"!==c)break;i=i.parentElement,a="relative"}return{isStatic:"static"===a,isEnd:o||!i||i===r,offsetParent:i||r}}function Ll(t,e,n,r){var i,o=t.tagName.toLowerCase(),a=t.offsetLeft,s=t.offsetTop;if(r){var c=(e||document.documentElement).getBoundingClientRect();a-=c.left,s-=c.top}var l,u,h=No(a),d=!h;return d||"svg"===o?(l=Al(n).map((function(t){return parseFloat(t)})),u=l.slice()):(l=vl?Rl(t):Al(n).map((function(t){return parseFloat(t)})),u=l.slice(),d=!0,i=Yl(t,l),a=i[0],s=i[1],l[0]=i[2],l[1]=i[3]),{tagName:o,isSVG:h,hasOffset:d,offset:[a||0,s||0],origin:l,targetOrigin:u}}function Bl(t,e,n){void 0===n&&(n=mu(t));var r=mu(document.body),i=r.position;if(!e&&(!i||"static"===i))return[0,0];var o=parseInt(r.marginLeft,10),a=parseInt(r.marginTop,10);return"absolute"===n.position&&("auto"===n.top&&"auto"===n.bottom||(a=0),"auto"===n.left&&"auto"===n.right||(o=0)),[o,a]}function Vl(t){t.forEach((function(t){var e=t.matrix;e&&(t.matrix=js(e,3,4))}))}function Fl(t,e,n){var r,i,o,a=t,s=[],c=!n&&t===e,l=c,u=!1,h=3,d=Nl(e,e,!0).offsetParent;while(a&&!l){l=c;var f=mu(a),p=f.position,g="fixed"===p,v=Ns(jl(f.transform)),m=v.length;u||16!==m||(u=!0,h=4,Vl(s),o&&(o=js(o,3,4))),u&&9===m&&(v=js(v,3,4));var b=Ll(a,e,f,g),y=b.tagName,S=b.hasOffset,w=b.isSVG,E=b.origin,C=b.targetOrigin,x=b.offset,O=x[0],_=x[1];"svg"===y&&o?(s.push({type:"target",target:a,matrix:Hl(a,h)}),s.push({type:"offset",target:a,matrix:Xs(h)})):"g"===y&&t!==a&&(O=0,_=0);var T=Nl(a,e),k=T.offsetParent,I=T.isEnd,P=T.isStatic;gl&&S&&!w&&P&&("relative"===p||"static"===p)&&(O-=k.offsetLeft,_-=k.offsetTop,c=c||I);var j=0,M=0;if(S&&d!==k&&(j=k.clientLeft,M=k.clientTop),S&&k===document.body){var D=Bl(a,!1,f);O+=D[0],_+=D[1]}if(s.push({type:"target",target:a,matrix:Ml(v,h,E)}),S?s.push({type:"offset",target:a,matrix:$s([O-a.scrollLeft+j,_-a.scrollTop+M],h)}):s.push({type:"offset",target:a,origin:E}),o||(o=v),r||(r=E),i||(i=C),l||g)break;a=k,c=I,n&&a!==document.body||(l=c)}return o||(o=Xs(h)),r||(r=[0,0]),i||(i=[0,0]),{offsetContainer:d,matrixes:s,targetMatrix:o,transformOrigin:r,targetOrigin:i,is3d:u}}function Ul(t,e,n,r){var i;void 0===n&&(n=e);var o=0,a=0,s=0,c={};if(t){var l=mu(t);o=t.offsetWidth,a=t.offsetHeight,No(o)&&(i=iu(t,l,!0),o=i[0],a=i[1])}if(t){var u=Wl(t,e,n,r),h=Zl(u.allMatrix,u.transformOrigin,o,a);c=sl(sl({},u),h);var d=Zl(u.allMatrix,[50,50],100,100);s=ou([d.pos1,d.pos2],d.direction)}var f=r?4:3;return sl({width:o,height:a,rotation:s,rootMatrix:Xs(f),beforeMatrix:Xs(f),offsetMatrix:Xs(f),allMatrix:Xs(f),targetMatrix:Xs(f),targetTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!r,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1},c)}function Wl(t,e,n,r){void 0===n&&(n=e);var i=Fl(t,e),o=i.matrixes,a=i.is3d,s=i.targetMatrix,c=i.transformOrigin,l=i.targetOrigin,u=i.offsetContainer,h=Fl(u,n,!0),d=h.matrixes,f=h.is3d,p=r||f||a,g=p?4:3,v="svg"!==t.tagName.toLowerCase()&&"ownerSVGElement"in t,m=s,b=Xs(g),y=Xs(g),S=Xs(g),w=Xs(g),E=o.length,C=n||document.body,x=Nl(C,C,!0).offsetParent;d.reverse(),o.reverse(),!a&&p&&(m=js(m,3,4),Vl(o)),!f&&p&&Vl(d),d.forEach((function(t){y=Ds(y,t.matrix,g)})),o.forEach((function(t,e){if(E-2===e&&(S=b.slice()),E-1===e&&(w=b.slice()),!t.matrix){var n=o[e+1],r=Kl(t,n,x,g,Ds(y,b,g));t.matrix=$s(r,g)}b=Ds(b,t.matrix,g)}));var O=!v&&a;m||(m=Xs(O?4:3));var _=zl(v&&16===m.length?js(m,4,3):m,O);return y=Os(y,g,g),{rootMatrix:y,beforeMatrix:S,offsetMatrix:w,allMatrix:b,targetMatrix:m,targetTransform:_,transformOrigin:c,targetOrigin:l,is3d:p}}function zl(t,e){return void 0===e&&(e=t.length>9),(e?"matrix3d":"matrix")+"("+Ls(t,!e).join(",")+")"}function Gl(t){var e=t.clientWidth,n=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:n};var r=t.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||n,clientWidth:e,clientHeight:n}}function Hl(t,e){var n=Gl(t),r=n.width,i=n.height,o=n.clientWidth,a=n.clientHeight,s=o/r,c=a/i,l=t.preserveAspectRatio.baseVal,u=l.align,h=l.meetOrSlice,d=[0,0],f=[s,c],p=[0,0];if(1!==u){var g=(u-2)%3,v=Math.floor((u-2)/3);d[0]=r*g/2,d[1]=i*v/2;var m=2===h?Math.max(c,s):Math.min(s,c);f[0]=m,f[1]=m,p[0]=(o-r)/2*g,p[1]=(a-i)/2*v}var b=qs(f,e);return b[e*(e-1)]=p[0],b[e*(e-1)+1]=p[1],Ml(b,e,d)}function Yl(t,e){if(!t.getBBox)return[0,0];var n=t.getBBox(),r=Gl(t.ownerSVGElement),i=n.x-r.x,o=n.y-r.y;return[i,o,e[0]-i,e[1]-o]}function Xl(t,e,n){return Bs(t,Ps(e,n),n)}function ql(t,e,n,r){return[[0,0],[e,0],[0,n],[e,n]].map((function(e){return Xl(t,e,r)}))}function $l(t){var e=t.map((function(t){return t[0]})),n=t.map((function(t){return t[1]})),r=Math.min.apply(Math,e),i=Math.min.apply(Math,n),o=Math.max.apply(Math,e),a=Math.max.apply(Math,n),s=o-r,c=a-i;return{left:r,top:i,right:o,bottom:a,width:s,height:c}}function Jl(t,e,n,r){var i=ql(t,e,n,r);return $l(i)}function Kl(t,e,n,r,i){var o,a=t.target,s=t.origin,c=e.matrix,l=iu(a,void 0,!0),u=l[0],h=l[1],d=n.getBoundingClientRect(),f=[0,0];n===document.body&&(f=Bl(a,!0));var p=a.getBoundingClientRect(),g=p.left-d.left+n.scrollLeft-(n.clientLeft||0)+f[0],v=p.top-d.top+n.scrollTop-(n.clientTop||0)+f[1],m=p.width,b=p.height,y=Ms(r,i,c),S=Jl(y,u,h,r),w=S.left,E=S.top,C=S.width,x=S.height,O=Xl(y,s,r),_=As(O,[w,E]),T=[g+_[0]*m/C,v+_[1]*b/x],k=[0,0],I=0;while(++I<10){var P=_s(i,r);o=As(Xl(P,T,r),Xl(P,O,r)),k[0]=o[0],k[1]=o[1];var j=Ms(r,i,$s(k,r),c),M=Jl(j,u,h,r),D=M.left,R=M.top,A=D-g,N=R-v;if(Math.abs(A)<2&&Math.abs(N)<2)break;T[0]-=A,T[1]-=N}return k.map((function(t){return Math.round(t)}))}function Zl(t,e,n,r){var i=16===t.length,o=i?4:3,a=ql(t,n,r,o),s=a[0],c=s[0],l=s[1],u=a[1],h=u[0],d=u[1],f=a[2],p=f[0],g=f[1],v=a[3],m=v[0],b=v[1],y=Xl(t,e,o),S=y[0],w=y[1],E=Math.min(c,h,p,m),C=Math.min(l,d,g,b),x=Math.max(c,h,p,m),O=Math.max(l,d,g,b);c=c-E||0,h=h-E||0,p=p-E||0,m=m-E||0,l=l-C||0,d=d-C||0,g=g-C||0,b=b-C||0,S=S-E||0,w=w-C||0;var _=ha(a);return{left:E,top:C,right:x,bottom:O,origin:[S,w],pos1:[c,l],pos2:[h,d],pos3:[p,g],pos4:[m,b],direction:_}}function Ql(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function tu(t,e){return Ql([e[0]-t[0],e[1]-t[1]])}function eu(t,e,n,r){void 0===n&&(n=1),void 0===r&&(r=la(t,e));var i=tu(t,e);return{transform:"translateY(-50%) translate("+t[0]+"px, "+t[1]+"px) rotate("+r+"rad) scaleY("+n+")",width:i+"px"}}function nu(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n.length,o=n.reduce((function(t,e){return t+e[0]}),0)/i,a=n.reduce((function(t,e){return t+e[1]}),0)/i;return{transform:"translateZ(0px) translate("+o+"px, "+a+"px) rotate("+t+"rad) scale("+e+")"}}function ru(t){var e=mu(t);return[parseFloat(e.width),parseFloat(e.height)]}function iu(t,e,n,r){void 0===e&&(e=mu(t)),void 0===r&&(r=n||"border-box"===e.boxSizing);var i=t.offsetWidth,o=t.offsetHeight,a=!No(i);if((n||r)&&a)return[i,o];if(!a&&"svg"!==t.tagName.toLowerCase()){var s=t.getBBox();return[s.width,s.height]}if(i=t.clientWidth,o=t.clientHeight,n||r){var c=parseFloat(e.borderLeftWidth)||0,l=parseFloat(e.borderRightWidth)||0,u=parseFloat(e.borderTopWidth)||0,h=parseFloat(e.borderBottomWidth)||0;return[i+c+l,o+u+h]}var d=parseFloat(e.paddingLeft)||0,f=parseFloat(e.paddingRight)||0,p=parseFloat(e.paddingTop)||0,g=parseFloat(e.paddingBottom)||0;return[i-d-f,o-p-g]}function ou(t,e){return la(e>0?t[0]:t[1],e>0?t[1]:t[0])}function au(t,e,n,r,i){var o=1,a=[0,0],s=su(),c=su(),l=su(),u=Ul(e,n,i,!1);if(e){var h=u.is3d?4:3,d=Zl(u.offsetMatrix,Rs(u.transformOrigin,ks(u.targetMatrix,h)),u.width,u.height);o=d.direction,a=Rs(d.origin,[d.left-u.left,d.top-u.top]),s=cu(e),c=cu(Nl(r,r,!0).offsetParent||document.body,!0),t&&(l=cu(t))}return sl({targetClientRect:s,containerClientRect:c,moveableClientRect:l,beforeDirection:o,beforeOrigin:a,originalBeforeOrigin:a,target:e},u)}function su(){return{left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function cu(t,e){var n=0,r=0,i=0,o=0;if(t===document.body||t===document.documentElement)i=window.innerWidth,o=window.innerHeight,n=-(document.documentElement.scrollLeft||document.body.scrollLeft),r=-(document.documentElement.scrollTop||document.body.scrollTop);else{var a=t.getBoundingClientRect();n=a.left,r=a.top,i=a.width,o=a.height}var s={left:n,right:n+i,top:r,bottom:r+o,width:i,height:o};return e&&(s.clientLeft=t.clientLeft,s.clientTop=t.clientTop,s.clientWidth=t.clientWidth,s.clientHeight=t.clientHeight,s.scrollWidth=t.scrollWidth,s.scrollHeight=t.scrollHeight,s.overflow="visible"!==mu(t).overflow),s}function lu(t){if(t){var e=t.getAttribute("data-direction");if(e){var n=[0,0];return e.indexOf("w")>-1&&(n[0]=-1),e.indexOf("e")>-1&&(n[0]=1),e.indexOf("n")>-1&&(n[1]=-1),e.indexOf("s")>-1&&(n[1]=1),n}}}function uu(t,e){return[Rs(e,t[0]),Rs(e,t[1]),Rs(e,t[2]),Rs(e,t[3])]}function hu(t){var e=t.left,n=t.top,r=t.pos1,i=t.pos2,o=t.pos3,a=t.pos4;return uu([r,i,o,a],[e,n])}function du(t){return Math.round(t%1===-.5?t-1:t)}function fu(t,e){t[e]&&(t[e].unset(),t[e]=null)}function pu(t,e,n){var r=e.datas;r.datas||(r.datas={});var i=sl(sl({},n),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:r.datas});return r.isStartEvent?r.lastEvent=i:r.isStartEvent=!0,i}function gu(t,e,n){var r=e.datas,i="isDrag"in n?n.isDrag:e.isDrag;return r.datas||(r.datas={}),sl(sl({isDrag:i},n),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas})}function vu(t,e,n,r){return t.triggerEvent(e,n,r)}function mu(t,e){return window.getComputedStyle(t,e)}function bu(t,e,n){var r={},i={};return t.filter((function(t){var o=t.name;if(r[o]||!e.some((function(e){return t[e]})))return!1;if(!n&&t.ableGroup){if(i[t.ableGroup])return!1;i[t.ableGroup]=!0}return r[o]=!0,!0}))}function yu(t,e){return t===e||null==t&&null==e}function Su(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.length-1,r=0;r<n;++r){var i=t[r];if(!No(i))return i}return t[n]}function wu(t,e){var n=[],r=[];return t.forEach((function(i,o){var a=e(i,o,t),s=r.indexOf(a),c=n[s]||[];-1===s&&(r.push(a),n.push(c)),c.push(i)})),n}function Eu(t,e){var n=[],r={};return t.forEach((function(i,o){var a=e(i,o,t),s=r[a];s||(s=[],r[a]=s,n.push(s)),s.push(i)})),n}function Cu(t){return t.reduce((function(t,e){return t.concat(e)}),[])}function xu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort((function(t,e){return Math.abs(e)-Math.abs(t)})),t[0]}function Ou(t,e,n){return Bs(_s(t,n),Ps(e,n),n)}function _u(t,e){var n,r=t.is3d,i=t.rootMatrix,o=r?4:3;return n=Ou(i,[e.distX,e.distY],o),e.distX=n[0],e.distY=n[1],e}function Tu(t,e,n,r,i){return As(Xl(t,Rs(n,e),i),r)}function ku(t,e,n){return n?t/e*100+"%":t+"px"}function Iu(t,e,n,r){var i=t[e],o=i.direction,a=i.sub,s=t.map((function(){return[0,0]})),c=o?o.split(""):[];if(r&&e<8){var l=c.filter((function(t){return"w"===t||"e"===t}))[0],u=c.filter((function(t){return"n"===t||"s"===t}))[0];s[e]=n,t.forEach((function(t,e){var r=t.direction;r&&(r.indexOf(l)>-1&&(s[e][0]=n[0]),r.indexOf(u)>-1&&(s[e][1]=n[1]))})),l&&(s[1][0]=n[0]/2,s[5][0]=n[0]/2),u&&(s[3][1]=n[1]/2,s[7][1]=n[1]/2)}else o&&!a?c.forEach((function(e){var r="n"===e||"s"===e;t.forEach((function(t,i){var o=t.direction,a=t.horizontal,c=t.vertical;o&&-1!==o.indexOf(e)&&(s[i]=[r||!a?0:n[0],r&&c?n[1]:0])}))})):s[e]=n;return s}function Pu(t){return Math.abs(t)<=wl?0:t}function ju(t,e){return e.isRequest?("resizable"===e.requestAble||"scalable"===e.requestAble)&&e.parentDirection:ga(e.inputEvent.target,Pl("direction"))}function Mu(t){var e={};for(var n in t)e[t[n]]=n;return e}function Du(t,e){var n=t.slice(0,e<0?void 0:e),r=t.slice(0,e<0?void 0:e+1),i=t[e]||"",o=e<0?[]:t.slice(e),a=e<0?[]:t.slice(e+1),s=ec(n),c=ec(r),l=ec([i]),u=ec(o),h=ec(a),d=tc(s),f=tc(c),p=tc(u),g=tc(h),v=Ds(d,p,4);return{transforms:t,beforeFunctionMatrix:d,beforeFunctionMatrix2:f,targetFunctionMatrix:tc(l),afterFunctionMatrix:p,afterFunctionMatrix2:g,allFunctionMatrix:v,beforeFunctions:s,beforeFunctions2:c,targetFunction:l[0],afterFunctions:u,afterFunctions2:h,beforeFunctionTexts:n,beforeFunctionTexts2:r,targetFunctionText:i,afterFunctionTexts:o,afterFunctionTexts2:a}}function Ru(t){return!(!t||!Lo(t))&&(Bo(t)||"length"in t)}function Au(t,e){return t?Vo(t)?e?document.querySelector(t):t:Uo(t)?t():"current"in t?t.current:t:null}function Nu(t,e){if(!t)return[];var n=Ru(t)?[].slice.call(t):[t];return n.reduce((function(t,n){return Vo(n)&&e?ul(t,[].slice.call(document.querySelectorAll(n))):(t.push(Au(n,e)),t)}),[])}function Lu(t,e){var n=[];return t.forEach((function(t){t&&(Vo(t)?e[t]&&n.push.apply(n,e[t]):n.push(t))})),n}function Bu(t,e,n){var r=la(t,e)/Math.PI*180;return r=n>=0?r:180-r,r=r>=0?r:360+r,r}function Vu(t,e){var n=t.rootMatrix,r=t.is3d,i=r?4:3,o=_s(n,i);return r||(o=js(o,3,4)),o[12]=0,o[13]=0,o[14]=0,Qs(o,e)}var Fu=hl("pinchable",{events:{onPinchStart:"pinchStart",onPinch:"pinch",onPinchEnd:"pinchEnd",onPinchGroupStart:"pinchGroupStart",onPinchGroup:"pinchGroup",onPinchGroupEnd:"pinchGroupEnd"},dragStart:function(){return!0},pinchStart:function(t,e){var n=e.datas,r=e.targets,i=e.angle,o=e.originalDatas,a=t.props,s=a.pinchable,c=a.ables;if(!s)return!1;var l="onPinch"+(r?"Group":"")+"Start",u="drag"+(r?"Group":"")+"ControlStart",h=(!0===s?t.controlAbles:c.filter((function(t){return s.indexOf(t.name)>-1}))).filter((function(t){return t.canPinch&&t[u]})),d=pu(t,e,{});r&&(d.targets=r);var f=vu(t,l,d);n.isPinch=!1!==f,n.ables=h;var p=n.isPinch;return!!p&&(h.forEach((function(n){if(o[n.name]=o[n.name]||{},n[u]){var r=sl(sl({},e),{datas:o[n.name],parentRotate:i,isPinch:!0});n[u](t,r)}})),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},p)},pinch:function(t,e){var n=e.datas,r=e.scale,i=e.distance,o=e.originalDatas,a=e.inputEvent,s=e.targets,c=e.angle;if(n.isPinch){var l=i*(1-1/r),u=pu(t,e,{});s&&(u.targets=s);var h="onPinch"+(s?"Group":"");vu(t,h,u);var d=n.ables,f="drag"+(s?"Group":"")+"Control";return d.forEach((function(n){n[f]&&n[f](t,sl(sl({},e),{datas:o[n.name],inputEvent:a,parentDistance:l,parentRotate:c,isPinch:!0}))})),u}},pinchEnd:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,o=e.targets,a=e.originalDatas;if(n.isPinch){var s="onPinch"+(o?"Group":"")+"End",c=gu(t,e,{isDrag:r});o&&(c.targets=o),vu(t,s,c);var l=n.ables,u="drag"+(o?"Group":"")+"ControlEnd";return l.forEach((function(n){n[u]&&n[u](t,sl(sl({},e),{isDrag:r,datas:a[n.name],inputEvent:i,isPinch:!0}))})),r}},pinchGroupStart:function(t,e){return this.pinchStart(t,sl(sl({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,sl(sl({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,sl(sl({},e),{targets:t.props.targets}))}});function Uu(t,e,n,r,i){var o=e.gesto.move(n,t.inputEvent),a=o.originalDatas||o.datas,s=a.draggable||(a.draggable={});return sl(sl({},i?_u(e,o):o),{isDrag:!0,isPinch:!!r,parentEvent:!0,datas:s,originalDatas:t.originalDatas})}var Wu=function(){function t(){this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}}}var e=t.prototype;return e.dragStart=function(t,e){this.isDrag=!1,this.isFlag=!1;var n=e.originalDatas;return this.datas=n,n.draggable||(n.draggable={}),sl(sl({},this.move(t,e.inputEvent)),{type:"dragstart"})},e.drag=function(t,e){return this.move([t[0]-this.prevX,t[1]-this.prevY],e)},e.move=function(t,e){var n,r;return this.isFlag?(n=this.prevX+t[0],r=this.prevY+t[1],this.isDrag=!0):(this.prevX=t[0],this.prevY=t[1],this.startX=t[0],this.startY=t[1],n=t[0],r=t[1],this.isFlag=!0),this.prevX=n,this.prevY=r,{type:"drag",clientX:n,clientY:r,inputEvent:e,isDrag:this.isDrag,distX:n-this.startX,distY:r-this.startY,deltaX:t[0],deltaY:t[1],datas:this.datas.draggable,originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t}();function zu(t,e,n){var r=n.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var o=i.childDatas;return t.moveables.map((function(t,r){return o[r]=o[r]||{},o[r][e]=o[r][e]||{},sl(sl({},n),{datas:o[r][e],originalDatas:o[r]})}))}function Gu(t,e,n,r,i,o){var a=!!n.match(/Start$/g),s=!!n.match(/End$/g),c=i.isPinch,l=i.datas,u=zu(t,e.name,i),h=t.moveables,d=u.map((function(t,i){var u=h[i],d=t;a?d=(new Wu).dragStart(r,t):(u.state.gesto||(u.state.gesto=l.childGestos[i]),d=Uu(t,u.state,r,c,o));var f=e[n](u,sl(sl({},d),{parentFlag:!0}));return s&&(u.state.gesto=null),f}));return a&&(l.childGestos=h.map((function(t){return t.state.gesto}))),d}function Hu(t,e,n,r,i,o){void 0===i&&(i=function(t,e){return e});var a=!!n.match(/End$/g),s=zu(t,e.name,r),c=t.moveables,l=s.map((function(t,r){var s=c[r],l=t;l=i(s,t);var u=e[n](s,sl(sl({},l),{parentFlag:!0}));return u&&o&&o(s,t,u,r),a&&(s.state.gesto=null),u}));return l}function Yu(t,e){var n=e.clientX,r=e.clientY,i=e.datas,o=t.state,a=o.moveableClientRect,s=o.rootMatrix,c=o.is3d,l=o.pos1,u=a.left,h=a.top,d=c?4:3,f=As(Ou(s,[n-u,r-h],d),l),p=f[0],g=f[1],v=th({datas:i,distX:p,distY:g}),m=v[0],b=v[1];return[m,b]}function Xu(t,e){var n=e.datas,r=t.state,i=r.allMatrix,o=r.beforeMatrix,a=r.is3d,s=r.left,c=r.top,l=r.origin,u=r.offsetMatrix,h=r.targetMatrix,d=r.transformOrigin,f=a?4:3;n.is3d=a,n.matrix=i,n.targetMatrix=h,n.beforeMatrix=o,n.offsetMatrix=u,n.transformOrigin=d,n.inverseMatrix=_s(i,f),n.inverseBeforeMatrix=_s(o,f),n.absoluteOrigin=Ps(Rs([s,c],l),f),n.startDragBeforeDist=Bs(n.inverseBeforeMatrix,n.absoluteOrigin,f),n.startDragDist=Bs(n.inverseMatrix,n.absoluteOrigin,f)}function qu(t){return Zl(t.datas.beforeTransform,[50,50],100,100).direction}function $u(t,e){var n=t.datas,r=t.originalDatas.beforeRenderable,i=n.transformIndex,o=r.nextTransforms,a=r.nextTransformAppendedIndexes,s=-1===i?o.length:i+a.filter((function(t){return t<i})).length,c=Du(o,s),l=c.targetFunction,u="rotate"===e?"rotateZ":e;n.beforeFunctionTexts=c.beforeFunctionTexts,n.afterFunctionTexts=c.afterFunctionTexts,n.beforeTransform=c.beforeFunctionMatrix,n.beforeTransform2=c.beforeFunctionMatrix2,n.targetTansform=c.targetFunctionMatrix,n.afterTransform=c.afterFunctionMatrix,n.afterTransform2=c.afterFunctionMatrix2,n.targetAllTransform=c.allFunctionMatrix,l.functionName===u?(n.afterFunctionTexts.splice(0,1),n.isAppendTransform=!1):(n.isAppendTransform=!0,r.nextTransformAppendedIndexes=ul(a,[s]))}function Ju(t,e,n){return t.beforeFunctionTexts.join(" ")+" "+(t.isAppendTransform?n:e)+" "+t.afterFunctionTexts.join(" ")}function Ku(t){var e=t.datas,n=t.distX,r=t.distY,i=Qu({datas:e,distX:n,distY:r}),o=i[0],a=i[1],s=Zu(e,Is([o,a],4));return Bs(s,Ps([0,0,0],4),4)}function Zu(t,e,n){var r=t.beforeTransform,i=t.afterTransform,o=t.beforeTransform2,a=t.afterTransform2,s=t.targetAllTransform,c=n?Ds(s,e,4):Ds(e,s,4),l=Ds(_s(n?o:r,4),c,4),u=Ds(l,_s(n?a:i,4),4);return u}function Qu(t){var e=t.datas,n=t.distX,r=t.distY,i=e.inverseBeforeMatrix,o=e.is3d,a=e.startDragBeforeDist,s=e.absoluteOrigin,c=o?4:3;return As(Bs(i,Rs(s,[n,r]),c),a)}function th(t,e){var n=t.datas,r=t.distX,i=t.distY,o=n.inverseBeforeMatrix,a=n.inverseMatrix,s=n.is3d,c=n.startDragBeforeDist,l=n.startDragDist,u=n.absoluteOrigin,h=s?4:3;return As(Bs(e?o:a,Rs(u,[r,i]),h),e?c:l)}function eh(t,e){var n=t.datas,r=t.distX,i=t.distY,o=n.beforeMatrix,a=n.matrix,s=n.is3d,c=n.startDragBeforeDist,l=n.startDragDist,u=n.absoluteOrigin,h=s?4:3;return As(Bs(e?o:a,Rs(e?c:l,[r,i]),h),u)}function nh(t,e,n,r,i,o){return void 0===r&&(r=e),void 0===i&&(i=n),void 0===o&&(o=[0,0]),t?t.map((function(t,a){var s=Jo(t),c=s.value,l=s.unit,u=a?i:r,h=a?n:e;if("%"===t||isNaN(c)){var d=u?o[a]/u:0;return h*d}return"%"!==l?c:h*c/100})):o}function rh(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function ih(t,e){return rh(e).map((function(e){return t[e]}))}function oh(t,e){var n=ih(t,e);return[ca(n.map((function(t){return t[0]}))),ca(n.map((function(t){return t[1]})))]}function ah(t,e){return oh(t,e.map((function(t){return-t})))}function sh(t,e,n,r,i,o){var a=ql(e,n,r,i),s=oh(a,o),c=t[0]-s[0],l=t[1]-s[1];return[c,l]}function ch(t,e,n,r){return Ds(t,Ml(e,r,n),r)}function lh(t,e,n){var r=t.transformOrigin,i=t.offsetMatrix,o=t.is3d,a=e.beforeTransform,s=e.afterTransform,c=o?4:3,l=Zs([n]);return ch(i,js(Ds(Ds(a,l,4),s,4),4,c),r,c)}function uh(t,e){var n=t.transformOrigin,r=t.offsetMatrix,i=t.is3d,o=t.targetMatrix,a=i?4:3;return ch(r,Ds(o,qs(e,a),a),n,a)}function hh(t){var e=t.originalDatas.beforeRenderable;return{setTransform:function(n,r){void 0===r&&(r=-1),e.startTransforms=Bo(n)?n:Xo(n),fh(t,r)},setTransformIndex:function(e){fh(t,e)}}}function dh(t,e){var n=t.originalDatas.beforeRenderable,r=n.startTransforms;fh(t,ta(r,(function(t){return 0===t.indexOf(e+"(")})))}function fh(t,e){var n=t.originalDatas.beforeRenderable,r=t.datas;if(r.transformIndex=e,-1!==e){var i=n.startTransforms[e];if(i){var o=ec([i]);r.startValue=o[0].functionValue}}}function ph(t,e){var n=t.originalDatas.beforeRenderable;n.nextTransforms=Xo(e)}function gh(t,e,n,r,i){return ph(i,e),{transform:e,drag:qd.drag(t,Uu(i,t.state,n,r,!1))}}function vh(t,e,n,r,i){var o=t.state,a=o.left,s=o.top,c=t.props.groupable,l=lh(t.state,i,e),u=c?a:0,h=c?s:0,d=yh(t,n,l),f=As(r,d);return As(f,[u,h])}function mh(t,e,n,r,i){return vh(t,"scale("+e.join(", ")+")",n,r,i)}function bh(t){var e=t.state,n=e.width,r=e.height,i=e.transformOrigin;return[i[0]/(n/2)-1,i[1]/(r/2)-1]}function yh(t,e,n){void 0===n&&(n=t.state.allMatrix);var r=t.state,i=r.width,o=r.height,a=r.is3d,s=a?4:3,c=[i/2*(1+e[0]),o/2*(1+e[1])];return Xl(n,c,s)}function Sh(t,e,n,r){var i=bh(t);return vh(t,"rotate("+e+"deg)",i,n,r)}function wh(t,e,n,r,i,o){var a=t.props.groupable,s=t.state,c=s.transformOrigin,l=s.targetMatrix,u=s.offsetMatrix,h=s.is3d,d=s.width,f=s.height,p=s.left,g=s.top,v=h?4:3,m=nh(o,e,n,d,f,c),b=a?p:0,y=a?g:0,S=ch(u,l,m,v),w=sh(i,S,e,n,v,r);return As(w,[b,y])}function Eh(t,e){return oh(hu(t.state),e)}var Ch=["left","right","center"],xh=["top","bottom","middle"],Oh={start:"left",end:"right",center:"center"},_h={start:"top",end:"bottom",center:"middle"};function Th(t,e){var n=t.props,r=n.snappable,i=n.bounds,o=n.innerBounds,a=n.verticalGuidelines,s=n.horizontalGuidelines,c=n.snapGridWidth,l=n.snapGridHeight,u=t.state,h=u.guidelines,d=u.enableSnap;return!(!r||!d||e&&!0!==r&&r.indexOf(e)<0)&&!!(c||l||i||o||h&&h.length||a&&a.length||s&&s.length)}function kh(t){return!1===t?{}:!0!==t&&t?t:{left:!0,right:!0,top:!0,bottom:!0}}function Ih(t,e){var n=kh(t),r={};for(var i in n)i in e&&n[i]&&(r[i]=e[i]);return r}function Ph(t,e){var n=Ih(t,e),r=xh.filter((function(t){return t in n})),i=Ch.filter((function(t){return t in n}));return{horizontal:r.map((function(t){return n[t]})),vertical:i.map((function(t){return n[t]}))}}function jh(t,e,n){var r=t.state.elementRects,i=[];return[["vertical",Oh,_h],["horizontal",_h,Oh]].forEach((function(t){var o=t[0],a=t[1],s=t[2],c=e[a.start],l=e[a.end],u=e[a.center],h=e[s.start],d=e[s.end];function f(t){var e=t.rect;return e[a.end]<c+n?c-e[a.end]:l-n<e[a.start]?e[a.start]-l:-1}var p=r.filter((function(t){var e=t.rect;return!(e[s.start]>d||e[s.end]<h)&&f(t)>0})).sort((function(t,e){return f(t)-f(e)})),g=[];p.forEach((function(t){p.forEach((function(e){if(t!==e){var n=t.rect,r=e.rect,i=n[s.start],o=n[s.end],a=r[s.start],c=r[s.end];i>c||a>o||g.push([t,e])}}))})),g.forEach((function(t){var e=t[0],r=t[1],s=e.rect,h=r.rect,d=s[a.start],f=s[a.end],p=h[a.start],g=h[a.end],v=0,m=0,b=!1,y=!1,S=!1;if(f<=c&&l<=p){if(y=!0,v=(p-f-(l-c))/2,m=f+v+(l-c)/2,Math.abs(m-u)>n)return}else if(f<p&&g<c+n){if(b=!0,v=p-f,m=g+v,Math.abs(m-c)>n)return}else{if(!(f<p&&l-n<d))return;if(S=!0,v=p-f,m=d-v,Math.abs(m-l)>n)return}v&&i.push({type:o,pos:"vertical"===o?[m,0]:[0,m],element:r.element,size:0,className:r.className,isStart:b,isCenter:y,isEnd:S,gap:v,hide:!0,gapRects:[e,r]})}))})),i}function Mh(t,e,n,r,i,o,a){void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a={left:0,top:0,right:0,bottom:0});var s=[],c=a.left,l=a.top,u=a.bottom,h=a.right,d=n+h-c,f=r+u-l;return t&&t.forEach((function(t){s.push({type:"horizontal",pos:[c,fa(t-o+l,.1)],size:d})})),e&&e.forEach((function(t){s.push({type:"vertical",pos:[fa(t-i+c,.1),l],size:f})})),s}function Dh(t,e,n){var r=Xl(t,[e.clientLeft,e.clientTop],n);return[e.left+r[0],e.top+r[1]]}function Rh(t,e){if(!e.length)return[];var n=t.state,r=n.containerClientRect,i=n.targetClientRect,o=i.top,a=i.left,s=n.rootMatrix,c=n.is3d,l=c?4:3,u=Dh(s,r,l),h=u[0],d=u[1],f=hu(n),p=hc(f),g=p.minX,v=p.minY,m=As([g,v],Ou(s,[a-h,o-d],l)).map((function(t){return du(t)})),b=m[0],y=m[1];return e.map((function(t){var e=t.element.getBoundingClientRect(),n=e.left-h,r=e.top-d,i=r+e.height,o=n+e.width,a=Ou(s,[n,r],l),c=a[0],u=a[1],f=Ou(s,[o,i],l),p=f[0],g=f[1];return sl(sl({},t),{rect:{left:c+b,right:p+b,top:u+y,bottom:g+y,center:(c+p)/2+b,middle:(u+g)/2+y}})}))}function Ah(t){var e=t.state,n=t.props.elementGuidelines,r=void 0===n?[]:n;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter((function(t){return!t.refresh})),o=r.map((function(t){return Lo(t)&&"element"in t?t:{element:Au(t,!0)}})).filter((function(t){return t.element})),a=ac(i.map((function(t){return t.element})),o.map((function(t){return t.element}))),s=a.maintained,c=a.added,l=[];s.forEach((function(t){var e=t[0],n=t[1];l[n]=i[e]})),Rh(t,c.map((function(t){return o[t]}))).map((function(t,e){l[c[e]]=t})),e.elementRects=l;var u=kh(t.props.elementSnapDirections),h=[];return l.forEach((function(t){var e=t.element,n=t.top,r=void 0===n?u.top:n,i=t.left,o=void 0===i?u.left:i,a=t.right,s=void 0===a?u.right:a,c=t.bottom,l=void 0===c?u.bottom:c,d=t.center,f=void 0===d?u.center:d,p=t.middle,g=void 0===p?u.middle:p,v=t.className,m=t.rect,b=Ph({top:r,right:s,left:o,bottom:l,center:f,middle:g},m),y=b.horizontal,S=b.vertical,w=m.top,E=m.left,C=m.right-E,x=m.bottom-w,O=[C,x];S.forEach((function(n){h.push({type:"vertical",element:e,pos:[fa(n,.1),w],size:x,sizes:O,className:v,elementRect:t})})),y.forEach((function(n){h.push({type:"horizontal",element:e,pos:[E,fa(n,.1)],size:C,sizes:O,className:v,elementRect:t})}))})),h}function Nh(t){var e=t.state,n=e.snapOffset,r=e.containerClientRect,i=r.overflow,o=r.scrollHeight,a=r.scrollWidth,s=r.clientHeight,c=r.clientWidth,l=r.clientLeft,u=r.clientTop,h=t.props,d=h.snapGap,f=void 0===d||d,p=h.verticalGuidelines,g=h.horizontalGuidelines,v=h.snapThreshold,m=void 0===v?5:v,b=h.snapGridWidth,y=void 0===b?0:b,S=h.snapGridHeight,w=void 0===S?0:S,E=Ah(t),C=ul(E);if(f){var x=$l(hu(t.state)),O=x.top,_=x.left,T=x.bottom,k=x.right;C.push.apply(C,jh(t,{top:O,left:_,bottom:T,right:k,center:(_+k)/2,middle:(O+T)/2},m))}return C.push.apply(C,Lh(y,w,i?a:c,i?o:s,l,u)),C.push.apply(C,Mh(g||!1,p||!1,i?a:c,i?o:s,l,u,n)),C}function Lh(t,e,n,r,i,o){void 0===i&&(i=0),void 0===o&&(o=0);var a=[];if(e)for(var s=0;s<=r;s+=e)a.push({type:"horizontal",pos:[0,fa(s-o,.1)],size:n,hide:!0});if(t)for(s=0;s<=n;s+=t)a.push({type:"vertical",pos:[fa(s-i,.1),0],size:r,hide:!0});return a}function Bh(t,e,n,r){var i=t.props,o=Su(r,i.snapThreshold,5);return Vh(t.state.guidelines,e,n,o)}function Vh(t,e,n,r){return{vertical:zh(t,"vertical",e,r),horizontal:zh(t,"horizontal",n,r)}}function Fh(t,e,n){var r=n[0],i=n[1],o=e[0],a=e[1],s=As(n,e),c=s[0],l=s[1],u=l>0,h=c>0;c=Pu(c),l=Pu(l);var d={isSnap:!1,offset:0,pos:0},f={isSnap:!1,offset:0,pos:0};if(0===c&&0===l)return{vertical:d,horizontal:f};var p=Bh(t,c?[r]:[],l?[i]:[]),g=p.vertical,v=p.horizontal;g.posInfos.filter((function(t){var e=t.pos;return h?e>=o:e<=o})),v.posInfos.filter((function(t){var e=t.pos;return u?e>=a:e<=a})),g.isSnap=g.posInfos.length>0,v.isSnap=v.posInfos.length>0;var m=Wh(g),b=m.isSnap,y=m.guideline,S=Wh(v),w=S.isSnap,E=S.guideline,C=w?E.pos[1]:0,x=b?y.pos[0]:0;if(0===c)w&&(f.isSnap=!0,f.pos=E.pos[1],f.offset=i-f.pos);else if(0===l)b&&(d.isSnap=!0,d.pos=x,d.offset=r-x);else{var O=l/c,_=n[1]-O*r,T=0,k=0,I=!1;b?(k=x,T=O*k+_,I=!0):w&&(T=C,k=(T-_)/O,I=!0),I&&(d.isSnap=!0,d.pos=k,d.offset=r-k,f.isSnap=!0,f.pos=T,f.offset=i-T)}return{vertical:d,horizontal:f}}function Uh(t,e,n){var r=Ph(t.props.snapDirections,e);return Bh(t,r.vertical,r.horizontal,n)}function Wh(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var n=t.posInfos[0],r=n.guidelineInfos[0],i=r.offset,o=r.dist,a=r.guideline;return{isSnap:e,offset:i,dist:o,pos:n.pos,guideline:a}}function zh(t,e,n,r){if(!t||!t.length)return{isSnap:!1,index:-1,posInfos:[]};var i="vertical"===e,o=i?0:1,a=n.map((function(n,i){var a=t.map((function(t){var e=t.pos,r=n-e[o];return{offset:r,dist:Math.abs(r),guideline:t}})).filter((function(t){var n=t.guideline,i=t.dist,o=n.type;return!(o!==e||i>r)})).sort((function(t,e){return t.dist-e.dist}));return{pos:n,index:i,guidelineInfos:a}})).filter((function(t){return t.guidelineInfos.length>0})).sort((function(t,e){return t.guidelineInfos[0].dist-e.guidelineInfos[0].dist})),s=a.length>0;return{isSnap:s,index:s?a[0].index:-1,posInfos:a}}function Gh(t,e,n){var r=[];if(n[0]&&n[1])r=[n,[-n[0],n[1]],[n[0],-n[1]]].map((function(t){return oh(e,t)}));else if(n[0]||n[1])t.props.keepRatio?r=[[-1,-1],[-1,1],[1,-1],[1,1],n].map((function(t){return oh(e,t)})):(r=ih(e,n),r.length>1&&r.push([(r[0][0]+r[1][0])/2,(r[0][1]+r[1][1])/2]));else for(var i=[e[0],e[1],e[3],e[2],e[0]],o=0;o<4;++o)r.push(i[o]),r.push([(i[o][0]+i[o+1][0])/2,(i[o][1]+i[o+1][1])/2]);return Bh(t,r.map((function(t){return t[0]})),r.map((function(t){return t[1]})),1)}function Hh(t,e){var n=Math.abs(t.offset),r=Math.abs(e.offset);return t.isBound&&e.isBound?r-n:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?r-n:t.isSnap?-1:e.isSnap||n<wl?1:r<wl?-1:n-r}function Yh(t,e){return t.slice().sort((function(t,n){var r=t.sign[e],i=n.sign[e],o=t.offset[e],a=n.offset[e];return r?i?Hh({isBound:t.isBound,isSnap:t.isSnap,offset:o},{isBound:n.isBound,isSnap:n.isSnap,offset:a}):-1:1}))[0]}function Xh(t,e){var n=[],r=[-t[0],-t[1]];return t[0]&&t[1]?(n.push([r,[t[0],-t[1]]],[r,[-t[0],t[1]]]),e&&n.push([r,t])):t[0]?e?n.push([r,[r[0],-1]],[r,[r[0],1]],[r,[t[0],-1]],[r,t],[r,[t[0],1]]):n.push([[r[0],-1],[t[0],-1]],[[r[0],0],[t[0],0]],[[r[0],1],[t[0],1]]):t[1]?e?n.push([r,[-1,r[1]]],[r,[1,r[1]]],[r,[-1,t[1]]],[r,[1,t[1]]],[r,t]):n.push([[-1,r[1]],[-1,t[1]]],[[0,r[1]],[0,t[1]]],[[1,r[1]],[1,t[1]]]):n.push([r,[1,0]],[r,[-1,0]],[r,[0,-1]],[r,[0,1]],[[1,0],[1,-1]],[[1,0],[1,1]],[[0,1],[1,1]],[[0,1],[-1,1]],[[-1,0],[-1,-1]],[[-1,0],[-1,1]],[[0,-1],[1,-1]],[[0,-1],[-1,-1]]),n}function qh(t,e){var n=ca([e[0][0],e[1][0]]),r=ca([e[0][1],e[1][1]]);return{vertical:n<=t[0],horizontal:r<=t[1]}}function $h(t,e){var n,r,i=e[0],o=e[1],a=o[0]-i[0],s=o[1]-i[1];if(Math.abs(a)<wl&&(a=0),Math.abs(s)<wl&&(s=0),a)if(s){var c=s/a;n=c*(t[0]-i[0])+i[1],r=t[1]}else n=i[1],r=t[1];else n=i[0],r=t[0];return n-r}function Jh(t,e,n){void 0===n&&(n=wl);var r=$h(t[0],e)<=0;return t.slice(1).every((function(t){var i=$h(t,e),o=i<=0;return o===r||Math.abs(i)<=n}))}function Kh(t,e,n,r,i){return void 0===i&&(i=0),r&&e-i<=t||!r&&t<=n+i?{isBound:!0,offset:r?e-t:n-t}:{isBound:!1,offset:0}}function Zh(t,e,n){var r=t.props.innerBounds;if(!r)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var i=r.left,o=r.top,a=r.width,s=r.height,c=[[i,o],[i,o+s]],l=[[i,o],[i+a,o]],u=[[i+a,o],[i+a,o+s]],h=[[i,o+s],[i+a,o+s]],d=qh(n,e),f=d.horizontal,p=d.vertical;if(Jh([n,[i,o],[i+a,o],[i,o+s],[i+a,o+s]],e))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var g=Qh(e,l,p),v=Qh(e,h,p),m=Qh(e,c,f),b=Qh(e,u,f),y=g.isBound&&v.isBound,S=g.isBound||v.isBound,w=m.isBound&&b.isBound,E=m.isBound||b.isBound,C=xu(g.offset,v.offset),x=xu(m.offset,b.offset),O=[0,0],_=!1,T=!1;return Math.abs(x)<Math.abs(C)?(O=[C,0],_=S,T=y):(O=[0,x],_=E,T=w),{isAllBound:T,isVerticalBound:S,isHorizontalBound:E,isBound:_,offset:O}}function Qh(t,e,n,r,i){var o=t[0],a=t[1],s=e[0],c=e[1],l=Pu(a[1]-o[1]),u=Pu(a[0]-o[0]),h=Pu(c[1]-s[1]),d=Pu(c[0]-s[0]);if(!d){if(i&&!l)return{isBound:!1,offset:0};if(u){var f=l/u*(s[0]-o[0])+o[1];return Kh(f,s[1],c[1],n,r)}var p=s[0]-o[0],g=Math.abs(p)<=(r||0);return{isBound:g,offset:g?p:0}}if(!h){if(i&&!u)return{isBound:!1,offset:0};if(l){var v=(s[1]-o[1])/(l/u)+o[0];return Kh(v,s[0],c[0],n,r)}p=s[1]-o[1],g=Math.abs(p)<=(r||0);return{isBound:g,offset:g?p:0}}return{isBound:!1,offset:0}}function td(t,e,n,r){return e.map((function(e){var i=e[0],o=e[1],a=e[2],s=Zh(t,[o,a],n),c=s.isBound,l=s.offset,u=s.isVerticalBound,h=s.isHorizontalBound,d=th({datas:r,distX:l[0],distY:l[1]}).map((function(t,e){return t*(i[e]?2/i[e]:0)}));return{sign:i,isBound:c,isVerticalBound:u,isHorizontalBound:h,isSnap:!1,offset:d}}))}function ed(t,e,n){var r,i=rd(e,[0,0],!1).map((function(t){var e=t[0],n=t[1],r=t[2];return[e.map((function(t){return 2*Math.abs(t)})),n,r]})),o=td(t,i,oh(e,[0,0]),n),a=Yh(o,0),s=Yh(o,1),c=0,l=0,u=a.isVerticalBound||s.isVerticalBound,h=a.isHorizontalBound||s.isHorizontalBound;return(u||h)&&(r=eh({datas:n,distX:-a.offset[0],distY:-s.offset[1]}),c=r[0],l=r[1]),{vertical:{isBound:u,offset:c},horizontal:{isBound:h,offset:l}}}function nd(t,e){var n=[],r=t[0],i=t[1];return r&&i?n.push([[0,2*i],t,[-r,i]],[[2*r,0],t,[r,-i]]):r?(n.push([[2*r,0],[r,1],[r,-1]]),e&&n.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(n.push([[0,2*i],[1,i],[-1,i]]),e&&n.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):n.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),n}function rd(t,e,n){return nd(e,n).map((function(e){var n=e[0],r=e[1],i=e[2];return[n,oh(t,r),oh(t,i)]}))}function id(t,e,n,r){var i=r?t.map((function(t){return zs(t,r)})):t,o=ul([n],e);return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some((function(t){return!Jh(o,t)}))}function od(t){var e=t[0],n=t[1],r=n[0]-e[0],i=n[1]-e[1];if(!r)return Math.abs(e[0]);if(!i)return Math.abs(e[1]);var o=i/r;return Math.abs((-o*e[0]+e[1])/Math.sqrt(Math.pow(o,2)+1))}function ad(t){var e=t[0],n=t[1],r=n[0]-e[0],i=n[1]-e[1];if(!r)return[e[0],0];if(!i)return[0,e[1]];var o=i/r,a=-o*e[0]+e[1];return[-a/(o+1/o),a/(o*o+1)]}function sd(t,e,n,r,i){var o=t.props.innerBounds,a=i*Math.PI/180;if(!o)return[];var s=o.left,c=o.top,l=o.width,u=o.height,h=s-r[0],d=s+l-r[0],f=c-r[1],p=c+u-r[1],g=[[h,f],[d,f],[h,p],[d,p]],v=oh(n,[0,0]);if(!id(n,g,v,0))return[];var m=[],b=g.map((function(t){return[Ql(t),la([0,0],t)]}));return[[n[0],n[1]],[n[1],n[3]],[n[3],n[2]],[n[2],n[0]]].forEach((function(t){var n=la([0,0],ad(t)),r=od(t);m.push.apply(m,b.filter((function(t){var e=t[0];return e&&r<=e})).map((function(t){var e=t[0],i=t[1],o=Math.acos(e?r/e:0),s=i+o,c=i-o;return[a+s-n,a+c-n]})).reduce((function(t,e){return t.push.apply(t,e),t}),[]).filter((function(t){return!id(e,g,v,t)})).map((function(t){return fa(180*t/Math.PI,wl)})))})),m}function cd(t){var e=t.props.innerBounds;if(!e)return{vertical:[],horizontal:[]};var n=t.getRect(),r=n.pos1,i=n.pos2,o=n.pos3,a=n.pos4,s=[r,i,o,a],c=oh(s,[0,0]),l=e.left,u=e.top,h=e.width,d=e.height,f=[[l,u],[l,u+d]],p=[[l,u],[l+h,u]],g=[[l+h,u],[l+h,u+d]],v=[[l,u+d],[l+h,u+d]],m=[[r,i],[i,a],[a,o],[o,r]],b=[],y=[],S={top:!1,bottom:!1,left:!1,right:!1};return m.forEach((function(t){var e=qh(c,t),n=e.horizontal,r=e.vertical,i=Qh(t,p,r,1,!0),o=Qh(t,v,r,1,!0),a=Qh(t,f,n,1,!0),s=Qh(t,g,n,1,!0);i.isBound&&!S.top&&(b.push(u),S.top=!0),o.isBound&&!S.bottom&&(b.push(u+d),S.bottom=!0),a.isBound&&!S.left&&(y.push(l),S.left=!0),s.isBound&&!S.right&&(y.push(l+h),S.right=!0)})),{horizontal:b,vertical:y}}function ld(t,e,n){var r=t||{},i=r.position,o=void 0===i?"client":i,a=r.left,s=void 0===a?-1/0:a,c=r.top,l=void 0===c?-1/0:c,u=r.right,h=void 0===u?1/0:u,d=r.bottom,f=void 0===d?1/0:d,p={position:o,left:s,top:l,right:h,bottom:f};return{vertical:dd(p,e,!0),horizontal:dd(p,n,!1)}}function ud(t,e){var n=t.state,r=n.containerClientRect,i=r.clientHeight,o=r.clientWidth,a=r.clientLeft,s=r.clientTop,c=n.snapOffset,l=c.left,u=c.top,h=c.right,d=c.bottom,f=e||t.props.bounds||{},p=f.position||"client",g="css"===p,v=f.left,m=void 0===v?-1/0:v,b=f.top,y=void 0===b?-1/0:b,S=f.right,w=void 0===S?g?-1/0:1/0:S,E=f.bottom,C=void 0===E?g?-1/0:1/0:E;return g&&(w=o+h-l-w,C=i+d-u-C),{left:m+l-a,right:w+l-a,top:y+u-s,bottom:C+u-s}}function hd(t,e,n){var r=ud(t),i=r.left,o=r.top,a=r.right,s=r.bottom,c=n[0],l=n[1],u=As(n,e),h=u[0],d=u[1];Math.abs(h)<wl&&(h=0),Math.abs(d)<wl&&(d=0);var f=d>0,p=h>0,g={isBound:!1,offset:0,pos:0},v={isBound:!1,offset:0,pos:0};if(0===h&&0===d)return{vertical:g,horizontal:v};if(0===h)f?s<l&&(v.pos=s,v.offset=l-s):o>l&&(v.pos=o,v.offset=l-o);else if(0===d)p?a<c&&(g.pos=a,g.offset=c-a):i>c&&(g.pos=i,g.offset=c-i);else{var m=d/h,b=n[1]-m*c,y=0,S=0,w=!1;p&&a<=c?(y=m*a+b,S=a,w=!0):!p&&c<=i&&(y=m*i+b,S=i,w=!0),w&&(y<o||y>s)&&(w=!1),w||(f&&s<=l?(y=s,S=(y-b)/m,w=!0):!f&&l<=o&&(y=o,S=(y-b)/m,w=!0)),w&&(g.isBound=!0,g.pos=S,g.offset=c-S,v.isBound=!0,v.pos=y,v.offset=l-y)}return{vertical:g,horizontal:v}}function dd(t,e,n){var r=t[n?"left":"top"],i=t[n?"right":"bottom"],o=Math.min.apply(Math,e),a=Math.max.apply(Math,e),s=[];return r+1>o&&s.push({isBound:!0,offset:o-r,pos:r}),i-1<a&&s.push({isBound:!0,offset:a-i,pos:i}),s.length||s.push({isBound:!1,offset:0,pos:0}),s.sort((function(t,e){return Math.abs(e.offset)-Math.abs(t.offset)}))}function fd(t,e,n){var r=n?t.map((function(t){return zs(t,n)})):t;return r.some((function(t){return t[0]<e.left&&Math.abs(t[0]-e.left)>.1||t[0]>e.right&&Math.abs(t[0]-e.right)>.1||t[1]<e.top&&Math.abs(t[1]-e.top)>.1||t[1]>e.bottom&&Math.abs(t[1]-e.bottom)>.1}))}function pd(t,e,n){var r=Ql(t),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort((function(e,r){return Math.abs(e-t[n?0:1])-Math.abs(r-t[n?0:1])})).map((function(t){return la([0,0],n?[t,e]:[e,t])}))}function gd(t,e,n,r,i){if(!t.props.bounds)return[];var o=i*Math.PI/180,a=ud(t),s=a.left,c=a.top,l=a.right,u=a.bottom,h=s-r[0],d=l-r[0],f=c-r[1],p=u-r[1],g={left:h,top:f,right:d,bottom:p};if(!fd(n,g,0))return[];var v=[];return[[h,0],[d,0],[f,1],[p,1]].forEach((function(t){var r=t[0],i=t[1];n.forEach((function(t){var n=la([0,0],t);v.push.apply(v,pd(t,r,i).map((function(t){return o+t-n})).filter((function(t){return!fd(e,g,t)})).map((function(t){return fa(180*t/Math.PI,wl)})))}))})),v}function vd(t,e){var n,r=t.direction,i=t.classNames,o=t.size,a=t.pos,s=t.zoom,c=t.key,l="horizontal"===r,u=l?"Y":"X";return e.createElement("div",{key:c,className:i.join(" "),style:(n={},n[l?"width":"height"]=""+o,n.transform="translate("+a[0]+", "+a[1]+") translate"+u+"(-50%) scale"+u+"("+s+")",n)})}function md(t,e){return vd(sl(sl({},t),{classNames:ul([Pl("line","guideline",t.direction)],t.classNames).filter((function(t){return t})),size:t.size||t.sizeValue+"px",pos:t.pos||t.posValue.map((function(t){return fa(t,.1)+"px"}))}),e)}function bd(t,e,n,r,i,o,a,s){var c=t.props.zoom;return n.map((function(t,n){var l=t.type,u=t.pos,h=[0,0];return h[a]=r,h[a?0:1]=-i+u,md({key:e+"TargetGuideline"+n,classNames:[Pl("target","bold",l)],posValue:h,sizeValue:o,zoom:c,direction:e},s)}))}function yd(t,e,n,r,i,o){var a=t.props,s=a.zoom,c=a.isDisplayInnerSnapDigit,l="horizontal"===e?Oh:_h,u=i[l.start],h=i[l.end];return n.filter((function(t){var e=t.hide,n=t.elementRect;if(e)return!1;if(c&&n){var r=n.rect;if(r[l.start]<=u&&h<=r[l.end])return!1}return!0})).map((function(t,n){var i=t.pos,a=t.size,c=t.element,l=[-r[0]+i[0],-r[1]+i[1]];return md({key:e+"-default-guideline-"+n,classNames:c?[Pl("bold")]:[],direction:e,posValue:l,sizeValue:a,zoom:s},o)}))}function Sd(t,e,n,r,i,o,a,s){var c,l=t.props,u=l.snapDigit,h=void 0===u?0:u,d=l.isDisplaySnapDigit,f=void 0===d||d,p=l.snapDistFormat,g=void 0===p?function(t){return t}:p,v=l.zoom,m="horizontal"===e?"X":"Y",b="vertical"===e?"height":"width",y=Math.abs(i),S=f?parseFloat(y.toFixed(h)):0;return s.createElement("div",{key:e+"-"+n+"-guideline-"+r,className:Pl("guideline-group",e),style:(c={left:o[0]+"px",top:o[1]+"px"},c[b]=y+"px",c)},md({direction:e,classNames:[Pl(n),a],size:"100%",posValue:[0,0],sizeValue:y,zoom:v},s),s.createElement("div",{className:Pl("size-value","gap"),style:{transform:"translate"+m+"(-50%) scale("+v+")"}},S>0?g(S):""))}function wd(t,e,n,r){var i="vertical"===t?0:1,o="vertical"===t?1:0,a=i?Oh:_h,s=n[a.start],c=n[a.end];return wu(e,(function(t){return t.pos[i]})).map((function(e){var n=[],l=[],u=[];return e.forEach((function(e){var u,h,d=e.element,f=e.elementRect.rect;if(f[a.end]<s)n.push(e);else if(c<f[a.start])l.push(e);else if(f[a.start]<=s&&c<=f[a.end]&&r){var p=e.pos,g={element:d,rect:sl(sl({},f),(u={},u[a.end]=f[a.start],u))},v={element:d,rect:sl(sl({},f),(h={},h[a.start]=f[a.end],h))},m=[0,0],b=[0,0];m[i]=p[i],m[o]=p[o],b[i]=p[i],b[o]=p[o]+e.size,n.push({type:t,pos:m,size:0,elementRect:g}),l.push({type:t,pos:b,size:0,elementRect:v})}})),n.sort((function(t,e){return e.pos[o]-t.pos[o]})),l.sort((function(t,e){return t.pos[o]-e.pos[o]})),{total:e,start:n,end:l,inner:u}}))}function Ed(t,e,n,r,i){var o=t.props.isDisplayInnerSnapDigit,a=[];return["vertical","horizontal"].forEach((function(s){var c=e.filter((function(t){return t.type===s})),l="vertical"===s?1:0,u=l?0:1,h=wd(s,c,r,o),d=l?_h:Oh,f=l?Oh:_h,p=r[d.start],g=r[d.end];h.forEach((function(e){var o=e.total,c=e.start,h=e.end,v=e.inner,m=n[u]+o[0].pos[u]-r[f.start],b=r;c.forEach((function(e){var r=e.elementRect.rect,o=b[d.start]-r[d.end];if(o>0){var c=[0,0];c[l]=n[l]+b[d.start]-p-o,c[u]=m,a.push(Sd(t,s,"dashed",a.length,o,c,e.className,i))}b=r})),b=r,h.forEach((function(e){var r=e.elementRect.rect,o=r[d.start]-b[d.end];if(o>0){var c=[0,0];c[l]=n[l]+b[d.end]-p,c[u]=m,a.push(Sd(t,s,"dashed",a.length,o,c,e.className,i))}b=r})),v.forEach((function(e){var r=e.elementRect.rect,o=p-r[d.start],c=r[d.end]-g,h=[0,0],f=[0,0];h[l]=n[l]-o,h[u]=m,f[l]=n[l]+g-p,f[u]=m,a.push(Sd(t,s,"dashed",a.length,o,h,e.className,i)),a.push(Sd(t,s,"dashed",a.length,c,f,e.className,i))}))}))})),a}function Cd(t,e,n,r,i){var o=[];return["horizontal","vertical"].forEach((function(a){var s=e.filter((function(t){return t.type===a})),c="vertical"===a?0:1,l=c?0:1,u=c?_h:Oh,h=c?Oh:_h,d=r[u.start],f=r[u.end],p=r[h.start],g=r[h.end];s.forEach((function(e){var r=e.gap,a=e.gapRects,s=e.className,v=Math.max.apply(Math,ul([p],a.map((function(t){var e=t.rect;return e[h.start]})))),m=Math.min.apply(Math,ul([g],a.map((function(t){var e=t.rect;return e[h.end]})))),b=(v+m)/2;v!==m&&b!==(p+g)/2&&a.forEach((function(e){var a=e.rect,h=[n[0],n[1]];if(a[u.end]<d)h[c]+=a[u.end]-d;else{if(!(f<a[u.start]))return;h[c]+=a[u.start]-d-r}h[l]+=b-p,o.push(Sd(t,c?"vertical":"horizontal","gap",o.length,r,h,s,i))}))}))})),o}function xd(t,e,n,r){var i=e[0]-t[0],o=e[1]-t[1];if(Math.abs(i)<Do&&(i=0),Math.abs(o)<Do&&(o=0),!i)return r?[0,0]:[0,n];if(!o)return r?[n,0]:[0,0];var a=o/i,s=t[1]-a*t[0];if(r){var c=a*(e[0]+n)+s;return[n,c-e[1]]}var l=(e[1]+n-s)/a;return[l-e[0],n]}function Od(t,e,n,r,i){var o=xd(t,e,n,r);if(!o)return{isOutside:!1,offset:[0,0]};var a=da(t,e),s=da(o,t),c=da(o,e),l=s>a||c>a,u=th({datas:i,distX:o[0],distY:o[1]}),h=u[0],d=u[1];return{offset:[h,d],isOutside:l}}function _d(t,e){return t.isBound?t.offset:e.isSnap?Wh(e).offset:0}function Td(t,e,n,r,i){var o=e[0],a=e[1],s=n[0],c=n[1],l=r[0],u=r[1],h=i[0],d=i[1],f=-h,p=-d;if(t&&o&&a){f=0,p=0;var g=[];if(s&&c?g.push([0,d],[h,0]):s?g.push([h,0]):c?g.push([0,d]):l&&u?g.push([0,d],[h,0]):l?g.push([h,0]):u&&g.push([0,d]),g.length){g.sort((function(t,e){return Ql(As([o,a],t))-Ql(As([o,a],e))}));var v=g[0];if(v[0]&&Math.abs(o)>Do)f=-v[0],p=a*Math.abs(o+f)/Math.abs(o)-a;else if(v[1]&&Math.abs(a)>Do){var m=a;p=-v[1],f=o*Math.abs(a+p)/Math.abs(m)-o}if(t&&c&&s)if(Math.abs(f)>Do&&Math.abs(f)<Math.abs(h)){var b=Math.abs(h)/Math.abs(f);f*=b,p*=b}else if(Math.abs(p)>Do&&Math.abs(p)<Math.abs(d)){b=Math.abs(d)/Math.abs(p);f*=b,p*=b}else f=xu(-h,f),p=xu(-d,p)}}else f=o||s?-h:0,p=a||c?-d:0;return[f,p]}function kd(t,e,n,r,i,o){if(!Th(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var a=uu(o.absolutePoses,[e,n]),s=$l(a),c=s.left,l=s.right,u=s.top,h=s.bottom,d={horizontal:a.map((function(t){return t[1]})),vertical:a.map((function(t){return t[0]}))},f=kh(t.props.snapDirections),p=Ph(f,{left:c,right:l,top:u,bottom:h,center:(c+l)/2,middle:(u+h)/2}),g=Id(t,i,p,d),v=g.vertical,m=g.horizontal,b=ed(t,a,o),y=b.vertical,S=b.horizontal,w=v.isSnap,E=m.isSnap,C=v.isBound||y.isBound,x=m.isBound||S.isBound,O=xu(v.offset,y.offset),_=xu(m.offset,S.offset),T=Td(r,[e,n],[C,x],[w,E],[O,_]),k=T[0],I=T[1];return[{isBound:C,isSnap:w,offset:k},{isBound:x,isSnap:E,offset:I}]}function Id(t,e,n,r){void 0===r&&(r=n);var i=ld(ud(t),r.vertical,r.horizontal),o=i.horizontal,a=i.vertical,s=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:Bh(t,n.vertical,n.horizontal),c=s.horizontal,l=s.vertical,u=_d(o[0],c),h=_d(a[0],l),d=Math.abs(u),f=Math.abs(h);return{horizontal:{isBound:o[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:u,dist:d,bounds:o,snap:c},vertical:{isBound:a[0].isBound,isSnap:l.isSnap,snapIndex:l.index,offset:h,dist:f,bounds:a,snap:l}}}function Pd(t,e,n,r,i){var o=ld(e,n,r),a=o.horizontal,s=o.vertical,c=Vh(t,n,r,i),l=c.horizontal,u=c.vertical,h=_d(a[0],l),d=_d(s[0],u),f=Math.abs(h),p=Math.abs(d);return{horizontal:{isBound:a[0].isBound,isSnap:l.isSnap,snapIndex:l.index,offset:h,dist:f,bounds:a,snap:l},vertical:{isBound:s[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:d,dist:p,bounds:s,snap:u}}}function jd(t,e,n,r){var i=la(t,e)/Math.PI*180,o=n.vertical,a=o.isBound,s=o.isSnap,c=o.dist,l=n.horizontal,u=l.isBound,h=l.isSnap,d=l.dist,f=i%180,p=f<3||f>177,g=f>87&&f<93;return d<c&&(a||s&&!g&&(!r||!p))?"vertical":!u&&(!h||p||r&&g)?"":"horizontal"}function Md(t,e,n,r,i,o){return n.map((function(n){var a=n[0],s=n[1],c=oh(e,a),l=oh(e,s),u=r?Rd(t,c,l,i):Id(t,i,{vertical:[l[0]],horizontal:[l[1]]}),h=u.horizontal,d=h.offset,f=h.isBound,p=h.isSnap,g=u.vertical,v=g.offset,m=g.isBound,b=g.isSnap,y=As(s,a);if(!v&&!d)return{isBound:m||f,isSnap:b||p,sign:y,offset:[0,0]};var S=jd(c,l,u,r);if(!S)return{sign:y,isBound:!1,isSnap:!1,offset:[0,0]};var w="vertical"===S,E=Od(c,l,-(w?v:d),w,o).offset.map((function(t,e){return t*(y[e]?2/y[e]:0)}));return{sign:y,isBound:w?m:f,isSnap:w?b:p,offset:E}}))}function Dd(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function Rd(t,e,n,r){var i=hd(t,e,n),o=i.horizontal,a=i.vertical,s=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:Fh(t,e,n),c=s.horizontal,l=s.vertical,u=Dd(o,c),h=Dd(a,l),d=Math.abs(u),f=Math.abs(h);return{horizontal:{isBound:o.isBound,isSnap:c.isSnap,offset:u,dist:d},vertical:{isBound:a.isBound,isSnap:l.isSnap,offset:h,dist:f}}}function Ad(t,e,n,r,i){var o=[-n[0],-n[1]],a=t.state,s=a.width,c=a.height,l=t.props.bounds,u=1/0,h=1/0;if(l){var d=[[n[0],-n[1]],[-n[0],n[1]]],f=l.left,p=void 0===f?-1/0:f,g=l.top,v=void 0===g?-1/0:g,m=l.right,b=void 0===m?1/0:m,y=l.bottom,S=void 0===y?1/0:y;d.forEach((function(t){var n=t[0]!==o[0],a=t[1]!==o[1],l=oh(e,t),d=360*la(r,l)/Math.PI;if(a){var f=l.slice();(Math.abs(d-360)<2||Math.abs(d-180)<2)&&(f[1]=r[1]);var g=Od(r,f,(r[1]<l[1]?S:v)-l[1],!1,i),m=g.offset,y=m[1],w=g.isOutside;isNaN(y)||(h=c+(w?1:-1)*Math.abs(y))}if(n){f=l.slice();(Math.abs(d-90)<2||Math.abs(d-270)<2)&&(f[0]=r[0]);var E=Od(r,f,(r[0]<l[0]?b:p)-l[0],!0,i),C=E.offset[0],x=E.isOutside;isNaN(C)||(u=s+(x?1:-1)*Math.abs(C))}}))}return{maxWidth:u,maxHeight:h}}function Nd(t){var e=t.state;if(!e.guidelines||!e.guidelines.length){var n=t.state.container,r=t.props.snapContainer||n,i=e.containerClientRect,o={left:0,top:0,bottom:0,right:0};if(n!==r){var a=Au(r,!0);if(a){var s=cu(a),c=Vu(e,[s.left-i.left,s.top-i.top]),l=Vu(e,[s.right-i.right,s.bottom-i.bottom]);o.left=fa(c[0],.1),o.top=fa(c[1],.1),o.right=fa(l[0],.1),o.bottom=fa(l[1],.1)}}e.snapOffset=o,e.guidelines=Nh(t),e.enableSnap=!0}}function Ld(t,e,n,r,i,o){var a=ql(t,e,n,o?4:3),s=ah(a,i);return uu(a,As(r,s))}function Bd(t,e,n,r,i,o){var a=Xh(n,r),s=rd(e,n,r),c=ul(Md(t,e,a,r,i,o),td(t,s,oh(e,[0,0]),o)),l=Yh(c,0),u=Yh(c,1);return{width:{isBound:l.isBound,offset:l.offset[0]},height:{isBound:u.isBound,offset:u.offset[1]}}}function Vd(t,e,n,r,i,o,a,s,c){var l=oh(e,a),u=Id(t,s,{vertical:[l[0]],horizontal:[l[1]]}),h=u.horizontal.offset,d=u.vertical.offset;if(d||h){var f=th({datas:c,distX:-d,distY:-h}),p=f[0],g=f[1],v=Math.min(i||1/0,n+a[0]*p),m=Math.min(o||1/0,r+a[1]*g);return[v-n,m-r]}return[0,0]}function Fd(t,e,n,r,i,o,a,s){for(var c=hu(t.state),l=t.props.keepRatio,u=0,h=0,d=0;d<2;++d){var f=e(u,h),p=Bd(t,f,i,l,a,s),g=p.width,v=p.height,m=g.isBound,b=v.isBound,y=g.offset,S=v.offset;if(1===d&&(m||(y=0),b||(S=0)),0===d&&a&&!m&&!b)return[0,0];if(l){var w=Math.abs(y)*(n?1/n:1),E=Math.abs(S)*(r?1/r:1),C=m&&b?w<E:b||!m&&w<E;C?y=n*S/r:S=r*y/n}u+=y,h+=S}if(i[0]&&i[1]){var x=Ad(t,c,i,o,s),O=x.maxWidth,_=x.maxHeight,T=Vd(t,e(u,h).map((function(t){return t.map((function(t){return fa(t,Sl)}))})),n+u,r+h,O,_,i,a,s);y=T[0],S=T[1];u+=y,h+=S}return[u,h]}function Ud(t,e,n,r){if(!Th(t,"rotatable"))return r;var i=e.pos1,o=e.pos2,a=e.pos3,s=e.pos4,c=r*Math.PI/180,l=[i,o,a,s].map((function(t){return As(t,n)})),u=l.map((function(t){return zs(t,c)})),h=ul(gd(t,l,u,n,r),sd(t,l,u,n,r));return h.sort((function(t,e){return Math.abs(t-r)-Math.abs(e-r)})),h.length?h[0]:r}function Wd(t,e,n,r,i,o,a){if(!Th(t,"resizable"))return[0,0];var s=t.state,c=s.allMatrix,l=s.is3d;return Fd(t,(function(t,o){return Ld(c,e+t,n+o,i,r,l)}),e,n,r,i,o,a)}function zd(t,e,n,r,i){var o=i.width,a=i.height,s=i.fixedPosition;if(!Th(t,"scalable"))return[0,0];var c=i.is3d,l=Fd(t,(function(t,r){return Ld(uh(i,Rs(e,[t/o,r/a])),o,a,s,n,c)}),o,a,n,s,r,i);return[l[0]/o,l[1]/a]}function Gd(t,e){e.absolutePoses=hu(t.state)}function Hd(t){var e=[];return t.forEach((function(t){t.guidelineInfos.forEach((function(t){var n=t.guideline;e.indexOf(n)>-1||e.push(n)}))})),e}function Yd(t,e,n,r,i,o){var a=ld(ud(t,o),e,n),s=a.vertical,c=a.horizontal;s.forEach((function(t){t.isBound&&r.push({type:"bounds",pos:t.pos})})),c.forEach((function(t){t.isBound&&i.push({type:"bounds",pos:t.pos})}));var l=cd(t),u=l.vertical,h=l.horizontal;u.forEach((function(t){ta(r,(function(e){var n=e.type,r=e.pos;return"bounds"===n&&r===t}))>=0||r.push({type:"bounds",pos:t})})),h.forEach((function(t){ta(i,(function(e){var n=e.type,r=e.pos;return"bounds"===n&&r===t}))>=0||i.push({type:"bounds",pos:t})}))}var Xd={name:"snappable",props:{snappable:[Boolean,Array],snapContainer:Object,snapDirections:[Boolean,Object],elementSnapDirections:[Boolean,Object],snapGap:Boolean,snapGridWidth:Number,snapGridHeight:Number,isDisplaySnapDigit:Boolean,isDisplayInnerSnapDigit:Boolean,snapDigit:Number,snapThreshold:Number,horizontalGuidelines:Array,verticalGuidelines:Array,elementGuidelines:Array,bounds:Object,innerBounds:Object,snapDistFormat:Function},events:{onSnap:"snap"},css:[":host {\n    --bounds-color: #d66;\n}\n.guideline {\n    pointer-events: none;\n    z-index: 2;\n}\n.guideline.bounds {\n    background: #d66;\n    background: var(--bounds-color);\n}\n.guideline-group {\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n.guideline-group .size-value {\n    position: absolute;\n    color: #f55;\n    font-size: 12px;\n    font-weight: bold;\n}\n.guideline-group.horizontal .size-value {\n    transform-origin: 50% 100%;\n    transform: translateX(-50%);\n    left: 50%;\n    bottom: 5px;\n}\n.guideline-group.vertical .size-value {\n    transform-origin: 0% 50%;\n    top: 50%;\n    transform: translateY(-50%);\n    left: 5px;\n}\n.guideline.gap {\n    background: #f55;\n}\n.size-value.gap {\n    color: #f55;\n}\n"],render:function(t,e){var n=t.state,r=n.top,i=n.left,o=n.pos1,a=n.pos2,s=n.pos3,c=n.pos4,l=n.snapRenderInfo;if(!l||!Th(t,""))return[];n.guidelines=Nh(t);var u=Math.min(o[0],a[0],s[0],c[0]),h=Math.min(o[1],a[1],s[1],c[1]),d=l.externalPoses||[],f=hu(t.state),p=[],g=[],v=[],m=[],b=[],y=$l(f),S=y.width,w=y.height,E=y.top,C=y.left,x=y.bottom,O=y.right,_={left:C,right:O,top:E,bottom:x,center:(C+O)/2,middle:(E+x)/2},T=d.length>0,k=T?$l(d):{};if(!l.request){if(l.direction&&b.push(Gh(t,f,l.direction)),l.snap){var I=$l(f);l.center&&(I.middle=(I.top+I.bottom)/2,I.center=(I.left+I.right)/2),b.push(Uh(t,I,1))}T&&(l.center&&(k.middle=(k.top+k.bottom)/2,k.center=(k.left+k.right)/2),b.push(Uh(t,k,1))),b.forEach((function(t){var e=t.vertical.posInfos,n=t.horizontal.posInfos;p.push.apply(p,e.filter((function(t){var e=t.guidelineInfos;return e.some((function(t){var e=t.guideline;return!e.hide}))})).map((function(t){return{type:"snap",pos:t.pos}}))),g.push.apply(g,n.filter((function(t){var e=t.guidelineInfos;return e.some((function(t){var e=t.guideline;return!e.hide}))})).map((function(t){return{type:"snap",pos:t.pos}}))),v.push.apply(v,Hd(e)),m.push.apply(m,Hd(n))}))}Yd(t,[C,O],[E,x],p,g),T&&Yd(t,[k.left,k.right],[k.top,k.bottom],p,g,l.externalBounds);var P=ul(v,m),j=P.filter((function(t){return t.element&&!t.gapRects})),M=P.filter((function(t){return t.gapRects}));return vu(t,"onSnap",{guidelines:P.filter((function(t){var e=t.element;return!e})),elements:j,gaps:M},!0),ul(Ed(t,j,[u,h],_,e),Cd(t,M,[u,h],_,e),yd(t,"horizontal",m,[i,r],_,e),yd(t,"vertical",v,[i,r],_,e),bd(t,"horizontal",g,u,r,S,0,e),bd(t,"vertical",p,h,i,w,1,e))},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},Nd(t)},drag:function(t){var e=t.state;e.guidelines=Nh(t)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){return!(!ju(t,e)&&!of(t,e))||(!e.isRequest&&e.inputEvent?ga(e.inputEvent.target,Pl("snap-control")):void 0)},dragControlStart:function(t){t.state.snapRenderInfo=null,Nd(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,Nd(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}},qd={name:"draggable",props:{draggable:Boolean,throttleDrag:Number,throttleDragRotate:Number,startDragRotate:Number,edgeDraggable:Boolean},events:{onDragStart:"dragStart",onDrag:"drag",onDragEnd:"dragEnd",onDragGroupStart:"dragGroupStart",onDragGroup:"dragGroup",onDragGroupEnd:"dragGroupEnd"},render:function(t,e){var n=t.props,r=n.throttleDragRotate,i=n.zoom,o=t.state,a=o.dragInfo,s=o.beforeOrigin;if(!r||!a)return[];var c=a.dist;if(!c[0]&&!c[1])return[];var l=Ql(c),u=la(c,[0,0]);return[e.createElement("div",{className:Pl("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:l+"px",transform:"translate("+s[0]+"px, "+s[1]+"px) rotate("+u+"rad) scaleY("+i+")"}})]},dragStart:function(t,e){var n=e.datas,r=e.parentEvent,i=e.parentGesto,o=t.state,a=o.target,s=o.gesto;if(s)return!1;o.gesto=i||t.targetGesto;var c=mu(a);n.datas={},n.left=parseFloat(c.left||"")||0,n.top=parseFloat(c.top||"")||0,n.bottom=parseFloat(c.bottom||"")||0,n.right=parseFloat(c.right||"")||0,n.startValue=[0,0],Xu(t,e),dh(e,"translate"),Gd(t,n),n.prevDist=[0,0],n.prevBeforeDist=[0,0],n.isDrag=!1,n.deltaOffset=[0,0],n.distOffset=[0,0];var l=pu(t,e,sl({set:function(t){n.startValue=t}},hh(e))),u=r||vu(t,"onDragStart",l);return!1!==u?(n.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(o.gesto=null,n.isPinch=!1),!!n.isDrag&&l},drag:function(t,e){if(e){$u(e,"translate");var n=e.datas,r=e.parentEvent,i=e.parentFlag,o=e.isPinch,a=e.isRequest,s=e.distX,c=e.distY,l=n.isDrag,u=n.prevDist,h=n.prevBeforeDist,d=n.startValue,f=n.distOffset;if(l){s+=f[0],c+=f[1];var p=t.props,g=p.parentMoveable,v=r?0:p.throttleDrag||0,m=r?0:p.throttleDragRotate||0,b=!1,y=0;if(!r&&m>0&&(s||c)){var S=p.startDragRotate||0,w=fa(S+180*la([0,0],[s,c])/Math.PI,m)-S,E=c*Math.abs(Math.cos((w-90)/180*Math.PI)),C=s*Math.abs(Math.cos(w/180*Math.PI)),x=Ql([C,E]);y=w*Math.PI/180,s=x*Math.cos(y),c=x*Math.sin(y)}if(!o&&!r&&!i&&(!m||s||c)){var O=kd(t,s,c,m,a,n),_=O[0],T=O[1],k=_.isSnap,I=_.isBound,P=_.offset,j=T.isSnap,M=T.isBound,D=T.offset;b=k||j||I||M,s+=P,c+=D}var R=Rs(Qu({datas:n,distX:s,distY:c}),d),A=Rs(Ku({datas:n,distX:s,distY:c}),d);m||b||(pa(A,v),pa(R,v));var N=As(R,d),L=As(A,d),B=As(L,u),V=As(N,h);n.prevDist=L,n.prevBeforeDist=N,n.passDelta=B,n.passDist=L;var F=n.left+N[0],U=n.top+N[1],W=n.right-N[0],z=n.bottom-N[1],G=Ju(n,"translate("+A[0]+"px, "+A[1]+"px)","translate("+L[0]+"px, "+L[1]+"px)");if(t.state.dragInfo.dist=r?[0,0]:L,r||g||!B.every((function(t){return!t}))||!V.some((function(t){return!t}))){var H=t.state,Y=H.width,X=H.height,q=pu(t,e,{transform:G,dist:L,delta:B,translate:A,beforeDist:N,beforeDelta:V,beforeTranslate:R,left:F,top:U,right:W,bottom:z,width:Y,height:X,isPinch:o});return!r&&vu(t,"onDrag",q),q}}}},dragAfter:function(t,e){var n=e.datas,r=e.datas,i=r.deltaOffset,o=r.distOffset;return!(!i[0]&&!i[1])&&(n.deltaOffset=[0,0],o[0]+=i[0],o[1]+=i[1],this.drag(t,e))},dragEnd:function(t,e){var n=e.parentEvent,r=e.datas,i=e.isDrag;if(t.state.gesto=null,t.state.dragInfo=null,r.isDrag)return r.isDrag=!1,!n&&vu(t,"onDragEnd",gu(t,e,{})),i},dragGroupStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY,o=this.dragStart(t,e);if(!o)return!1;var a=Gu(t,this,"dragStart",[r||0,i||0],e,!1),s=sl(sl({},o),{targets:t.props.targets,events:a}),c=vu(t,"onDragGroupStart",s);return n.isDrag=!1!==c,!!n.isDrag&&o},dragGroup:function(t,e){var n=e.datas;if(n.isDrag){var r=this.drag(t,e),i=e.datas.passDelta,o=Gu(t,this,"drag",i,e,!1);if(r){var a=sl({targets:t.props.targets,events:o},r);return vu(t,"onDragGroup",a),a}}},dragGroupEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isDrag)return this.dragEnd(t,e),Gu(t,this,"dragEnd",[0,0],e,!1),vu(t,"onDragGroupEnd",gu(t,e,{targets:t.props.targets})),n},request:function(t){var e={},n=t.getRect(),r=0,i=0;return{isControl:!1,requestStart:function(){return{datas:e}},request:function(t){return"x"in t?r=t.x-n.left:"deltaX"in t&&(r+=t.deltaX),"y"in t?i=t.y-n.top:"deltaY"in t&&(i+=t.deltaY),{datas:e,distX:r,distY:i}},requestEnd:function(){return{datas:e,isDrag:!0}}}},unset:function(t){t.state.dragInfo=null}};function $d(t,e,n,r){void 0===r&&(r="");var i=t.state,o=i.renderPoses,a=i.rotation,s=i.direction,c=t.props,l=c.renderDirections,u=void 0===l?e:l,h=c.zoom,d={};if(!u)return[];var f=s>0?1:-1,p=!0===u?Ol:u,g=a/Math.PI*180;return p.forEach((function(t){d[t]=!0})),p.map((function(t){var e=_l[t];if(!e||!d[t])return null;var i=(fa(g,15)+f*Tl[t]+720)%180;return n.createElement("div",{className:Pl("control","direction",t,r),"data-rotation":i,"data-direction":t,key:"direction-"+t,style:nu.apply(void 0,ul([a,h],e.map((function(t){return o[t]}))))})}))}function Jd(t,e,n,r,i,o){for(var a=[],s=6;s<arguments.length;s++)a[s-6]=arguments[s];var c=la(n,r),l=e?fa(c/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line"+o,className:Pl.apply(void 0,ul(["line","direction",e],a)),"data-rotation":l,"data-line-index":o,"data-direction":e,style:eu(n,r,i,c)})}function Kd(t,e){return $d(t,Ol,e)}function Zd(t,e){return $d(t,["nw","ne","sw","se"],e)}function Qd(t,e,n,r,i,o){var a=t.state.is3d?4:3,s=Xl(t.state.rootMatrix,i,a),c=Rs([o.left,o.top],s);e.startAbsoluteOrigin=c,e.prevDeg=la(c,[n,r])/Math.PI*180,e.prevSnapDeg=e.prevDeg,e.startDeg=e.prevDeg,e.loop=0}function tf(t,e,n,r,i,o){var a=n.prevDeg,s=Ud(t,e,n.origin,r);n.prevDeg=s;var c=s-a;return[c,s,o+s]}function ef(t,e,n,r,i,o,a,s){var c=n.prevDeg,l=n.prevSnapDeg,u=n.startDeg,h=n.loop;c>r&&c>270&&r<90?++n.loop:c<r&&c<90&&r>270&&--n.loop;var d=n.loop,f=360*h+l-u+o,p=360*d+r-u+o;n.prevDeg=p-360*d+u-o,p=fa(p,a);var g=i*(p-o);s&&(g=Ud(t,e,n.origin,g),p=g/i+o),n.prevSnapDeg=p-360*d+u-o;var v=i*(p-f);return[v,g,o+g]}function nf(t,e,n,r,i,o,a,s){return ef(t,e,n,la(n.startAbsoluteOrigin,[i,o])/Math.PI*180,r,a,s,!0)}function rf(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];if("none"!==t){var s=(t||"top").split("-"),c=s[0],l=s[1],u=[r,i];"left"===c?u=[o,r]:"right"===c?u=[i,a]:"bottom"===c&&(u=[a,o]);var h=[(u[0][0]+u[1][0])/2,(u[0][1]+u[1][1])/2],d=ou(u,n);if(l){var f="top"===l||"left"===l,p="bottom"===c||"left"===c;h=u[f&&!p||!f&&p?0:1]}return[h,d]}}function of(t,e){if(e.isRequest)return"rotatable"===e.requestAble;var n=e.inputEvent.target;if(ga(n,Pl("rotation-control")))return!0;var r=t.props.rotationTarget;return!!r&&Nu(r,!0).some((function(t){return!!t&&(n===t||n.contains(t))}))}var af={name:"rotatable",canPinch:!0,props:{rotatable:Boolean,rotationPosition:String,throttleRotate:Number,renderDirections:Object,rotationTarget:Object},events:{onRotateStart:"rotateStart",onRotate:"rotate",onRotateEnd:"rotateEnd",onRotateGroupStart:"rotateGroupStart",onRotateGroup:"rotateGroup",onRotateGroupEnd:"rotateGroupEnd"},css:[".rotation {\n            position: absolute;\n            height: 40px;\n            width: 1px;\n            transform-origin: 50% 100%;\n            height: calc(40px * var(--zoom));\n            top: auto;\n            left: 0;\n            bottom: 100%;\n            will-change: transform;\n        }\n        .rotation .rotation-line {\n            display: block;\n            width: 100%;\n            height: 100%;\n            transform-origin: 50% 50%;\n        }\n        .rotation .rotation-control {\n            border-color: #4af;\n            border-color: var(--moveable-color);\n            background:#fff;\n            cursor: alias;\n        }"],render:function(t,e){var n=t.props,r=n.rotatable,i=n.rotationPosition,o=n.zoom,a=n.renderDirections,s=t.state,c=s.renderPoses,l=s.direction;if(!r)return null;var u=rf(i,c,l),h=[];if(u){var d=u[0],f=u[1];h.push(e.createElement("div",{key:"rotation",className:Pl("rotation"),style:{transform:"translate(-50%) translate("+d[0]+"px, "+d[1]+"px) rotate("+f+"rad)"}},e.createElement("div",{className:Pl("line rotation-line"),style:{transform:"scaleX("+o+")"}}),e.createElement("div",{className:Pl("control rotation-control"),style:{transform:"translate(0.5px) scale("+o+")"}})))}return a&&h.push.apply(h,$d(t,[],e)),h},dragControlCondition:of,dragControlStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY,o=e.parentRotate,a=e.parentFlag,s=e.isPinch,c=e.isRequest,l=t.state,u=l.target,h=l.left,d=l.top,f=l.origin,p=l.beforeOrigin,g=l.direction,v=l.beforeDirection,m=l.targetTransform,b=l.moveableClientRect;if(!c&&!u)return!1;var y=t.getRect();if(n.rect=y,n.transform=m,n.left=h,n.top=d,n.fixedPosition=yh(t,bh(t)),n.absoluteInfo={origin:y.origin,startValue:y.rotation},Qd(t,n.absoluteInfo,r,i,f,b),c||s||a){var S=o||0;n.beforeInfo={origin:y.beforeOrigin,prevDeg:S,startDeg:S,prevSnapDeg:S,loop:0},n.afterInfo={origin:y.origin,prevDeg:S,startDeg:S,prevSnapDeg:S,loop:0}}else n.beforeInfo={origin:y.beforeOrigin},n.afterInfo={origin:y.origin},Qd(t,n.beforeInfo,r,i,p,b),Qd(t,n.afterInfo,r,i,f,b);n.direction=g,n.beforeDirection=v,n.startValue=0,n.datas={},dh(e,"rotate");var w=pu(t,e,sl(sl({set:function(t){n.startValue=t*Math.PI/180}},hh(e)),{dragStart:qd.dragStart(t,(new Wu).dragStart([0,0],e))})),E=vu(t,"onRotateStart",w);return n.isRotate=!1!==E,t.state.snapRenderInfo={request:e.isRequest},!!n.isRotate&&w},dragControl:function(t,e){var n,r,i,o,a,s,c,l,u,h=e.datas,d=e.clientX,f=e.clientY,p=e.parentRotate,g=e.parentFlag,v=e.isPinch,m=e.groupDelta,b=h.beforeDirection,y=h.beforeInfo,S=h.afterInfo,w=h.absoluteInfo,E=h.isRotate,C=h.startValue,x=h.rect;if(E){$u(e,"rotate");var O,_,T,k,I,P,j,M,D,R=qu(e),A=b*R,N=t.props,L=N.throttleRotate,B=void 0===L?0:L,V=N.parentMoveable,F=180/Math.PI*C,U=w.startValue;if(!g&&"parentDist"in e){var W=e.parentDist;n=tf(t,x,S,W,A,F),O=n[0],_=n[1],T=n[2],r=tf(t,x,y,W,b,F),k=r[0],I=r[1],P=r[2],i=tf(t,x,w,W,A,U),j=i[0],M=i[1],D=i[2]}else v||g?(o=ef(t,x,S,p,A,F,B),O=o[0],_=o[1],T=o[2],a=ef(t,x,y,p,b,F,B),k=a[0],I=a[1],P=a[2],s=ef(t,x,w,p,A,U,B),j=s[0],M=s[1],D=s[2]):(c=nf(t,x,S,A,d,f,F,B),O=c[0],_=c[1],T=c[2],l=nf(t,x,y,b,d,f,F,B),k=l[0],I=l[1],P=l[2],u=nf(t,x,w,A,d,f,U,B),j=u[0],M=u[1],D=u[2]);if(j||O||k||V){var z=Ju(h,"rotate("+T+"deg)","rotate("+_+"deg)"),G=Sh(t,_,h.fixedPosition,h),H=As(Rs(m||[0,0],G),h.prevInverseDist||[0,0]);h.prevInverseDist=G;var Y=pu(t,e,sl({delta:O,dist:_,rotate:T,beforeDist:I,beforeDelta:k,beforeRotate:P,absoluteDist:M,absoluteDelta:j,absoluteRotate:D,isPinch:!!v},gh(t,z,H,v,e)));return vu(t,"onRotate",Y),Y}}},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return!!n.isRotate&&(n.isRotate=!1,vu(t,"onRotateEnd",gu(t,e,{})),r)},dragGroupControlCondition:of,dragGroupControlStart:function(t,e){var n=e.datas,r=t.state,i=r.left,o=r.top,a=r.beforeOrigin,s=this.dragControlStart(t,e);if(!s)return!1;s.set(n.beforeDirection*t.rotation);var c=Hu(t,this,"dragControlStart",e,(function(t,e){var n=t.state,r=n.left,s=n.top,c=n.beforeOrigin,l=Rs(As([r,s],[i,o]),As(c,a));return e.datas.groupClient=l,sl(sl({},e),{parentRotate:0})})),l=sl(sl({},s),{targets:t.props.targets,events:c}),u=vu(t,"onRotateGroupStart",l);return n.isRotate=!1!==u,!!n.isRotate&&s},dragGroupControl:function(t,e){var n=e.datas;if(n.isRotate){var r=this.dragControl(t,e);if(r){var i=n.beforeDirection,o=r.beforeDist,a=r.beforeDelta,s=a/180*Math.PI,c=Hu(t,this,"dragControl",e,(function(t,e){var n=e.datas.groupClient,r=n[0],a=n[1],c=zs([r,a],s*i),l=c[0],u=c[1],h=[l-r,u-a];return e.datas.groupClient=[l,u],sl(sl({},e),{parentRotate:o,groupDelta:h})}));t.rotation=i*r.beforeRotate;var l=sl({targets:t.props.targets,events:c,set:function(e){t.rotation=e}},r);return vu(t,"onRotateGroup",l),l}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isRotate){this.dragControlEnd(t,e),Hu(t,this,"dragControlEnd",e);var i=gu(t,e,{targets:t.props.targets});return vu(t,"onRotateGroupEnd",i),n}},request:function(t){var e={},n=0,r=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(t){return"deltaRotate"in t?n+=t.deltaRotate:"rotate"in t&&(n=t.rotate-r),{datas:e,parentDist:n}},requestEnd:function(){return{datas:e,isDrag:!0}}}}},sf={name:"resizable",ableGroup:"size",canPinch:!0,props:{resizable:Boolean,throttleResize:Number,renderDirections:Array,keepRatio:Boolean},events:{onResizeStart:"resizeStart",onResize:"resize",onResizeEnd:"resizeEnd",onResizeGroupStart:"resizeGroupStart",onResizeGroup:"resizeGroup",onResizeGroupEnd:"resizeGroupEnd"},render:function(t,e){var n=t.props,r=n.resizable,i=n.edge;if(r)return i?Zd(t,e):Kd(t,e)},dragControlCondition:ju,dragControlStart:function(t,e){var n,r=e.inputEvent,i=e.isPinch,o=e.parentDirection,a=e.datas,s=e.parentFlag,c=o||(i?[0,0]:lu(r.target)),l=t.state,u=l.target,h=l.width,d=l.height;if(!c||!u)return!1;!i&&Xu(t,e),a.datas={},a.direction=c,a.startOffsetWidth=h,a.startOffsetHeight=d,a.prevWidth=0,a.prevHeight=0,n=ru(u),a.startWidth=n[0],a.startHeight=n[1];var f=[Math.max(0,h-a.startWidth),Math.max(0,d-a.startHeight)];if(a.minSize=f,a.maxSize=[1/0,1/0],!s){var p=mu(u),g=p.position,v=p.minWidth,m=p.minHeight,b=p.maxWidth,y=p.maxHeight,S="static"===g||"relative"===g,w=S?u.parentElement:u.offsetParent,E=h,C=d;if(w&&(E=w.clientWidth,C=w.clientHeight,S)){var x=mu(w);E-=parseFloat(x.paddingLeft)||0,C-=parseFloat(x.paddingTop)||0}a.minSize=Rs([ra(v,E)||0,ra(m,C)||0],f),a.maxSize=Rs([ra(b,E)||1/0,ra(y,C)||1/0],f)}var O=t.props.transformOrigin||"% %";function _(t){a.ratio=t&&isFinite(t)?t:0}function T(e){a.fixedDirection=e,a.fixedPosition=Eh(t,e)}a.transformOrigin=O&&Vo(O)?O.split(" "):O,a.isWidth=!c[0]&&!c[1]||c[0]||!c[1],_(h/d),T([-c[0],-c[1]]);var k=pu(t,e,{direction:c,set:function(t){var e=t[0],n=t[1];a.startWidth=e,a.startHeight=n},setMin:function(t){a.minSize=t},setMax:function(t){a.maxSize=[t[0]||1/0,t[1]||1/0]},setRatio:_,setFixedDirection:T,setOrigin:function(t){a.transformOrigin=t},dragStart:qd.dragStart(t,(new Wu).dragStart([0,0],e))}),I=vu(t,"onResizeStart",k);return!1!==I&&(a.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:c}),!!a.isResize&&k},dragControl:function(t,e){var n,r=e.datas,i=e.distX,o=e.distY,a=e.parentFlag,s=e.isPinch,c=e.parentDistance,l=e.parentScale,u=e.parentKeepRatio,h=e.dragClient,d=e.parentDist,f=e.isRequest,p=r.isResize,g=r.transformOrigin,v=r.fixedDirection,m=r.startWidth,b=r.startHeight,y=r.prevWidth,S=r.prevHeight,w=r.minSize,E=r.maxSize,C=r.ratio,x=r.isWidth,O=r.startOffsetWidth,_=r.startOffsetHeight;if(p){var T=t.props,k=T.throttleResize,I=void 0===k?0:k,P=T.parentMoveable,j=T.snapThreshold,M=void 0===j?5:j,D=r.direction,R=D,A=0,N=0;D[0]||D[1]||(R=[1,1]);var L=C&&(t.props.keepRatio||u),B=h;if(h||(B=!a&&s?Eh(t,[0,0]):r.fixedPosition),d)A=d[0],N=d[1],L&&(A?N||(N=A/C):A=N*C);else if(l)A=(l[0]-1)*O,N=(l[1]-1)*_;else if(s)c&&(A=c,N=c*_/O);else{var V=th({datas:r,distX:i,distY:o});if(A=R[0]*V[0],N=R[1]*V[1],L&&O&&_){var F=la([0,0],V),U=la([0,0],R),W=Ql([A,N]),z=Math.cos(F-U)*W;if(R[0])if(R[1]){var G=2*R[0]*O,H=2*R[1]*_,Y=Ql([G+V[0],H+V[1]])-Ql([G,H]),X=la([0,0],[C,1]);A=Math.cos(X)*Y,N=Math.sin(X)*Y}else A=z,N=A*C;else N=z,A=N/C}else if(!L){var q=ul(D);O||(V[0]<0?q[0]=-1:V[0]>0&&(q[0]=1)),_||(V[1]<0?q[1]=-1:V[1]>0&&(q[1]=1)),D=q,R=q,A=R[0]*V[0],N=R[1]*V[1]}}var $=R[0]||L?Math.max(O+A,wl):O,J=R[1]||L?Math.max(_+N,wl):_;L&&O&&_&&(x?J=$/C:$=J*C);var K=[0,0];if(s||(K=Wd(t,$,J,D,B,f,r)),d&&(!d[0]&&(K[0]=0),!d[1]&&(K[1]=0)),L){R[0]&&R[1]&&K[0]&&K[1]&&(Math.abs(K[0])>Math.abs(K[1])?K[1]=0:K[0]=0);var Z=!K[0]&&!K[1];Z&&(x?$=fa($,I):J=fa(J,I)),R[0]&&!R[1]||K[0]&&!K[1]||Z&&x?($+=K[0],J=$/C):(!R[0]&&R[1]||!K[0]&&K[1]||Z&&!x)&&(J+=K[1],$=J*C)}else O+A<-M&&(K[0]=0),O+N<-M&&(K[1]=0),$+=K[0],J+=K[1],K[0]||($=fa($,I)),K[1]||(J=fa(J,I));n=aa([$,J],w,E,L),$=n[0],J=n[1],$=Math.round($),J=Math.round(J),A=$-O,N=J-_;var Q=[A-y,N-S];r.prevWidth=A,r.prevHeight=N;var tt=wh(t,$,J,v,B,g);if(P||!Q.every((function(t){return!t}))||!tt.every((function(t){return!t}))){var et=pu(t,e,{width:m+A,height:b+N,offsetWidth:$,offsetHeight:J,direction:D,dist:[A,N],delta:Q,isPinch:!!s,drag:qd.drag(t,Uu(e,t.state,tt,!!s,!1))});return vu(t,"onResize",et),et}}},dragControlAfter:function(t,e){var n=e.datas,r=n.isResize,i=n.startOffsetWidth,o=n.startOffsetHeight,a=n.prevWidth,s=n.prevHeight;if(r){var c=t.state,l=c.width,u=c.height,h=l-(i+a),d=u-(o+s),f=Math.abs(h)>3,p=Math.abs(d)>3;return f&&(n.startWidth+=h,n.startOffsetWidth+=h,n.prevWidth+=h),p&&(n.startHeight+=d,n.startOffsetHeight+=d,n.prevHeight+=d),f||p?(this.dragControl(t,e),!0):void 0}},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;if(!n.isResize)return!1;n.isResize=!1;var i=gu(t,e,{});return vu(t,"onResizeEnd",i),r},dragGroupControlCondition:ju,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var i=zu(t,"resizable",e);function o(e,r){var i=n.fixedDirection,o=n.fixedPosition,a=Eh(e,i),s=Bs(Ys(-t.rotation/180*Math.PI,3),[a[0]-o[0],a[1]-o[1],1],3),c=s[0],l=s[1];return r.datas.originalX=c,r.datas.originalY=l,r}var a=Hu(t,this,"dragControlStart",e,(function(t,e){return o(t,e)})),s=sl(sl({},r),{targets:t.props.targets,events:a,setFixedDirection:function(e){r.setFixedDirection(e),a.forEach((function(n,r){n.setFixedDirection(e),o(t.moveables[r],i[r])}))}}),c=vu(t,"onResizeGroupStart",s);return n.isResize=!1!==c,!!n.isResize&&r},dragGroupControl:function(t,e){var n=e.datas;if(n.isResize){var r=this.dragControl(t,e);if(r){var i=r.offsetWidth,o=r.offsetHeight,a=r.dist,s=t.props.keepRatio,c=[i/(i-a[0]),o/(o-a[1])],l=n.fixedPosition,u=Hu(t,this,"dragControl",e,(function(e,n){var r=Bs(Ys(t.rotation/180*Math.PI,3),[n.datas.originalX*c[0],n.datas.originalY*c[1],1],3),i=r[0],o=r[1];return sl(sl({},n),{parentDist:null,parentScale:c,dragClient:Rs(l,[i,o]),parentKeepRatio:s})})),h=sl({targets:t.props.targets,events:u},r);return vu(t,"onResizeGroup",h),h}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isResize){this.dragControlEnd(t,e),Hu(t,this,"dragControlEnd",e);var i=gu(t,e,{targets:t.props.targets});return vu(t,"onResizeGroupEnd",i),n}},request:function(t){var e={},n=0,r=0,i=t.getRect();return{isControl:!0,requestStart:function(t){return{datas:e,parentDirection:t.direction||[1,1]}},request:function(t){return"offsetWidth"in t?n=t.offsetWidth-i.offsetWidth:"deltaWidth"in t&&(n+=t.deltaWidth),"offsetHeight"in t?r=t.offsetHeight-i.offsetHeight:"deltaHeight"in t&&(r+=t.deltaHeight),{datas:e,parentDist:[n,r]}},requestEnd:function(){return{datas:e,isDrag:!0}}}}},cf={name:"scalable",ableGroup:"size",canPinch:!0,props:{scalable:Boolean,throttleScale:Number,renderDirections:String,keepRatio:Boolean},events:{onScaleStart:"scaleStart",onScale:"scale",onScaleEnd:"scaleEnd",onScaleGroupStart:"scaleGroupStart",onScaleGroup:"scaleGroup",onScaleGroupEnd:"scaleGroupEnd"},render:function(t,e){var n=t.props,r=n.resizable,i=n.scalable,o=n.edge;if(!r&&i)return o?Zd(t,e):Kd(t,e)},dragControlCondition:ju,dragControlStart:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,o=e.parentDirection,a=o||(r?[0,0]:lu(i.target)),s=t.state,c=s.width,l=s.height,u=s.targetTransform,h=s.target,d=s.pos1,f=s.pos2,p=s.pos4;if(!a||!h)return!1;r||Xu(t,e),n.datas={},n.transform=u,n.prevDist=[1,1],n.direction=a,n.width=c,n.height=l,n.startValue=[1,1];var g=da(d,f),v=da(f,p),m=!a[0]&&!a[1]||a[0]||!a[1];function b(t){n.ratio=t&&isFinite(t)?t:0}function y(e){n.fixedDirection=e,n.fixedPosition=Eh(t,e)}n.scaleWidth=g,n.scaleHeight=v,n.scaleXRatio=g/c,n.scaleYRatio=v/l,dh(e,"scale"),n.isWidth=m,b(da(d,f)/da(f,p)),y([-a[0],-a[1]]);var S=pu(t,e,sl(sl({direction:a,set:function(t){n.startValue=t},setRatio:b,setFixedDirection:y},hh(e)),{dragStart:qd.dragStart(t,(new Wu).dragStart([0,0],e))})),w=vu(t,"onScaleStart",S);return!1!==w&&(n.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:a}),!!n.isScale&&S},dragControl:function(t,e){$u(e,"scale");var n=e.datas,r=e.distX,i=e.distY,o=e.parentScale,a=e.parentDistance,s=e.parentKeepRatio,c=e.parentFlag,l=e.isPinch,u=e.dragClient,h=e.parentDist,d=e.isRequest,f=n.prevDist,p=n.direction,g=n.width,v=n.height,m=n.isScale,b=n.startValue,y=n.isWidth,S=n.ratio,w=n.fixedDirection,E=n.scaleXRatio,C=n.scaleYRatio;if(!m)return!1;var x=t.props,O=x.throttleScale,_=x.parentMoveable,T=p;p[0]||p[1]||(T=[1,1]);var k=S&&(t.props.keepRatio||s),I=t.state,P=1,j=1,M=u;if(u||(M=!c&&l?Eh(t,[0,0]):n.fixedPosition),h)P=(g+h[0])/g,j=(v+h[1])/v;else if(o)P=o[0],j=o[1];else if(l)a&&(P=(g+a)/g,j=(v+a*v/g)/v);else{var D=th({datas:n,distX:r,distY:i}),R=T[0]*D[0]*E,A=T[1]*D[1]*C;if(k&&g&&v)if(T[0])if(T[1]){var N=Ql([R,A]),L=la([0,0],D),B=la([0,0],T),V=Math.cos(L-B)*N,F=la([0,0],[S,1]);R=Math.cos(F)*V,A=Math.sin(F)*V}else A=R/S;else R=A*S;P=(g+R/E)/g,j=(v+A/C)/v}P=T[0]||k?P*b[0]:b[0],j=T[1]||k?j*b[1]:b[1],0===P&&(P=(f[0]>0?1:-1)*El),0===j&&(j=(f[1]>0?1:-1)*El);var U=[P/b[0],j/b[1]],W=[P,j];if(!l&&t.props.groupable){var z=I.snapRenderInfo||{},G=z.direction;Bo(G)&&(G[0]||G[1])&&(I.snapRenderInfo={direction:p,request:e.isRequest})}var H=[0,0];if(l||(H=zd(t,U,p,d,n)),k){T[0]&&T[1]&&H[0]&&H[1]&&(Math.abs(H[0]*g)>Math.abs(H[1]*v)?H[1]=0:H[0]=0);var Y=!H[0]&&!H[1];if(Y&&(y?U[0]=fa(U[0]*b[0],O)/b[0]:U[1]=fa(U[1]*b[1],O)/b[1]),T[0]&&!T[1]||H[0]&&!H[1]||Y&&y){U[0]+=H[0];var X=g*U[0]*b[0]/S;U[1]=X/v/b[1]}else if(!T[0]&&T[1]||!H[0]&&H[1]||Y&&!y){U[1]+=H[1];var q=v*U[1]*b[1]*S;U[0]=q/g/b[0]}}else U[0]+=H[0],U[1]+=H[1],H[0]||(U[0]=fa(U[0]*b[0],O)/b[0]),H[1]||(U[1]=fa(U[1]*b[1],O)/b[1]);0===U[0]&&(U[0]=(f[0]>0?1:-1)*El),0===U[1]&&(U[1]=(f[1]>0?1:-1)*El);var $=[U[0]/f[0],U[1]/f[1]];W=Il(U,b);var J=mh(t,U,w,M,n),K=As(J,n.prevInverseDist||[0,0]);if(n.prevDist=U,n.prevInverseDist=J,P===f[0]&&j===f[1]&&K.every((function(t){return!t}))&&!_)return!1;var Z=Ju(n,"scale("+W.join(", ")+")","scale("+U.join(", ")+")"),Q=pu(t,e,sl({offsetWidth:g,offsetHeight:v,direction:p,scale:W,dist:U,delta:$,isPinch:!!l},gh(t,Z,K,l,e)));return vu(t,"onScale",Q),Q},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return!!n.isScale&&(n.isScale=!1,vu(t,"onScaleEnd",gu(t,e,{})),r)},dragGroupControlCondition:ju,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var i=zu(t,"resizable",e);function o(e,r){var i=n.fixedDirection,o=n.fixedPosition,a=Eh(e,i),s=Bs(Ys(-t.rotation/180*Math.PI,3),[a[0]-o[0],a[1]-o[1],1],3),c=s[0],l=s[1];return r.datas.originalX=c,r.datas.originalY=l,r}n.moveableScale=t.scale;var a=Hu(t,this,"dragControlStart",e,(function(t,e){return o(t,e)})),s=sl(sl({},r),{targets:t.props.targets,events:a,setFixedDirection:function(e){r.setFixedDirection(e),a.forEach((function(n,r){n.setFixedDirection(e),o(t.moveables[r],i[r])}))}}),c=vu(t,"onScaleGroupStart",s);return n.isScale=!1!==c,!!n.isScale&&s},dragGroupControl:function(t,e){var n=e.datas;if(n.isScale){var r=this.dragControl(t,e);if(r){var i=n.moveableScale;t.scale=[r.scale[0]*i[0],r.scale[1]*i[1]];var o=t.props.keepRatio,a=r.dist,s=r.scale,c=n.fixedPosition,l=Hu(t,this,"dragControl",e,(function(e,n){var r=Bs(Ys(t.rotation/180*Math.PI,3),[n.datas.originalX*a[0],n.datas.originalY*a[1],1],3),i=r[0],l=r[1];return sl(sl({},n),{parentDist:null,parentScale:s,parentKeepRatio:o,dragClient:Rs(c,[i,l])})})),u=sl({targets:t.props.targets,events:l},r);return vu(t,"onScaleGroup",u),u}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isScale){this.dragControlEnd(t,e),Hu(t,this,"dragControlEnd",e);var i=gu(t,e,{targets:t.props.targets});return vu(t,"onScaleGroupEnd",i),n}},request:function(){var t={},e=0,n=0;return{isControl:!0,requestStart:function(e){return{datas:t,parentDirection:e.direction||[1,1]}},request:function(r){return e+=r.deltaWidth,n+=r.deltaHeight,{datas:t,parentDist:[e,n]}},requestEnd:function(){return{datas:t,isDrag:!0}}}}};function lf(t,e){return t.map((function(t,n){return Ao(t,e[n],1,2)}))}function uf(t,e,n){var r=la(t,e),i=la(t,n),o=i-r;return o>=0?o:o+2*Math.PI}function hf(t,e){var n=uf(t[0],t[1],t[2]),r=uf(e[0],e[1],e[2]),i=Math.PI;return!(n>=i&&r<=i||n<=i&&r>=i)}var df={name:"warpable",ableGroup:"size",props:{warpable:Boolean,renderDirections:Array},events:{onWarpStart:"warpStart",onWarp:"warp",onWarpEnd:"warpEnd"},render:function(t,e){var n=t.props,r=n.resizable,i=n.scalable,o=n.warpable,a=n.zoom;if(r||i||!o)return[];var s=t.state,c=s.pos1,l=s.pos2,u=s.pos3,h=s.pos4,d=lf(c,l),f=lf(l,c),p=lf(c,u),g=lf(u,c),v=lf(u,h),m=lf(h,u),b=lf(l,h),y=lf(h,l);return ul([e.createElement("div",{className:Pl("line"),key:"middeLine1",style:eu(d,v,a)}),e.createElement("div",{className:Pl("line"),key:"middeLine2",style:eu(f,m,a)}),e.createElement("div",{className:Pl("line"),key:"middeLine3",style:eu(p,b,a)}),e.createElement("div",{className:Pl("line"),key:"middeLine4",style:eu(g,y,a)})],Kd(t,e))},dragControlCondition:function(t,e){return!e.isRequest&&ga(e.inputEvent.target,Pl("direction"))},dragControlStart:function(t,e){var n=e.datas,r=e.inputEvent,i=t.props.target,o=r.target,a=lu(o);if(!a||!i)return!1;var s=t.state,c=s.transformOrigin,l=s.is3d,u=s.targetTransform,h=s.targetMatrix,d=s.width,f=s.height,p=s.left,g=s.top;n.datas={},n.targetTransform=u,n.warpTargetMatrix=l?h:js(h,3,4),n.targetInverseMatrix=Os(_s(n.warpTargetMatrix,4),3,4),n.direction=a,n.left=p,n.top=g,n.poses=[[0,0],[d,0],[0,f],[d,f]].map((function(t){return As(t,c)})),n.nextPoses=n.poses.map((function(t){var e=t[0],r=t[1];return Bs(n.warpTargetMatrix,[e,r,0,1],4)})),n.startValue=Xs(4),n.prevMatrix=Xs(4),n.absolutePoses=hu(s),n.posIndexes=rh(a),Xu(t,e),dh(e,"matrix3d"),s.snapRenderInfo={request:e.isRequest,direction:a};var v=pu(t,e,sl({set:function(t){n.startValue=t}},hh(e))),m=vu(t,"onWarpStart",v);return!1!==m&&(n.isWarp=!0),n.isWarp},dragControl:function(t,e){var n=e.datas,r=e.isRequest,i=e.distX,o=e.distY,a=n.targetInverseMatrix,s=n.prevMatrix,c=n.isWarp,l=n.startValue,u=n.poses,h=n.posIndexes,d=n.absolutePoses;if(!c)return!1;if($u(e,"matrix3d"),Th(t,"warpable")){var f=h.map((function(t){return d[t]}));f.length>1&&f.push([(f[0][0]+f[1][0])/2,(f[0][1]+f[1][1])/2]);var p=Id(t,r,{horizontal:f.map((function(t){return t[1]+o})),vertical:f.map((function(t){return t[0]+i}))}),g=p.horizontal,v=p.vertical;o-=g.offset,i-=v.offset}var m=th({datas:n,distX:i,distY:o},!0),b=n.nextPoses.slice();if(h.forEach((function(t){b[t]=Rs(b[t],m)})),!yl.every((function(t){return hf(t.map((function(t){return u[t]})),t.map((function(t){return b[t]})))})))return!1;var y=Js(u[0],u[2],u[1],u[3],b[0],b[2],b[1],b[3]);if(!y.length)return!1;var S=Ds(a,y,4),w=Zu(n,S,!0),E=Ds(_s(s,4),w,4);n.prevMatrix=w;var C=Ds(l,w,4),x=Ju(n,"matrix3d("+C.join(", ")+")","matrix3d("+w.join(", ")+")");return ph(e,x),vu(t,"onWarp",pu(t,e,{delta:E,matrix:C,dist:w,multiply:Ds,transform:x})),!0},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return!!n.isWarp&&(n.isWarp=!1,vu(t,"onWarpEnd",gu(t,e,{})),r)}},ff=Pl("area-pieces"),pf=Pl("area-piece"),gf=Pl("avoid");function vf(t){var e=t.areaElement,n=t.state,r=n.width,i=n.height;ma(e,gf),e.style.cssText+="left: 0px; top: 0px; width: "+r+"px; height: "+i+"px"}function mf(t){return t.createElement("div",{key:"area_pieces",className:ff},t.createElement("div",{className:pf}),t.createElement("div",{className:pf}),t.createElement("div",{className:pf}),t.createElement("div",{className:pf}))}var bf={name:"dragArea",props:{dragArea:Boolean,passDragArea:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},render:function(t,e){var n=t.props,r=n.target,i=n.dragArea,o=n.groupable,a=n.passDragArea,s=t.state,c=s.width,l=s.height,u=s.renderPoses,h=a?Pl("area","pass"):Pl("area");if(o)return[e.createElement("div",{key:"area",ref:po(t,"areaElement"),className:h}),mf(e)];if(!r||!i)return[];var d=Js([0,0],[c,0],[0,l],[c,l],u[0],u[1],u[2],u[3]),f=d.length?zl(d,!0):"none";return[e.createElement("div",{key:"area",ref:po(t,"areaElement"),className:h,style:{top:"0px",left:"0px",width:c+"px",height:l+"px",transformOrigin:"0 0",transform:f}}),mf(e)]},dragStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY,o=e.inputEvent;if(!o)return!1;n.isDragArea=!1;var a=t.areaElement,s=t.state,c=s.moveableClientRect,l=s.renderPoses,u=s.rootMatrix,h=s.is3d,d=c.left,f=c.top,p=$l(l),g=p.left,v=p.top,m=p.width,b=p.height,y=h?4:3,S=Ou(u,[r-d,i-f],y),w=S[0],E=S[1];w-=g,E-=v;var C=[{left:g,top:v,width:m,height:E-10},{left:g,top:v,width:w-10,height:b},{left:g,top:v+E+10,width:m,height:b-E-10},{left:g+w+10,top:v,width:m-w-10,height:b}],x=[].slice.call(a.nextElementSibling.children);C.forEach((function(t,e){x[e].style.cssText="left: "+t.left+"px;top: "+t.top+"px; width: "+t.width+"px; height: "+t.height+"px;"})),va(a,gf),s.disableNativeEvent=!0},drag:function(t,e){var n=e.datas,r=e.inputEvent;if(this.enableNativeEvent(t),!r)return!1;n.isDragArea||(n.isDragArea=!0,vf(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var n=e.inputEvent,r=e.datas;if(!n)return!1;r.isDragArea||vf(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){vf(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&requestAnimationFrame((function(){e.disableNativeEvent=!1}))}},yf=hl("origin",{render:function(t,e){var n=t.props.zoom,r=t.state,i=r.beforeOrigin,o=r.rotation;return[e.createElement("div",{className:Pl("control","origin"),style:nu(o,n,i),key:"beforeOrigin"})]}});function Sf(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var wf={name:"scrollable",canPinch:!0,props:{scrollable:Boolean,scrollContainer:Object,scrollThreshold:Number,getScrollPosition:Function},events:{onScroll:"scroll",onScrollGroup:"scrollGroup"},dragStart:function(t,e){var n=t.props,r=n.scrollContainer,i=void 0===r?t.getContainer():r,o=new Tc,a=Au(i,!0);e.datas.dragScroll=o;var s=e.isControl?"controlGesto":"targetGesto",c=e.targets;o.on("scroll",(function(n){var r=n.container,i=n.direction,o=pu(t,e,{scrollContainer:r,direction:i}),a=c?"onScrollGroup":"onScroll";c&&(o.targets=c),vu(t,a,o)})).on("move",(function(n){var r=n.offsetX,i=n.offsetY;t[s].scrollBy(r,i,e.inputEvent,!1)})),o.dragStart(e,{container:a})},checkScroll:function(t,e){var n=e.datas.dragScroll;if(n){var r=t.props,i=r.scrollContainer,o=void 0===i?t.getContainer():i,a=r.scrollThreshold,s=void 0===a?0:a,c=r.getScrollPosition,l=void 0===c?Sf:c;return n.drag(e,{container:o,threshold:s,getScrollPosition:function(t){return l({scrollContainer:t.container,direction:t.direction})}}),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,sl(sl({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,sl(sl({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,sl(sl({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,sl(sl({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,sl(sl({},e),{targets:t.props.targets,isControl:!0}))},dragGroupContro:function(t,e){return this.drag(t,sl(sl({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,sl(sl({},e),{targets:t.props.targets}))}},Ef={name:"",props:{target:Object,dragTarget:Object,container:Object,portalContainer:Object,rootContainer:Object,zoom:Number,transformOrigin:Array,edge:Boolean,ables:Array,className:String,pinchThreshold:Number,pinchOutside:Boolean,triggerAblesSimultaneously:Boolean,checkInput:Boolean,cspNonce:String,translateZ:Number,hideDefaultLines:Boolean,props:Object},events:{}},Cf=hl("padding",{render:function(t,e){var n=t.props;if(n.dragArea)return[];var r=n.padding||{},i=r.left,o=void 0===i?0:i,a=r.top,s=void 0===a?0:a,c=r.right,l=void 0===c?0:c,u=r.bottom,h=void 0===u?0:u,d=t.state,f=d.renderPoses,p=d.pos1,g=d.pos2,v=d.pos3,m=d.pos4,b=[p,g,v,m],y=[];return o>0&&y.push([0,2]),s>0&&y.push([0,1]),l>0&&y.push([1,3]),h>0&&y.push([2,3]),y.map((function(t,n){var r=t[0],i=t[1],o=b[r],a=b[i],s=f[r],c=f[i],l=Js([0,0],[100,0],[0,100],[100,100],o,a,s,c);if(l.length)return e.createElement("div",{key:"padding"+n,className:Pl("padding"),style:{transform:zl(l,!0)}})}))}}),xf=["nw","ne","se","sw"];function Of(t,e){var n=t[0]+t[1],r=n>e?e/n:1;return t[0]*=r,t[1]=e-t[1]*r,t}var _f=[1,2,5,6],Tf=[0,3,4,7],kf=[1,-1,-1,1],If=[1,1,-1,-1];function Pf(t,e,n,r,i,o,a,s,c){void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=r),void 0===c&&(c=i);var l=[],u=!1,h=t.map((function(t,h){var d=e[h],f=d.horizontal,p=d.vertical;if(p&&!u&&(u=!0,l.push("/")),u){var g=Math.max(0,1===p?t[1]-a:c-t[1]);return l.push(ku(g,i,n)),g}g=Math.max(0,1===f?t[0]-o:s-t[0]);return l.push(ku(g,r,n)),g}));return{styles:l,raws:h}}function jf(t){for(var e=[0,0],n=[0,0],r=t.length,i=0;i<r;++i){var o=t[i];o.sub&&(o.horizontal&&(0===e[1]&&(e[0]=i),e[1]=i-e[0]+1,n[0]=i+1),o.vertical&&(0===n[1]&&(n[0]=i),n[1]=i-n[0]+1))}return{horizontalRange:e,verticalRange:n}}function Mf(t,e,n,r,i,o){var a,s,c,l;void 0===o&&(o=[0,0]);var u=t.indexOf("/"),h=(u>-1?t.slice(0,u):t).length,d=t.slice(0,h),f=t.slice(h+1),p=d[0],g=void 0===p?"0px":p,v=d[1],m=void 0===v?g:v,b=d[2],y=void 0===b?g:b,S=d[3],w=void 0===S?m:S,E=f[0],C=void 0===E?g:E,x=f[1],O=void 0===x?C:x,_=f[2],T=void 0===_?C:_,k=f[3],I=void 0===k?O:k,P=[g,m,y,w].map((function(t){return ra(t,e)})),j=[C,O,T,I].map((function(t){return ra(t,n)})),M=P.slice(),D=j.slice();a=Of([M[0],M[1]],e),M[0]=a[0],M[1]=a[1],s=Of([M[3],M[2]],e),M[3]=s[0],M[2]=s[1],c=Of([D[0],D[3]],n),D[0]=c[0],D[3]=c[1],l=Of([D[1],D[2]],n),D[1]=l[0],D[2]=l[1];var R=M.slice(0,Math.max(o[0],d.length)),A=D.slice(0,Math.max(o[1],f.length));return ul(R.map((function(t,e){var o=xf[e];return{horizontal:kf[e],vertical:0,pos:[r+t,i+(-1===If[e]?n:0)],sub:!0,raw:P[e],direction:o}})),A.map((function(t,n){var o=xf[n];return{horizontal:0,vertical:If[n],pos:[r+(-1===kf[n]?e:0),i+t],sub:!0,raw:j[n],direction:o}})))}function Df(t,e,n,r,i){void 0===i&&(i=e.length);var o=jf(t.slice(r)),a=o.horizontalRange,s=o.verticalRange,c=n-r,l=0;if(0===c)l=i;else if(c>0&&c<a[1])l=a[1]-c;else{if(!(c>=s[0]))return;l=s[0]+s[1]-c}t.splice(n,l),e.splice(n,l)}function Rf(t,e,n,r,i,o,a,s,c,l,u){void 0===l&&(l=0),void 0===u&&(u=0);var h=jf(t.slice(n)),d=h.horizontalRange,f=h.verticalRange;if(r>-1)for(var p=1===kf[r]?o-l:s-o,g=d[1];g<=r;++g){var v=1===If[g]?u:c,m=0;if(r===g?m=o:0===g?m=l+p:-1===kf[g]&&(m=s-(e[n][0]-l)),t.splice(n+g,0,{horizontal:kf[g],vertical:0,pos:[m,v]}),e.splice(n+g,0,[m,v]),0===g)break}else if(i>-1){var b=1===If[i]?a-u:c-a;if(0===d[1]&&0===f[1]){var y=[l+b,u];t.push({horizontal:kf[0],vertical:0,pos:y}),e.push(y)}var S=f[0];for(g=f[1];g<=i;++g){m=1===kf[g]?l:s,v=0;if(i===g?v=a:0===g?v=u+b:1===If[g]?v=e[n+S][1]:-1===If[g]&&(v=c-(e[n+S][1]-u)),t.push({horizontal:0,vertical:If[g],pos:[m,v]}),e.push([m,v]),0===g)break}}}function Af(t,e){void 0===e&&(e=t.map((function(t){return t.raw})));var n=t.map((function(t,n){return t.horizontal?e[n]:null})).filter((function(t){return null!=t})),r=t.map((function(t,n){return t.vertical?e[n]:null})).filter((function(t){return null!=t}));return{horizontals:n,verticals:r}}var Nf=[[0,-1,"n"],[1,0,"e"]],Lf=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function Bf(t,e,n){var r=t.props.clipRelative,i=t.state,o=i.width,a=i.height,s=e,c=s.type,l=s.poses,u="rect"===c,h="circle"===c;if("polygon"===c)return n.map((function(t){return ku(t[0],o,r)+" "+ku(t[1],a,r)}));if(u||"inset"===c){var d=n[1][1],f=n[3][0],p=n[7][0],g=n[5][1];if(u)return[d,f,g,p].map((function(t){return t+"px"}));var v=[d,o-f,a-g,p].map((function(t,e){return ku(t,e%2?o:a,r)}));if(n.length>8){var m=As(n[4],n[0]),b=m[0],y=m[1];v.push.apply(v,ul(["round"],Pf(n.slice(8),l.slice(8),r,b,y,p,d,f,g).styles))}return v}if(h||"ellipse"===c){var S=n[0],w=ku(Math.abs(n[1][1]-S[1]),h?Math.sqrt((o*o+a*a)/2):a,r);v=h?[w]:[ku(Math.abs(n[2][0]-S[0]),o,r),w];return v.push("at",ku(S[0],o,r),ku(S[1],a,r)),v}}function Vf(t,e,n,r){var i=[r,(r+e)/2,e],o=[t,(t+n)/2,n];return Lf.map((function(t){var e=t[0],n=t[1],r=t[2],a=i[e+1],s=o[n+1];return{vertical:Math.abs(n),horizontal:Math.abs(e),direction:r,pos:[a,s]}}))}function Ff(t,e,n,r,i){var o,a,s,c,l,u,h,d=i;if(!d){var f=mu(t),p=f.clipPath;d="none"!==p?p:f.clip}if(d&&"none"!==d&&"auto"!==d||(d=r,d)){var g=$o(d),v=g.prefix,m=void 0===v?d:v,b=g.value,y=void 0===b?"":b,S="circle"===m,w=" ";if("polygon"===m){var E=qo(y||"0% 0%, 100% 0%, 100% 100%, 0% 100%");w=",";var C=E.map((function(t){var r=t.split(" "),i=r[0],o=r[1];return{vertical:1,horizontal:1,pos:[ra(i,e),ra(o,n)]}}));return{type:m,clipText:d,poses:C,splitter:w}}if(S||"ellipse"===m){var x="",O="",_=0,T=0;E=Xo(y);if(S){var k="";o=E[0],k=void 0===o?"50%":o,a=E[2],x=void 0===a?"50%":a,s=E[3],O=void 0===s?"50%":s,_=ra(k,Math.sqrt((e*e+n*n)/2)),T=_}else{var I="",P="";c=E[0],I=void 0===c?"50%":c,l=E[1],P=void 0===l?"50%":l,u=E[3],x=void 0===u?"50%":u,h=E[4],O=void 0===h?"50%":h,_=ra(I,e),T=ra(P,n)}var j=[ra(x,e),ra(O,n)];C=ul([{vertical:1,horizontal:1,pos:j,direction:"nesw"}],Nf.slice(0,S?1:2).map((function(t){return{vertical:Math.abs(t[1]),horizontal:t[0],direction:t[2],sub:!0,pos:[j[0]+t[0]*_,j[1]+t[1]*T]}})));return{type:m,clipText:d,radiusX:_,radiusY:T,left:j[0]-_,top:j[1]-T,poses:C,splitter:w}}if("inset"===m){E=Xo(y||"0 0 0 0");var M=E.indexOf("round"),D=(M>-1?E.slice(0,M):E).length,R=E.slice(D+1),A=E.slice(0,D),N=A[0],L=A[1],B=void 0===L?N:L,V=A[2],F=void 0===V?N:V,U=A[3],W=void 0===U?B:U,z=[N,F].map((function(t){return ra(t,n)})),G=z[0],H=z[1],Y=[W,B].map((function(t){return ra(t,e)})),X=Y[0],q=Y[1],$=e-q,J=n-H,K=Mf(R,$-X,J-G,X,G);C=ul(Vf(G,$,J,X),K);return{type:"inset",clipText:d,poses:C,top:G,left:X,right:$,bottom:J,radius:R,splitter:w}}if("rect"===m){E=qo(y||"0px, "+e+"px, "+n+"px, 0px");w=",";var Z=E.map((function(t){var e=Jo(t).value;return e}));G=Z[0],q=Z[1],H=Z[2],X=Z[3],C=Vf(G,q,H,X);return{type:"rect",clipText:d,poses:C,top:G,right:q,bottom:H,left:X,values:E,splitter:w}}}}function Uf(t,e){var n=Yu(t,e),r=n[0],i=n[1],o=e.datas,a=o.clipPath,s=o.index,c=a,l=c.type,u=c.poses,h=c.splitter,d=u.map((function(t){return t.pos}));if("polygon"===l)d.splice(s,0,[r,i]);else{if("inset"!==l)return;var f=_f.indexOf(s),p=Tf.indexOf(s),g=u.length;if(Rf(u,d,8,f,p,r,i,d[4][0],d[4][1],d[0][0],d[0][1]),g===u.length)return}var v=Bf(t,a,d);vu(t,"onClip",pu(t,e,{clipEventType:"added",clipType:l,poses:d,clipStyles:v,clipStyle:l+"("+v.join(h)+")",distX:0,distY:0}))}function Wf(t,e){var n=e.datas,r=n.clipPath,i=n.index,o=r,a=o.type,s=o.poses,c=o.splitter,l=s.map((function(t){return t.pos})),u=l.length;if("polygon"===a)s.splice(i,1),l.splice(i,1);else{if("inset"!==a)return;if(i<8)return;if(Df(s,l,i,8,u),u===s.length)return}var h=Bf(t,r,l);vu(t,"onClip",pu(t,e,{clipEventType:"removed",clipType:a,poses:l,clipStyles:h,clipStyle:a+"("+h.join(c)+")",distX:0,distY:0}))}var zf={name:"clippable",props:{clippable:Boolean,defaultClipPath:String,customClipPath:String,clipRelative:Boolean,clipArea:Boolean,dragWithClip:Boolean,clipTargetBounds:Boolean,clipVerticalGuidelines:Array,clipHorizontalGuidelines:Array,clipSnapThreshold:Boolean},events:{onClipStart:"clipStart",onClip:"clip",onClipEnd:"clipEnd"},css:[".control.clip-control {\n    background: #6d6;\n    cursor: pointer;\n}\n.control.clip-control.clip-radius {\n    background: #d66;\n}\n.line.clip-line {\n    background: #6e6;\n    cursor: move;\n    z-index: 1;\n}\n.clip-area {\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n.clip-ellipse {\n    position: absolute;\n    cursor: move;\n    border: 1px solid #6d6;\n    border: var(--zoompx) solid #6d6;\n    border-radius: 50%;\n    transform-origin: 0px 0px;\n}",":host {\n    --bounds-color: #d66;\n}",".guideline {\n    pointer-events: none;\n    z-index: 2;\n}",".line.guideline.bounds {\n    background: #d66;\n    background: var(--bounds-color);\n}"],render:function(t,e){var n=t.props,r=n.customClipPath,i=n.defaultClipPath,o=n.clipArea,a=n.zoom,s=t.state,c=s.target,l=s.width,u=s.height,h=s.allMatrix,d=s.is3d,f=s.left,p=s.top,g=s.pos1,v=s.pos2,m=s.pos3,b=s.pos4,y=s.clipPathState,S=s.snapBoundInfos;if(!c)return[];var w=Ff(c,l,u,i||"inset",y||r);if(!w)return[];var E=d?4:3,C=w.type,x=w.poses,O=x.map((function(t){var e=Xl(h,t.pos,E);return[e[0]-f,e[1]-p]})),_=[],T=[],k="rect"===C,I="inset"===C,P="polygon"===C;if(k||I||P){var j=I?O.slice(0,8):O;T=j.map((function(t,n){var r=0===n?j[j.length-1]:j[n-1],i=la(r,t),o=tu(r,t);return e.createElement("div",{key:"clipLine"+n,className:Pl("line","clip-line","snap-control"),"data-clip-index":n,style:{width:o+"px",transform:"translate("+r[0]+"px, "+r[1]+"px) rotate("+i+"rad) scaleY("+a+")"}})}))}if(_=O.map((function(t,n){return e.createElement("div",{key:"clipControl"+n,className:Pl("control","clip-control","snap-control"),"data-clip-index":n,style:{transform:"translate("+t[0]+"px, "+t[1]+"px) scale("+a+")"}})})),I&&_.push.apply(_,O.slice(8).map((function(t,n){return e.createElement("div",{key:"clipRadiusControl"+n,className:Pl("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+n,style:{transform:"translate("+t[0]+"px, "+t[1]+"px) scale("+a+")"}})}))),"circle"===C||"ellipse"===C){var M=w.left,D=w.top,R=w.radiusX,A=w.radiusY,N=As(Xl(h,[M,D],E),Xl(h,[0,0],E)),L=N[0],B=N[1],V="none";if(!o){for(var F=Math.max(10,R/5,A/5),U=[],W=0;W<=F;++W){var z=2*Math.PI/F*W;U.push([R+(R-a)*Math.cos(z),A+(A-a)*Math.sin(z)])}U.push([R,-2]),U.push([-2,-2]),U.push([-2,2*A+2]),U.push([2*R+2,2*A+2]),U.push([2*R+2,-2]),U.push([R,-2]),V="polygon("+U.map((function(t){return t[0]+"px "+t[1]+"px"})).join(", ")+")"}_.push(e.createElement("div",{key:"clipEllipse",className:Pl("clip-ellipse","snap-control"),style:{width:2*R+"px",height:2*A+"px",clipPath:V,transform:"translate("+(-f+L)+"px, "+(-p+B)+"px) "+zl(h)}}))}if(o){var G=$l(ul([g,v,m,b],O)),H=G.width,Y=G.height,X=G.left,q=G.top;if(P||k||I){U=I?O.slice(0,8):O;_.push(e.createElement("div",{key:"clipArea",className:Pl("clip-area","snap-control"),style:{width:H+"px",height:Y+"px",transform:"translate("+X+"px, "+q+"px)",clipPath:"polygon("+U.map((function(t){return t[0]-X+"px "+(t[1]-q)+"px"})).join(", ")+")"}}))}}return S&&["vertical","horizontal"].forEach((function(t){var n=S[t],r="horizontal"===t;n.isSnap&&T.push.apply(T,n.snap.posInfos.map((function(n,i){var o=n.pos,s=As(Xl(h,r?[0,o]:[o,0],E),[f,p]),c=As(Xl(h,r?[l,o]:[o,u],E),[f,p]);return Jd(e,"",s,c,a,"clip"+t+"snap"+i,"guideline")}))),n.isBound&&T.push.apply(T,n.bounds.map((function(n,i){var o=n.pos,s=As(Xl(h,r?[0,o]:[o,0],E),[f,p]),c=As(Xl(h,r?[l,o]:[o,u],E),[f,p]);return Jd(e,"",s,c,a,"clip"+t+"bounds"+i,"guideline","bounds","bold")})))})),ul(_,T)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var n=t.props,r=n.dragWithClip,i=void 0===r||r;return!i&&this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,e)},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var n=t.state,r=t.props,i=r.defaultClipPath,o=r.customClipPath,a=n.target,s=n.width,c=n.height,l=e.inputEvent?e.inputEvent.target:null,u=l?l.getAttribute("class"):"",h=e.datas,d=Ff(a,s,c,i||"inset",o);if(!d)return!1;var f=d.clipText,p=d.type,g=d.poses,v=vu(t,"onClipStart",pu(t,e,{clipType:p,clipStyle:f,poses:g.map((function(t){return t.pos}))}));return!1===v?(h.isClipStart=!1,!1):(h.isControl=u.indexOf("clip-control")>-1,h.isLine=u.indexOf("clip-line")>-1,h.isArea=u.indexOf("clip-area")>-1||u.indexOf("clip-ellipse")>-1,h.index=l?parseInt(l.getAttribute("data-clip-index"),10):-1,h.clipPath=d,h.isClipStart=!0,n.clipPathState=f,Xu(t,e),!0)},dragControl:function(t,e){var n=e.datas,r=e.originalDatas;if(!n.isClipStart)return!1;var i=r&&r.draggable||{},o=n,a=o.isControl,s=o.isLine,c=o.isArea,l=o.index,u=o.clipPath;if(!u)return!1;var h=i.isDrag?i.prevDist:th(e),d=h[0],f=h[1],p=t.props,g=t.state,v=g.width,m=g.height,b=!c&&!a&&!s,y=u.type,S=u.poses,w=u.splitter,E=S.map((function(t){return t.pos}));b&&(d=-d,f=-f);var C=!a||"nesw"===S[l].direction,x="inset"===y||"rect"===y,O=S.map((function(){return[0,0]}));if(a&&!C){var _=S[l],T=_.horizontal,k=_.vertical,I=[d*Math.abs(T),f*Math.abs(k)];O=Iu(S,l,I,x)}else C&&(O=E.map((function(){return[d,f]})));var P=E.map((function(t,e){return Rs(t,O[e])})),j=ul(P);g.snapBoundInfos=null;var M="circle"===u.type,D="ellipse"===u.type;if(M||D){var R=$l(P),A=Math.abs(R.bottom-R.top),N=Math.abs(D?R.right-R.left:A),L=P[0][1]+A,B=P[0][0]-N,V=P[0][0]+N;M&&(j.push([V,R.bottom]),O.push([1,0])),j.push([R.left,L]),O.push([0,1]),j.push([B,R.bottom]),O.push([1,0])}var F=Mh((p.clipHorizontalGuidelines||[]).map((function(t){return ra(""+t,m)})),(p.clipVerticalGuidelines||[]).map((function(t){return ra(""+t,v)})),v,m),U=[],W=[];if(M||D)U=[j[4][0],j[2][0]],W=[j[1][1],j[3][1]];else if(x){var z=[j[0],j[2],j[4],j[6]],G=[O[0],O[2],O[4],O[6]];U=z.filter((function(t,e){return G[e][0]})).map((function(t){return t[0]})),W=z.filter((function(t,e){return G[e][1]})).map((function(t){return t[1]}))}else U=j.filter((function(t,e){return O[e][0]})).map((function(t){return t[0]})),W=j.filter((function(t,e){return O[e][1]})).map((function(t){return t[1]}));for(var H=[0,0],Y=function(t){var e=Pd(F,p.clipTargetBounds&&{left:0,top:0,right:v,bottom:m},U,W,5),n=e.horizontal,r=e.vertical,i=n.offset,o=r.offset;if(n.isBound&&(H[1]+=i),r.isBound&&(H[0]+=o),!D&&!M||0!==O[0][0]||0!==O[0][1])return j.forEach((function(t,e){var n=O[e];n[0]&&(t[0]-=o),n[1]&&(t[1]-=i)})),"break";var a=$l(P),s=a.bottom-a.top,c=D?a.right-a.left:s,l=r.isBound?Math.abs(o):0===r.snapIndex?-o:o,u=n.isBound?Math.abs(i):0===n.snapIndex?-i:i;c-=l,s-=u,M&&(s=Hh(r,n)>0?s:c,c=s);var h=j[0];j[1][1]=h[1]-s,j[2][0]=h[0]+c,j[3][1]=h[1]+s,j[4][0]=h[0]-c},X=0;X<2;++X){var q=Y();if("break"===q)break}var $=Bf(t,u,P),J=y+"("+$.join(w)+")";if(g.clipPathState=J,M||D)U=[j[4][0],j[2][0]],W=[j[1][1],j[3][1]];else if(x){z=[j[0],j[2],j[4],j[6]];U=z.map((function(t){return t[0]})),W=z.map((function(t){return t[1]}))}else U=j.map((function(t){return t[0]})),W=j.map((function(t){return t[1]}));return g.snapBoundInfos=Pd(F,p.clipTargetBounds&&{left:0,top:0,right:v,bottom:m},U,W,1),r.draggable&&(r.draggable.deltaOffset=H),vu(t,"onClip",pu(t,e,{clipEventType:"changed",clipType:y,poses:P,clipStyle:J,clipStyles:$,distX:d,distY:f})),!0},dragControlEnd:function(t,e){this.unset(t);var n=e.isDrag,r=e.datas,i=e.isDouble,o=r.isLine,a=r.isClipStart,s=r.isControl;return!!a&&(vu(t,"onClipEnd",gu(t,e,{})),i&&(s?Wf(t,e):o&&Uf(t,e)),i||n)},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},Gf={name:"originDraggable",props:{originDraggable:Boolean,originRelative:Boolean},events:{onDragOriginStart:"dragOriginStart",onDragOrigin:"dragOrigin",onDragOriginEnd:"dragOriginEnd"},css:[":host[data-able-origindraggable] .control.origin {\n    pointer-events: auto;\n}"],dragControlCondition:function(t,e){return e.isRequest?"originDraggable"===e.requestAble:ga(e.inputEvent.target,Pl("origin"))},dragControlStart:function(t,e){var n=e.datas;Xu(t,e);var r=pu(t,e,{dragStart:qd.dragStart(t,(new Wu).dragStart([0,0],e))}),i=vu(t,"onDragOriginStart",r);return n.startOrigin=t.state.transformOrigin,n.startTargetOrigin=t.state.targetOrigin,n.prevOrigin=[0,0],n.isDragOrigin=!0,!1===i?(n.isDragOrigin=!1,!1):r},dragControl:function(t,e){var n=e.datas,r=e.isPinch,i=e.isRequest;if(!n.isDragOrigin)return!1;var o=th(e),a=o[0],s=o[1],c=t.state,l=c.width,u=c.height,h=c.offsetMatrix,d=c.targetMatrix,f=c.is3d,p=t.props.originRelative,g=void 0===p||p,v=f?4:3,m=[a,s];if(i){var b=e.distOrigin;(b[0]||b[1])&&(m=b)}var y=Rs(n.startOrigin,m),S=Rs(n.startTargetOrigin,m),w=As(m,n.prevOrigin),E=ch(h,d,y,v),C=t.getRect(),x=$l(ql(E,l,u,v)),O=[C.left-x.left,C.top-x.top];n.prevOrigin=m;var _=[ku(S[0],l,g),ku(S[1],u,g)].join(" "),T=pu(t,e,{width:l,height:u,origin:y,dist:m,delta:w,transformOrigin:_,drag:qd.drag(t,Uu(e,t.state,O,!!r,!1))});return vu(t,"onDragOrigin",T),T},dragControlEnd:function(t,e){var n=e.datas;return!!n.isDragOrigin&&(vu(t,"onDragOriginEnd",gu(t,e,{})),!0)},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){var n=this.dragControlStart(t,e);return!!n},dragGroupControl:function(t,e){var n=this.dragControl(t,e);return!!n&&(t.transformOrigin=n.transformOrigin,!0)},request:function(t){var e={},n=t.getRect(),r=0,i=0,o=n.transformOrigin,a=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(t){return"deltaOrigin"in t?(a[0]+=t.deltaOrigin[0],a[1]+=t.deltaOrigin[1]):"origin"in t?(a[0]=t.origin[0]-o[0],a[1]=t.origin[1]-o[1]):("x"in t?r=t.x-n.left:"deltaX"in t&&(r+=t.deltaX),"y"in t?i=t.y-n.top:"deltaY"in t&&(i+=t.deltaY)),{datas:e,distX:r,distY:i,distOrigin:a}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function Hf(t,e,n,r,i,o,a){var s=Af(t),c=s.horizontals,l=s.verticals,u=c.length,h=l.length,d=-1,f=-1;0===n?0===u?d=0:1===u&&(d=1):3===n&&(u<=2?d=2:u<=3&&(d=3)),2===n?0===h?f=0:h<4&&(f=3):1===n&&(h<=1?f=1:h<=2&&(f=2)),Rf(t,e,0,d,f,r,i,o,a)}function Yf(t,e,n,r,i){var o;void 0===r&&(r=[0,0]);var a=[];if(i)o=i;else{var s=mu(t);o=s&&s.borderRadius||""}return a=!o||!i&&"0px"===o?[]:Xo(o),Mf(a,e,n,0,0,r)}function Xf(t,e,n,r,i,o){var a=t.state,s=a.width,c=a.height,l=Pf(o,i,t.props.roundRelative,s,c),u=l.raws,h=l.styles,d=Af(i,u),f=d.horizontals,p=d.verticals,g=h.join(" ");a.borderRadiusState=g,vu(t,"onRound",pu(t,e,{horizontals:f,verticals:p,borderRadius:g,width:s,height:c,delta:r,dist:n}))}var qf={name:"roundable",props:{roundable:Boolean,roundRelative:Boolean,minRoundControls:Array,maxRoundControls:Array,roundClickable:Boolean},events:{onRoundStart:"roundStart",onRound:"round",onRoundEnd:"roundEnd"},css:[".control.border-radius {\n    background: #d66;\n    cursor: pointer;\n}",":host[data-able-roundable] .line.direction {\n    cursor: pointer;\n}"],render:function(t,e){var n=t.state,r=n.target,i=n.width,o=n.height,a=n.allMatrix,s=n.is3d,c=n.left,l=n.top,u=n.borderRadiusState,h=t.props,d=h.minRoundControls,f=void 0===d?[0,0]:d,p=h.maxRoundControls,g=void 0===p?[4,4]:p,v=h.zoom;if(!r)return null;var m=s?4:3,b=Yf(r,i,o,f,u);if(!b)return null;var y=0,S=0;return b.map((function(t,n){S+=Math.abs(t.horizontal),y+=Math.abs(t.vertical);var r=As(Xl(a,t.pos,m),[c,l]),i=t.vertical?y<=g[1]:S<=g[0];return e.createElement("div",{key:"borderRadiusControl"+n,className:Pl("control","border-radius"),"data-radius-index":n,style:{display:i?"block":"none",transform:"translate("+r[0]+"px, "+r[1]+"px) scale("+v+")"}})}))},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var n=e.inputEvent.target.getAttribute("class")||"";return n.indexOf("border-radius")>-1||n.indexOf("moveable-line")>-1&&n.indexOf("moveable-direction")>-1},dragControlStart:function(t,e){var n=e.inputEvent,r=e.datas,i=n.target,o=i.getAttribute("class")||"",a=o.indexOf("border-radius")>-1,s=o.indexOf("moveable-line")>-1&&o.indexOf("moveable-direction")>-1,c=a?parseInt(i.getAttribute("data-radius-index"),10):-1,l=s?parseInt(i.getAttribute("data-line-index"),10):-1;if(!a&&!s)return!1;var u=vu(t,"onRoundStart",pu(t,e,{}));if(!1===u)return!1;r.lineIndex=l,r.controlIndex=c,r.isControl=a,r.isLine=s,Xu(t,e);var h=t.props,d=h.roundRelative,f=h.minRoundControls,p=void 0===f?[0,0]:f,g=t.state,v=g.target,m=g.width,b=g.height;r.isRound=!0,r.prevDist=[0,0];var y=Yf(v,m,b,p)||[];return r.controlPoses=y,g.borderRadiusState=Pf(y.map((function(t){return t.pos})),y,d,m,b).styles.join(" "),!0},dragControl:function(t,e){var n=e.datas;if(!n.isRound||!n.isControl||!n.controlPoses.length)return!1;var r=n.controlIndex,i=n.controlPoses,o=th(e),a=o[0],s=o[1],c=[a,s],l=As(c,n.prevDist),u=t.props.maxRoundControls,h=void 0===u?[4,4]:u,d=t.state,f=d.width,p=d.height,g=i[r],v=g.vertical,m=g.horizontal,b=i.map((function(t){var e=t.horizontal,n=t.vertical,r=[e*m*c[0],n*v*c[1]];if(e){if(1===h[0])return r;if(h[0]<4&&e!==m)return r}else{if(0===h[1])return r[1]=n*m*c[0]/f*p,r;if(v){if(1===h[1])return r;if(h[1]<4&&n!==v)return r}}return[0,0]}));b[r]=c;var y=i.map((function(t,e){return Rs(t.pos,b[e])}));return n.prevDist=[a,s],Xf(t,e,c,l,i,y),!0},dragControlEnd:function(t,e){var n=t.state;n.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var o=n.width,a=n.height,s=r.isControl,c=r.controlIndex,l=r.isLine,u=r.lineIndex,h=r.controlPoses,d=h.map((function(t){return t.pos})),f=d.length,p=t.props.roundClickable,g=void 0===p||p;if(i&&g){if(s)Df(h,d,c,0);else if(l){var v=Yu(t,e),m=v[0],b=v[1];Hf(h,d,u,m,b,o,a)}f!==h.length&&Xf(t,e,[0,0],[0,0],h,d)}return vu(t,"onRoundEnd",gu(t,e,{})),n.borderRadiusState="",!0},unset:function(t){t.state.borderRadiusState=""}},$f={isPinch:!0,name:"beforeRenderable",props:{},events:{onBeforeRenderStart:"beforeRenderStart",onBeforeRender:"beforeRender",onBeforeRenderEnd:"beforeRenderEnd",onBeforeRenderGroupStart:"beforeRenderGroupStart",onBeforeRenderGroup:"beforeRenderGroup",onBeforeRenderGroupEnd:"beforeRenderGroupEnd"},setTransform:function(t,e){var n=t.state,r=n.is3d,i=n.target,o=n.targetMatrix,a=null===i||void 0===i?void 0:i.style.transform,s=r?"matrix3d("+o.join(",")+")":"matrix("+Ls(o,!0)+")";e.datas.startTransforms=a&&"none"!==a?Xo(a):[s]},resetTransform:function(t,e){e.datas.nextTransforms=e.datas.startTransforms,e.datas.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return pu(t,e,{setTransform:function(t){e.datas.startTransforms=Bo(t)?t:Xo(t)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return pu(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),vu(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){this.resetTransform(t,e),vu(t,"onBeforeRender",pu(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){vu(t,"onBeforeRenderEnd",pu(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var n=this;this.dragStart(t,e);var r=zu(t,"beforeRenderable",e),i=t.moveables,o=r.map((function(t,e){var r=i[e];return n.setTransform(r,t),n.fillDragStartParams(r,t)}));vu(t,"onBeforeRenderGroupStart",pu(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:o}))},dragGroup:function(t,e){var n=this;this.drag(t,e);var r=zu(t,"beforeRenderable",e),i=t.moveables,o=r.map((function(t,e){var r=i[e];return n.resetTransform(r,t),n.fillDragParams(r,t)}));vu(t,"onBeforeRenderGroup",pu(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:o}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),vu(t,"onBeforeRenderGroupEnd",pu(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},Jf={name:"renderable",props:{},events:{onRenderStart:"renderStart",onRender:"render",onRenderEnd:"renderEnd",onRenderGroupStart:"renderGroupStart",onRenderGroup:"renderGroup",onRenderGroupEnd:"renderGroupEnd"},dragStart:function(t,e){vu(t,"onRenderStart",pu(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){vu(t,"onRender",pu(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){vu(t,"onRenderEnd",pu(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){vu(t,"onRenderGroupStart",pu(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){vu(t,"onRenderGroup",pu(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroupEnd:function(t,e){vu(t,"onRenderGroupEnd",pu(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}};function Kf(t,e,n,r,i,o,a){var s="Start"===i,c=t.state.target,l=o.isRequest;if(!c||s&&r.indexOf("Control")>-1&&!l&&t.areaElement===o.inputEvent.target)return!1;var u=""+n+r+i,h=""+n+r+"Condition",d="End"===i,f=i.indexOf("After")>-1,p=s&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());p&&t.updateRect(i,!0,!1),""!==i||f||l||_u(t.state,o);var g=ul([$f],t[e],[Jf]);if(l){var v=o.requestAble;g.some((function(t){return t.name===v}))||g.push.apply(g,t.props.ables.filter((function(t){return t.name===v})))}if(!g.length)return!1;var m=g.filter((function(t){return t[u]})),b=o.datas;p&&m.forEach((function(e){e.unset&&e.unset(t)}));var y,S=o.inputEvent;d&&S&&(y=document.elementFromPoint(o.clientX,o.clientY)||S.target);var w=m.filter((function(e){var n=e.name,r=b[n]||(b[n]={});return s&&(r.isEventStart=!e[h]||e[h](t,o)),!!r.isEventStart&&e[u](t,sl(sl({},o),{datas:r,originalDatas:b,inputTarget:y}))})),E=w.length,C=s&&m.length&&!E;return(d||C)&&(t.state.gesto=null,t.moveables&&t.moveables.forEach((function(t){t.state.gesto=null}))),p&&C&&m.forEach((function(e){e.unset&&e.unset(t)})),!t.isUnmounted&&!C&&((!s&&E&&!a||d)&&(t.updateRect(i,!0,!1),t.forceUpdate()),s||d||f||!E||a||Kf(t,e,n,r,i+"After",o),!0)}function Zf(t,e,n){var r=t.controlBox.getElement(),i=[];i.push(r),t.props.dragArea&&!t.props.dragTarget||i.push(e);var o=function(e){var n=e.inputEvent.target,r=t.areaElement;return n===r||!t.isMoveableElement(n)||ga(n,"moveable-area")||ga(n,"moveable-padding")};return Qf(t,i,"targetAbles",n,{dragStart:o,pinchStart:o})}function Qf(t,e,n,r,i){void 0===i&&(i={});var o=t.props,a=o.pinchOutside,s=o.pinchThreshold,c={container:window,pinchThreshold:s,pinchOutside:a},l=new zc(e,c);return["drag","pinch"].forEach((function(e){["Start","","End"].forEach((function(o){l.on(""+e+o,(function(a){var s=a.eventType;if(!i[s]||i[s](a)){var c=Kf(t,n,e,r,o,a);c||a.stop()}else a.stop()}))}))})),l}var tp=function(){function t(t,e,n){var r=this;this.target=t,this.moveable=e,this.eventName=n,this.ables=[],this.onEvent=function(t){var e=r.eventName,n=r.moveable;n.state.disableNativeEvent||r.ables.forEach((function(r){r[e](n,{inputEvent:t})}))},this.target.addEventListener(this.eventName.toLowerCase(),this.onEvent)}var e=t.prototype;return e.setAbles=function(t){this.ables=t},e.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this.onEvent),this.target=null,this.moveable=null},t}(),ep=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=sl({container:null,gesto:null,renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1},au(null)),e.enabledAbles=[],e.targetAbles=[],e.controlAbles=[],e.rotation=0,e.scale=[1,1],e.isUnmounted=!1,e.events={mouseEnter:null,mouseLeave:null},e.onPreventClick=function(t){t.stopPropagation(),ya(window,"click",e.onPreventClick,!0)},e}al(e,t);var n=e.prototype;return n.render=function(){var t=this.props,e=this.state,n=t.parentPosition,r=t.className,i=t.target,o=t.zoom,a=t.cspNonce,s=t.translateZ,c=t.cssStyled,l=t.portalContainer;this.checkUpdate(),this.updateRenderPoses();var u=n||{left:0,top:0},h=u.left,d=u.top,f=e.left,p=e.top,g=e.target,v=e.direction,m=t.targets,b=(m&&m.length||i)&&g,y=this.isDragging(),S={};return this.getEnabledAbles().forEach((function(t){S["data-able-"+t.name.toLowerCase()]=!0})),Da(c,sl({cspNonce:a,ref:po(this,"controlBox"),className:Pl("control-box",-1===v?"reverse":"",y?"dragging":"")+" "+r},S,{onClick:this.onPreventClick,portalContainer:l,style:{position:"absolute",display:b?"block":"none",transform:"translate3d("+(f-h)+"px, "+(p-d)+"px, "+s+")","--zoom":o,"--zoompx":o+"px"}}),this.renderAbles(),this._renderLines())},n.componentDidMount=function(){this.controlBox.getElement();var t=this.props,e=t.parentMoveable,n=t.container,r=t.wrapperMoveable;this.updateEvent(t),this.updateNativeEvents(t),n||e||r||this.updateRect("",!1,!0),this.updateCheckInput()},n.componentDidUpdate=function(t){this.updateNativeEvents(t),this.updateEvent(t),this.updateCheckInput()},n.componentWillUnmount=function(){this.isUnmounted=!0,fu(this,"targetGesto"),fu(this,"controlGesto");var t=this.events;for(var e in t){var n=t[e];n&&n.destroy()}},n.getContainer=function(){var t=this.props,e=t.parentMoveable,n=t.wrapperMoveable,r=t.container;return r||n&&n.getContainer()||e&&e.getContainer()||this.controlBox.getElement().parentElement},n.isMoveableElement=function(t){return t&&(t.getAttribute("class")||"").indexOf(ml)>-1},n.dragStart=function(t){return this.targetGesto&&this.targetGesto.triggerDragStart(t),this},n.hitTest=function(t){var e,n=this.state,r=n.target,i=n.pos1,o=n.pos2,a=n.pos3,s=n.pos4,c=n.targetClientRect;if(!r)return 0;if(t instanceof Element){var l=t.getBoundingClientRect();e={left:l.left,top:l.top,width:l.width,height:l.height}}else e=sl({width:0,height:0},t);var u=e.left,h=e.top,d=e.width,f=e.height,p=uc([i,o,s,a],c),g=bc(p,[[u,h],[u+d,h],[u+d,h+f],[u,h+f]]),v=lc(p);return g&&v?Math.min(100,g/v*100):0},n.isInside=function(t,e){var n=this.state,r=n.target,i=n.pos1,o=n.pos2,a=n.pos3,s=n.pos4,c=n.targetClientRect;return!!r&&dc([t,e],uc([i,o,s,a],c))},n.updateRect=function(t,e,n){void 0===n&&(n=!0);var r=this.props,i=r.parentMoveable,o=this.state,a=o.target||this.props.target,s=this.getContainer(),c=i?i.props.rootContainer:r.rootContainer;this.updateState(au(this.controlBox&&this.controlBox.getElement(),a,s,s,c||s),!i&&n)},n.isTargetChanged=function(t,e){var n=this.props,r=n.dragTarget||n.target,i=t.dragTarget||t.target,o=n.dragArea,a=t.dragArea,s=!o&&i!==r;return s||(e||o)&&a!==o},n.updateNativeEvents=function(t){var e=this,n=this.props,r=n.dragArea?this.areaElement:this.state.target,i=this.events,o=na(i);if(this.isTargetChanged(t))for(var a in i){var s=i[a];s&&s.destroy(),i[a]=null}if(r){var c=this.enabledAbles;o.forEach((function(t){var n=bu(c,[t]),o=n.length>0,a=i[t];o?(a||(a=new tp(r,e,t),i[t]=a),a.setAbles(n)):a&&(a.destroy(),i[t]=null)}))}},n.updateEvent=function(t){var e=this.controlBox.getElement(),n=this.targetAbles.length,r=this.controlAbles.length,i=this.props,o=i.dragTarget||i.target,a=this.isTargetChanged(t,!0),s=!n&&this.targetGesto||a;s&&(fu(this,"targetGesto"),this.updateState({gesto:null})),r||fu(this,"controlGesto"),o&&n&&!this.targetGesto&&(this.targetGesto=Zf(this,o,"")),!this.controlGesto&&r&&(this.controlGesto=Qf(this,e,"controlAbles","Control")),s&&this.unsetAbles()},n.isDragging=function(){return!!this.targetGesto&&this.targetGesto.isFlag()||!!this.controlGesto&&this.controlGesto.isFlag()},n.updateTarget=function(t){this.updateRect(t,!0)},n.getRect=function(){var t=this.state,e=hu(this.state),n=e[0],r=e[1],i=e[2],o=e[3],a=$l(e),s=t.width,c=t.height,l=a.width,u=a.height,h=a.left,d=a.top,f=[t.left,t.top],p=Rs(f,t.origin),g=Rs(f,t.beforeOrigin),v=t.transformOrigin;return{width:l,height:u,left:h,top:d,pos1:n,pos2:r,pos3:i,pos4:o,offsetWidth:s,offsetHeight:c,beforeOrigin:g,origin:p,transformOrigin:v,rotation:this.getRotation()}},n.getManager=function(){return this},n.getRotation=function(){var t=this.state,e=t.pos1,n=t.pos2,r=t.direction;return Bu(e,n,r)},n.request=function(t,e,n){void 0===e&&(e={});var r=this.props,i=r.ables,o=r.groupable,a=i.filter((function(e){return e.name===t}))[0];if(this.isDragging()||!a||!a.request)return{request:function(){return this},requestEnd:function(){return this}};var s=this,c=a.request(this),l=n||e.isInstant,u=c.isControl?"controlAbles":"targetAbles",h=(o?"Group":"")+(c.isControl?"Control":""),d={request:function(e){return Kf(s,u,"drag",h,"",sl(sl({},c.request(e)),{requestAble:t,isRequest:!0}),l),this},requestEnd:function(){return Kf(s,u,"drag",h,"End",sl(sl({},c.requestEnd()),{requestAble:t,isRequest:!0}),l),this}};return Kf(s,u,"drag",h,"Start",sl(sl({},c.requestStart(e)),{requestAble:t,isRequest:!0}),l),l?d.request(e).requestEnd():d},n.destroy=function(){this.componentWillUnmount()},n.updateRenderPoses=function(){var t=this.state,e=this.props,n=t.originalBeforeOrigin,r=t.transformOrigin,i=t.allMatrix,o=t.is3d,a=t.pos1,s=t.pos2,c=t.pos3,l=t.pos4,u=t.left,h=t.top,d=e.padding||{},f=d.left,p=void 0===f?0:f,g=d.top,v=void 0===g?0:g,m=d.bottom,b=void 0===m?0:m,y=d.right,S=void 0===y?0:y,w=o?4:3,E=e.groupable?n:Rs(n,[u,h]);t.renderPoses=[Rs(a,Tu(i,[-p,-v],r,E,w)),Rs(s,Tu(i,[S,-v],r,E,w)),Rs(c,Tu(i,[-p,b],r,E,w)),Rs(l,Tu(i,[S,b],r,E,w))]},n.checkUpdate=function(){var t=this.props,e=t.target,n=t.container,r=t.parentMoveable,i=this.state,o=i.target,a=i.container;if(o||e){this.updateAbles();var s=!yu(o,e)||!yu(a,n);s&&(this.updateState({target:e,container:n}),r||!n&&!this.controlBox||this.updateRect("End",!1,!1))}},n.triggerEvent=function(t,e){var n=this.props[t];return n&&n(e)},n.useCSS=function(t,e){var n=this.props.customStyledMap,r=t+e;return n[r]||(n[r]=il(t,e)),n[r]},n.unsetAbles=function(){var t=this;this.targetAbles.filter((function(e){return!!e.unset&&(e.unset(t),!0)})).length&&this.forceUpdate()},n.updateAbles=function(t,e){void 0===t&&(t=this.props.ables),void 0===e&&(e="");var n=this.props,r=n.triggerAblesSimultaneously,i=t.filter((function(t){return t&&(t.always||n[t.name])})),o="drag"+e+"Start",a="pinch"+e+"Start",s="drag"+e+"ControlStart",c=bu(i,[o,a],r),l=bu(i,[s],r);this.enabledAbles=i,this.targetAbles=c,this.controlAbles=l},n.updateState=function(t,e){if(e)this.setState(t);else{var n=this.state;for(var r in t)n[r]=t[r]}},n.getEnabledAbles=function(){var t=this.props,e=t.ables;return e.filter((function(e){return e&&t[e.name]}))},n.renderAbles=function(){var t=this,e=this.props,n=e.triggerAblesSimultaneously,r={createElement:Da};return Eu(Cu(bu(this.getEnabledAbles(),["render"],n).map((function(e){var n=e.render;return n(t,r)||[]}))).filter((function(t){return t})),(function(t){var e=t.key;return e})).map((function(t){return t[0]}))},n.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},n._renderLines=function(){var t=this.props,e=t.edge,n=t.zoom,r=t.hideDefaultLines;if(r)return[];var i=this.state.renderPoses,o={createElement:Da};return[Jd(o,e?"n":"",i[0],i[1],n,0),Jd(o,e?"e":"",i[1],i[3],n,1),Jd(o,e?"w":"",i[0],i[2],n,2),Jd(o,e?"s":"",i[2],i[3],n,3)]},e.defaultProps={target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,edge:!1,parentMoveable:null,wrapperMoveable:null,parentPosition:null,portalContainer:null,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{}},e}(Xa),np={name:"groupable",props:{defaultGroupRotate:Number,defaultGroupOrigin:String,groupable:Boolean},events:{},render:function(t,e){var n=t.props.targets||[];t.moveables=[];var r=t.state,i=r.left,o=r.top,a={left:i,top:o};return n.map((function(n,r){return e.createElement(ep,{key:"moveable"+r,ref:go(t,"moveables",r),target:n,origin:!1,cssStyled:t.props.cssStyled,customStyledMap:t.props.customStyledMap,parentMoveable:t,parentPosition:a})}))}},rp=hl("clickable",{props:{},events:{onClick:"click",onClickGroup:"clickGroup"},always:!0,dragStart:function(t,e){e.isRequest||ba(window,"click",t.onPreventClick,!0)},dragControlStart:function(t,e){this.dragStart(t,e)},dragGroupStart:function(t,e){this.dragStart(t,e),e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){this.endEvent(t);var n=t.state.target,r=e.inputEvent,i=e.inputTarget;if(e.isDrag||this.unset(t),r&&i&&!e.isDrag&&!t.isMoveableElement(i)){var o=n.contains(i);vu(t,"onClick",pu(t,e,{isDouble:e.isDouble,inputTarget:i,isTarget:n===i,containsTarget:o}))}},dragGroupEnd:function(t,e){this.endEvent(t);var n=e.inputEvent,r=e.inputTarget;if(n&&r&&!e.isDrag&&!t.isMoveableElement(r)&&e.datas.inputTarget!==r){var i=t.props.targets,o=i.indexOf(r),a=o>-1,s=!1;-1===o&&(o=ta(i,(function(t){return t.contains(r)})),s=o>-1),vu(t,"onClickGroup",pu(t,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:o,isTarget:a,containsTarget:s}))}},dragControlEnd:function(t){this.endEvent(t)},dragGroupControlEnd:function(t){this.endEvent(t)},endEvent:function(t){var e=this;requestAnimationFrame((function(){e.unset(t)}))},unset:function(t){ya(window,"click",t.onPreventClick,!0)}});function ip(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),sl(sl({},t),{datas:e})}var op=hl("edgeDraggable",{dragControlCondition:function(t,e){if(!t.props.edgeDraggable||!e.inputEvent)return!1;var n=e.inputEvent.target;return ga(n,Pl("direction"))&&ga(n,Pl("line"))},dragControlStart:function(t,e){return qd.dragStart(t,ip(e))},dragControl:function(t,e){return qd.drag(t,ip(e))},dragControlEnd:function(t,e){return qd.dragEnd(t,ip(e))},dragGroupControlCondition:function(t,e){if(!t.props.edgeDraggable||!e.inputEvent)return!1;var n=e.inputEvent.target;return ga(n,Pl("direction"))&&ga(n,Pl("line"))},dragGroupControlStart:function(t,e){return qd.dragGroupStart(t,ip(e))},dragGroupControl:function(t,e){return qd.dragGroup(t,ip(e))},dragGroupControlEnd:function(t,e){return qd.dragGroupEnd(t,ip(e))},unset:function(t){t.state.dragInfo=null}}),ap={name:"individualGroupable",props:{individualGroupable:Boolean},events:{}},sp=[$f,Ef,Xd,Fu,qd,op,af,sf,cf,df,wf,Cf,yf,Gf,zf,qf,np,ap,rp,bf,Jf],cp=sp.reduce((function(t,e){return sl(sl({},t),"events"in e?e.events:{})}),{}),lp=sp.reduce((function(t,e){return sl(sl({},t),e.props)}),{}),up=Mu(cp),hp=Object.keys(up),dp=Object.keys(lp);function fp(t,e){return Math.max.apply(Math,t.map((function(t){var n=t[0],r=t[1],i=t[2],o=t[3];return Math.max(n[e],r[e],i[e],o[e])})))}function pp(t,e){return Math.min.apply(Math,t.map((function(t){var n=t[0],r=t[1],i=t[2],o=t[3];return Math.min(n[e],r[e],i[e],o[e])})))}function gp(t,e){if(!t.length)return[0,0,0,0];var n=t.map((function(t){var e=t.state;return hu(e)})),r=Cl,i=Cl,o=0,a=0,s=fa(e,wl);if(s%90){var c=s/180*Math.PI,l=Math.tan(c),u=-1/l,h=[xl,Cl],d=[xl,Cl];n.forEach((function(t){t.forEach((function(t){var e=t[1]-l*t[0],n=t[1]-u*t[0];h[0]=Math.max(h[0],e),h[1]=Math.min(h[1],e),d[0]=Math.max(d[0],n),d[1]=Math.min(d[1],n)}))})),h.forEach((function(t){d.forEach((function(e){var n=(e-t)/(l-u),o=l*n+t;r=Math.min(r,n),i=Math.min(i,o)}))}));var f=n.map((function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return[zs(e,-c),zs(n,-c),zs(r,-c),zs(i,-c)]}));o=fp(f,0)-pp(f,0),a=fp(f,1)-pp(f,1)}else if(r=pp(n,0),i=pp(n,1),o=fp(n,0)-r,a=fp(n,1)-i,s%180){var p=o;o=a,a=p}return[r,i,o,a]}var vp=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.differ=new sc,e.moveables=[],e.transformOrigin="50% 50%",e}al(e,t);var n=e.prototype;return n.updateEvent=function(t){var e=this.state,n=this.props,r=t.dragTarget||e.target,i=n.dragTarget||this.areaElement;r!==i&&(fu(this,"targetGesto"),fu(this,"controlGesto"),e.target=null),e.target||(e.target=this.areaElement,this.controlBox.getElement().style.display="block",this.targetGesto=Zf(this,i,"Group"),this.controlGesto=Qf(this,this.controlBox.getElement(),"controlAbles","GroupControl"));var o=!yu(t.container,n.container);o&&(e.container=n.container);var a=this.differ.update(n.targets),s=a.added,c=a.changed,l=a.removed;(o||s.length||c.length||l.length)&&this.updateRect()},n.checkUpdate=function(){this.updateAbles()},n.updateRect=function(t,e,n){if(void 0===n&&(n=!0),this.controlBox){this.moveables.forEach((function(e){e.updateRect(t,!1,!1)}));var r=this.state,i=this.props,o=r.target||i.target;(!e||""!==t&&i.updateGroup)&&(this.rotation=i.defaultGroupRotate,this.transformOrigin=i.defaultGroupOrigin||"50% 50%",this.scale=[1,1]);var a=this.rotation,s=this.scale,c=gp(this.moveables,a),l=c[0],u=c[1],h=c[2],d=c[3],f="rotate("+a+"deg) scale("+(s[0]>=0?1:-1)+", "+(s[1]>=0?1:-1)+")";o.style.cssText+="left:0px;top:0px; transform-origin: "+this.transformOrigin+"; width:"+h+"px; height:"+d+"px;transform:"+f,r.width=h,r.height=d;var p=this.getContainer(),g=au(this.controlBox.getElement(),o,this.controlBox.getElement(),this.getContainer(),this.props.rootContainer||p),v=[g.left,g.top],m=hu(g),b=m[0],y=m[1],S=m[2],w=m[3],E=hc([b,y,S,w]),C=[E.minX,E.minY];g.pos1=As(b,C),g.pos2=As(y,C),g.pos3=As(S,C),g.pos4=As(w,C),g.left=l-g.left+C[0],g.top=u-g.top+C[1],g.origin=As(Rs(v,g.origin),C),g.beforeOrigin=As(Rs(v,g.beforeOrigin),C),g.originalBeforeOrigin=Rs(v,g.originalBeforeOrigin);var x=g.targetClientRect,O=s[0]*s[1]>0?1:-1;x.top+=g.top-r.top,x.left+=g.left-r.left,o.style.transform="translate("+-C[0]+"px, "+-C[1]+"px) "+f,this.updateState(sl(sl({},g),{direction:O,beforeDirection:O}),n)}},n.getRect=function(){return sl(sl({},t.prototype.getRect.call(this)),{children:this.moveables.map((function(t){return t.getRect()}))})},n.triggerEvent=function(e,n,r){if(r||e.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,e,n)},n.updateAbles=function(){t.prototype.updateAbles.call(this,ul(this.props.ables,[np]),"Group")},e.defaultProps=sl(sl({},ep.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e}(ep),mp=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.moveables=[],e}al(e,t);var n=e.prototype;return n.render=function(){var t=this,e=this.props,n=e.cspNonce,r=e.cssStyled,i=e.targets;return Da(r,{cspNonce:n,ref:po(this,"controlBox"),className:Pl("control-box")},i.map((function(e,n){return Da(ep,sl({key:"moveable"+n,ref:go(t,"moveables",n)},t.props,{target:e,wrapperMoveable:t}))})))},n.componentDidUpdate=function(){},n.updateRect=function(t,e,n){void 0===n&&(n=!0),this.moveables.forEach((function(r){r.updateRect(t,e,n)}))},n.getRect=function(){return sl(sl({},t.prototype.getRect.call(this)),{children:this.moveables.map((function(t){return t.getRect()}))})},n.request=function(){return{request:function(){return this},requestEnd:function(){return this}}},n.dragStart=function(){return this},n.hitTest=function(){return 0},n.isInside=function(){return!1},n.isDragging=function(){return!1},n.updateRenderPoses=function(){},n.updateEvent=function(){},n.checkUpdate=function(){},n.triggerEvent=function(){},n.updateAbles=function(){},e}(ep),bp=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.refTargets=[],e.selectorMap={},e}al(e,t);var n=e.prototype;return e.makeStyled=function(){var t={},e=this.getTotalAbles();e.forEach((function(e){var n=e.css;n&&n.forEach((function(e){t[e]=!0}))}));var n=na(t).join("\n");this.defaultStyled=il("div",fo(ml,bl+n))},e.getTotalAbles=function(){return ul([Ef,np,ap,bf],this.defaultAbles)},n.render=function(){var t=this.constructor;t.defaultStyled||t.makeStyled();var e=this.props,n=e.ables,r=e.props,i=cl(e,["ables","props"]),o=Nu(i.target||i.targets),a=Lu(o,this.selectorMap);this.refTargets=o;var s=a.length>1,c=t.getTotalAbles(),l=ul(c,n||[]),u=sl(sl(sl({},i),r||{}),{ables:l,cssStyled:t.defaultStyled,customStyledMap:t.customStyledMap});return s?i.individualGroupable?Da(mp,sl({key:"individual-group",ref:po(this,"moveable")},u,{target:null,targets:a})):Da(vp,sl({key:"group",ref:po(this,"moveable")},u,{target:null,targets:a})):Da(ep,sl({key:"single",ref:po(this,"moveable")},u,{target:a[0]}))},n.componentDidMount=function(){this.updateRefs()},n.componentDidUpdate=function(){this.updateRefs()},n.updateRefs=function(t){var e=Nu(this.props.target||this.props.targets),n=this.refTargets.some((function(t,n){var r=e[n];return!(!t&&!r)&&t!==r})),r=t?{}:this.selectorMap,i={};this.refTargets.forEach((function(t){Vo(t)&&(r[t]?i[t]=r[t]:(n=!0,i[t]=[].slice.call(document.querySelectorAll(t))))})),this.selectorMap=i,n&&this.forceUpdate()},n.getManager=function(){return this.moveable},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,ll([mo(kl)],e.prototype,"moveable",void 0),e}(Xa),yp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return al(e,t),e.defaultAbles=sp,e}(bp);var Sp=yp,wp=function(t,e){return wp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},wp(t,e)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Ep(t,e){function n(){this.constructor=t}wp(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Cp=function(){return Cp=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Cp.apply(this,arguments)};function xp(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}var Op=function(t){function e(e){var n=t.call(this,e)||this;return n.state={},n.state=n.props,n}Ep(e,t);var n=e.prototype;return n.render=function(){return es(Da(Sp,Cp({ref:po(this,"moveable")},this.state)),this.state.parentElement)},e}(Ya),_p=dp,Tp=kl,kp=hp,Ip=function(){return Ip=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Ip.apply(this,arguments)};function Pp(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var jp=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(Lo(t))for(var n in t)this.on(n,t[n]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(Lo(t))for(var n in t)this.off(n);else if(e){var r=this._events[t];if(r){var i=ta(r,(function(t){return t.listener===e}));i>-1&&r.splice(i,1)}}else this._events[t]=[];else this._events={};return this},e.once=function(t,e){var n=this;return e&&this._addEvent(t,e,{once:!0}),new Promise((function(e){n._addEvent(t,e,{once:!0})}))},e.emit=function(t,e){var n=this;void 0===e&&(e={});var r=this._events[t];if(!t||!r)return!0;var i=!1;return e.eventType=t,e.stop=function(){i=!0},e.currentTarget=this,Pp(r).forEach((function(r){r.listener(e),r.once&&n.off(t,r.listener)})),!i},e.trigger=function(t,e){return void 0===e&&(e={}),this.emit(t,e)},e._addEvent=function(t,e,n){var r=this._events;r[t]=r[t]||[];var i=r[t];i.push(Ip({listener:e},n))},t}(),Mp=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;r.tempElement=document.createElement("div");var i=Cp({},n),o={};kp.forEach((function(t){o[Ko("on "+t)]=function(e){return r.trigger(t,e)}})),ts(Da(Op,Cp({ref:po(r,"innerMoveable"),parentElement:e},i,o)),r.tempElement);var a=i.target;return Bo(a)&&a.length>1&&r.updateRect(),r}Ep(e,t);var n=e.prototype;return n.setState=function(t,e){this.innerMoveable.setState(t,e)},n.destroy=function(){ts(null,this.tempElement),this.off(),this.tempElement=null,this.innerMoveable=null},n.getMoveable=function(){return this.innerMoveable.moveable},e=xp([vo(Tp,(function(t,e){t[e]||(t[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this.getMoveable();if(r&&r[e])return r[e].apply(r,t)})})),vo(_p,(function(t,e){Object.defineProperty(t,e,{get:function(){return this.getMoveable().props[e]},set:function(t){var n;this.setState((n={},n[e]=t,n))},enumerable:!0,configurable:!0})}))],e),e}(jp),Dp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ep(e,t),e}(Mp);var Rp=Dp,Ap=function(){return Ap=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Ap.apply(this,arguments)},Np={};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */Tp.forEach((function(t){Np[t]=function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];(e=this.$_moveable)[t].apply(e,n)}}));var Lp={};_p.forEach((function(t){Lp[t]=function(e){this.$_moveable[t]=e}}));var Bp={name:"moveable",methods:Np,props:_p,watch:Lp,mounted:function(){var t=this,e={},n=this.$props;_p.forEach((function(t){var r=n[t];No(r)||(e[t]=n[t])}));var r=this.$refs,i=r.moveableElement,o=new Rp(i,Ap(Ap({},e),{portalContainer:i}));kp.forEach((function(e){o.on(e,(function(n){t.$emit(e,Ap({},n))}))})),this.$_moveable=o},beforeUnmount:function(){this.$_moveable.destroy()}};const Vp={ref:"moveableElement"};function Fp(t,e,n,r,o,a){return Object(i["openBlock"])(),Object(i["createBlock"])("div",Vp,null,512)}Bp.render=Fp,Bp.__file="src/Moveable.vue";var Up=Bp,Wp=function(t){return Object(i["pushScopeId"])("data-v-0b54a984"),t=t(),Object(i["popScopeId"])(),t},zp={class:"modal fade",id:"memoModal",tabindex:"-1","aria-labelledby":"memoModalLabel","aria-hidden":"true"},Gp={class:"modal-dialog modal-dialog-centered modal-sm"},Hp={class:"modal-content"},Yp={class:"modal-header justify-content-start border-0 pb-0"},Xp=Wp((function(){return Object(i["createElementVNode"])("label",{for:"red-radio",class:"red"},null,-1)})),qp=Wp((function(){return Object(i["createElementVNode"])("label",{for:"blue-radio",class:"blue"},null,-1)})),$p=Wp((function(){return Object(i["createElementVNode"])("label",{for:"yellow-radio",class:"yellow"},null,-1)})),Jp={class:"modal-body px-3"},Kp={class:"text-limit text-end text-muted mb-0"},Zp=Wp((function(){return Object(i["createElementVNode"])("div",{class:"modal-footer border-0 pt-0"},[Object(i["createElementVNode"])("button",{type:"button",class:"btn btn-secondary btn-sm","data-bs-dismiss":"modal"},"저장")],-1)}));function Qp(t,e,n,r,o,a){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",zp,[Object(i["createElementVNode"])("div",Gp,[Object(i["createElementVNode"])("div",Hp,[Object(i["createElementVNode"])("div",Yp,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{id:"red-radio",class:"form-check-input d-none",name:"color",type:"radio","onUpdate:modelValue":e[0]||(e[0]=function(t){return a.memoColor=t}),value:"0"},null,512),[[i["vModelRadio"],a.memoColor]]),Xp,Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{id:"blue-radio",class:"form-check-input d-none",name:"color",type:"radio","onUpdate:modelValue":e[1]||(e[1]=function(t){return a.memoColor=t}),value:"1"},null,512),[[i["vModelRadio"],a.memoColor]]),qp,Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{id:"yellow-radio",class:"form-check-input d-none",name:"color",type:"radio","onUpdate:modelValue":e[2]||(e[2]=function(t){return a.memoColor=t}),value:"2"},null,512),[[i["vModelRadio"],a.memoColor]]),$p]),Object(i["createElementVNode"])("div",Jp,[Object(i["withDirectives"])(Object(i["createElementVNode"])("textarea",{name:"memoText",class:Object(i["normalizeClass"])(["form-control",o.colorList[a.memoColor]]),cols:"20",rows:"10","onUpdate:modelValue":e[3]||(e[3]=function(t){return a.memoContent=t}),maxlength:"140",style:{resize:"none"}},"\r\n          ",2),[[i["vModelText"],a.memoContent]]),Object(i["createElementVNode"])("p",Kp,Object(i["toDisplayString"])(a.memoLength)+" / 140",1)]),Zp])])])}var tg={name:"MemoModal",components:{},data:function(){return{colorList:["red","blue","yellow"]}},unmounted:function(){},methods:{},computed:Object(ft["a"])(Object(ft["a"])({},Object(pt["d"])({selectedIdx:function(t){return t.memo.selectedIdx}})),{},{memoLength:function(){return this.memoContent?this.memoContent.length:0},memoContent:{get:function(){return this.$store.state.memo.memoList&&void 0!==this.$store.state.memo.selectedIdx&&-1!==this.$store.state.memo.selectedIdx?this.$store.state.memo.memoList[this.$store.state.memo.selectedIdx].content:null},set:function(t){var e=this.$store.state.memo.selectedIdx;this.$store.commit("UPDATE_SELECTED_MEMO_CONTENT",{index:e,content:t})}},memoColor:{get:function(){return this.$store.state.memo.memoList&&void 0!==this.$store.state.memo.selectedIdx&&-1!==this.$store.state.memo.selectedIdx?this.$store.state.memo.memoList[this.$store.state.memo.selectedIdx].color:null},set:function(t){var e=this.$store.state.memo.selectedIdx;this.$store.commit("UPDATE_SELECTED_MEMO_COLOR",{index:e,color:t})}}})};n("85ad");const eg=yt()(tg,[["render",Qp],["__scopeId","data-v-0b54a984"]]);var ng=eg,rg={name:"Memo",components:{Moveable:Up,MemoModal:ng},data:function(){var t=this;return{colorList:["red","blue","yellow"],imgSrc:n("e93c"),isEditting:!1,memoContainer:null,initZIndex:0,resizeObserver:new ResizeObserver((function(){t.containerWidth=t.memoContainer.offsetWidth,t.containerHeight=t.memoContainer.offsetHeight})),containerWidth:0,containerHeight:0}},setup:function(){},created:function(){this.$store.dispatch("GET_MEMO_LIST",this.$route.params.studyId)},mounted:function(){this.memoContainer=document.getElementById("memoContainer"),this.resizeObserver.observe(this.memoContainer)},beforeUnmount:function(){this.isEditting&&this.onClickSaveBtn()},methods:{handleSelectedMemo:function(t){this.$store.commit("SET_SELECTED_MEMO_INDEX",t)},onDblClick:function(){var t=document.getElementById("memoModal"),e=Ue["a"].getOrCreateInstance(t);e.show()},onDrag:function(t){var e=t.target,n=t.transform;e.style.transform=n},onScale:function(t){var e=t.target,n=t.drag;e.style.transform=n.transform},onRotate:function(t){var e=t.target,n=t.drag;e.style.transform=n.transform},onClick:function(t){this.$store.commit("SET_SELECTED_MEMO_INDEX",t)},onClickDelete:function(){this.$store.commit("DELETE_SELECTED_MEMO",this.selectedIdx)},handleRenderEnd:function(t,e){this.memoList[t].transform=e.target.style.transform},onClickCreateBtn:function(){this.$store.commit("ADD_MEMO",{content:"",color:0,zIndex:this.zIndexCount++})},onClickSaveBtn:function(){this.$store.dispatch("UPDATE_MEMO_LIST",{studyId:this.$route.params.studyId,memoList:this.memoList}),this.isEditting=!1}},computed:Object(ft["a"])({},Object(pt["d"])({memoList:function(t){return t.memo.memoList},zIndexCount:function(t){return t.memo.zIndexCount},selectedIdx:function(t){return t.memo.selectedIdx}}))};n("e1ff");const ig=yt()(rg,[["render",uo],["__scopeId","data-v-7aafa3a8"]]);var og=ig,ag=n("3d9c"),sg=n("bc3a"),cg=n.n(sg),lg={class:"control-buttons-container"},ug={class:"control-buttons-frame"};function hg(t,e,n,r,o,a){var s=Object(i["resolveComponent"])("font-awesome-icon");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",lg,[Object(i["createElementVNode"])("div",ug,[Object(i["createElementVNode"])("div",{class:"icon-container",onClick:e[0]||(e[0]=function(){return r.onClickKanbanBoardIcon&&r.onClickKanbanBoardIcon.apply(r,arguments)}),tabindex:"0","data-bs-container":"body","data-bs-trigger":"hover","data-bs-toggle":"popover","data-bs-placement":"bottom","data-bs-content":"칸반보드"},[Object(i["createVNode"])(s,{class:Object(i["normalizeClass"])(["icon",{"font-active":4===n.screenMode}]),icon:["fas","tasks"]},null,8,["class"])]),Object(i["createElementVNode"])("div",{class:"icon-container",onClick:e[1]||(e[1]=function(){return r.onClickWhiteBoardIcon&&r.onClickWhiteBoardIcon.apply(r,arguments)}),tabindex:"0","data-bs-container":"body","data-bs-trigger":"hover","data-bs-toggle":"popover","data-bs-placement":"bottom","data-bs-content":"화이트보드"},[Object(i["createVNode"])(s,{class:Object(i["normalizeClass"])(["icon",{"font-active":2===n.screenMode}]),icon:["fas","highlighter"]},null,8,["class"])]),Object(i["createElementVNode"])("div",{class:"icon-container",onClick:e[2]||(e[2]=function(){return r.onClickPostItIcon&&r.onClickPostItIcon.apply(r,arguments)}),tabindex:"0","data-bs-container":"body","data-bs-trigger":"hover","data-bs-toggle":"popover","data-bs-placement":"bottom","data-bs-content":"포스트잇"},[Object(i["createVNode"])(s,{class:Object(i["normalizeClass"])(["icon",{"font-active":3===n.screenMode}]),icon:["fas","sticky-note"]},null,8,["class"])]),Object(i["createElementVNode"])("div",{class:"icon-container",onClick:e[3]||(e[3]=function(){return r.onClickScreenShareIcon&&r.onClickScreenShareIcon.apply(r,arguments)}),tabindex:"0","data-bs-container":"body","data-bs-trigger":"hover","data-bs-toggle":"popover","data-bs-placement":"bottom","data-bs-content":"화면공유"},[Object(i["createVNode"])(s,{class:Object(i["normalizeClass"])(["icon",{"font-active":n.isScreenShared}]),icon:["fas","chalkboard-teacher"]},null,8,["class"])])])])}var dg={name:"ControlButtons",props:{screenMode:Number,isScreenShared:Boolean},setup:function(t,e){var n=e.emit,r=Object(pt["e"])(),o=Object(i["reactive"])({memberList:Object(i["computed"])((function(){return r.state.study.memberList})),isChat:!1,isMemberList:!1,isFile:!1,collapsed:!0,recvList:[],chatLog:[]}),a=22,s=4,c=Object(i["computed"])((function(){return"".concat(o.collapsed?s:a,"vw")})),l=function(){n("show-screenmode",4)},u=function(){t.isScreenShared?n("stopScreenSharing"):n("startScreenSharing")},h=function(){n("show-screenmode",2)},d=function(){n("show-screenmode",3)};return{state:o,sidebarWidth:c,onClickScreenShareIcon:u,onClickWhiteBoardIcon:h,onClickKanbanBoardIcon:l,onClickPostItIcon:d}},mounted:function(){Array.from(document.querySelectorAll('[data-bs-toggle="popover"]')).forEach((function(t){return new Ue["b"](t)}))}};n("1cb0");const fg=yt()(dg,[["render",hg]]);var pg=fg;cg.a.defaults.headers.post["Content-Type"]="application/json";var gg="https://i6a501.p.ssafy.io:4443",vg="MY_SECRET",mg=function(t){return!("false"===t)},bg={name:"Studies",props:{initVideoId:String,initAudioId:String,initVideoOn:Boolean,initAudioOn:Boolean},components:{Sidebar:Ge,KanbanBoard:Kn,MainScreen:vr,WhiteBoard:no,UserVideo:fr,Memo:og,ControlButtons:pg},beforeRouteLeave:function(t,e,n){return this.canLeave||this.$refs.kanbanBoard.onClickSaveBtn(),this.$store.commit("SET_STUDY_INFO",{}),t.fullPath=="/studies/".concat(this.$route.params.studyId)?(this.session&&this.session.disconnect(),this.sessionForScreenShare&&this.sessionForScreenShare.disconnect(),n()):(this.session&&this.session.disconnect(),this.sessionForScreenShare&&this.sessionForScreenShare.disconnect(),this.session=void 0,this.mainStreamManager=void 0,this.publisher=void 0,this.subscribers=[],this.OV=void 0,this.OVForScreenShare=void 0,this.sessionForScreenShare=void 0,this.mainStreamManager2=void 0,this.sharingPublisher=void 0,window.removeEventListener("beforeunload",this.unloadEvent),n())},setup:function(){var t=Object(pt["e"])(),e=Object(xt["c"])();t.dispatch("GET_STUDY_INFO",e.params.studyId);var n=Object(i["ref"])("4vw"),r=function(t){n.value=t};return{toggleSidebar:r,sidebarWidth:n}},data:function(){return{OV:void 0,session:void 0,mainStreamManager:void 0,publisher:void 0,subscribers:[],videoOn:mg(this.initVideoOn),audioOn:mg(this.initAudioOn),connectionUser:!1,mainOnOff:!1,myUserId:"",tg:!1,screenMode:4,editPermit:!1,canLeave:!0,OVForScreenShare:void 0,sessionForScreenShare:void 0,mainStreamManager2:void 0,sharingPublisher:void 0,isScreenShared:!1,screenShareName:"Screen Sharing",isSpeakList:[],isSpeak:!1}},mounted:function(){this.joinSession(this.initVideoOn,this.initAudioOn),window.addEventListener("beforeunload",this.unloadEvent)},unmounted:function(){window.removeEventListener("beforeunload",this.unloadEvent)},computed:{mySessionId:function(){return this.$route.params.studyId},myUserName:function(){return this.$store.state.user.userInfo.nickname}},methods:{unloadEvent:function(t){if(this.canLeave)return this.leaveSession(),void this.leaveSessionForScreenSharing();t.preventDefault(),t.returnValue=""},isEditPermit:function(t){this.editPermit=t,this.canLeave=!t},showScreenMode:function(t){this.screenMode=t},toggleVideoSub:function(t){var e=t.stream.videoActive;t.subscribeToVideo(t.muteVideo),t.muteVideo=!t.muteVideo,t.stream.videoActive=e},toggleAudioSub:function(t){var e=t.stream.audioActive;t.subscribeToAudio(t.muteAudio),t.muteAudio=!t.muteAudio,t.stream.audioActive=e},joinSession:function(t,e){var n=this;this.OV=new ag["OpenVidu"],this.OV.enableProdMode(),this.session=this.OV.initSession(),this.session.on("streamCreated",(function(t){var e=t.stream,r=n.session.subscribe(e);r.muteVideo=!1,r.muteAudio=!1,n.subscribers.push(r)})),this.session.on("streamDestroyed",(function(t){var e=t.stream,r=n.subscribers.indexOf(e.streamManager,0);r>=0&&n.subscribers.splice(r,1)})),this.session.on("exception",(function(t){var e=t.exception;console.warn(e)})),this.session.on("signal:startScreenSharing",(function(){n.isScreenShared=!0})),this.session.on("signal:stopScreenSharing",(function(){n.isScreenShared=!1})),this.session.on("publisherStartSpeaking",(function(t){n.isSpeakList.push(t.connection.connectionId),n.isSpeak=!n.isSpeak})),this.session.on("publisherStopSpeaking",(function(t){var e=n.isSpeakList,r=e.indexOf(t.connection.connectionId,0);r>=0&&(e.splice(r,1),n.isSpeakList=e),n.isSpeak=!n.isSpeak})),this.getToken(this.mySessionId).then((function(r){n.session.connect(r,{clientData:n.myUserName}).then((function(){var r=n.OV.initPublisher(void 0,{audioSource:n.initAudioId?n.initAudioId:void 0,videoSource:n.initVideoId?n.initVideoId:void 0,publishAudio:mg(e),publishVideo:mg(t),resolution:"640x480",frameRate:30,insertMode:"APPEND",mirror:!1});n.publisher=r,n.session.publish(n.publisher)})).catch((function(t){console.log("There was an error connecting to the session:",t.code,t.message)}))}))},connectionUserOnOff:function(){this.connectionUser=!this.connectionUser},audioOnOff:function(){this.publisher.publishAudio(!this.audioOn),this.audioOn=!this.audioOn},videoOnOff:function(){this.publisher.publishVideo(!this.videoOn),this.videoOn=!this.videoOn},leaveSession:function(){this.leaveSessionForScreenSharing(),this.isScreenShared=!1,this.session&&this.session.disconnect(),this.session=void 0,this.mainStreamManager=void 0,this.publisher=void 0,this.subscribers=[],this.OV=void 0},updateMainVideoStreamManager:function(t){this.screenMode=1,this.mainStreamManager=t,this.mainStreamManager.stream.videoDimensions={width:960,height:600}},deleteMainVideoStreamManager:function(){this.mainStreamManager=void 0},getToken:function(t){var e=this;return this.createSession(t).then((function(t){return e.createToken(t)}))},createSession:function(t){return new Promise((function(e,n){cg.a.post("".concat(gg,"/openvidu/api/sessions"),JSON.stringify({customSessionId:t}),{auth:{username:"OPENVIDUAPP",password:vg}}).then((function(t){return t.data})).then((function(t){return e(t.id)})).catch((function(r){409===r.response.status?e(t):(console.warn("No connection to OpenVidu Server. This may be a certificate error at ".concat(gg)),window.confirm("No connection to OpenVidu Server. This may be a certificate error at ".concat(gg,'\n\nClick OK to navigate and accept it. If no certificate warning is shown, then check that your OpenVidu Server is up and running at "').concat(gg,'"'))&&location.assign("".concat(gg,"/accept-certificate")),n(r.response))}))}))},createToken:function(t){return new Promise((function(e,n){cg.a.post("".concat(gg,"/openvidu/api/sessions/").concat(t,"/connection"),{},{auth:{username:"OPENVIDUAPP",password:vg}}).then((function(t){return t.data})).then((function(t){return e(t.token)})).catch((function(t){return n(t.response)}))}))},startScreenSharing:function(){var t=this;this.OVForScreenShare=new ag["OpenVidu"],this.sessionForScreenShare=this.OVForScreenShare.initSession();var e=this.mySessionId;this.getToken(e).then((function(e){t.sessionForScreenShare.connect(e,{clientData:t.myUserName+" 님의 화면공유"}).then((function(){var e=t.OVForScreenShare.initPublisher("sharingvideo",{audioSource:!1,videoSource:"screen",publishVideo:!0,resolution:"1920x1980",frameRate:10,insertMode:"APPEND",mirror:!1});e.once("accessAllowed",(function(){try{t.isScreenShared=!0,t.session.signal({data:JSON.stringify(status),to:[],type:"startScreenSharing"}),e.stream.getMediaStream().getVideoTracks()[0].addEventListener("ended",(function(){t.session.signal({data:JSON.stringify(status),to:[],type:"stopScreenSharing"}),t.leaveSessionForScreenSharing(),t.isScreenShared=!1}))}catch(n){console.error("Error applying constraints: ",n)}})),e.once("accessDenied",(function(){console.warn("ScreenShare: Access Denied")})),t.mainStreamManager=e,t.sharingPublisher=e,t.sessionForScreenShare.publish(t.sharingPublisher)})).catch((function(t){console.warn("There was an error connecting to the session:",t.code,t.message)}))}))},stopScreenSharing:function(){this.isScreenShared=!1,this.leaveSessionForScreenSharing()},leaveSessionForScreenSharing:function(){this.sessionForScreenShare&&this.sessionForScreenShare.disconnect(),this.sessionForScreenShare=void 0,this.mainStreamManager=void 0,this.sharingPublisher=void 0,this.OVForScreenShare=void 0}}};n("74fc");const yg=yt()(bg,[["render",w],["__scopeId","data-v-1414b85b"]]);e["default"]=yg},9152:function(t,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,c=(1<<s)-1,l=c>>1,u=-7,h=n?i-1:0,d=n?-1:1,f=t[e+h];for(h+=d,o=f&(1<<-u)-1,f>>=-u,u+=s;u>0;o=256*o+t[e+h],h+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=r;u>0;a=256*a+t[e+h],h+=d,u-=8);if(0===o)o=1-l;else{if(o===c)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),o-=l}return(f?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,c,l=8*o-i-1,u=(1<<l)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),e+=a+h>=1?d/c:d*Math.pow(2,1-h),e*c>=2&&(a++,c/=2),a+h>=u?(s=0,a=u):a+h>=1?(s=(e*c-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+f]=255&s,f+=p,s/=256,i-=8);for(a=a<<i|s,l+=i;l>0;t[n+f]=255&a,f+=p,a/=256,l-=8);t[n+f-p]|=128*g}},"92c2":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.SessionDisconnectedEvent=void 0;var i=n("8733"),o=n("f66e"),a=o.OpenViduLogger.getInstance(),s=function(t){function e(e,n){var r=t.call(this,!0,e,"sessionDisconnected")||this;return r.reason=n,r}return r(e,t),e.prototype.callDefaultBehavior=function(){a.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'");var t=this.target;t.remoteConnections.forEach((function(e){var n,r,i,o,a,s,c,l,u=e.connectionId;if(null===(n=t.remoteConnections.get(u))||void 0===n?void 0:n.stream){null===(r=t.remoteConnections.get(u))||void 0===r||r.stream.disposeWebRtcPeer(),null===(i=t.remoteConnections.get(u))||void 0===i||i.stream.disposeMediaStream(),(null===(o=t.remoteConnections.get(u))||void 0===o?void 0:o.stream.streamManager)&&(null===(a=t.remoteConnections.get(u))||void 0===a||a.stream.streamManager.removeAllVideos());var h=null===(c=null===(s=t.remoteConnections.get(u))||void 0===s?void 0:s.stream)||void 0===c?void 0:c.streamId;h&&t.remoteStreamsCreated.delete(h),null===(l=t.remoteConnections.get(u))||void 0===l||l.dispose()}t.remoteConnections.delete(u)}))},e}(i.Event);e.SessionDisconnectedEvent=s},"930c":function(t,e,n){(function(t,r){var i;/*! JSON v3.3.2 | https://bestiejs.github.io/json3 | Copyright 2012-2015, Kit Cambridge, Benjamin Tan | http://kit.mit-license.org */(function(){var o=n("3c35"),a={function:!0,object:!0},s=a[typeof e]&&e&&!e.nodeType&&e,c=a[typeof window]&&window||this,l=s&&a[typeof t]&&t&&!t.nodeType&&"object"==typeof r&&r;function u(t,e){t||(t=c.Object()),e||(e=c.Object());var n=t.Number||c.Number,r=t.String||c.String,i=t.Object||c.Object,o=t.Date||c.Date,s=t.SyntaxError||c.SyntaxError,l=t.TypeError||c.TypeError,h=t.Math||c.Math,d=t.JSON||c.JSON;"object"==typeof d&&d&&(e.stringify=d.stringify,e.parse=d.parse);var f,p=i.prototype,g=p.toString,v=p.hasOwnProperty;function m(t,e){try{t()}catch(n){e&&e()}}var b=new o(-0xc782b5b800cec);function y(t){if(null!=y[t])return y[t];var i;if("bug-string-char-index"==t)i="a"!="a"[0];else if("json"==t)i=y("json-stringify")&&y("date-serialization")&&y("json-parse");else if("date-serialization"==t){if(i=y("json-stringify")&&b,i){var a=e.stringify;m((function(){i='"-271821-04-20T00:00:00.000Z"'==a(new o(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==a(new o(864e13))&&'"-000001-01-01T00:00:00.000Z"'==a(new o(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==a(new o(-1))}))}}else{var s,c='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){a=e.stringify;var l="function"==typeof a;l&&((s=function(){return 1}).toJSON=s,m((function(){l="0"===a(0)&&"0"===a(new n)&&'""'==a(new r)&&a(g)===f&&a(f)===f&&a()===f&&"1"===a(s)&&"[1]"==a([s])&&"[null]"==a([f])&&"null"==a(null)&&"[null,null,null]"==a([f,g,null])&&a({a:[s,!0,!1,null,"\0\b\n\f\r\t"]})==c&&"1"===a(null,s)&&"[\n 1,\n 2\n]"==a([1,2],null,1)}),(function(){l=!1}))),i=l}if("json-parse"==t){var u,h=e.parse;"function"==typeof h&&m((function(){0!==h("0")||h(!1)||(s=h(c),u=5==s["a"].length&&1===s["a"][0],u&&(m((function(){u=!h('"\t"')})),u&&m((function(){u=1!==h("01")})),u&&m((function(){u=1!==h("1.")}))))}),(function(){u=!1})),i=u}}return y[t]=!!i}if(m((function(){b=-109252==b.getUTCFullYear()&&0===b.getUTCMonth()&&1===b.getUTCDate()&&10==b.getUTCHours()&&37==b.getUTCMinutes()&&6==b.getUTCSeconds()&&708==b.getUTCMilliseconds()})),y["bug-string-char-index"]=y["date-serialization"]=y["json"]=y["json-stringify"]=y["json-parse"]=null,!y("json")){var S="[object Function]",w="[object Date]",E="[object Number]",C="[object String]",x="[object Array]",O="[object Boolean]",_=y("bug-string-char-index"),T=function(t,e){var n,r,i,o=0;for(i in(n=function(){this.valueOf=0}).prototype.valueOf=0,r=new n,r)v.call(r,i)&&o++;return n=r=null,o?T=function(t,e){var n,r,i=g.call(t)==S;for(n in t)i&&"prototype"==n||!v.call(t,n)||(r="constructor"===n)||e(n);(r||v.call(t,n="constructor"))&&e(n)}:(r=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],T=function(t,e){var n,i,o=g.call(t)==S,s=!o&&"function"!=typeof t.constructor&&a[typeof t.hasOwnProperty]&&t.hasOwnProperty||v;for(n in t)o&&"prototype"==n||!s.call(t,n)||e(n);for(i=r.length;n=r[--i];)s.call(t,n)&&e(n)}),T(t,e)};if(!y("json-stringify")&&!y("date-serialization")){var k={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},I="000000",P=function(t,e){return(I+(e||0)).slice(-t)},j=function(t){var e,n,r,i,o,a,s,c,l;if(b)e=function(t){n=t.getUTCFullYear(),r=t.getUTCMonth(),i=t.getUTCDate(),a=t.getUTCHours(),s=t.getUTCMinutes(),c=t.getUTCSeconds(),l=t.getUTCMilliseconds()};else{var u=h.floor,d=[0,31,59,90,120,151,181,212,243,273,304,334],f=function(t,e){return d[e]+365*(t-1970)+u((t-1969+(e=+(e>1)))/4)-u((t-1901+e)/100)+u((t-1601+e)/400)};e=function(t){for(i=u(t/864e5),n=u(i/365.2425)+1970-1;f(n+1,0)<=i;n++);for(r=u((i-f(n,0))/30.42);f(n,r+1)<=i;r++);i=1+i-f(n,r),o=(t%864e5+864e5)%864e5,a=u(o/36e5)%24,s=u(o/6e4)%60,c=u(o/1e3)%60,l=o%1e3}}return j=function(t){return t>-1/0&&t<1/0?(e(t),t=(n<=0||n>=1e4?(n<0?"-":"+")+P(6,n<0?-n:n):P(4,n))+"-"+P(2,r+1)+"-"+P(2,i)+"T"+P(2,a)+":"+P(2,s)+":"+P(2,c)+"."+P(3,l)+"Z",n=r=i=a=s=c=l=null):t=null,t},j(t)};if(y("json-stringify")&&!y("date-serialization")){function M(t){return j(this)}var D=e.stringify;e.stringify=function(t,e,n){var r=o.prototype.toJSON;o.prototype.toJSON=M;var i=D(t,e,n);return o.prototype.toJSON=r,i}}else{var R="\\u00",A=function(t){var e=t.charCodeAt(0),n=k[e];return n||R+P(2,e.toString(16))},N=/[\x00-\x1f\x22\x5c]/g,L=function(t){return N.lastIndex=0,'"'+(N.test(t)?t.replace(N,A):t)+'"'},B=function(t,e,n,r,i,a,s){var c,u,h,d,p,v,b,y,S;if(m((function(){c=e[t]})),"object"==typeof c&&c&&(c.getUTCFullYear&&g.call(c)==w&&c.toJSON===o.prototype.toJSON?c=j(c):"function"==typeof c.toJSON&&(c=c.toJSON(t))),n&&(c=n.call(e,t,c)),c==f)return c===f?c:"null";switch(u=typeof c,"object"==u&&(h=g.call(c)),h||u){case"boolean":case O:return""+c;case"number":case E:return c>-1/0&&c<1/0?""+c:"null";case"string":case C:return L(""+c)}if("object"==typeof c){for(b=s.length;b--;)if(s[b]===c)throw l();if(s.push(c),d=[],y=a,a+=i,h==x){for(v=0,b=c.length;v<b;v++)p=B(v,c,n,r,i,a,s),d.push(p===f?"null":p);S=d.length?i?"[\n"+a+d.join(",\n"+a)+"\n"+y+"]":"["+d.join(",")+"]":"[]"}else T(r||c,(function(t){var e=B(t,c,n,r,i,a,s);e!==f&&d.push(L(t)+":"+(i?" ":"")+e)})),S=d.length?i?"{\n"+a+d.join(",\n"+a)+"\n"+y+"}":"{"+d.join(",")+"}":"{}";return s.pop(),S}};e.stringify=function(t,e,n){var r,i,o,s;if(a[typeof e]&&e)if(s=g.call(e),s==S)i=e;else if(s==x){o={};for(var c,l=0,u=e.length;l<u;)c=e[l++],s=g.call(c),"[object String]"!=s&&"[object Number]"!=s||(o[c]=1)}if(n)if(s=g.call(n),s==E){if((n-=n%1)>0)for(n>10&&(n=10),r="";r.length<n;)r+=" "}else s==C&&(r=n.length<=10?n:n.slice(0,10));return B("",(c={},c[""]=t,c),i,o,r,"",[])}}}if(!y("json-parse")){var V,F,U=r.fromCharCode,W={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},z=function(){throw V=F=null,s()},G=function(){var t,e,n,r,i,o=F,a=o.length;while(V<a)switch(i=o.charCodeAt(V),i){case 9:case 10:case 13:case 32:V++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=_?o.charAt(V):o[V],V++,t;case 34:for(t="@",V++;V<a;)if(i=o.charCodeAt(V),i<32)z();else if(92==i)switch(i=o.charCodeAt(++V),i){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=W[i],V++;break;case 117:for(e=++V,n=V+4;V<n;V++)i=o.charCodeAt(V),i>=48&&i<=57||i>=97&&i<=102||i>=65&&i<=70||z();t+=U("0x"+o.slice(e,V));break;default:z()}else{if(34==i)break;i=o.charCodeAt(V),e=V;while(i>=32&&92!=i&&34!=i)i=o.charCodeAt(++V);t+=o.slice(e,V)}if(34==o.charCodeAt(V))return V++,t;z();default:if(e=V,45==i&&(r=!0,i=o.charCodeAt(++V)),i>=48&&i<=57){for(48==i&&(i=o.charCodeAt(V+1),i>=48&&i<=57)&&z(),r=!1;V<a&&(i=o.charCodeAt(V),i>=48&&i<=57);V++);if(46==o.charCodeAt(V)){for(n=++V;n<a;n++)if(i=o.charCodeAt(n),i<48||i>57)break;n==V&&z(),V=n}if(i=o.charCodeAt(V),101==i||69==i){for(i=o.charCodeAt(++V),43!=i&&45!=i||V++,n=V;n<a;n++)if(i=o.charCodeAt(n),i<48||i>57)break;n==V&&z(),V=n}return+o.slice(e,V)}r&&z();var s=o.slice(V,V+4);if("true"==s)return V+=4,!0;if("fals"==s&&101==o.charCodeAt(V+4))return V+=5,!1;if("null"==s)return V+=4,null;z()}return"$"},H=function(t){var e,n;if("$"==t&&z(),"string"==typeof t){if("@"==(_?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];;){if(t=G(),"]"==t)break;n?","==t?(t=G(),"]"==t&&z()):z():n=!0,","==t&&z(),e.push(H(t))}return e}if("{"==t){for(e={};;){if(t=G(),"}"==t)break;n?","==t?(t=G(),"}"==t&&z()):z():n=!0,","!=t&&"string"==typeof t&&"@"==(_?t.charAt(0):t[0])&&":"==G()||z(),e[t.slice(1)]=H(G())}return e}z()}return t},Y=function(t,e,n){var r=X(t,e,n);r===f?delete t[e]:t[e]=r},X=function(t,e,n){var r,i=t[e];if("object"==typeof i&&i)if(g.call(i)==x)for(r=i.length;r--;)Y(g,T,i,r,n);else T(i,(function(t){Y(i,t,n)}));return n.call(t,e,i)};e.parse=function(t,e){var n,r;return V=0,F=""+t,n=H(G()),"$"!=G()&&z(),V=F=null,e&&g.call(e)==S?X((r={},r[""]=n,r),"",e):n}}}return e.runInContext=u,e}if(!l||l.global!==l&&l.window!==l&&l.self!==l||(c=l),s&&!o)u(c,s);else{var h=c.JSON,d=c.JSON3,f=!1,p=u(c,c.JSON3={noConflict:function(){return f||(f=!0,c.JSON=h,c.JSON3=d,h=d=null),p}});c.JSON={parse:p.parse,stringify:p.stringify}}o&&(i=function(){return p}.call(e,n,e,t),void 0===i||(t.exports=i))}).call(this)}).call(this,n("62e4")(t),n("c8ba"))},"97a2":function(t,e,n){"use strict";function r(){this._listeners={}}r.prototype.addEventListener=function(t,e){t in this._listeners||(this._listeners[t]=[]);var n=this._listeners[t];-1===n.indexOf(e)&&(n=n.concat([e])),this._listeners[t]=n},r.prototype.removeEventListener=function(t,e){var n=this._listeners[t];if(n){var r=n.indexOf(e);-1===r||(n.length>1?this._listeners[t]=n.slice(0,r).concat(n.slice(r+1)):delete this._listeners[t])}},r.prototype.dispatchEvent=function(){var t=arguments[0],e=t.type,n=1===arguments.length?[t]:Array.apply(null,arguments);if(this["on"+e]&&this["on"+e].apply(this,n),e in this._listeners)for(var r=this._listeners[e],i=0;i<r.length;i++)r[i].apply(this,n)},t.exports=r},"9a83":function(t,e,n){"use strict";function r(t){this.type=t}r.prototype.initEvent=function(t,e,n){return this.type=t,this.bubbles=e,this.cancelable=n,this.timeStamp=+new Date,this},r.prototype.stopPropagation=function(){},r.prototype.preventDefault=function(){},r.CAPTURING_PHASE=1,r.AT_TARGET=2,r.BUBBLING_PHASE=3,t.exports=r},"9bbd":function(t,e,n){},"9c59":function(t,e,n){"use strict";var r,i=Object.prototype.hasOwnProperty;function o(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(e){return null}}function a(t){try{return encodeURIComponent(t)}catch(e){return null}}function s(t){var e,n=/([^=?#&]+)=?([^&]*)/g,r={};while(e=n.exec(t)){var i=o(e[1]),a=o(e[2]);null===i||null===a||i in r||(r[i]=a)}return r}function c(t,e){e=e||"";var n,o,s=[];for(o in"string"!==typeof e&&(e="?"),t)if(i.call(t,o)){if(n=t[o],n||null!==n&&n!==r&&!isNaN(n)||(n=""),o=a(o),n=a(n),null===o||null===n)continue;s.push(o+"="+n)}return s.length?e+s.join("&"):""}e.stringify=c,e.parse=s},"9d7d":function(t,e,n){"use strict";(function(e){var r=n("ada0").EventEmitter,i=n("3fb5"),o=n("c282"),a=n("26a0"),s=n("621f"),c=function(){};function l(t,e,n){c(t,e);var i=this;r.call(this),setTimeout((function(){i._start(t,e,n)}),0)}i(l,r),l.prototype._start=function(t,n,r){c("_start");var i=this,a=new e.XDomainRequest;n=s.addQuery(n,"t="+ +new Date),a.onerror=function(){c("onerror"),i._error()},a.ontimeout=function(){c("ontimeout"),i._error()},a.onprogress=function(){c("progress",a.responseText),i.emit("chunk",200,a.responseText)},a.onload=function(){c("load"),i.emit("finish",200,a.responseText),i._cleanup(!1)},this.xdr=a,this.unloadRef=o.unloadAdd((function(){i._cleanup(!0)}));try{this.xdr.open(t,n),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(r)}catch(l){this._error()}},l.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},l.prototype._cleanup=function(t){if(c("cleanup",t),this.xdr){if(this.removeAllListeners(),o.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,t)try{this.xdr.abort()}catch(e){}this.unloadRef=this.xdr=null}},l.prototype.close=function(){c("close"),this._cleanup(!0)},l.enabled=!(!e.XDomainRequest||!a.hasDomain()),t.exports=l}).call(this,n("c8ba"))},"9f3a":function(t,e,n){"use strict";var r=n("3fb5"),i=n("930c"),o=n("ada0").EventEmitter,a=n("1015"),s=n("621f"),c=n("f1f8"),l=n("c282"),u=n("2582"),h=function(){};function d(t,e,n){if(!d.enabled())throw new Error("Transport created when disabled");o.call(this);var r=this;this.origin=s.getOrigin(n),this.baseUrl=n,this.transUrl=e,this.transport=t,this.windowId=u.string(8);var i=s.addPath(n,"/iframe.html")+"#"+this.windowId;h(t,e,i),this.iframeObj=c.createIframe(i,(function(t){h("err callback"),r.emit("close",1006,"Unable to load an iframe ("+t+")"),r.close()})),this.onmessageCallback=this._message.bind(this),l.attachEvent("message",this.onmessageCallback)}r(d,o),d.prototype.close=function(){if(h("close"),this.removeAllListeners(),this.iframeObj){l.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch(t){}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},d.prototype._message=function(t){if(h("message",t.data),s.isOriginEqual(t.origin,this.origin)){var e;try{e=i.parse(t.data)}catch(r){return void h("bad json",t.data)}if(e.windowId===this.windowId)switch(e.type){case"s":this.iframeObj.loaded(),this.postMessage("s",i.stringify([a,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",e.data);break;case"c":var n;try{n=i.parse(e.data)}catch(r){return void h("bad json",e.data)}this.emit("close",n[0],n[1]),this.close();break}else h("mismatched window id",e.windowId,this.windowId)}else h("not same origin",t.origin,this.origin)},d.prototype.postMessage=function(t,e){h("postMessage",t,e),this.iframeObj.post(i.stringify({windowId:this.windowId,type:t,data:e||""}),this.origin)},d.prototype.send=function(t){h("send",t),this.postMessage("m",t)},d.enabled=function(){return c.iframeEnabled},d.transportName="iframe",d.roundTrips=2,t.exports=d},"9fa7":function(t,e,n){"use strict";var r=n("621f"),i=n("c282"),o=n("930c"),a=n("bb31"),s=n("c529"),c=n("f1f8"),l=n("a0e2"),u=function(){};t.exports=function(t,e){var n,h={};e.forEach((function(t){t.facadeTransport&&(h[t.facadeTransport.transportName]=t.facadeTransport)})),h[s.transportName]=s,t.bootstrap_iframe=function(){var e;c.currentWindowId=l.hash.slice(1);var s=function(i){if(i.source===parent&&("undefined"===typeof n&&(n=i.origin),i.origin===n)){var s;try{s=o.parse(i.data)}catch(m){return void u("bad json",i.data)}if(s.windowId===c.currentWindowId)switch(s.type){case"s":var d;try{d=o.parse(s.data)}catch(m){u("bad json",s.data);break}var f=d[0],p=d[1],g=d[2],v=d[3];if(u(f,p,g,v),f!==t.version)throw new Error('Incompatible SockJS! Main site uses: "'+f+'", the iframe: "'+t.version+'".');if(!r.isOriginEqual(g,l.href)||!r.isOriginEqual(v,l.href))throw new Error("Can't connect to different domain from within an iframe. ("+l.href+", "+g+", "+v+")");e=new a(new h[p](g,v));break;case"m":e._send(s.data);break;case"c":e&&e._close(),e=null;break}}};i.attachEvent("message",s),c.postMessage("s")}}},a081:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.VideoElementEvent=void 0;var i=n("8733"),o=function(t){function e(e,n,r){var i=t.call(this,!1,n,r)||this;return i.element=e,i}return r(e,t),e.prototype.callDefaultBehavior=function(){},e}(i.Event);e.VideoElementEvent=o},a0e2:function(t,e,n){"use strict";(function(e){t.exports=e.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}}).call(this,n("c8ba"))},a21b:function(t,e){var n=["stun:","turn:"];t.exports=function(t){var e,r,i=(t||{}).url||t,o={};return"string"==typeof i||i instanceof String?(i=i.trim(),e=n[n.indexOf(i.slice(0,5))],e?(i=i.slice(5),r=i.split("@"),o.username=t.username,o.credential=t.credential,r.length>1&&(i=r[1],r=r[0].split(":"),o.username=r[0],o.credential=(t||{}).credential||r[1]||""),o.url=e+i,o.urls=[o.url],o):t):t}},a267:function(t,e,n){"use strict";n("132d")},a4b2:function(t,e){function n(t){throw new TypeError("Not yet implemented")}function r(t){throw new TypeError("Not yet implemented")}e.pack=n,e.unpack=r},a630:function(t,e,n){var r=n("23e7"),i=n("4df4"),o=n("1c7e"),a=!o((function(t){Array.from(t)}));r({target:"Array",stat:!0,forced:a},{from:i})},a7b3:function(t,e){function n(){}t.exports=n,n.mixin=function(t){var e=t.prototype||t;e.isWildEmitter=!0,e.on=function(t,e,n){this.callbacks=this.callbacks||{};var r=3===arguments.length,i=r?arguments[1]:void 0,o=r?arguments[2]:arguments[1];return o._groupName=i,(this.callbacks[t]=this.callbacks[t]||[]).push(o),this},e.once=function(t,e,n){var r=this,i=3===arguments.length,o=i?arguments[1]:void 0,a=i?arguments[2]:arguments[1];function s(){r.off(t,s),a.apply(this,arguments)}return this.on(t,o,s),this},e.releaseGroup=function(t){var e,n,r,i;for(e in this.callbacks=this.callbacks||{},this.callbacks)for(i=this.callbacks[e],n=0,r=i.length;n<r;n++)i[n]._groupName===t&&(i.splice(n,1),n--,r--);return this},e.off=function(t,e){this.callbacks=this.callbacks||{};var n,r=this.callbacks[t];return r?1===arguments.length?(delete this.callbacks[t],this):(n=r.indexOf(e),-1!==n&&(r.splice(n,1),0===r.length&&delete this.callbacks[t]),this):this},e.emit=function(t){this.callbacks=this.callbacks||{};var e,n,r,i=[].slice.call(arguments,1),o=this.callbacks[t],a=this.getWildcardCallbacks(t);if(o)for(r=o.slice(),e=0,n=r.length;e<n;++e){if(!r[e])break;r[e].apply(this,i)}if(a)for(n=a.length,r=a.slice(),e=0,n=r.length;e<n;++e){if(!r[e])break;r[e].apply(this,[t].concat(i))}return this},e.getWildcardCallbacks=function(t){this.callbacks=this.callbacks||{};var e,n,r=[];for(e in this.callbacks)n=e.split("*"),("*"===e||2===n.length&&t.slice(0,n[0].length)===n[0])&&(r=r.concat(this.callbacks[e]));return r}},n.mixin(n)},a9e3:function(t,e,n){"use strict";var r=n("83ab"),i=n("da84"),o=n("e330"),a=n("94ca"),s=n("6eeb"),c=n("1a2d"),l=n("7156"),u=n("3a9b"),h=n("d9b5"),d=n("c04e"),f=n("d039"),p=n("241c").f,g=n("06cf").f,v=n("9bf2").f,m=n("408a"),b=n("58a8").trim,y="Number",S=i[y],w=S.prototype,E=i.TypeError,C=o("".slice),x=o("".charCodeAt),O=function(t){var e=d(t,"number");return"bigint"==typeof e?e:_(e)},_=function(t){var e,n,r,i,o,a,s,c,l=d(t,"number");if(h(l))throw E("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(l=b(l),e=x(l,0),43===e||45===e){if(n=x(l,2),88===n||120===n)return NaN}else if(48===e){switch(x(l,1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+l}for(o=C(l,2),a=o.length,s=0;s<a;s++)if(c=x(o,s),c<48||c>i)return NaN;return parseInt(o,r)}return+l};if(a(y,!S(" 0o1")||!S("0b1")||S("+0x1"))){for(var T,k=function(t){var e=arguments.length<1?0:S(O(t)),n=this;return u(w,n)&&f((function(){m(n)}))?l(Object(e),n,k):e},I=r?p(S):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),P=0;I.length>P;P++)c(S,T=I[P])&&!c(k,T)&&v(k,T,g(S,T));k.prototype=w,w.constructor=k,s(i,y,k)}},aa47:function(t,e,n){"use strict";
/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(){return s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s.apply(this,arguments)}function c(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}function l(t,e){if(null==t)return{};var n,r,i=c(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function u(t){return h(t)||d(t)||f(t)||g()}function h(t){if(Array.isArray(t))return p(t)}function d(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function f(t,e){if(t){if("string"===typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function g(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.r(e),n.d(e,"MultiDrag",(function(){return ze})),n.d(e,"Sortable",(function(){return ne})),n.d(e,"Swap",(function(){return je}));var v="1.14.0";function m(t){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(t)}var b=m(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),y=m(/Edge/i),S=m(/firefox/i),w=m(/safari/i)&&!m(/chrome/i)&&!m(/android/i),E=m(/iP(ad|od|hone)/i),C=m(/chrome/i)&&m(/android/i),x={capture:!1,passive:!1};function O(t,e,n){t.addEventListener(e,n,!b&&x)}function _(t,e,n){t.removeEventListener(e,n,!b&&x)}function T(t,e){if(e){if(">"===e[0]&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(n){return!1}return!1}}function k(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function I(t,e,n,r){if(t){n=n||document;do{if(null!=e&&(">"===e[0]?t.parentNode===n&&T(t,e):T(t,e))||r&&t===n)return t;if(t===n)break}while(t=k(t))}return null}var P,j=/\s+/g;function M(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var r=(" "+t.className+" ").replace(j," ").replace(" "+e+" "," ");t.className=(r+(n?" "+e:"")).replace(j," ")}}function D(t,e,n){var r=t&&t.style;if(r){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in r||-1!==e.indexOf("webkit")||(e="-webkit-"+e),r[e]=n+("string"===typeof n?"":"px")}}function R(t,e){var n="";if("string"===typeof t)n=t;else do{var r=D(t,"transform");r&&"none"!==r&&(n=r+" "+n)}while(!e&&(t=t.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function A(t,e,n){if(t){var r=t.getElementsByTagName(e),i=0,o=r.length;if(n)for(;i<o;i++)n(r[i],i);return r}return[]}function N(){var t=document.scrollingElement;return t||document.documentElement}function L(t,e,n,r,i){if(t.getBoundingClientRect||t===window){var o,a,s,c,l,u,h;if(t!==window&&t.parentNode&&t!==N()?(o=t.getBoundingClientRect(),a=o.top,s=o.left,c=o.bottom,l=o.right,u=o.height,h=o.width):(a=0,s=0,c=window.innerHeight,l=window.innerWidth,u=window.innerHeight,h=window.innerWidth),(e||n)&&t!==window&&(i=i||t.parentNode,!b))do{if(i&&i.getBoundingClientRect&&("none"!==D(i,"transform")||n&&"static"!==D(i,"position"))){var d=i.getBoundingClientRect();a-=d.top+parseInt(D(i,"border-top-width")),s-=d.left+parseInt(D(i,"border-left-width")),c=a+o.height,l=s+o.width;break}}while(i=i.parentNode);if(r&&t!==window){var f=R(i||t),p=f&&f.a,g=f&&f.d;f&&(a/=g,s/=p,h/=p,u/=g,c=a+u,l=s+h)}return{top:a,left:s,bottom:c,right:l,width:h,height:u}}}function B(t,e,n){var r=G(t,!0),i=L(t)[e];while(r){var o=L(r)[n],a=void 0;if(a="top"===n||"left"===n?i>=o:i<=o,!a)return r;if(r===N())break;r=G(r,!1)}return!1}function V(t,e,n,r){var i=0,o=0,a=t.children;while(o<a.length){if("none"!==a[o].style.display&&a[o]!==ne.ghost&&(r||a[o]!==ne.dragged)&&I(a[o],n.draggable,t,!1)){if(i===e)return a[o];i++}o++}return null}function F(t,e){var n=t.lastElementChild;while(n&&(n===ne.ghost||"none"===D(n,"display")||e&&!T(n,e)))n=n.previousElementSibling;return n||null}function U(t,e){var n=0;if(!t||!t.parentNode)return-1;while(t=t.previousElementSibling)"TEMPLATE"===t.nodeName.toUpperCase()||t===ne.clone||e&&!T(t,e)||n++;return n}function W(t){var e=0,n=0,r=N();if(t)do{var i=R(t),o=i.a,a=i.d;e+=t.scrollLeft*o,n+=t.scrollTop*a}while(t!==r&&(t=t.parentNode));return[e,n]}function z(t,e){for(var n in t)if(t.hasOwnProperty(n))for(var r in e)if(e.hasOwnProperty(r)&&e[r]===t[n][r])return Number(n);return-1}function G(t,e){if(!t||!t.getBoundingClientRect)return N();var n=t,r=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=D(n);if(n.clientWidth<n.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!n.getBoundingClientRect||n===document.body)return N();if(r||e)return n;r=!0}}}while(n=n.parentNode);return N()}function H(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function Y(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}function X(t,e){return function(){if(!P){var n=arguments,r=this;1===n.length?t.call(r,n[0]):t.apply(r,n),P=setTimeout((function(){P=void 0}),e)}}}function q(){clearTimeout(P),P=void 0}function $(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function J(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function K(t,e){D(t,"position","absolute"),D(t,"top",e.top),D(t,"left",e.left),D(t,"width",e.width),D(t,"height",e.height)}function Z(t){D(t,"position",""),D(t,"top",""),D(t,"left",""),D(t,"width",""),D(t,"height","")}var Q="Sortable"+(new Date).getTime();function tt(){var t,e=[];return{captureAnimationState:function(){if(e=[],this.options.animation){var t=[].slice.call(this.el.children);t.forEach((function(t){if("none"!==D(t,"display")&&t!==ne.ghost){e.push({target:t,rect:L(t)});var n=i({},e[e.length-1].rect);if(t.thisAnimationDuration){var r=R(t,!0);r&&(n.top-=r.f,n.left-=r.e)}t.fromRect=n}}))}},addAnimationState:function(t){e.push(t)},removeAnimationState:function(t){e.splice(z(e,{target:t}),1)},animateAll:function(n){var r=this;if(!this.options.animation)return clearTimeout(t),void("function"===typeof n&&n());var i=!1,o=0;e.forEach((function(t){var e=0,n=t.target,a=n.fromRect,s=L(n),c=n.prevFromRect,l=n.prevToRect,u=t.rect,h=R(n,!0);h&&(s.top-=h.f,s.left-=h.e),n.toRect=s,n.thisAnimationDuration&&Y(c,s)&&!Y(a,s)&&(u.top-s.top)/(u.left-s.left)===(a.top-s.top)/(a.left-s.left)&&(e=nt(u,c,l,r.options)),Y(s,a)||(n.prevFromRect=a,n.prevToRect=s,e||(e=r.options.animation),r.animate(n,u,s,e)),e&&(i=!0,o=Math.max(o,e),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),e),n.thisAnimationDuration=e)})),clearTimeout(t),i?t=setTimeout((function(){"function"===typeof n&&n()}),o):"function"===typeof n&&n(),e=[]},animate:function(t,e,n,r){if(r){D(t,"transition",""),D(t,"transform","");var i=R(this.el),o=i&&i.a,a=i&&i.d,s=(e.left-n.left)/(o||1),c=(e.top-n.top)/(a||1);t.animatingX=!!s,t.animatingY=!!c,D(t,"transform","translate3d("+s+"px,"+c+"px,0)"),this.forRepaintDummy=et(t),D(t,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),D(t,"transform","translate3d(0,0,0)"),"number"===typeof t.animated&&clearTimeout(t.animated),t.animated=setTimeout((function(){D(t,"transition",""),D(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1}),r)}}}}function et(t){return t.offsetWidth}function nt(t,e,n,r){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*r.animation}var rt=[],it={initializeByDefault:!0},ot={mount:function(t){for(var e in it)it.hasOwnProperty(e)&&!(e in t)&&(t[e]=it[e]);rt.forEach((function(e){if(e.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")})),rt.push(t)},pluginEvent:function(t,e,n){var r=this;this.eventCanceled=!1,n.cancel=function(){r.eventCanceled=!0};var o=t+"Global";rt.forEach((function(r){e[r.pluginName]&&(e[r.pluginName][o]&&e[r.pluginName][o](i({sortable:e},n)),e.options[r.pluginName]&&e[r.pluginName][t]&&e[r.pluginName][t](i({sortable:e},n)))}))},initializePlugins:function(t,e,n,r){for(var i in rt.forEach((function(r){var i=r.pluginName;if(t.options[i]||r.initializeByDefault){var o=new r(t,e,t.options);o.sortable=t,o.options=t.options,t[i]=o,s(n,o.defaults)}})),t.options)if(t.options.hasOwnProperty(i)){var o=this.modifyOption(t,i,t.options[i]);"undefined"!==typeof o&&(t.options[i]=o)}},getEventProperties:function(t,e){var n={};return rt.forEach((function(r){"function"===typeof r.eventProperties&&s(n,r.eventProperties.call(e[r.pluginName],t))})),n},modifyOption:function(t,e,n){var r;return rt.forEach((function(i){t[i.pluginName]&&i.optionListeners&&"function"===typeof i.optionListeners[e]&&(r=i.optionListeners[e].call(t[i.pluginName],n))})),r}};function at(t){var e=t.sortable,n=t.rootEl,r=t.name,o=t.targetEl,a=t.cloneEl,s=t.toEl,c=t.fromEl,l=t.oldIndex,u=t.newIndex,h=t.oldDraggableIndex,d=t.newDraggableIndex,f=t.originalEvent,p=t.putSortable,g=t.extraEventProperties;if(e=e||n&&n[Q],e){var v,m=e.options,S="on"+r.charAt(0).toUpperCase()+r.substr(1);!window.CustomEvent||b||y?(v=document.createEvent("Event"),v.initEvent(r,!0,!0)):v=new CustomEvent(r,{bubbles:!0,cancelable:!0}),v.to=s||n,v.from=c||n,v.item=o||n,v.clone=a,v.oldIndex=l,v.newIndex=u,v.oldDraggableIndex=h,v.newDraggableIndex=d,v.originalEvent=f,v.pullMode=p?p.lastPutMode:void 0;var w=i(i({},g),ot.getEventProperties(r,e));for(var E in w)v[E]=w[E];n&&n.dispatchEvent(v),m[S]&&m[S].call(e,v)}}var st=["evt"],ct=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.evt,o=l(n,st);ot.pluginEvent.bind(ne)(t,e,i({dragEl:ut,parentEl:ht,ghostEl:dt,rootEl:ft,nextEl:pt,lastDownEl:gt,cloneEl:vt,cloneHidden:mt,dragStarted:Pt,putSortable:Ct,activeSortable:ne.active,originalEvent:r,oldIndex:bt,oldDraggableIndex:St,newIndex:yt,newDraggableIndex:wt,hideGhostForTarget:Zt,unhideGhostForTarget:Qt,cloneNowHidden:function(){mt=!0},cloneNowShown:function(){mt=!1},dispatchSortableEvent:function(t){lt({sortable:e,name:t,originalEvent:r})}},o))};function lt(t){at(i({putSortable:Ct,cloneEl:vt,targetEl:ut,rootEl:ft,oldIndex:bt,oldDraggableIndex:St,newIndex:yt,newDraggableIndex:wt},t))}var ut,ht,dt,ft,pt,gt,vt,mt,bt,yt,St,wt,Et,Ct,xt,Ot,_t,Tt,kt,It,Pt,jt,Mt,Dt,Rt,At=!1,Nt=!1,Lt=[],Bt=!1,Vt=!1,Ft=[],Ut=!1,Wt=[],zt="undefined"!==typeof document,Gt=E,Ht=y||b?"cssFloat":"float",Yt=zt&&!C&&!E&&"draggable"in document.createElement("div"),Xt=function(){if(zt){if(b)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}}(),qt=function(t,e){var n=D(t),r=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=V(t,0,e),o=V(t,1,e),a=i&&D(i),s=o&&D(o),c=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+L(i).width,l=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+L(o).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&a["float"]&&"none"!==a["float"]){var u="left"===a["float"]?"left":"right";return!o||"both"!==s.clear&&s.clear!==u?"horizontal":"vertical"}return i&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||c>=r&&"none"===n[Ht]||o&&"none"===n[Ht]&&c+l>r)?"vertical":"horizontal"},$t=function(t,e,n){var r=n?t.left:t.top,i=n?t.right:t.bottom,o=n?t.width:t.height,a=n?e.left:e.top,s=n?e.right:e.bottom,c=n?e.width:e.height;return r===a||i===s||r+o/2===a+c/2},Jt=function(t,e){var n;return Lt.some((function(r){var i=r[Q].options.emptyInsertThreshold;if(i&&!F(r)){var o=L(r),a=t>=o.left-i&&t<=o.right+i,s=e>=o.top-i&&e<=o.bottom+i;return a&&s?n=r:void 0}})),n},Kt=function(t){function e(t,n){return function(r,i,o,a){var s=r.options.group.name&&i.options.group.name&&r.options.group.name===i.options.group.name;if(null==t&&(n||s))return!0;if(null==t||!1===t)return!1;if(n&&"clone"===t)return t;if("function"===typeof t)return e(t(r,i,o,a),n)(r,i,o,a);var c=(n?r:i).options.group.name;return!0===t||"string"===typeof t&&t===c||t.join&&t.indexOf(c)>-1}}var n={},r=t.group;r&&"object"==o(r)||(r={name:r}),n.name=r.name,n.checkPull=e(r.pull,!0),n.checkPut=e(r.put),n.revertClone=r.revertClone,t.group=n},Zt=function(){!Xt&&dt&&D(dt,"display","none")},Qt=function(){!Xt&&dt&&D(dt,"display","")};zt&&document.addEventListener("click",(function(t){if(Nt)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Nt=!1,!1}),!0);var te=function(t){if(ut){t=t.touches?t.touches[0]:t;var e=Jt(t.clientX,t.clientY);if(e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);n.target=n.rootEl=e,n.preventDefault=void 0,n.stopPropagation=void 0,e[Q]._onDragOver(n)}}},ee=function(t){ut&&ut.parentNode[Q]._isOutsideThisEl(t.target)};function ne(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=s({},e),t[Q]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return qt(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==ne.supportPointer&&"PointerEvent"in window&&!w,emptyInsertThreshold:5};for(var r in ot.initializePlugins(this,t,n),n)!(r in e)&&(e[r]=n[r]);for(var i in Kt(e),this)"_"===i.charAt(0)&&"function"===typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!e.forceFallback&&Yt,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?O(t,"pointerdown",this._onTapStart):(O(t,"mousedown",this._onTapStart),O(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(O(t,"dragover",this),O(t,"dragenter",this)),Lt.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),s(this,tt())}function re(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function ie(t,e,n,r,i,o,a,s){var c,l,u=t[Q],h=u.options.onMove;return!window.CustomEvent||b||y?(c=document.createEvent("Event"),c.initEvent("move",!0,!0)):c=new CustomEvent("move",{bubbles:!0,cancelable:!0}),c.to=e,c.from=t,c.dragged=n,c.draggedRect=r,c.related=i||e,c.relatedRect=o||L(e),c.willInsertAfter=s,c.originalEvent=a,t.dispatchEvent(c),h&&(l=h.call(u,c,a)),l}function oe(t){t.draggable=!1}function ae(){Ut=!1}function se(t,e,n){var r=L(V(n.el,0,n.options,!0)),i=10;return e?t.clientX<r.left-i||t.clientY<r.top&&t.clientX<r.right:t.clientY<r.top-i||t.clientY<r.bottom&&t.clientX<r.left}function ce(t,e,n){var r=L(F(n.el,n.options.draggable)),i=10;return e?t.clientX>r.right+i||t.clientX<=r.right&&t.clientY>r.bottom&&t.clientX>=r.left:t.clientX>r.right&&t.clientY>r.top||t.clientX<=r.right&&t.clientY>r.bottom+i}function le(t,e,n,r,i,o,a,s){var c=r?t.clientY:t.clientX,l=r?n.height:n.width,u=r?n.top:n.left,h=r?n.bottom:n.right,d=!1;if(!a)if(s&&Dt<l*i){if(!Bt&&(1===Mt?c>u+l*o/2:c<h-l*o/2)&&(Bt=!0),Bt)d=!0;else if(1===Mt?c<u+Dt:c>h-Dt)return-Mt}else if(c>u+l*(1-i)/2&&c<h-l*(1-i)/2)return ue(e);return d=d||a,d&&(c<u+l*o/2||c>h-l*o/2)?c>u+l/2?1:-1:0}function ue(t){return U(ut)<U(t)?1:-1}function he(t){var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,r=0;while(n--)r+=e.charCodeAt(n);return r.toString(36)}function de(t){Wt.length=0;var e=t.getElementsByTagName("input"),n=e.length;while(n--){var r=e[n];r.checked&&Wt.push(r)}}function fe(t){return setTimeout(t,0)}function pe(t){return clearTimeout(t)}ne.prototype={constructor:ne,_isOutsideThisEl:function(t){this.el.contains(t)||t===this.el||(jt=null)},_getDirection:function(t,e){return"function"===typeof this.options.direction?this.options.direction.call(this,t,e,ut):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,n=this.el,r=this.options,i=r.preventOnFilter,o=t.type,a=t.touches&&t.touches[0]||t.pointerType&&"touch"===t.pointerType&&t,s=(a||t).target,c=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||s,l=r.filter;if(de(n),!ut&&!(/mousedown|pointerdown/.test(o)&&0!==t.button||r.disabled)&&!c.isContentEditable&&(this.nativeDraggable||!w||!s||"SELECT"!==s.tagName.toUpperCase())&&(s=I(s,r.draggable,n,!1),(!s||!s.animated)&&gt!==s)){if(bt=U(s),St=U(s,r.draggable),"function"===typeof l){if(l.call(this,t,s,this))return lt({sortable:e,rootEl:c,name:"filter",targetEl:s,toEl:n,fromEl:n}),ct("filter",e,{evt:t}),void(i&&t.cancelable&&t.preventDefault())}else if(l&&(l=l.split(",").some((function(r){if(r=I(c,r.trim(),n,!1),r)return lt({sortable:e,rootEl:r,name:"filter",targetEl:s,fromEl:n,toEl:n}),ct("filter",e,{evt:t}),!0})),l))return void(i&&t.cancelable&&t.preventDefault());r.handle&&!I(c,r.handle,n,!1)||this._prepareDragStart(t,a,s)}}},_prepareDragStart:function(t,e,n){var r,i=this,o=i.el,a=i.options,s=o.ownerDocument;if(n&&!ut&&n.parentNode===o){var c=L(n);if(ft=o,ut=n,ht=ut.parentNode,pt=ut.nextSibling,gt=n,Et=a.group,ne.dragged=ut,xt={target:ut,clientX:(e||t).clientX,clientY:(e||t).clientY},kt=xt.clientX-c.left,It=xt.clientY-c.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,ut.style["will-change"]="all",r=function(){ct("delayEnded",i,{evt:t}),ne.eventCanceled?i._onDrop():(i._disableDelayedDragEvents(),!S&&i.nativeDraggable&&(ut.draggable=!0),i._triggerDragStart(t,e),lt({sortable:i,name:"choose",originalEvent:t}),M(ut,a.chosenClass,!0))},a.ignore.split(",").forEach((function(t){A(ut,t.trim(),oe)})),O(s,"dragover",te),O(s,"mousemove",te),O(s,"touchmove",te),O(s,"mouseup",i._onDrop),O(s,"touchend",i._onDrop),O(s,"touchcancel",i._onDrop),S&&this.nativeDraggable&&(this.options.touchStartThreshold=4,ut.draggable=!0),ct("delayStart",this,{evt:t}),!a.delay||a.delayOnTouchOnly&&!e||this.nativeDraggable&&(y||b))r();else{if(ne.eventCanceled)return void this._onDrop();O(s,"mouseup",i._disableDelayedDrag),O(s,"touchend",i._disableDelayedDrag),O(s,"touchcancel",i._disableDelayedDrag),O(s,"mousemove",i._delayedDragTouchMoveHandler),O(s,"touchmove",i._delayedDragTouchMoveHandler),a.supportPointer&&O(s,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(r,a.delay)}}},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){ut&&oe(ut),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;_(t,"mouseup",this._disableDelayedDrag),_(t,"touchend",this._disableDelayedDrag),_(t,"touchcancel",this._disableDelayedDrag),_(t,"mousemove",this._delayedDragTouchMoveHandler),_(t,"touchmove",this._delayedDragTouchMoveHandler),_(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||"touch"==t.pointerType&&t,!this.nativeDraggable||e?this.options.supportPointer?O(document,"pointermove",this._onTouchMove):O(document,e?"touchmove":"mousemove",this._onTouchMove):(O(ut,"dragend",this),O(ft,"dragstart",this._onDragStart));try{document.selection?fe((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(n){}},_dragStarted:function(t,e){if(At=!1,ft&&ut){ct("dragStarted",this,{evt:e}),this.nativeDraggable&&O(document,"dragover",ee);var n=this.options;!t&&M(ut,n.dragClass,!1),M(ut,n.ghostClass,!0),ne.active=this,t&&this._appendGhost(),lt({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(Ot){this._lastX=Ot.clientX,this._lastY=Ot.clientY,Zt();var t=document.elementFromPoint(Ot.clientX,Ot.clientY),e=t;while(t&&t.shadowRoot){if(t=t.shadowRoot.elementFromPoint(Ot.clientX,Ot.clientY),t===e)break;e=t}if(ut.parentNode[Q]._isOutsideThisEl(t),e)do{if(e[Q]){var n=void 0;if(n=e[Q]._onDragOver({clientX:Ot.clientX,clientY:Ot.clientY,target:t,rootEl:e}),n&&!this.options.dragoverBubble)break}t=e}while(e=e.parentNode);Qt()}},_onTouchMove:function(t){if(xt){var e=this.options,n=e.fallbackTolerance,r=e.fallbackOffset,i=t.touches?t.touches[0]:t,o=dt&&R(dt,!0),a=dt&&o&&o.a,s=dt&&o&&o.d,c=Gt&&Rt&&W(Rt),l=(i.clientX-xt.clientX+r.x)/(a||1)+(c?c[0]-Ft[0]:0)/(a||1),u=(i.clientY-xt.clientY+r.y)/(s||1)+(c?c[1]-Ft[1]:0)/(s||1);if(!ne.active&&!At){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(dt){o?(o.e+=l-(_t||0),o.f+=u-(Tt||0)):o={a:1,b:0,c:0,d:1,e:l,f:u};var h="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");D(dt,"webkitTransform",h),D(dt,"mozTransform",h),D(dt,"msTransform",h),D(dt,"transform",h),_t=l,Tt=u,Ot=i}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!dt){var t=this.options.fallbackOnBody?document.body:ft,e=L(ut,!0,Gt,!0,t),n=this.options;if(Gt){Rt=t;while("static"===D(Rt,"position")&&"none"===D(Rt,"transform")&&Rt!==document)Rt=Rt.parentNode;Rt!==document.body&&Rt!==document.documentElement?(Rt===document&&(Rt=N()),e.top+=Rt.scrollTop,e.left+=Rt.scrollLeft):Rt=N(),Ft=W(Rt)}dt=ut.cloneNode(!0),M(dt,n.ghostClass,!1),M(dt,n.fallbackClass,!0),M(dt,n.dragClass,!0),D(dt,"transition",""),D(dt,"transform",""),D(dt,"box-sizing","border-box"),D(dt,"margin",0),D(dt,"top",e.top),D(dt,"left",e.left),D(dt,"width",e.width),D(dt,"height",e.height),D(dt,"opacity","0.8"),D(dt,"position",Gt?"absolute":"fixed"),D(dt,"zIndex","100000"),D(dt,"pointerEvents","none"),ne.ghost=dt,t.appendChild(dt),D(dt,"transform-origin",kt/parseInt(dt.style.width)*100+"% "+It/parseInt(dt.style.height)*100+"%")}},_onDragStart:function(t,e){var n=this,r=t.dataTransfer,i=n.options;ct("dragStart",this,{evt:t}),ne.eventCanceled?this._onDrop():(ct("setupClone",this),ne.eventCanceled||(vt=J(ut),vt.draggable=!1,vt.style["will-change"]="",this._hideClone(),M(vt,this.options.chosenClass,!1),ne.clone=vt),n.cloneId=fe((function(){ct("clone",n),ne.eventCanceled||(n.options.removeCloneOnHide||ft.insertBefore(vt,ut),n._hideClone(),lt({sortable:n,name:"clone"}))})),!e&&M(ut,i.dragClass,!0),e?(Nt=!0,n._loopId=setInterval(n._emulateDragOver,50)):(_(document,"mouseup",n._onDrop),_(document,"touchend",n._onDrop),_(document,"touchcancel",n._onDrop),r&&(r.effectAllowed="move",i.setData&&i.setData.call(n,r,ut)),O(document,"drop",n),D(ut,"transform","translateZ(0)")),At=!0,n._dragStartId=fe(n._dragStarted.bind(n,e,t)),O(document,"selectstart",n),Pt=!0,w&&D(document.body,"user-select","none"))},_onDragOver:function(t){var e,n,r,o,a=this.el,s=t.target,c=this.options,l=c.group,u=ne.active,h=Et===l,d=c.sort,f=Ct||u,p=this,g=!1;if(!Ut){if(void 0!==t.preventDefault&&t.cancelable&&t.preventDefault(),s=I(s,c.draggable,a,!0),j("dragOver"),ne.eventCanceled)return g;if(ut.contains(t.target)||s.animated&&s.animatingX&&s.animatingY||p._ignoreWhileAnimating===s)return A(!1);if(Nt=!1,u&&!c.disabled&&(h?d||(r=ht!==ft):Ct===this||(this.lastPutMode=Et.checkPull(this,u,ut,t))&&l.checkPut(this,u,ut,t))){if(o="vertical"===this._getDirection(t,s),e=L(ut),j("dragOverValid"),ne.eventCanceled)return g;if(r)return ht=ft,R(),this._hideClone(),j("revert"),ne.eventCanceled||(pt?ft.insertBefore(ut,pt):ft.appendChild(ut)),A(!0);var v=F(a,c.draggable);if(!v||ce(t,o,this)&&!v.animated){if(v===ut)return A(!1);if(v&&a===t.target&&(s=v),s&&(n=L(s)),!1!==ie(ft,a,ut,e,s,n,t,!!s))return R(),a.appendChild(ut),ht=a,N(),A(!0)}else if(v&&se(t,o,this)){var m=V(a,0,c,!0);if(m===ut)return A(!1);if(s=m,n=L(s),!1!==ie(ft,a,ut,e,s,n,t,!1))return R(),a.insertBefore(ut,m),ht=a,N(),A(!0)}else if(s.parentNode===a){n=L(s);var b,y,S=0,w=ut.parentNode!==a,E=!$t(ut.animated&&ut.toRect||e,s.animated&&s.toRect||n,o),C=o?"top":"left",x=B(s,"top","top")||B(ut,"top","top"),O=x?x.scrollTop:void 0;if(jt!==s&&(b=n[C],Bt=!1,Vt=!E&&c.invertSwap||w),S=le(t,s,n,o,E?1:c.swapThreshold,null==c.invertedSwapThreshold?c.swapThreshold:c.invertedSwapThreshold,Vt,jt===s),0!==S){var _=U(ut);do{_-=S,y=ht.children[_]}while(y&&("none"===D(y,"display")||y===dt))}if(0===S||y===s)return A(!1);jt=s,Mt=S;var T=s.nextElementSibling,k=!1;k=1===S;var P=ie(ft,a,ut,e,s,n,t,k);if(!1!==P)return 1!==P&&-1!==P||(k=1===P),Ut=!0,setTimeout(ae,30),R(),k&&!T?a.appendChild(ut):s.parentNode.insertBefore(ut,k?T:s),x&&$(x,0,O-x.scrollTop),ht=ut.parentNode,void 0===b||Vt||(Dt=Math.abs(b-L(s)[C])),N(),A(!0)}if(a.contains(ut))return A(!1)}return!1}function j(c,l){ct(c,p,i({evt:t,isOwner:h,axis:o?"vertical":"horizontal",revert:r,dragRect:e,targetRect:n,canSort:d,fromSortable:f,target:s,completed:A,onMove:function(n,r){return ie(ft,a,ut,e,n,L(n),t,r)},changed:N},l))}function R(){j("dragOverAnimationCapture"),p.captureAnimationState(),p!==f&&f.captureAnimationState()}function A(e){return j("dragOverCompleted",{insertion:e}),e&&(h?u._hideClone():u._showClone(p),p!==f&&(M(ut,Ct?Ct.options.ghostClass:u.options.ghostClass,!1),M(ut,c.ghostClass,!0)),Ct!==p&&p!==ne.active?Ct=p:p===ne.active&&Ct&&(Ct=null),f===p&&(p._ignoreWhileAnimating=s),p.animateAll((function(){j("dragOverAnimationComplete"),p._ignoreWhileAnimating=null})),p!==f&&(f.animateAll(),f._ignoreWhileAnimating=null)),(s===ut&&!ut.animated||s===a&&!s.animated)&&(jt=null),c.dragoverBubble||t.rootEl||s===document||(ut.parentNode[Q]._isOutsideThisEl(t.target),!e&&te(t)),!c.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),g=!0}function N(){yt=U(ut),wt=U(ut,c.draggable),lt({sortable:p,name:"change",toEl:a,newIndex:yt,newDraggableIndex:wt,originalEvent:t})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){_(document,"mousemove",this._onTouchMove),_(document,"touchmove",this._onTouchMove),_(document,"pointermove",this._onTouchMove),_(document,"dragover",te),_(document,"mousemove",te),_(document,"touchmove",te)},_offUpEvents:function(){var t=this.el.ownerDocument;_(t,"mouseup",this._onDrop),_(t,"touchend",this._onDrop),_(t,"pointerup",this._onDrop),_(t,"touchcancel",this._onDrop),_(document,"selectstart",this)},_onDrop:function(t){var e=this.el,n=this.options;yt=U(ut),wt=U(ut,n.draggable),ct("drop",this,{evt:t}),ht=ut&&ut.parentNode,yt=U(ut),wt=U(ut,n.draggable),ne.eventCanceled||(At=!1,Vt=!1,Bt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),pe(this.cloneId),pe(this._dragStartId),this.nativeDraggable&&(_(document,"drop",this),_(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),w&&D(document.body,"user-select",""),D(ut,"transform",""),t&&(Pt&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),dt&&dt.parentNode&&dt.parentNode.removeChild(dt),(ft===ht||Ct&&"clone"!==Ct.lastPutMode)&&vt&&vt.parentNode&&vt.parentNode.removeChild(vt),ut&&(this.nativeDraggable&&_(ut,"dragend",this),oe(ut),ut.style["will-change"]="",Pt&&!At&&M(ut,Ct?Ct.options.ghostClass:this.options.ghostClass,!1),M(ut,this.options.chosenClass,!1),lt({sortable:this,name:"unchoose",toEl:ht,newIndex:null,newDraggableIndex:null,originalEvent:t}),ft!==ht?(yt>=0&&(lt({rootEl:ht,name:"add",toEl:ht,fromEl:ft,originalEvent:t}),lt({sortable:this,name:"remove",toEl:ht,originalEvent:t}),lt({rootEl:ht,name:"sort",toEl:ht,fromEl:ft,originalEvent:t}),lt({sortable:this,name:"sort",toEl:ht,originalEvent:t})),Ct&&Ct.save()):yt!==bt&&yt>=0&&(lt({sortable:this,name:"update",toEl:ht,originalEvent:t}),lt({sortable:this,name:"sort",toEl:ht,originalEvent:t})),ne.active&&(null!=yt&&-1!==yt||(yt=bt,wt=St),lt({sortable:this,name:"end",toEl:ht,originalEvent:t}),this.save())))),this._nulling()},_nulling:function(){ct("nulling",this),ft=ut=ht=dt=pt=vt=gt=mt=xt=Ot=Pt=yt=wt=bt=St=jt=Mt=Ct=Et=ne.dragged=ne.ghost=ne.clone=ne.active=null,Wt.forEach((function(t){t.checked=!0})),Wt.length=_t=Tt=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":ut&&(this._onDragOver(t),re(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t,e=[],n=this.el.children,r=0,i=n.length,o=this.options;r<i;r++)t=n[r],I(t,o.draggable,this.el,!1)&&e.push(t.getAttribute(o.dataIdAttr)||he(t));return e},sort:function(t,e){var n={},r=this.el;this.toArray().forEach((function(t,e){var i=r.children[e];I(i,this.options.draggable,r,!1)&&(n[t]=i)}),this),e&&this.captureAnimationState(),t.forEach((function(t){n[t]&&(r.removeChild(n[t]),r.appendChild(n[t]))})),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return I(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var n=this.options;if(void 0===e)return n[t];var r=ot.modifyOption(this,t,e);n[t]="undefined"!==typeof r?r:e,"group"===t&&Kt(n)},destroy:function(){ct("destroy",this);var t=this.el;t[Q]=null,_(t,"mousedown",this._onTapStart),_(t,"touchstart",this._onTapStart),_(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(_(t,"dragover",this),_(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),(function(t){t.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Lt.splice(Lt.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!mt){if(ct("hideClone",this),ne.eventCanceled)return;D(vt,"display","none"),this.options.removeCloneOnHide&&vt.parentNode&&vt.parentNode.removeChild(vt),mt=!0}},_showClone:function(t){if("clone"===t.lastPutMode){if(mt){if(ct("showClone",this),ne.eventCanceled)return;ut.parentNode!=ft||this.options.group.revertClone?pt?ft.insertBefore(vt,pt):ft.appendChild(vt):ft.insertBefore(vt,ut),this.options.group.revertClone&&this.animate(ut,vt),D(vt,"display",""),mt=!1}}else this._hideClone()}},zt&&O(document,"touchmove",(function(t){(ne.active||At)&&t.cancelable&&t.preventDefault()})),ne.utils={on:O,off:_,css:D,find:A,is:function(t,e){return!!I(t,e,t,!1)},extend:H,throttle:X,closest:I,toggleClass:M,clone:J,index:U,nextTick:fe,cancelNextTick:pe,detectDirection:qt,getChild:V},ne.get=function(t){return t[Q]},ne.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach((function(t){if(!t.prototype||!t.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t));t.utils&&(ne.utils=i(i({},ne.utils),t.utils)),ot.mount(t)}))},ne.create=function(t,e){return new ne(t,e)},ne.version=v;var ge,ve,me,be,ye,Se,we=[],Ee=!1;function Ce(){function t(){for(var t in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===t.charAt(0)&&"function"===typeof this[t]&&(this[t]=this[t].bind(this))}return t.prototype={dragStarted:function(t){var e=t.originalEvent;this.sortable.nativeDraggable?O(document,"dragover",this._handleAutoScroll):this.options.supportPointer?O(document,"pointermove",this._handleFallbackAutoScroll):e.touches?O(document,"touchmove",this._handleFallbackAutoScroll):O(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var e=t.originalEvent;this.options.dragOverBubble||e.rootEl||this._handleAutoScroll(e)},drop:function(){this.sortable.nativeDraggable?_(document,"dragover",this._handleAutoScroll):(_(document,"pointermove",this._handleFallbackAutoScroll),_(document,"touchmove",this._handleFallbackAutoScroll),_(document,"mousemove",this._handleFallbackAutoScroll)),Oe(),xe(),q()},nulling:function(){ye=ve=ge=Ee=Se=me=be=null,we.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,e){var n=this,r=(t.touches?t.touches[0]:t).clientX,i=(t.touches?t.touches[0]:t).clientY,o=document.elementFromPoint(r,i);if(ye=t,e||this.options.forceAutoScrollFallback||y||b||w){Te(t,this.options,o,e);var a=G(o,!0);!Ee||Se&&r===me&&i===be||(Se&&Oe(),Se=setInterval((function(){var o=G(document.elementFromPoint(r,i),!0);o!==a&&(a=o,xe()),Te(t,n.options,o,e)}),10),me=r,be=i)}else{if(!this.options.bubbleScroll||G(o,!0)===N())return void xe();Te(t,this.options,G(o,!1),!1)}}},s(t,{pluginName:"scroll",initializeByDefault:!0})}function xe(){we.forEach((function(t){clearInterval(t.pid)})),we=[]}function Oe(){clearInterval(Se)}var _e,Te=X((function(t,e,n,r){if(e.scroll){var i,o=(t.touches?t.touches[0]:t).clientX,a=(t.touches?t.touches[0]:t).clientY,s=e.scrollSensitivity,c=e.scrollSpeed,l=N(),u=!1;ve!==n&&(ve=n,xe(),ge=e.scroll,i=e.scrollFn,!0===ge&&(ge=G(n,!0)));var h=0,d=ge;do{var f=d,p=L(f),g=p.top,v=p.bottom,m=p.left,b=p.right,y=p.width,S=p.height,w=void 0,E=void 0,C=f.scrollWidth,x=f.scrollHeight,O=D(f),_=f.scrollLeft,T=f.scrollTop;f===l?(w=y<C&&("auto"===O.overflowX||"scroll"===O.overflowX||"visible"===O.overflowX),E=S<x&&("auto"===O.overflowY||"scroll"===O.overflowY||"visible"===O.overflowY)):(w=y<C&&("auto"===O.overflowX||"scroll"===O.overflowX),E=S<x&&("auto"===O.overflowY||"scroll"===O.overflowY));var k=w&&(Math.abs(b-o)<=s&&_+y<C)-(Math.abs(m-o)<=s&&!!_),I=E&&(Math.abs(v-a)<=s&&T+S<x)-(Math.abs(g-a)<=s&&!!T);if(!we[h])for(var P=0;P<=h;P++)we[P]||(we[P]={});we[h].vx==k&&we[h].vy==I&&we[h].el===f||(we[h].el=f,we[h].vx=k,we[h].vy=I,clearInterval(we[h].pid),0==k&&0==I||(u=!0,we[h].pid=setInterval(function(){r&&0===this.layer&&ne.active._onTouchMove(ye);var e=we[this.layer].vy?we[this.layer].vy*c:0,n=we[this.layer].vx?we[this.layer].vx*c:0;"function"===typeof i&&"continue"!==i.call(ne.dragged.parentNode[Q],n,e,t,ye,we[this.layer].el)||$(we[this.layer].el,n,e)}.bind({layer:h}),24))),h++}while(e.bubbleScroll&&d!==l&&(d=G(d,!1)));Ee=u}}),30),ke=function(t){var e=t.originalEvent,n=t.putSortable,r=t.dragEl,i=t.activeSortable,o=t.dispatchSortableEvent,a=t.hideGhostForTarget,s=t.unhideGhostForTarget;if(e){var c=n||i;a();var l=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,u=document.elementFromPoint(l.clientX,l.clientY);s(),c&&!c.el.contains(u)&&(o("spill"),this.onSpill({dragEl:r,putSortable:n}))}};function Ie(){}function Pe(){}function je(){function t(){this.defaults={swapClass:"sortable-swap-highlight"}}return t.prototype={dragStart:function(t){var e=t.dragEl;_e=e},dragOverValid:function(t){var e=t.completed,n=t.target,r=t.onMove,i=t.activeSortable,o=t.changed,a=t.cancel;if(i.options.swap){var s=this.sortable.el,c=this.options;if(n&&n!==s){var l=_e;!1!==r(n)?(M(n,c.swapClass,!0),_e=n):_e=null,l&&l!==_e&&M(l,c.swapClass,!1)}o(),e(!0),a()}},drop:function(t){var e=t.activeSortable,n=t.putSortable,r=t.dragEl,i=n||this.sortable,o=this.options;_e&&M(_e,o.swapClass,!1),_e&&(o.swap||n&&n.options.swap)&&r!==_e&&(i.captureAnimationState(),i!==e&&e.captureAnimationState(),Me(r,_e),i.animateAll(),i!==e&&e.animateAll())},nulling:function(){_e=null}},s(t,{pluginName:"swap",eventProperties:function(){return{swapItem:_e}}})}function Me(t,e){var n,r,i=t.parentNode,o=e.parentNode;i&&o&&!i.isEqualNode(e)&&!o.isEqualNode(t)&&(n=U(t),r=U(e),i.isEqualNode(o)&&n<r&&r++,i.insertBefore(e,i.children[n]),o.insertBefore(t,o.children[r]))}Ie.prototype={startIndex:null,dragStart:function(t){var e=t.oldDraggableIndex;this.startIndex=e},onSpill:function(t){var e=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var r=V(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(e,r):this.sortable.el.appendChild(e),this.sortable.animateAll(),n&&n.animateAll()},drop:ke},s(Ie,{pluginName:"revertOnSpill"}),Pe.prototype={onSpill:function(t){var e=t.dragEl,n=t.putSortable,r=n||this.sortable;r.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),r.animateAll()},drop:ke},s(Pe,{pluginName:"removeOnSpill"});var De,Re,Ae,Ne,Le,Be=[],Ve=[],Fe=!1,Ue=!1,We=!1;function ze(){function t(t){for(var e in this)"_"===e.charAt(0)&&"function"===typeof this[e]&&(this[e]=this[e].bind(this));t.options.supportPointer?O(document,"pointerup",this._deselectMultiDrag):(O(document,"mouseup",this._deselectMultiDrag),O(document,"touchend",this._deselectMultiDrag)),O(document,"keydown",this._checkKeyDown),O(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(e,n){var r="";Be.length&&Re===t?Be.forEach((function(t,e){r+=(e?", ":"")+t.textContent})):r=n.textContent,e.setData("Text",r)}}}return t.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(t){var e=t.dragEl;Ae=e},delayEnded:function(){this.isMultiDrag=~Be.indexOf(Ae)},setupClone:function(t){var e=t.sortable,n=t.cancel;if(this.isMultiDrag){for(var r=0;r<Be.length;r++)Ve.push(J(Be[r])),Ve[r].sortableIndex=Be[r].sortableIndex,Ve[r].draggable=!1,Ve[r].style["will-change"]="",M(Ve[r],this.options.selectedClass,!1),Be[r]===Ae&&M(Ve[r],this.options.chosenClass,!1);e._hideClone(),n()}},clone:function(t){var e=t.sortable,n=t.rootEl,r=t.dispatchSortableEvent,i=t.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||Be.length&&Re===e&&(He(!0,n),r("clone"),i()))},showClone:function(t){var e=t.cloneNowShown,n=t.rootEl,r=t.cancel;this.isMultiDrag&&(He(!1,n),Ve.forEach((function(t){D(t,"display","")})),e(),Le=!1,r())},hideClone:function(t){var e=this,n=(t.sortable,t.cloneNowHidden),r=t.cancel;this.isMultiDrag&&(Ve.forEach((function(t){D(t,"display","none"),e.options.removeCloneOnHide&&t.parentNode&&t.parentNode.removeChild(t)})),n(),Le=!0,r())},dragStartGlobal:function(t){t.sortable;!this.isMultiDrag&&Re&&Re.multiDrag._deselectMultiDrag(),Be.forEach((function(t){t.sortableIndex=U(t)})),Be=Be.sort((function(t,e){return t.sortableIndex-e.sortableIndex})),We=!0},dragStarted:function(t){var e=this,n=t.sortable;if(this.isMultiDrag){if(this.options.sort&&(n.captureAnimationState(),this.options.animation)){Be.forEach((function(t){t!==Ae&&D(t,"position","absolute")}));var r=L(Ae,!1,!0,!0);Be.forEach((function(t){t!==Ae&&K(t,r)})),Ue=!0,Fe=!0}n.animateAll((function(){Ue=!1,Fe=!1,e.options.animation&&Be.forEach((function(t){Z(t)})),e.options.sort&&Ye()}))}},dragOver:function(t){var e=t.target,n=t.completed,r=t.cancel;Ue&&~Be.indexOf(e)&&(n(!1),r())},revert:function(t){var e=t.fromSortable,n=t.rootEl,r=t.sortable,i=t.dragRect;Be.length>1&&(Be.forEach((function(t){r.addAnimationState({target:t,rect:Ue?L(t):i}),Z(t),t.fromRect=i,e.removeAnimationState(t)})),Ue=!1,Ge(!this.options.removeCloneOnHide,n))},dragOverCompleted:function(t){var e=t.sortable,n=t.isOwner,r=t.insertion,i=t.activeSortable,o=t.parentEl,a=t.putSortable,s=this.options;if(r){if(n&&i._hideClone(),Fe=!1,s.animation&&Be.length>1&&(Ue||!n&&!i.options.sort&&!a)){var c=L(Ae,!1,!0,!0);Be.forEach((function(t){t!==Ae&&(K(t,c),o.appendChild(t))})),Ue=!0}if(!n)if(Ue||Ye(),Be.length>1){var l=Le;i._showClone(e),i.options.animation&&!Le&&l&&Ve.forEach((function(t){i.addAnimationState({target:t,rect:Ne}),t.fromRect=Ne,t.thisAnimationDuration=null}))}else i._showClone(e)}},dragOverAnimationCapture:function(t){var e=t.dragRect,n=t.isOwner,r=t.activeSortable;if(Be.forEach((function(t){t.thisAnimationDuration=null})),r.options.animation&&!n&&r.multiDrag.isMultiDrag){Ne=s({},e);var i=R(Ae,!0);Ne.top-=i.f,Ne.left-=i.e}},dragOverAnimationComplete:function(){Ue&&(Ue=!1,Ye())},drop:function(t){var e=t.originalEvent,n=t.rootEl,r=t.parentEl,i=t.sortable,o=t.dispatchSortableEvent,a=t.oldIndex,s=t.putSortable,c=s||this.sortable;if(e){var l=this.options,u=r.children;if(!We)if(l.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),M(Ae,l.selectedClass,!~Be.indexOf(Ae)),~Be.indexOf(Ae))Be.splice(Be.indexOf(Ae),1),De=null,at({sortable:i,rootEl:n,name:"deselect",targetEl:Ae,originalEvt:e});else{if(Be.push(Ae),at({sortable:i,rootEl:n,name:"select",targetEl:Ae,originalEvt:e}),e.shiftKey&&De&&i.el.contains(De)){var h,d,f=U(De),p=U(Ae);if(~f&&~p&&f!==p)for(p>f?(d=f,h=p):(d=p,h=f+1);d<h;d++)~Be.indexOf(u[d])||(M(u[d],l.selectedClass,!0),Be.push(u[d]),at({sortable:i,rootEl:n,name:"select",targetEl:u[d],originalEvt:e}))}else De=Ae;Re=c}if(We&&this.isMultiDrag){if(Ue=!1,(r[Q].options.sort||r!==n)&&Be.length>1){var g=L(Ae),v=U(Ae,":not(."+this.options.selectedClass+")");if(!Fe&&l.animation&&(Ae.thisAnimationDuration=null),c.captureAnimationState(),!Fe&&(l.animation&&(Ae.fromRect=g,Be.forEach((function(t){if(t.thisAnimationDuration=null,t!==Ae){var e=Ue?L(t):g;t.fromRect=e,c.addAnimationState({target:t,rect:e})}}))),Ye(),Be.forEach((function(t){u[v]?r.insertBefore(t,u[v]):r.appendChild(t),v++})),a===U(Ae))){var m=!1;Be.forEach((function(t){t.sortableIndex===U(t)||(m=!0)})),m&&o("update")}Be.forEach((function(t){Z(t)})),c.animateAll()}Re=c}(n===r||s&&"clone"!==s.lastPutMode)&&Ve.forEach((function(t){t.parentNode&&t.parentNode.removeChild(t)}))}},nullingGlobal:function(){this.isMultiDrag=We=!1,Ve.length=0},destroyGlobal:function(){this._deselectMultiDrag(),_(document,"pointerup",this._deselectMultiDrag),_(document,"mouseup",this._deselectMultiDrag),_(document,"touchend",this._deselectMultiDrag),_(document,"keydown",this._checkKeyDown),_(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(t){if(("undefined"===typeof We||!We)&&Re===this.sortable&&(!t||!I(t.target,this.options.draggable,this.sortable.el,!1))&&(!t||0===t.button))while(Be.length){var e=Be[0];M(e,this.options.selectedClass,!1),Be.shift(),at({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:e,originalEvt:t})}},_checkKeyDown:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},s(t,{pluginName:"multiDrag",utils:{select:function(t){var e=t.parentNode[Q];e&&e.options.multiDrag&&!~Be.indexOf(t)&&(Re&&Re!==e&&(Re.multiDrag._deselectMultiDrag(),Re=e),M(t,e.options.selectedClass,!0),Be.push(t))},deselect:function(t){var e=t.parentNode[Q],n=Be.indexOf(t);e&&e.options.multiDrag&&~n&&(M(t,e.options.selectedClass,!1),Be.splice(n,1))}},eventProperties:function(){var t=this,e=[],n=[];return Be.forEach((function(r){var i;e.push({multiDragElement:r,index:r.sortableIndex}),i=Ue&&r!==Ae?-1:Ue?U(r,":not(."+t.options.selectedClass+")"):U(r),n.push({multiDragElement:r,index:i})})),{items:u(Be),clones:[].concat(Ve),oldIndicies:e,newIndicies:n}},optionListeners:{multiDragKey:function(t){return t=t.toLowerCase(),"ctrl"===t?t="Control":t.length>1&&(t=t.charAt(0).toUpperCase()+t.substr(1)),t}}})}function Ge(t,e){Be.forEach((function(n,r){var i=e.children[n.sortableIndex+(t?Number(r):0)];i?e.insertBefore(n,i):e.appendChild(n)}))}function He(t,e){Ve.forEach((function(n,r){var i=e.children[n.sortableIndex+(t?Number(r):0)];i?e.insertBefore(n,i):e.appendChild(n)}))}function Ye(){Be.forEach((function(t){t!==Ae&&t.parentNode&&t.parentNode.removeChild(t)}))}ne.mount(new Ce),ne.mount(Pe,Ie),e["default"]=ne},ab13:function(t,e,n){var r=n("b622"),i=r("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,"/./"[t](e)}catch(r){}}return!1}},ab36:function(t,e,n){var r=n("861d"),i=n("9112");t.exports=function(t,e){r(e)&&"cause"in e&&i(t,"cause",e.cause)}},ab9d:function(t,e,n){},ad42:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.RecordingEvent=void 0;var i=n("8733"),o=function(t){function e(e,n,r,i,o){var a=t.call(this,!1,e,n)||this;return a.id=r,i!==r&&(a.name=i),a.reason=o,a}return r(e,t),e.prototype.callDefaultBehavior=function(){},e}(i.Event);e.RecordingEvent=o},ada0:function(t,e,n){"use strict";var r=n("3fb5"),i=n("97a2");function o(){i.call(this)}r(o,i),o.prototype.removeAllListeners=function(t){t?delete this._listeners[t]:this._listeners={}},o.prototype.once=function(t,e){var n=this,r=!1;function i(){n.removeListener(t,i),r||(r=!0,e.apply(this,arguments))}this.on(t,i)},o.prototype.emit=function(){var t=arguments[0],e=this._listeners[t];if(e){for(var n=arguments.length,r=new Array(n-1),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=0;o<e.length;o++)e[o].apply(this,r)}},o.prototype.on=o.prototype.addListener=i.prototype.addEventListener,o.prototype.removeListener=i.prototype.removeEventListener,t.exports.EventEmitter=o},af03:function(t,e,n){var r=n("d039");t.exports=function(t){return r((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}},af24:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Connection=void 0;var r=n("0cf2"),i=n("f66e"),o=n("e9cb"),a=i.OpenViduLogger.getInstance(),s=function(){function t(t,e){this.session=t,this.disposed=!1;var n="'Connection' created ";e.role?(this.localOptions=e,this.connectionId=this.localOptions.id,this.creationTime=this.localOptions.createdAt,this.data=this.localOptions.metadata,this.rpcSessionId=this.localOptions.sessionId,this.role=this.localOptions.role,this.record=this.localOptions.record,n+="(local)"):(this.remoteOptions=e,this.connectionId=this.remoteOptions.id,this.creationTime=this.remoteOptions.createdAt,this.remoteOptions.metadata&&(this.data=this.remoteOptions.metadata),this.remoteOptions.streams&&this.initRemoteStreams(this.remoteOptions.streams),n+="(remote) with 'connectionId' ["+this.remoteOptions.id+"]"),a.info(n)}return t.prototype.sendIceCandidate=function(t){var e=this;a.debug((this.stream.outboundStreamOpts?"Local":"Remote")+"candidate for"+this.connectionId,t),this.session.openvidu.sendRequest("onIceCandidate",{endpointName:this.connectionId,candidate:t.candidate,sdpMid:t.sdpMid,sdpMLineIndex:t.sdpMLineIndex},(function(t,n){t&&(a.error("Error sending ICE candidate: "+JSON.stringify(t)),e.session.emitEvent("exception",[new o.ExceptionEvent(e.session,o.ExceptionEventName.ICE_CANDIDATE_ERROR,e.session,"There was an unexpected error on the server-side processing an ICE candidate generated and sent by the client-side",t)]))}))},t.prototype.initRemoteStreams=function(t){var e=this;t.forEach((function(t){var n={id:t.id,createdAt:t.createdAt,connection:e,hasAudio:t.hasAudio,hasVideo:t.hasVideo,audioActive:t.audioActive,videoActive:t.videoActive,typeOfVideo:t.typeOfVideo,frameRate:t.frameRate,videoDimensions:t.videoDimensions?JSON.parse(t.videoDimensions):void 0,filter:t.filter?t.filter:void 0},i=new r.Stream(e.session,n);e.addStream(i)})),a.info("Remote 'Connection' with 'connectionId' ["+this.connectionId+"] is now configured for receiving Streams with options: ",this.stream.inboundStreamOpts)},t.prototype.addStream=function(t){t.connection=this,this.stream=t},t.prototype.removeStream=function(t){delete this.stream},t.prototype.dispose=function(){this.stream&&delete this.stream,this.disposed=!0},t}();e.Connection=s},af7f:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s}));var r=n("20a4");function i(t,...e){return e.reduce((e,n)=>(t.hasOwnProperty(n)&&(e[n]=t[n]),e),{})}const o=setTimeout,a=clearTimeout;function s(t,e){e.useNativeTimers?(t.setTimeoutFn=o.bind(r["a"]),t.clearTimeoutFn=a.bind(r["a"])):(t.setTimeoutFn=setTimeout.bind(r["a"]),t.clearTimeoutFn=clearTimeout.bind(r["a"]))}},b0c0:function(t,e,n){var r=n("83ab"),i=n("5e77").EXISTS,o=n("e330"),a=n("9bf2").f,s=Function.prototype,c=o(s.toString),l=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=o(l.exec),h="name";r&&!i&&a(s,h,{configurable:!0,get:function(){try{return u(l,c(this))[1]}catch(t){return""}}})},b14c:function(t,e,n){},b14f:function(t,e,n){"use strict";n("e20c")},b185:function(t,e,n){"use strict";var r=n("3fb5"),i=n("7577"),o=n("1548"),a=n("9d7d");function s(t){if(!a.enabled)throw new Error("Transport created when disabled");i.call(this,t,"/xhr_streaming",o,a)}r(s,i),s.enabled=function(t){return!t.cookie_needed&&!t.nullOrigin&&(a.enabled&&t.sameScheme)},s.transportName="xdr-streaming",s.roundTrips=2,t.exports=s},b19d:function(t,e){function n(t){if(t)return r(t)}function r(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}e.Emitter=n,n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},n.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){n=n.slice(0);r=0;for(var i=n.length;r<i;++r)n[r].apply(this,e)}return this},n.prototype.emitReserved=n.prototype.emit,n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},b24f:function(t,e,n){},b2e1:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.SignalEvent=void 0;var i=n("8733"),o=function(t){function e(e,n,r,i){var o=t.call(this,!1,e,"signal")||this;return n&&(o.type="signal:"+n),o.data=r,o.from=i,o}return r(e,t),e.prototype.callDefaultBehavior=function(){},e}(i.Event);e.SignalEvent=o},b489:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LocalRecorder=void 0;var r,i=n("627d"),o=n("f66e"),a=n("e237"),s=o.OpenViduLogger.getInstance(),c=function(){function t(t){this.stream=t,this.chunks=[],r=a.PlatformUtils.getInstance(),this.connectionId=this.stream.connection?this.stream.connection.connectionId:"default-connection",this.id=this.stream.streamId+"_"+this.connectionId+"_localrecord",this.state=i.LocalRecorderState.READY}return t.prototype.record=function(t){var e=this;return new Promise((function(n,r){try{if("undefined"===typeof MediaRecorder)throw s.error("MediaRecorder not supported on your browser. See compatibility in https://caniuse.com/#search=MediaRecorder"),Error("MediaRecorder not supported on your browser. See compatibility in https://caniuse.com/#search=MediaRecorder");if(e.state!==i.LocalRecorderState.READY)throw Error("'LocalRecord.record()' needs 'LocalRecord.state' to be 'READY' (current value: '"+e.state+"'). Call 'LocalRecorder.clean()' or init a new LocalRecorder before");s.log("Starting local recording of stream '"+e.stream.streamId+"' of connection '"+e.connectionId+"'");var o={};"function"===typeof MediaRecorder.isTypeSupported?t?(MediaRecorder.isTypeSupported(t)||r(new Error('mimeType "'+t+'" is not supported')),o={mimeType:t}):s.log("No mimeType parameter provided. Using default codecs"):s.warn("MediaRecorder#isTypeSupported is not supported. Using default codecs"),e.mediaRecorder=new MediaRecorder(e.stream.getMediaStream(),o),e.mediaRecorder.start(10)}catch(a){r(a)}e.mediaRecorder.ondataavailable=function(t){e.chunks.push(t.data)},e.mediaRecorder.onerror=function(t){s.error("MediaRecorder error: ",t)},e.mediaRecorder.onstart=function(){s.log("MediaRecorder started (state="+e.mediaRecorder.state+")")},e.mediaRecorder.onstop=function(){e.onStopDefault()},e.mediaRecorder.onpause=function(){s.log("MediaRecorder paused (state="+e.mediaRecorder.state+")")},e.mediaRecorder.onresume=function(){s.log("MediaRecorder resumed (state="+e.mediaRecorder.state+")")},e.mediaRecorder.onwarning=function(t){s.log("MediaRecorder warning: "+t)},e.state=i.LocalRecorderState.RECORDING,n()}))},t.prototype.stop=function(){var t=this;return new Promise((function(e,n){try{if(t.state===i.LocalRecorderState.READY||t.state===i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.stop()' needs 'LocalRecord.state' to be 'RECORDING' or 'PAUSED' (current value: '"+t.state+"'). Call 'LocalRecorder.start()' before");t.mediaRecorder.onstop=function(){t.onStopDefault(),e()},t.mediaRecorder.stop()}catch(r){n(r)}}))},t.prototype.pause=function(){var t=this;return new Promise((function(e,n){try{t.state!==i.LocalRecorderState.RECORDING&&n(Error("'LocalRecord.pause()' needs 'LocalRecord.state' to be 'RECORDING' (current value: '"+t.state+"'). Call 'LocalRecorder.start()' or 'LocalRecorder.resume()' before")),t.mediaRecorder.pause(),t.state=i.LocalRecorderState.PAUSED,e()}catch(r){n(r)}}))},t.prototype.resume=function(){var t=this;return new Promise((function(e,n){try{if(t.state!==i.LocalRecorderState.PAUSED)throw Error("'LocalRecord.resume()' needs 'LocalRecord.state' to be 'PAUSED' (current value: '"+t.state+"'). Call 'LocalRecorder.pause()' before");t.mediaRecorder.resume(),t.state=i.LocalRecorderState.RECORDING,e()}catch(r){n(r)}}))},t.prototype.preview=function(t){if(this.state!==i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.preview()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");if(this.videoPreview=document.createElement("video"),this.videoPreview.id=this.id,this.videoPreview.autoplay=!0,r.isSafariBrowser()&&this.videoPreview.setAttribute("playsinline","true"),"string"===typeof t){var e=document.getElementById(t);e&&(this.videoPreview=e.appendChild(this.videoPreview))}else this.videoPreview=t.appendChild(this.videoPreview);return this.videoPreview.src=this.videoPreviewSrc,this.videoPreview},t.prototype.clean=function(){var t=this,e=function(){delete t.blob,t.chunks=[],delete t.mediaRecorder,t.state=i.LocalRecorderState.READY};this.state===i.LocalRecorderState.RECORDING||this.state===i.LocalRecorderState.PAUSED?this.stop().then((function(){return e()})).catch((function(){return e()})):e()},t.prototype.download=function(){if(this.state!==i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.download()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");var t=document.createElement("a");t.style.display="none",document.body.appendChild(t);var e=window.URL.createObjectURL(this.blob);t.href=e,t.download=this.id+".webm",t.click(),window.URL.revokeObjectURL(e),document.body.removeChild(t)},t.prototype.getBlob=function(){if(this.state!==i.LocalRecorderState.FINISHED)throw Error("Call 'LocalRecord.stop()' before getting Blob file");return this.blob},t.prototype.uploadAsBinary=function(t,e){var n=this;return new Promise((function(r,o){if(n.state!==i.LocalRecorderState.FINISHED)o(Error("'LocalRecord.uploadAsBinary()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+n.state+"'). Call 'LocalRecorder.stop()' before"));else{var a=new XMLHttpRequest;if(a.open("POST",t,!0),"object"===typeof e)for(var s=0,c=Object.keys(e);s<c.length;s++){var l=c[s];a.setRequestHeader(l,e[l])}a.onreadystatechange=function(){4===a.readyState&&("2"===a.status.toString().charAt(0)?r(a.responseText):o(a.status))},a.send(n.blob)}}))},t.prototype.uploadAsMultipartfile=function(t,e){var n=this;return new Promise((function(r,o){if(n.state!==i.LocalRecorderState.FINISHED)o(Error("'LocalRecord.uploadAsMultipartfile()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+n.state+"'). Call 'LocalRecorder.stop()' before"));else{var a=new XMLHttpRequest;if(a.open("POST",t,!0),"object"===typeof e)for(var s=0,c=Object.keys(e);s<c.length;s++){var l=c[s];a.setRequestHeader(l,e[l])}var u=new FormData;u.append("file",n.blob,n.id+".webm"),a.onreadystatechange=function(){4===a.readyState&&("2"===a.status.toString().charAt(0)?r(a.responseText):o(a.status))},a.send(u)}}))},t.prototype.onStopDefault=function(){s.log("MediaRecorder stopped  (state="+this.mediaRecorder.state+")"),this.blob=new Blob(this.chunks,{type:"video/webm"}),this.chunks=[],this.videoPreviewSrc=window.URL.createObjectURL(this.blob),this.state=i.LocalRecorderState.FINISHED},t}();e.LocalRecorder=c},b639:function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n("1fb5"),i=n("9152"),o=n("e3db");function a(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"===typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(e){return!1}}function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function c(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=l.prototype):(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,n){if(!l.TYPED_ARRAY_SUPPORT&&!(this instanceof l))return new l(t,e,n);if("number"===typeof t){if("string"===typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return u(this,t,e,n)}function u(t,e,n,r){if("number"===typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer?v(t,e,n,r):"string"===typeof e?p(t,e,n):m(t,e)}function h(t){if("number"!==typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function d(t,e,n,r){return h(e),e<=0?c(t,e):void 0!==n?"string"===typeof r?c(t,e).fill(n,r):c(t,e).fill(n):c(t,e)}function f(t,e){if(h(e),t=c(t,e<0?0:0|b(e)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function p(t,e,n){if("string"===typeof n&&""!==n||(n="utf8"),!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|S(e,n);t=c(t,r);var i=t.write(e,n);return i!==r&&(t=t.slice(0,i)),t}function g(t,e){var n=e.length<0?0:0|b(e.length);t=c(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function v(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),l.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=l.prototype):t=g(t,e),t}function m(t,e){if(l.isBuffer(e)){var n=0|b(e.length);return t=c(t,n),0===t.length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!==typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!==typeof e.length||et(e.length)?c(t,0):g(t,e);if("Buffer"===e.type&&o(e.data))return g(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function b(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function y(t){return+t!=t&&(t=0),l.alloc(+t)}function S(t,e){if(l.isBuffer(t))return t.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!==typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return J(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Q(t).length;default:if(r)return J(t).length;e=(""+e).toLowerCase(),r=!0}}function w(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,e>>>=0,n<=e)return"";t||(t="utf8");while(1)switch(t){case"hex":return L(this,e,n);case"utf8":case"utf-8":return M(this,e,n);case"ascii":return A(this,e,n);case"latin1":case"binary":return N(this,e,n);case"base64":return j(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function E(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function C(t,e,n,r,i){if(0===t.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"===typeof e&&(e=l.from(e,r)),l.isBuffer(e))return 0===e.length?-1:x(t,e,n,r,i);if("number"===typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):x(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function x(t,e,n,r,i){var o,a=1,s=t.length,c=e.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,s/=2,c/=2,n/=2}function l(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var u=-1;for(o=n;o<s;o++)if(l(t,o)===l(e,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===c)return u*a}else-1!==u&&(o-=o-u),u=-1}else for(n+c>s&&(n=s-c),o=n;o>=0;o--){for(var h=!0,d=0;d<c;d++)if(l(t,o+d)!==l(e,d)){h=!1;break}if(h)return o}return-1}function O(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=e.length;if(o%2!==0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function _(t,e,n,r){return tt(J(e,t.length-n),t,n,r)}function T(t,e,n,r){return tt(K(e),t,n,r)}function k(t,e,n,r){return T(t,e,n,r)}function I(t,e,n,r){return tt(Q(e),t,n,r)}function P(t,e,n,r){return tt(Z(e,t.length-n),t,n,r)}function j(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function M(t,e,n){n=Math.min(t.length,n);var r=[],i=e;while(i<n){var o,a,s,c,l=t[i],u=null,h=l>239?4:l>223?3:l>191?2:1;if(i+h<=n)switch(h){case 1:l<128&&(u=l);break;case 2:o=t[i+1],128===(192&o)&&(c=(31&l)<<6|63&o,c>127&&(u=c));break;case 3:o=t[i+1],a=t[i+2],128===(192&o)&&128===(192&a)&&(c=(15&l)<<12|(63&o)<<6|63&a,c>2047&&(c<55296||c>57343)&&(u=c));break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128===(192&o)&&128===(192&a)&&128===(192&s)&&(c=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s,c>65535&&c<1114112&&(u=c))}null===u?(u=65533,h=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=h}return R(r)}e.Buffer=l,e.SlowBuffer=y,e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:a(),e.kMaxLength=s(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,n){return u(null,t,e,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,n){return d(null,t,e,n)},l.allocUnsafe=function(t){return f(null,t)},l.allocUnsafeSlow=function(t){return f(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=l.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},l.byteLength=S,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)E(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)E(this,e,e+3),E(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)E(this,e,e+7),E(this,e+1,e+6),E(this,e+2,e+5),E(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?M(this,0,t):w.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,n,r,i){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var o=i-r,a=n-e,s=Math.min(o,a),c=this.slice(r,i),u=t.slice(e,n),h=0;h<s;++h)if(c[h]!==u[h]){o=c[h],a=u[h];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return C(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return C(this,t,e,n,!1)},l.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"===typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return O(this,t,e,n);case"utf8":case"utf-8":return _(this,t,e,n);case"ascii":return T(this,t,e,n);case"latin1":case"binary":return k(this,t,e,n);case"base64":return I(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var D=4096;function R(t){var e=t.length;if(e<=D)return String.fromCharCode.apply(String,t);var n="",r=0;while(r<e)n+=String.fromCharCode.apply(String,t.slice(r,r+=D));return n}function A(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function N(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function L(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=$(t[o]);return i}function B(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function V(t,e,n){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function F(t,e,n,r,i,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function U(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function W(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function z(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function G(t,e,n,r,o){return o||z(t,e,n,4,34028234663852886e22,-34028234663852886e22),i.write(t,e,n,r,23,4),n+4}function H(t,e,n,r,o){return o||z(t,e,n,8,17976931348623157e292,-17976931348623157e292),i.write(t,e,n,r,52,8),n+8}l.prototype.slice=function(t,e){var n,r=this.length;if(t=~~t,e=void 0===e?r:~~e,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)n=this.subarray(t,e),n.__proto__=l.prototype;else{var i=e-t;n=new l(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},l.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||V(t,e,this.length);var r=this[t],i=1,o=0;while(++o<e&&(i*=256))r+=this[t+o]*i;return r},l.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||V(t,e,this.length);var r=this[t+--e],i=1;while(e>0&&(i*=256))r+=this[t+--e]*i;return r},l.prototype.readUInt8=function(t,e){return e||V(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||V(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||V(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||V(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||V(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||V(t,e,this.length);var r=this[t],i=1,o=0;while(++o<e&&(i*=256))r+=this[t+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*e)),r},l.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||V(t,e,this.length);var r=e,i=1,o=this[t+--r];while(r>0&&(i*=256))o+=this[t+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return e||V(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||V(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){e||V(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return e||V(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||V(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||V(t,4,this.length),i.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||V(t,4,this.length),i.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||V(t,8,this.length),i.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||V(t,8,this.length),i.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){var i=Math.pow(2,8*n)-1;F(this,t,e,n,i,0)}var o=1,a=0;this[e]=255&t;while(++a<n&&(o*=256))this[e+a]=t/o&255;return e+n},l.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){var i=Math.pow(2,8*n)-1;F(this,t,e,n,i,0)}var o=n-1,a=1;this[e+o]=255&t;while(--o>=0&&(a*=256))this[e+o]=t/a&255;return e+n},l.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):U(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):U(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):W(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):W(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);F(this,t,e,n,i-1,-i)}var o=0,a=1,s=0;this[e]=255&t;while(++o<n&&(a*=256))t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},l.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);F(this,t,e,n,i-1,-i)}var o=n-1,a=1,s=0;this[e+o]=255&t;while(--o>=0&&(a*=256))t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):U(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):U(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):W(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):W(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,n){return G(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return G(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return H(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return H(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},l.prototype.fill=function(t,e,n,r){if("string"===typeof t){if("string"===typeof e?(r=e,e=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"===typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=l.isBuffer(t)?t:J(new l(t,r).toString()),s=a.length;for(o=0;o<n-e;++o)this[o+e]=a[o%s]}return this};var Y=/[^+\/0-9A-Za-z-_]/g;function X(t){if(t=q(t).replace(Y,""),t.length<2)return"";while(t.length%4!==0)t+="=";return t}function q(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function $(t){return t<16?"0"+t.toString(16):t.toString(16)}function J(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],a=0;a<r;++a){if(n=t.charCodeAt(a),n>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function K(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function Z(t,e){for(var n,r,i,o=[],a=0;a<t.length;++a){if((e-=2)<0)break;n=t.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r)}return o}function Q(t){return r.toByteArray(X(t))}function tt(t,e,n,r){for(var i=0;i<r;++i){if(i+n>=e.length||i>=t.length)break;e[i+n]=t[i]}return i}function et(t){return t!==t}}).call(this,n("c8ba"))},b680:function(t,e,n){"use strict";var r=n("23e7"),i=n("da84"),o=n("e330"),a=n("5926"),s=n("408a"),c=n("1148"),l=n("d039"),u=i.RangeError,h=i.String,d=Math.floor,f=o(c),p=o("".slice),g=o(1..toFixed),v=function(t,e,n){return 0===e?n:e%2===1?v(t,e-1,n*t):v(t*t,e/2,n)},m=function(t){var e=0,n=t;while(n>=4096)e+=12,n/=4096;while(n>=2)e+=1,n/=2;return e},b=function(t,e,n){var r=-1,i=n;while(++r<6)i+=e*t[r],t[r]=i%1e7,i=d(i/1e7)},y=function(t,e){var n=6,r=0;while(--n>=0)r+=t[n],t[n]=d(r/e),r=r%e*1e7},S=function(t){var e=6,n="";while(--e>=0)if(""!==n||0===e||0!==t[e]){var r=h(t[e]);n=""===n?r:n+f("0",7-r.length)+r}return n},w=l((function(){return"0.000"!==g(8e-5,3)||"1"!==g(.9,0)||"1.25"!==g(1.255,2)||"1000000000000000128"!==g(0xde0b6b3a7640080,0)}))||!l((function(){g({})}));r({target:"Number",proto:!0,forced:w},{toFixed:function(t){var e,n,r,i,o=s(this),c=a(t),l=[0,0,0,0,0,0],d="",g="0";if(c<0||c>20)throw u("Incorrect fraction digits");if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return h(o);if(o<0&&(d="-",o=-o),o>1e-21)if(e=m(o*v(2,69,1))-69,n=e<0?o*v(2,-e,1):o/v(2,e,1),n*=4503599627370496,e=52-e,e>0){b(l,0,n),r=c;while(r>=7)b(l,1e7,0),r-=7;b(l,v(10,r,1),0),r=e-1;while(r>=23)y(l,1<<23),r-=23;y(l,1<<r),b(l,1,1),y(l,2),g=S(l)}else b(l,0,n),b(l,1<<-e,0),g=S(l)+f("0",c);return c>0?(i=g.length,g=d+(i<=c?"0."+f("0",c-i)+g:p(g,0,i-c)+"."+p(g,i-c))):g=d+g,g}})},b76a:function(t,e,n){(function(e,r){t.exports=r(n("7a23"),n("aa47"))})("undefined"!==typeof self&&self,(function(t,e){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="fb15")}({"00ee":function(t,e,n){var r=n("b622"),i=r("toStringTag"),o={};o[i]="z",t.exports="[object z]"===String(o)},"0366":function(t,e,n){var r=n("1c0b");t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},"057f":function(t,e,n){var r=n("fc6a"),i=n("241c").f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return i(t)}catch(e){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?s(t):i(r(t))}},"06cf":function(t,e,n){var r=n("83ab"),i=n("d1e7"),o=n("5c6c"),a=n("fc6a"),s=n("c04e"),c=n("5135"),l=n("0cfb"),u=Object.getOwnPropertyDescriptor;e.f=r?u:function(t,e){if(t=a(t),e=s(e,!0),l)try{return u(t,e)}catch(n){}if(c(t,e))return o(!i.f.call(t,e),t[e])}},"0cfb":function(t,e,n){var r=n("83ab"),i=n("d039"),o=n("cc12");t.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},"13d5":function(t,e,n){"use strict";var r=n("23e7"),i=n("d58f").left,o=n("a640"),a=n("ae40"),s=o("reduce"),c=a("reduce",{1:0});r({target:"Array",proto:!0,forced:!s||!c},{reduce:function(t){return i(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(t,e,n){var r=n("c6b6"),i=n("9263");t.exports=function(t,e){var n=t.exec;if("function"===typeof n){var o=n.call(t,e);if("object"!==typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(t))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},"159b":function(t,e,n){var r=n("da84"),i=n("fdbc"),o=n("17c2"),a=n("9112");for(var s in i){var c=r[s],l=c&&c.prototype;if(l&&l.forEach!==o)try{a(l,"forEach",o)}catch(u){l.forEach=o}}},"17c2":function(t,e,n){"use strict";var r=n("b727").forEach,i=n("a640"),o=n("ae40"),a=i("forEach"),s=o("forEach");t.exports=a&&s?[].forEach:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}},"1be4":function(t,e,n){var r=n("d066");t.exports=r("document","documentElement")},"1c0b":function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},"1c7e":function(t,e,n){var r=n("b622"),i=r("iterator"),o=!1;try{var a=0,s={next:function(){return{done:!!a++}},return:function(){o=!0}};s[i]=function(){return this},Array.from(s,(function(){throw 2}))}catch(c){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var r={};r[i]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(c){}return n}},"1d80":function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on "+t);return t}},"1dde":function(t,e,n){var r=n("d039"),i=n("b622"),o=n("2d00"),a=i("species");t.exports=function(t){return o>=51||!r((function(){var e=[],n=e.constructor={};return n[a]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},"23cb":function(t,e,n){var r=n("a691"),i=Math.max,o=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):o(n,e)}},"23e7":function(t,e,n){var r=n("da84"),i=n("06cf").f,o=n("9112"),a=n("6eeb"),s=n("ce4e"),c=n("e893"),l=n("94ca");t.exports=function(t,e){var n,u,h,d,f,p,g=t.target,v=t.global,m=t.stat;if(u=v?r:m?r[g]||s(g,{}):(r[g]||{}).prototype,u)for(h in e){if(f=e[h],t.noTargetGet?(p=i(u,h),d=p&&p.value):d=u[h],n=l(v?h:g+(m?".":"#")+h,t.forced),!n&&void 0!==d){if(typeof f===typeof d)continue;c(f,d)}(t.sham||d&&d.sham)&&o(f,"sham",!0),a(u,h,f,t)}}},"241c":function(t,e,n){var r=n("ca84"),i=n("7839"),o=i.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},"25f0":function(t,e,n){"use strict";var r=n("6eeb"),i=n("825a"),o=n("d039"),a=n("ad6d"),s="toString",c=RegExp.prototype,l=c[s],u=o((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),h=l.name!=s;(u||h)&&r(RegExp.prototype,s,(function(){var t=i(this),e=String(t.source),n=t.flags,r=String(void 0===n&&t instanceof RegExp&&!("flags"in c)?a.call(t):n);return"/"+e+"/"+r}),{unsafe:!0})},"2ca0":function(t,e,n){"use strict";var r=n("23e7"),i=n("06cf").f,o=n("50c4"),a=n("5a34"),s=n("1d80"),c=n("ab13"),l=n("c430"),u="".startsWith,h=Math.min,d=c("startsWith"),f=!l&&!d&&!!function(){var t=i(String.prototype,"startsWith");return t&&!t.writable}();r({target:"String",proto:!0,forced:!f&&!d},{startsWith:function(t){var e=String(s(this));a(t);var n=o(h(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return u?u.call(e,r,n):e.slice(n,n+r.length)===r}})},"2d00":function(t,e,n){var r,i,o=n("da84"),a=n("342f"),s=o.process,c=s&&s.versions,l=c&&c.v8;l?(r=l.split("."),i=r[0]+r[1]):a&&(r=a.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/),r&&(i=r[1]))),t.exports=i&&+i},"342f":function(t,e,n){var r=n("d066");t.exports=r("navigator","userAgent")||""},"35a1":function(t,e,n){var r=n("f5df"),i=n("3f8c"),o=n("b622"),a=o("iterator");t.exports=function(t){if(void 0!=t)return t[a]||t["@@iterator"]||i[r(t)]}},"37e8":function(t,e,n){var r=n("83ab"),i=n("9bf2"),o=n("825a"),a=n("df75");t.exports=r?Object.defineProperties:function(t,e){o(t);var n,r=a(e),s=r.length,c=0;while(s>c)i.f(t,n=r[c++],e[n]);return t}},"3bbe":function(t,e,n){var r=n("861d");t.exports=function(t){if(!r(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},"3ca3":function(t,e,n){"use strict";var r=n("6547").charAt,i=n("69f3"),o=n("7dd0"),a="String Iterator",s=i.set,c=i.getterFor(a);o(String,"String",(function(t){s(this,{type:a,string:String(t),index:0})}),(function(){var t,e=c(this),n=e.string,i=e.index;return i>=n.length?{value:void 0,done:!0}:(t=r(n,i),e.index+=t.length,{value:t,done:!1})}))},"3f8c":function(t,e){t.exports={}},4160:function(t,e,n){"use strict";var r=n("23e7"),i=n("17c2");r({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},"428f":function(t,e,n){var r=n("da84");t.exports=r},"44ad":function(t,e,n){var r=n("d039"),i=n("c6b6"),o="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?o.call(t,""):Object(t)}:Object},"44d2":function(t,e,n){var r=n("b622"),i=n("7c73"),o=n("9bf2"),a=r("unscopables"),s=Array.prototype;void 0==s[a]&&o.f(s,a,{configurable:!0,value:i(null)}),t.exports=function(t){s[a][t]=!0}},"44e7":function(t,e,n){var r=n("861d"),i=n("c6b6"),o=n("b622"),a=o("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[a])?!!e:"RegExp"==i(t))}},4930:function(t,e,n){var r=n("d039");t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},"4d64":function(t,e,n){var r=n("fc6a"),i=n("50c4"),o=n("23cb"),a=function(t){return function(e,n,a){var s,c=r(e),l=i(c.length),u=o(a,l);if(t&&n!=n){while(l>u)if(s=c[u++],s!=s)return!0}else for(;l>u;u++)if((t||u in c)&&c[u]===n)return t||u||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},"4de4":function(t,e,n){"use strict";var r=n("23e7"),i=n("b727").filter,o=n("1dde"),a=n("ae40"),s=o("filter"),c=a("filter");r({target:"Array",proto:!0,forced:!s||!c},{filter:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(t,e,n){"use strict";var r=n("0366"),i=n("7b0b"),o=n("9bdd"),a=n("e95a"),s=n("50c4"),c=n("8418"),l=n("35a1");t.exports=function(t){var e,n,u,h,d,f,p=i(t),g="function"==typeof this?this:Array,v=arguments.length,m=v>1?arguments[1]:void 0,b=void 0!==m,y=l(p),S=0;if(b&&(m=r(m,v>2?arguments[2]:void 0,2)),void 0==y||g==Array&&a(y))for(e=s(p.length),n=new g(e);e>S;S++)f=b?m(p[S],S):p[S],c(n,S,f);else for(h=y.call(p),d=h.next,n=new g;!(u=d.call(h)).done;S++)f=b?o(h,m,[u.value,S],!0):u.value,c(n,S,f);return n.length=S,n}},"4fad":function(t,e,n){var r=n("23e7"),i=n("6f53").entries;r({target:"Object",stat:!0},{entries:function(t){return i(t)}})},"50c4":function(t,e,n){var r=n("a691"),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},5135:function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},5319:function(t,e,n){"use strict";var r=n("d784"),i=n("825a"),o=n("7b0b"),a=n("50c4"),s=n("a691"),c=n("1d80"),l=n("8aa5"),u=n("14c3"),h=Math.max,d=Math.min,f=Math.floor,p=/\$([$&'`]|\d\d?|<[^>]*>)/g,g=/\$([$&'`]|\d\d?)/g,v=function(t){return void 0===t?t:String(t)};r("replace",2,(function(t,e,n,r){var m=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,b=r.REPLACE_KEEPS_$0,y=m?"$":"$0";return[function(n,r){var i=c(this),o=void 0==n?void 0:n[t];return void 0!==o?o.call(n,i,r):e.call(String(i),n,r)},function(t,r){if(!m&&b||"string"===typeof r&&-1===r.indexOf(y)){var o=n(e,t,this,r);if(o.done)return o.value}var c=i(t),f=String(this),p="function"===typeof r;p||(r=String(r));var g=c.global;if(g){var w=c.unicode;c.lastIndex=0}var E=[];while(1){var C=u(c,f);if(null===C)break;if(E.push(C),!g)break;var x=String(C[0]);""===x&&(c.lastIndex=l(f,a(c.lastIndex),w))}for(var O="",_=0,T=0;T<E.length;T++){C=E[T];for(var k=String(C[0]),I=h(d(s(C.index),f.length),0),P=[],j=1;j<C.length;j++)P.push(v(C[j]));var M=C.groups;if(p){var D=[k].concat(P,I,f);void 0!==M&&D.push(M);var R=String(r.apply(void 0,D))}else R=S(k,f,I,P,M,r);I>=_&&(O+=f.slice(_,I)+R,_=I+k.length)}return O+f.slice(_)}];function S(t,n,r,i,a,s){var c=r+t.length,l=i.length,u=g;return void 0!==a&&(a=o(a),u=p),e.call(s,u,(function(e,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return t;case"`":return n.slice(0,r);case"'":return n.slice(c);case"<":s=a[o.slice(1,-1)];break;default:var u=+o;if(0===u)return e;if(u>l){var h=f(u/10);return 0===h?e:h<=l?void 0===i[h-1]?o.charAt(1):i[h-1]+o.charAt(1):e}s=i[u-1]}return void 0===s?"":s}))}}))},5692:function(t,e,n){var r=n("c430"),i=n("c6cd");(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(t,e,n){var r=n("d066"),i=n("241c"),o=n("7418"),a=n("825a");t.exports=r("Reflect","ownKeys")||function(t){var e=i.f(a(t)),n=o.f;return n?e.concat(n(t)):e}},"5a34":function(t,e,n){var r=n("44e7");t.exports=function(t){if(r(t))throw TypeError("The method doesn't accept regular expressions");return t}},"5c6c":function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"5db7":function(t,e,n){"use strict";var r=n("23e7"),i=n("a2bf"),o=n("7b0b"),a=n("50c4"),s=n("1c0b"),c=n("65f0");r({target:"Array",proto:!0},{flatMap:function(t){var e,n=o(this),r=a(n.length);return s(t),e=c(n,0),e.length=i(e,n,n,r,0,1,t,arguments.length>1?arguments[1]:void 0),e}})},6547:function(t,e,n){var r=n("a691"),i=n("1d80"),o=function(t){return function(e,n){var o,a,s=String(i(e)),c=r(n),l=s.length;return c<0||c>=l?t?"":void 0:(o=s.charCodeAt(c),o<55296||o>56319||c+1===l||(a=s.charCodeAt(c+1))<56320||a>57343?t?s.charAt(c):o:t?s.slice(c,c+2):a-56320+(o-55296<<10)+65536)}};t.exports={codeAt:o(!1),charAt:o(!0)}},"65f0":function(t,e,n){var r=n("861d"),i=n("e8b5"),o=n("b622"),a=o("species");t.exports=function(t,e){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)?r(n)&&(n=n[a],null===n&&(n=void 0)):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},"69f3":function(t,e,n){var r,i,o,a=n("7f9a"),s=n("da84"),c=n("861d"),l=n("9112"),u=n("5135"),h=n("f772"),d=n("d012"),f=s.WeakMap,p=function(t){return o(t)?i(t):r(t,{})},g=function(t){return function(e){var n;if(!c(e)||(n=i(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}};if(a){var v=new f,m=v.get,b=v.has,y=v.set;r=function(t,e){return y.call(v,t,e),e},i=function(t){return m.call(v,t)||{}},o=function(t){return b.call(v,t)}}else{var S=h("state");d[S]=!0,r=function(t,e){return l(t,S,e),e},i=function(t){return u(t,S)?t[S]:{}},o=function(t){return u(t,S)}}t.exports={set:r,get:i,has:o,enforce:p,getterFor:g}},"6eeb":function(t,e,n){var r=n("da84"),i=n("9112"),o=n("5135"),a=n("ce4e"),s=n("8925"),c=n("69f3"),l=c.get,u=c.enforce,h=String(String).split("String");(t.exports=function(t,e,n,s){var c=!!s&&!!s.unsafe,l=!!s&&!!s.enumerable,d=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof e||o(n,"name")||i(n,"name",e),u(n).source=h.join("string"==typeof e?e:"")),t!==r?(c?!d&&t[e]&&(l=!0):delete t[e],l?t[e]=n:i(t,e,n)):l?t[e]=n:a(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||s(this)}))},"6f53":function(t,e,n){var r=n("83ab"),i=n("df75"),o=n("fc6a"),a=n("d1e7").f,s=function(t){return function(e){var n,s=o(e),c=i(s),l=c.length,u=0,h=[];while(l>u)n=c[u++],r&&!a.call(s,n)||h.push(t?[n,s[n]]:s[n]);return h}};t.exports={entries:s(!0),values:s(!1)}},"73d9":function(t,e,n){var r=n("44d2");r("flatMap")},7418:function(t,e){e.f=Object.getOwnPropertySymbols},"746f":function(t,e,n){var r=n("428f"),i=n("5135"),o=n("e538"),a=n("9bf2").f;t.exports=function(t){var e=r.Symbol||(r.Symbol={});i(e,t)||a(e,t,{value:o.f(t)})}},7839:function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(t,e,n){var r=n("1d80");t.exports=function(t){return Object(r(t))}},"7c73":function(t,e,n){var r,i=n("825a"),o=n("37e8"),a=n("7839"),s=n("d012"),c=n("1be4"),l=n("cc12"),u=n("f772"),h=">",d="<",f="prototype",p="script",g=u("IE_PROTO"),v=function(){},m=function(t){return d+p+h+t+d+"/"+p+h},b=function(t){t.write(m("")),t.close();var e=t.parentWindow.Object;return t=null,e},y=function(){var t,e=l("iframe"),n="java"+p+":";return e.style.display="none",c.appendChild(e),e.src=String(n),t=e.contentWindow.document,t.open(),t.write(m("document.F=Object")),t.close(),t.F},S=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(e){}S=r?b(r):y();var t=a.length;while(t--)delete S[f][a[t]];return S()};s[g]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(v[f]=i(t),n=new v,v[f]=null,n[g]=t):n=S(),void 0===e?n:o(n,e)}},"7dd0":function(t,e,n){"use strict";var r=n("23e7"),i=n("9ed3"),o=n("e163"),a=n("d2bb"),s=n("d44e"),c=n("9112"),l=n("6eeb"),u=n("b622"),h=n("c430"),d=n("3f8c"),f=n("ae93"),p=f.IteratorPrototype,g=f.BUGGY_SAFARI_ITERATORS,v=u("iterator"),m="keys",b="values",y="entries",S=function(){return this};t.exports=function(t,e,n,u,f,w,E){i(n,e,u);var C,x,O,_=function(t){if(t===f&&j)return j;if(!g&&t in I)return I[t];switch(t){case m:return function(){return new n(this,t)};case b:return function(){return new n(this,t)};case y:return function(){return new n(this,t)}}return function(){return new n(this)}},T=e+" Iterator",k=!1,I=t.prototype,P=I[v]||I["@@iterator"]||f&&I[f],j=!g&&P||_(f),M="Array"==e&&I.entries||P;if(M&&(C=o(M.call(new t)),p!==Object.prototype&&C.next&&(h||o(C)===p||(a?a(C,p):"function"!=typeof C[v]&&c(C,v,S)),s(C,T,!0,!0),h&&(d[T]=S))),f==b&&P&&P.name!==b&&(k=!0,j=function(){return P.call(this)}),h&&!E||I[v]===j||c(I,v,j),d[e]=j,f)if(x={values:_(b),keys:w?j:_(m),entries:_(y)},E)for(O in x)(g||k||!(O in I))&&l(I,O,x[O]);else r({target:e,proto:!0,forced:g||k},x);return x}},"7f9a":function(t,e,n){var r=n("da84"),i=n("8925"),o=r.WeakMap;t.exports="function"===typeof o&&/native code/.test(i(o))},"825a":function(t,e,n){var r=n("861d");t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},"83ab":function(t,e,n){var r=n("d039");t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},8418:function(t,e,n){"use strict";var r=n("c04e"),i=n("9bf2"),o=n("5c6c");t.exports=function(t,e,n){var a=r(e);a in t?i.f(t,a,o(0,n)):t[a]=n}},"861d":function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},8875:function(t,e,n){var r,i,o;(function(n,a){i=[],r=a,o="function"===typeof r?r.apply(e,i):r,void 0===o||(t.exports=o)})("undefined"!==typeof self&&self,(function(){function t(){var e=Object.getOwnPropertyDescriptor(document,"currentScript");if(!e&&"currentScript"in document&&document.currentScript)return document.currentScript;if(e&&e.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(f){var n,r,i,o=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,a=/@([^@]*):(\d+):(\d+)\s*$/gi,s=o.exec(f.stack)||a.exec(f.stack),c=s&&s[1]||!1,l=s&&s[2]||!1,u=document.location.href.replace(document.location.hash,""),h=document.getElementsByTagName("script");c===u&&(n=document.documentElement.outerHTML,r=new RegExp("(?:[^\\n]+?\\n){0,"+(l-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),i=n.replace(r,"$1").trim());for(var d=0;d<h.length;d++){if("interactive"===h[d].readyState)return h[d];if(h[d].src===c)return h[d];if(c===u&&h[d].innerHTML&&h[d].innerHTML.trim()===i)return h[d]}return null}}return t}))},8925:function(t,e,n){var r=n("c6cd"),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return i.call(t)}),t.exports=r.inspectSource},"8aa5":function(t,e,n){"use strict";var r=n("6547").charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},"8bbf":function(e,n){e.exports=t},"90e3":function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},9112:function(t,e,n){var r=n("83ab"),i=n("9bf2"),o=n("5c6c");t.exports=r?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},9263:function(t,e,n){"use strict";var r=n("ad6d"),i=n("9f7f"),o=RegExp.prototype.exec,a=String.prototype.replace,s=o,c=function(){var t=/a/,e=/b*/g;return o.call(t,"a"),o.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),l=i.UNSUPPORTED_Y||i.BROKEN_CARET,u=void 0!==/()??/.exec("")[1],h=c||u||l;h&&(s=function(t){var e,n,i,s,h=this,d=l&&h.sticky,f=r.call(h),p=h.source,g=0,v=t;return d&&(f=f.replace("y",""),-1===f.indexOf("g")&&(f+="g"),v=String(t).slice(h.lastIndex),h.lastIndex>0&&(!h.multiline||h.multiline&&"\n"!==t[h.lastIndex-1])&&(p="(?: "+p+")",v=" "+v,g++),n=new RegExp("^(?:"+p+")",f)),u&&(n=new RegExp("^"+p+"$(?!\\s)",f)),c&&(e=h.lastIndex),i=o.call(d?n:h,v),d?i?(i.input=i.input.slice(g),i[0]=i[0].slice(g),i.index=h.lastIndex,h.lastIndex+=i[0].length):h.lastIndex=0:c&&i&&(h.lastIndex=h.global?i.index+i[0].length:e),u&&i&&i.length>1&&a.call(i[0],n,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(i[s]=void 0)})),i}),t.exports=s},"94ca":function(t,e,n){var r=n("d039"),i=/#|\.prototype\./,o=function(t,e){var n=s[a(t)];return n==l||n!=c&&("function"==typeof e?r(e):!!e)},a=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},s=o.data={},c=o.NATIVE="N",l=o.POLYFILL="P";t.exports=o},"99af":function(t,e,n){"use strict";var r=n("23e7"),i=n("d039"),o=n("e8b5"),a=n("861d"),s=n("7b0b"),c=n("50c4"),l=n("8418"),u=n("65f0"),h=n("1dde"),d=n("b622"),f=n("2d00"),p=d("isConcatSpreadable"),g=9007199254740991,v="Maximum allowed index exceeded",m=f>=51||!i((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),b=h("concat"),y=function(t){if(!a(t))return!1;var e=t[p];return void 0!==e?!!e:o(t)},S=!m||!b;r({target:"Array",proto:!0,forced:S},{concat:function(t){var e,n,r,i,o,a=s(this),h=u(a,0),d=0;for(e=-1,r=arguments.length;e<r;e++)if(o=-1===e?a:arguments[e],y(o)){if(i=c(o.length),d+i>g)throw TypeError(v);for(n=0;n<i;n++,d++)n in o&&l(h,d,o[n])}else{if(d>=g)throw TypeError(v);l(h,d++,o)}return h.length=d,h}})},"9bdd":function(t,e,n){var r=n("825a");t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(a){var o=t["return"];throw void 0!==o&&r(o.call(t)),a}}},"9bf2":function(t,e,n){var r=n("83ab"),i=n("0cfb"),o=n("825a"),a=n("c04e"),s=Object.defineProperty;e.f=r?s:function(t,e,n){if(o(t),e=a(e,!0),o(n),i)try{return s(t,e,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},"9ed3":function(t,e,n){"use strict";var r=n("ae93").IteratorPrototype,i=n("7c73"),o=n("5c6c"),a=n("d44e"),s=n("3f8c"),c=function(){return this};t.exports=function(t,e,n){var l=e+" Iterator";return t.prototype=i(r,{next:o(1,n)}),a(t,l,!1,!0),s[l]=c,t}},"9f7f":function(t,e,n){"use strict";var r=n("d039");function i(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=r((function(){var t=i("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=r((function(){var t=i("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},a2bf:function(t,e,n){"use strict";var r=n("e8b5"),i=n("50c4"),o=n("0366"),a=function(t,e,n,s,c,l,u,h){var d,f=c,p=0,g=!!u&&o(u,h,3);while(p<s){if(p in n){if(d=g?g(n[p],p,e):n[p],l>0&&r(d))f=a(t,e,d,i(d.length),f,l-1)-1;else{if(f>=9007199254740991)throw TypeError("Exceed the acceptable array length");t[f]=d}f++}p++}return f};t.exports=a},a352:function(t,n){t.exports=e},a434:function(t,e,n){"use strict";var r=n("23e7"),i=n("23cb"),o=n("a691"),a=n("50c4"),s=n("7b0b"),c=n("65f0"),l=n("8418"),u=n("1dde"),h=n("ae40"),d=u("splice"),f=h("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,g=Math.min,v=9007199254740991,m="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!d||!f},{splice:function(t,e){var n,r,u,h,d,f,b=s(this),y=a(b.length),S=i(t,y),w=arguments.length;if(0===w?n=r=0:1===w?(n=0,r=y-S):(n=w-2,r=g(p(o(e),0),y-S)),y+n-r>v)throw TypeError(m);for(u=c(b,r),h=0;h<r;h++)d=S+h,d in b&&l(u,h,b[d]);if(u.length=r,n<r){for(h=S;h<y-r;h++)d=h+r,f=h+n,d in b?b[f]=b[d]:delete b[f];for(h=y;h>y-r+n;h--)delete b[h-1]}else if(n>r)for(h=y-r;h>S;h--)d=h+r-1,f=h+n-1,d in b?b[f]=b[d]:delete b[f];for(h=0;h<n;h++)b[h+S]=arguments[h+2];return b.length=y-r+n,u}})},a4d3:function(t,e,n){"use strict";var r=n("23e7"),i=n("da84"),o=n("d066"),a=n("c430"),s=n("83ab"),c=n("4930"),l=n("fdbf"),u=n("d039"),h=n("5135"),d=n("e8b5"),f=n("861d"),p=n("825a"),g=n("7b0b"),v=n("fc6a"),m=n("c04e"),b=n("5c6c"),y=n("7c73"),S=n("df75"),w=n("241c"),E=n("057f"),C=n("7418"),x=n("06cf"),O=n("9bf2"),_=n("d1e7"),T=n("9112"),k=n("6eeb"),I=n("5692"),P=n("f772"),j=n("d012"),M=n("90e3"),D=n("b622"),R=n("e538"),A=n("746f"),N=n("d44e"),L=n("69f3"),B=n("b727").forEach,V=P("hidden"),F="Symbol",U="prototype",W=D("toPrimitive"),z=L.set,G=L.getterFor(F),H=Object[U],Y=i.Symbol,X=o("JSON","stringify"),q=x.f,$=O.f,J=E.f,K=_.f,Z=I("symbols"),Q=I("op-symbols"),tt=I("string-to-symbol-registry"),et=I("symbol-to-string-registry"),nt=I("wks"),rt=i.QObject,it=!rt||!rt[U]||!rt[U].findChild,ot=s&&u((function(){return 7!=y($({},"a",{get:function(){return $(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=q(H,e);r&&delete H[e],$(t,e,n),r&&t!==H&&$(H,e,r)}:$,at=function(t,e){var n=Z[t]=y(Y[U]);return z(n,{type:F,tag:t,description:e}),s||(n.description=e),n},st=l?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof Y},ct=function(t,e,n){t===H&&ct(Q,e,n),p(t);var r=m(e,!0);return p(n),h(Z,r)?(n.enumerable?(h(t,V)&&t[V][r]&&(t[V][r]=!1),n=y(n,{enumerable:b(0,!1)})):(h(t,V)||$(t,V,b(1,{})),t[V][r]=!0),ot(t,r,n)):$(t,r,n)},lt=function(t,e){p(t);var n=v(e),r=S(n).concat(pt(n));return B(r,(function(e){s&&!ht.call(n,e)||ct(t,e,n[e])})),t},ut=function(t,e){return void 0===e?y(t):lt(y(t),e)},ht=function(t){var e=m(t,!0),n=K.call(this,e);return!(this===H&&h(Z,e)&&!h(Q,e))&&(!(n||!h(this,e)||!h(Z,e)||h(this,V)&&this[V][e])||n)},dt=function(t,e){var n=v(t),r=m(e,!0);if(n!==H||!h(Z,r)||h(Q,r)){var i=q(n,r);return!i||!h(Z,r)||h(n,V)&&n[V][r]||(i.enumerable=!0),i}},ft=function(t){var e=J(v(t)),n=[];return B(e,(function(t){h(Z,t)||h(j,t)||n.push(t)})),n},pt=function(t){var e=t===H,n=J(e?Q:v(t)),r=[];return B(n,(function(t){!h(Z,t)||e&&!h(H,t)||r.push(Z[t])})),r};if(c||(Y=function(){if(this instanceof Y)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=M(t),n=function(t){this===H&&n.call(Q,t),h(this,V)&&h(this[V],e)&&(this[V][e]=!1),ot(this,e,b(1,t))};return s&&it&&ot(H,e,{configurable:!0,set:n}),at(e,t)},k(Y[U],"toString",(function(){return G(this).tag})),k(Y,"withoutSetter",(function(t){return at(M(t),t)})),_.f=ht,O.f=ct,x.f=dt,w.f=E.f=ft,C.f=pt,R.f=function(t){return at(D(t),t)},s&&($(Y[U],"description",{configurable:!0,get:function(){return G(this).description}}),a||k(H,"propertyIsEnumerable",ht,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!c,sham:!c},{Symbol:Y}),B(S(nt),(function(t){A(t)})),r({target:F,stat:!0,forced:!c},{for:function(t){var e=String(t);if(h(tt,e))return tt[e];var n=Y(e);return tt[e]=n,et[n]=e,n},keyFor:function(t){if(!st(t))throw TypeError(t+" is not a symbol");if(h(et,t))return et[t]},useSetter:function(){it=!0},useSimple:function(){it=!1}}),r({target:"Object",stat:!0,forced:!c,sham:!s},{create:ut,defineProperty:ct,defineProperties:lt,getOwnPropertyDescriptor:dt}),r({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:ft,getOwnPropertySymbols:pt}),r({target:"Object",stat:!0,forced:u((function(){C.f(1)}))},{getOwnPropertySymbols:function(t){return C.f(g(t))}}),X){var gt=!c||u((function(){var t=Y();return"[null]"!=X([t])||"{}"!=X({a:t})||"{}"!=X(Object(t))}));r({target:"JSON",stat:!0,forced:gt},{stringify:function(t,e,n){var r,i=[t],o=1;while(arguments.length>o)i.push(arguments[o++]);if(r=e,(f(e)||void 0!==t)&&!st(t))return d(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!st(e))return e}),i[1]=e,X.apply(null,i)}})}Y[U][W]||T(Y[U],W,Y[U].valueOf),N(Y,F),j[V]=!0},a630:function(t,e,n){var r=n("23e7"),i=n("4df4"),o=n("1c7e"),a=!o((function(t){Array.from(t)}));r({target:"Array",stat:!0,forced:a},{from:i})},a640:function(t,e,n){"use strict";var r=n("d039");t.exports=function(t,e){var n=[][t];return!!n&&r((function(){n.call(null,e||function(){throw 1},1)}))}},a691:function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},ab13:function(t,e,n){var r=n("b622"),i=r("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,"/./"[t](e)}catch(r){}}return!1}},ac1f:function(t,e,n){"use strict";var r=n("23e7"),i=n("9263");r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},ad6d:function(t,e,n){"use strict";var r=n("825a");t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},ae40:function(t,e,n){var r=n("83ab"),i=n("d039"),o=n("5135"),a=Object.defineProperty,s={},c=function(t){throw t};t.exports=function(t,e){if(o(s,t))return s[t];e||(e={});var n=[][t],l=!!o(e,"ACCESSORS")&&e.ACCESSORS,u=o(e,0)?e[0]:c,h=o(e,1)?e[1]:void 0;return s[t]=!!n&&!i((function(){if(l&&!r)return!0;var t={length:-1};l?a(t,1,{enumerable:!0,get:c}):t[1]=1,n.call(t,u,h)}))}},ae93:function(t,e,n){"use strict";var r,i,o,a=n("e163"),s=n("9112"),c=n("5135"),l=n("b622"),u=n("c430"),h=l("iterator"),d=!1,f=function(){return this};[].keys&&(o=[].keys(),"next"in o?(i=a(a(o)),i!==Object.prototype&&(r=i)):d=!0),void 0==r&&(r={}),u||c(r,h)||s(r,h,f),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:d}},b041:function(t,e,n){"use strict";var r=n("00ee"),i=n("f5df");t.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},b0c0:function(t,e,n){var r=n("83ab"),i=n("9bf2").f,o=Function.prototype,a=o.toString,s=/^\s*function ([^ (]*)/,c="name";r&&!(c in o)&&i(o,c,{configurable:!0,get:function(){try{return a.call(this).match(s)[1]}catch(t){return""}}})},b622:function(t,e,n){var r=n("da84"),i=n("5692"),o=n("5135"),a=n("90e3"),s=n("4930"),c=n("fdbf"),l=i("wks"),u=r.Symbol,h=c?u:u&&u.withoutSetter||a;t.exports=function(t){return o(l,t)||(s&&o(u,t)?l[t]=u[t]:l[t]=h("Symbol."+t)),l[t]}},b64b:function(t,e,n){var r=n("23e7"),i=n("7b0b"),o=n("df75"),a=n("d039"),s=a((function(){o(1)}));r({target:"Object",stat:!0,forced:s},{keys:function(t){return o(i(t))}})},b727:function(t,e,n){var r=n("0366"),i=n("44ad"),o=n("7b0b"),a=n("50c4"),s=n("65f0"),c=[].push,l=function(t){var e=1==t,n=2==t,l=3==t,u=4==t,h=6==t,d=5==t||h;return function(f,p,g,v){for(var m,b,y=o(f),S=i(y),w=r(p,g,3),E=a(S.length),C=0,x=v||s,O=e?x(f,E):n?x(f,0):void 0;E>C;C++)if((d||C in S)&&(m=S[C],b=w(m,C,y),t))if(e)O[C]=b;else if(b)switch(t){case 3:return!0;case 5:return m;case 6:return C;case 2:c.call(O,m)}else if(u)return!1;return h?-1:l||u?u:O}};t.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6)}},c04e:function(t,e,n){var r=n("861d");t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},c430:function(t,e){t.exports=!1},c6b6:function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},c6cd:function(t,e,n){var r=n("da84"),i=n("ce4e"),o="__core-js_shared__",a=r[o]||i(o,{});t.exports=a},c740:function(t,e,n){"use strict";var r=n("23e7"),i=n("b727").findIndex,o=n("44d2"),a=n("ae40"),s="findIndex",c=!0,l=a(s);s in[]&&Array(1)[s]((function(){c=!1})),r({target:"Array",proto:!0,forced:c||!l},{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o(s)},c8ba:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}t.exports=n},c975:function(t,e,n){"use strict";var r=n("23e7"),i=n("4d64").indexOf,o=n("a640"),a=n("ae40"),s=[].indexOf,c=!!s&&1/[1].indexOf(1,-0)<0,l=o("indexOf"),u=a("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:c||!l||!u},{indexOf:function(t){return c?s.apply(this,arguments)||0:i(this,t,arguments.length>1?arguments[1]:void 0)}})},ca84:function(t,e,n){var r=n("5135"),i=n("fc6a"),o=n("4d64").indexOf,a=n("d012");t.exports=function(t,e){var n,s=i(t),c=0,l=[];for(n in s)!r(a,n)&&r(s,n)&&l.push(n);while(e.length>c)r(s,n=e[c++])&&(~o(l,n)||l.push(n));return l}},caad:function(t,e,n){"use strict";var r=n("23e7"),i=n("4d64").includes,o=n("44d2"),a=n("ae40"),s=a("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:!s},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o("includes")},cc12:function(t,e,n){var r=n("da84"),i=n("861d"),o=r.document,a=i(o)&&i(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},ce4e:function(t,e,n){var r=n("da84"),i=n("9112");t.exports=function(t,e){try{i(r,t,e)}catch(n){r[t]=e}return e}},d012:function(t,e){t.exports={}},d039:function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},d066:function(t,e,n){var r=n("428f"),i=n("da84"),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?o(r[t])||o(i[t]):r[t]&&r[t][e]||i[t]&&i[t][e]}},d1e7:function(t,e,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);e.f=o?function(t){var e=i(this,t);return!!e&&e.enumerable}:r},d28b:function(t,e,n){var r=n("746f");r("iterator")},d2bb:function(t,e,n){var r=n("825a"),i=n("3bbe");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,t.call(n,[]),e=n instanceof Array}catch(o){}return function(n,o){return r(n),i(o),e?t.call(n,o):n.__proto__=o,n}}():void 0)},d3b7:function(t,e,n){var r=n("00ee"),i=n("6eeb"),o=n("b041");r||i(Object.prototype,"toString",o,{unsafe:!0})},d44e:function(t,e,n){var r=n("9bf2").f,i=n("5135"),o=n("b622"),a=o("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,a)&&r(t,a,{configurable:!0,value:e})}},d58f:function(t,e,n){var r=n("1c0b"),i=n("7b0b"),o=n("44ad"),a=n("50c4"),s=function(t){return function(e,n,s,c){r(n);var l=i(e),u=o(l),h=a(l.length),d=t?h-1:0,f=t?-1:1;if(s<2)while(1){if(d in u){c=u[d],d+=f;break}if(d+=f,t?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;t?d>=0:h>d;d+=f)d in u&&(c=n(c,u[d],d,l));return c}};t.exports={left:s(!1),right:s(!0)}},d784:function(t,e,n){"use strict";n("ac1f");var r=n("6eeb"),i=n("d039"),o=n("b622"),a=n("9263"),s=n("9112"),c=o("species"),l=!i((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),u=function(){return"$0"==="a".replace(/./,"$0")}(),h=o("replace"),d=function(){return!!/./[h]&&""===/./[h]("a","$0")}(),f=!i((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));t.exports=function(t,e,n,h){var p=o(t),g=!i((function(){var e={};return e[p]=function(){return 7},7!=""[t](e)})),v=g&&!i((function(){var e=!1,n=/a/;return"split"===t&&(n={},n.constructor={},n.constructor[c]=function(){return n},n.flags="",n[p]=/./[p]),n.exec=function(){return e=!0,null},n[p](""),!e}));if(!g||!v||"replace"===t&&(!l||!u||d)||"split"===t&&!f){var m=/./[p],b=n(p,""[t],(function(t,e,n,r,i){return e.exec===a?g&&!i?{done:!0,value:m.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:d}),y=b[0],S=b[1];r(String.prototype,t,y),r(RegExp.prototype,p,2==e?function(t,e){return S.call(t,this,e)}:function(t){return S.call(t,this)})}h&&s(RegExp.prototype[p],"sham",!0)}},d81d:function(t,e,n){"use strict";var r=n("23e7"),i=n("b727").map,o=n("1dde"),a=n("ae40"),s=o("map"),c=a("map");r({target:"Array",proto:!0,forced:!s||!c},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},da84:function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")()}).call(this,n("c8ba"))},dbb4:function(t,e,n){var r=n("23e7"),i=n("83ab"),o=n("56ef"),a=n("fc6a"),s=n("06cf"),c=n("8418");r({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(t){var e,n,r=a(t),i=s.f,l=o(r),u={},h=0;while(l.length>h)n=i(r,e=l[h++]),void 0!==n&&c(u,e,n);return u}})},dbf1:function(t,e,n){"use strict";(function(t){function r(){return"undefined"!==typeof window?window.console:t.console}n.d(e,"a",(function(){return i}));var i=r()}).call(this,n("c8ba"))},ddb0:function(t,e,n){var r=n("da84"),i=n("fdbc"),o=n("e260"),a=n("9112"),s=n("b622"),c=s("iterator"),l=s("toStringTag"),u=o.values;for(var h in i){var d=r[h],f=d&&d.prototype;if(f){if(f[c]!==u)try{a(f,c,u)}catch(g){f[c]=u}if(f[l]||a(f,l,h),i[h])for(var p in o)if(f[p]!==o[p])try{a(f,p,o[p])}catch(g){f[p]=o[p]}}}},df75:function(t,e,n){var r=n("ca84"),i=n("7839");t.exports=Object.keys||function(t){return r(t,i)}},e01a:function(t,e,n){"use strict";var r=n("23e7"),i=n("83ab"),o=n("da84"),a=n("5135"),s=n("861d"),c=n("9bf2").f,l=n("e893"),u=o.Symbol;if(i&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var h={},d=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof d?new u(t):void 0===t?u():u(t);return""===t&&(h[e]=!0),e};l(d,u);var f=d.prototype=u.prototype;f.constructor=d;var p=f.toString,g="Symbol(test)"==String(u("test")),v=/^Symbol\((.*)\)[^)]+$/;c(f,"description",{configurable:!0,get:function(){var t=s(this)?this.valueOf():this,e=p.call(t);if(a(h,t))return"";var n=g?e.slice(7,-1):e.replace(v,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:d})}},e163:function(t,e,n){var r=n("5135"),i=n("7b0b"),o=n("f772"),a=n("e177"),s=o("IE_PROTO"),c=Object.prototype;t.exports=a?Object.getPrototypeOf:function(t){return t=i(t),r(t,s)?t[s]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?c:null}},e177:function(t,e,n){var r=n("d039");t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},e260:function(t,e,n){"use strict";var r=n("fc6a"),i=n("44d2"),o=n("3f8c"),a=n("69f3"),s=n("7dd0"),c="Array Iterator",l=a.set,u=a.getterFor(c);t.exports=s(Array,"Array",(function(t,e){l(this,{type:c,target:r(t),index:0,kind:e})}),(function(){var t=u(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},e439:function(t,e,n){var r=n("23e7"),i=n("d039"),o=n("fc6a"),a=n("06cf").f,s=n("83ab"),c=i((function(){a(1)})),l=!s||c;r({target:"Object",stat:!0,forced:l,sham:!s},{getOwnPropertyDescriptor:function(t,e){return a(o(t),e)}})},e538:function(t,e,n){var r=n("b622");e.f=r},e893:function(t,e,n){var r=n("5135"),i=n("56ef"),o=n("06cf"),a=n("9bf2");t.exports=function(t,e){for(var n=i(e),s=a.f,c=o.f,l=0;l<n.length;l++){var u=n[l];r(t,u)||s(t,u,c(e,u))}}},e8b5:function(t,e,n){var r=n("c6b6");t.exports=Array.isArray||function(t){return"Array"==r(t)}},e95a:function(t,e,n){var r=n("b622"),i=n("3f8c"),o=r("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||a[o]===t)}},f5df:function(t,e,n){var r=n("00ee"),i=n("c6b6"),o=n("b622"),a=o("toStringTag"),s="Arguments"==i(function(){return arguments}()),c=function(t,e){try{return t[e]}catch(n){}};t.exports=r?i:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=c(e=Object(t),a))?n:s?i(e):"Object"==(r=i(e))&&"function"==typeof e.callee?"Arguments":r}},f772:function(t,e,n){var r=n("5692"),i=n("90e3"),o=r("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},fb15:function(t,e,n){"use strict";if(n.r(e),"undefined"!==typeof window){var r=window.document.currentScript,i=n("8875");r=i(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:i});var o=r&&r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(n.p=o[1])}n("99af"),n("4de4"),n("4160"),n("c975"),n("d81d"),n("a434"),n("159b"),n("a4d3"),n("e439"),n("dbb4"),n("b64b");function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t){if(Array.isArray(t))return t}n("e01a"),n("d28b"),n("e260"),n("d3b7"),n("3ca3"),n("ddb0");function u(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)if(n.push(a.value),e&&n.length===e)break}catch(c){i=!0,o=c}finally{try{r||null==s["return"]||s["return"]()}finally{if(i)throw o}}return n}}n("a630"),n("fb6a"),n("b0c0"),n("25f0");function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e){if(t){if("string"===typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function f(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(t,e){return l(t)||u(t,e)||d(t,e)||f()}function g(t){if(Array.isArray(t))return h(t)}function v(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(t){return g(t)||v(t)||d(t)||m()}var y=n("a352"),S=n.n(y);function w(t){null!==t.parentElement&&t.parentElement.removeChild(t)}function E(t,e,n){var r=0===n?t.children[0]:t.children[n-1].nextSibling;t.insertBefore(e,r)}var C=n("dbf1");n("13d5"),n("4fad"),n("ac1f"),n("5319");function x(t){var e=Object.create(null);return function(n){var r=e[n];return r||(e[n]=t(n))}}var O=/-(\w)/g,_=x((function(t){return t.replace(O,(function(t,e){return e.toUpperCase()}))})),T=(n("5db7"),n("73d9"),["Start","Add","Remove","Update","End"]),k=["Choose","Unchoose","Sort","Filter","Clone"],I=["Move"],P=[I,T,k].flatMap((function(t){return t})).map((function(t){return"on".concat(t)})),j={manage:I,manageAndEmit:T,emit:k};function M(t){return-1!==P.indexOf(t)}n("caad"),n("2ca0");var D=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function R(t){return D.includes(t)}function A(t){return["transition-group","TransitionGroup"].includes(t)}function N(t){return["id","class","role","style"].includes(t)||t.startsWith("data-")||t.startsWith("aria-")||t.startsWith("on")}function L(t){return t.reduce((function(t,e){var n=p(e,2),r=n[0],i=n[1];return t[r]=i,t}),{})}function B(t){var e=t.$attrs,n=t.componentData,r=void 0===n?{}:n,i=L(Object.entries(e).filter((function(t){var e=p(t,2),n=e[0];e[1];return N(n)})));return c(c({},i),r)}function V(t){var e=t.$attrs,n=t.callBackBuilder,r=L(F(e));Object.entries(n).forEach((function(t){var e=p(t,2),n=e[0],i=e[1];j[n].forEach((function(t){r["on".concat(t)]=i(t)}))}));var i="[data-draggable]".concat(r.draggable||"");return c(c({},r),{},{draggable:i})}function F(t){return Object.entries(t).filter((function(t){var e=p(t,2),n=e[0];e[1];return!N(n)})).map((function(t){var e=p(t,2),n=e[0],r=e[1];return[_(n),r]})).filter((function(t){var e=p(t,2),n=e[0];e[1];return!M(n)}))}n("c740");function U(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function z(t,e,n){return e&&W(t.prototype,e),n&&W(t,n),t}var G=function(t){var e=t.el;return e},H=function(t,e){return t.__draggable_context=e},Y=function(t){return t.__draggable_context},X=function(){function t(e){var n=e.nodes,r=n.header,i=n.default,o=n.footer,a=e.root,s=e.realList;U(this,t),this.defaultNodes=i,this.children=[].concat(b(r),b(i),b(o)),this.externalComponent=a.externalComponent,this.rootTransition=a.transition,this.tag=a.tag,this.realList=s}return z(t,[{key:"render",value:function(t,e){var n=this.tag,r=this.children,i=this._isRootComponent,o=i?{default:function(){return r}}:r;return t(n,e,o)}},{key:"updated",value:function(){var t=this.defaultNodes,e=this.realList;t.forEach((function(t,n){H(G(t),{element:e[n],index:n})}))}},{key:"getUnderlyingVm",value:function(t){return Y(t)}},{key:"getVmIndexFromDomIndex",value:function(t,e){var n=this.defaultNodes,r=n.length,i=e.children,o=i.item(t);if(null===o)return r;var a=Y(o);if(a)return a.index;if(0===r)return 0;var s=G(n[0]),c=b(i).findIndex((function(t){return t===s}));return t<c?0:r}},{key:"_isRootComponent",get:function(){return this.externalComponent||this.rootTransition}}]),t}(),q=n("8bbf");function $(t,e){var n=t[e];return n?n():[]}function J(t){var e=t.$slots,n=t.realList,r=t.getKey,i=n||[],o=["header","footer"].map((function(t){return $(e,t)})),a=p(o,2),s=a[0],l=a[1],u=e.item;if(!u)throw new Error("draggable element must have an item slot");var h=i.flatMap((function(t,e){return u({element:t,index:e}).map((function(e){return e.key=r(t),e.props=c(c({},e.props||{}),{},{"data-draggable":!0}),e}))}));if(h.length!==i.length)throw new Error("Item slot must have only one child");return{header:s,footer:l,default:h}}function K(t){var e=A(t),n=!R(t)&&!e;return{transition:e,externalComponent:n,tag:n?Object(q["resolveComponent"])(t):e?q["TransitionGroup"]:t}}function Z(t){var e=t.$slots,n=t.tag,r=t.realList,i=t.getKey,o=J({$slots:e,realList:r,getKey:i}),a=K(n);return new X({nodes:o,root:a,realList:r})}function Q(t,e){var n=this;Object(q["nextTick"])((function(){return n.$emit(t.toLowerCase(),e)}))}function tt(t){var e=this;return function(n,r){if(null!==e.realList)return e["onDrag".concat(t)](n,r)}}function et(t){var e=this,n=tt.call(this,t);return function(r,i){n.call(e,r,i),Q.call(e,t,r)}}var nt=null,rt={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:function(t){return t}},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},it=["update:modelValue","change"].concat(b([].concat(b(j.manageAndEmit),b(j.emit)).map((function(t){return t.toLowerCase()})))),ot=Object(q["defineComponent"])({name:"draggable",inheritAttrs:!1,props:rt,emits:it,data:function(){return{error:!1}},render:function(){try{this.error=!1;var t=this.$slots,e=this.$attrs,n=this.tag,r=this.componentData,i=this.realList,o=this.getKey,a=Z({$slots:t,tag:n,realList:i,getKey:o});this.componentStructure=a;var s=B({$attrs:e,componentData:r});return a.render(q["h"],s)}catch(c){return this.error=!0,Object(q["h"])("pre",{style:{color:"red"}},c.stack)}},created:function(){null!==this.list&&null!==this.modelValue&&C["a"].error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted:function(){var t=this;if(!this.error){var e=this.$attrs,n=this.$el,r=this.componentStructure;r.updated();var i=V({$attrs:e,callBackBuilder:{manageAndEmit:function(e){return et.call(t,e)},emit:function(e){return Q.bind(t,e)},manage:function(e){return tt.call(t,e)}}}),o=1===n.nodeType?n:n.parentElement;this._sortable=new S.a(o,i),this.targetDomElement=o,o.__draggable_component__=this}},updated:function(){this.componentStructure.updated()},beforeUnmount:function(){void 0!==this._sortable&&this._sortable.destroy()},computed:{realList:function(){var t=this.list;return t||this.modelValue},getKey:function(){var t=this.itemKey;return"function"===typeof t?t:function(e){return e[t]}}},watch:{$attrs:{handler:function(t){var e=this._sortable;e&&F(t).forEach((function(t){var n=p(t,2),r=n[0],i=n[1];e.option(r,i)}))},deep:!0}},methods:{getUnderlyingVm:function(t){return this.componentStructure.getUnderlyingVm(t)||null},getUnderlyingPotencialDraggableComponent:function(t){return t.__draggable_component__},emitChanges:function(t){var e=this;Object(q["nextTick"])((function(){return e.$emit("change",t)}))},alterList:function(t){if(this.list)t(this.list);else{var e=b(this.modelValue);t(e),this.$emit("update:modelValue",e)}},spliceList:function(){var t=arguments,e=function(e){return e.splice.apply(e,b(t))};this.alterList(e)},updatePosition:function(t,e){var n=function(n){return n.splice(e,0,n.splice(t,1)[0])};this.alterList(n)},getRelatedContextFromMoveEvent:function(t){var e=t.to,n=t.related,r=this.getUnderlyingPotencialDraggableComponent(e);if(!r)return{component:r};var i=r.realList,o={list:i,component:r};if(e!==n&&i){var a=r.getUnderlyingVm(n)||{};return c(c({},a),o)}return o},getVmIndexFromDomIndex:function(t){return this.componentStructure.getVmIndexFromDomIndex(t,this.targetDomElement)},onDragStart:function(t){this.context=this.getUnderlyingVm(t.item),t.item._underlying_vm_=this.clone(this.context.element),nt=t.item},onDragAdd:function(t){var e=t.item._underlying_vm_;if(void 0!==e){w(t.item);var n=this.getVmIndexFromDomIndex(t.newIndex);this.spliceList(n,0,e);var r={element:e,newIndex:n};this.emitChanges({added:r})}},onDragRemove:function(t){if(E(this.$el,t.item,t.oldIndex),"clone"!==t.pullMode){var e=this.context,n=e.index,r=e.element;this.spliceList(n,1);var i={element:r,oldIndex:n};this.emitChanges({removed:i})}else w(t.clone)},onDragUpdate:function(t){w(t.item),E(t.from,t.item,t.oldIndex);var e=this.context.index,n=this.getVmIndexFromDomIndex(t.newIndex);this.updatePosition(e,n);var r={element:this.context.element,oldIndex:e,newIndex:n};this.emitChanges({moved:r})},computeFutureIndex:function(t,e){if(!t.element)return 0;var n=b(e.to.children).filter((function(t){return"none"!==t.style["display"]})),r=n.indexOf(e.related),i=t.component.getVmIndexFromDomIndex(r),o=-1!==n.indexOf(nt);return o||!e.willInsertAfter?i:i+1},onDragMove:function(t,e){var n=this.move,r=this.realList;if(!n||!r)return!0;var i=this.getRelatedContextFromMoveEvent(t),o=this.computeFutureIndex(i,t),a=c(c({},this.context),{},{futureIndex:o}),s=c(c({},t),{},{relatedContext:i,draggedContext:a});return n(s,e)},onDragEnd:function(){nt=null}}}),at=ot;e["default"]=at},fb6a:function(t,e,n){"use strict";var r=n("23e7"),i=n("861d"),o=n("e8b5"),a=n("23cb"),s=n("50c4"),c=n("fc6a"),l=n("8418"),u=n("b622"),h=n("1dde"),d=n("ae40"),f=h("slice"),p=d("slice",{ACCESSORS:!0,0:0,1:2}),g=u("species"),v=[].slice,m=Math.max;r({target:"Array",proto:!0,forced:!f||!p},{slice:function(t,e){var n,r,u,h=c(this),d=s(h.length),f=a(t,d),p=a(void 0===e?d:e,d);if(o(h)&&(n=h.constructor,"function"!=typeof n||n!==Array&&!o(n.prototype)?i(n)&&(n=n[g],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return v.call(h,f,p);for(r=new(void 0===n?Array:n)(m(p-f,0)),u=0;f<p;f++,u++)f in h&&l(r,u,h[f]);return r.length=u,r}})},fc6a:function(t,e,n){var r=n("44ad"),i=n("1d80");t.exports=function(t){return r(i(t))}},fdbc:function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(t,e,n){var r=n("4930");t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator}})["default"]}))},b78e:function(t,e,n){"use strict";n("b14c")},b797:function(t,e,n){t.exports=n.p+"img/check-DEE8F9.ffe38d9e.svg"},b980:function(t,e,n){var r=n("d039"),i=n("5c6c");t.exports=!r((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",i(1,7)),7!==t.stack)}))},b9a8:function(t,e,n){"use strict";var r=n("ada0").EventEmitter,i=n("3fb5"),o=n("621f"),a=n("9d7d"),s=n("df09"),c=n("73aa"),l=n("f701"),u=n("7c20"),h=n("89bc"),d=function(){};function f(t,e){d(t);var n=this;r.call(this),setTimeout((function(){n.doXhr(t,e)}),0)}i(f,r),f._getReceiver=function(t,e,n){return n.sameOrigin?new h(e,c):s.enabled?new h(e,s):a.enabled&&n.sameScheme?new h(e,a):u.enabled()?new u(t,e):new h(e,l)},f.prototype.doXhr=function(t,e){var n=this,r=o.addPath(t,"/info");d("doXhr",r),this.xo=f._getReceiver(t,r,e),this.timeoutRef=setTimeout((function(){d("timeout"),n._cleanup(!1),n.emit("finish")}),f.timeout),this.xo.once("finish",(function(t,e){d("finish",t,e),n._cleanup(!0),n.emit("finish",t,e)}))},f.prototype._cleanup=function(t){d("_cleanup"),clearTimeout(this.timeoutRef),this.timeoutRef=null,!t&&this.xo&&this.xo.close(),this.xo=null},f.prototype.close=function(){d("close"),this.removeAllListeners(),this._cleanup(!1)},f.timeout=8e3,t.exports=f},bb31:function(t,e,n){"use strict";var r=n("930c"),i=n("f1f8");function o(t){this._transport=t,t.on("message",this._transportMessage.bind(this)),t.on("close",this._transportClose.bind(this))}o.prototype._transportClose=function(t,e){i.postMessage("c",r.stringify([t,e]))},o.prototype._transportMessage=function(t){i.postMessage("t",t)},o.prototype._send=function(t){this._transport.send(t)},o.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},t.exports=o},bea1:function(t){t.exports=JSON.parse('{"author":"OpenVidu","dependencies":{"freeice":"2.2.2","hark":"1.2.3","jsnlog":"2.30.0","platform":"1.3.6","uuid":"8.3.2","wolfy87-eventemitter":"5.2.9"},"description":"OpenVidu Browser","devDependencies":{"@types/node":"15.12.2","@types/platform":"1.3.3","browserify":"17.0.0","grunt":"1.4.1","grunt-cli":"1.4.3","grunt-contrib-copy":"1.0.0","grunt-contrib-sass":"2.0.0","grunt-contrib-uglify":"5.0.1","grunt-contrib-watch":"1.1.0","grunt-postcss":"0.9.0","grunt-string-replace":"1.3.1","grunt-ts":"6.0.0-beta.22","terser":"5.7.0","tsify":"5.0.4","tslint":"6.1.3","typedoc":"0.19.2","typescript":"4.0.7"},"license":"Apache-2.0","main":"lib/index.js","name":"openvidu-browser","repository":{"type":"git","url":"git://github.com/OpenVidu/openvidu"},"scripts":{"browserify":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js Main.ts -p [ tsify ] --exclude kurento-browser-extensions --debug -o ../static/js/openvidu-browser-$VERSION.js -v","browserify-prod":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js --debug Main.ts -p [ tsify ] --exclude kurento-browser-extensions | ../node_modules/terser/bin/terser --source-map content=inline --output ../static/js/openvidu-browser-$VERSION.min.js","build":"cd src/OpenVidu && ./../../node_modules/typescript/bin/tsc && cd ../.. && ./node_modules/typescript/bin/tsc --declaration src/index.ts --outDir ./lib --sourceMap --target es5 --lib dom,es5,es2015.promise,scripthost","docs":"./generate-docs.sh"},"types":"lib/index.d.ts","version":"2.21.0-beta1"}')},bf19:function(t,e,n){"use strict";var r=n("23e7"),i=n("c65b");r({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return i(URL.prototype.toString,this)}})},bf4a:function(t,e,n){"use strict";(function(e){var r,i,o=n("2582"),a=n("621f"),s=function(){};function c(t){s("createIframe",t);try{return e.document.createElement('<iframe name="'+t+'">')}catch(r){var n=e.document.createElement("iframe");return n.name=t,n}}function l(){s("createForm"),r=e.document.createElement("form"),r.style.display="none",r.style.position="absolute",r.method="POST",r.enctype="application/x-www-form-urlencoded",r.acceptCharset="UTF-8",i=e.document.createElement("textarea"),i.name="d",r.appendChild(i),e.document.body.appendChild(r)}t.exports=function(t,e,n){s(t,e),r||l();var u="a"+o.string(8);r.target=u,r.action=a.addQuery(a.addPath(t,"/jsonp_send"),"i="+u);var h=c(u);h.id=u,h.style.display="none",r.appendChild(h);try{i.value=e}catch(f){}r.submit();var d=function(t){s("completed",u,t),h.onerror&&(h.onreadystatechange=h.onerror=h.onload=null,setTimeout((function(){s("cleaning up",u),h.parentNode.removeChild(h),h=null}),500),i.value="",n(t))};return h.onerror=function(){s("onerror",u),d()},h.onload=function(){s("onload",u),d()},h.onreadystatechange=function(t){s("onreadystatechange",u,h.readyState,t),"complete"===h.readyState&&d()},function(){s("aborted",u),d(new Error("Aborted"))}}}).call(this,n("c8ba"))},c09e:function(t){t.exports=JSON.parse("[]")},c282:function(t,e,n){"use strict";(function(e){var r=n("2582"),i={},o=!1,a=e.chrome&&e.chrome.app&&e.chrome.app.runtime;t.exports={attachEvent:function(t,n){"undefined"!==typeof e.addEventListener?e.addEventListener(t,n,!1):e.document&&e.attachEvent&&(e.document.attachEvent("on"+t,n),e.attachEvent("on"+t,n))},detachEvent:function(t,n){"undefined"!==typeof e.addEventListener?e.removeEventListener(t,n,!1):e.document&&e.detachEvent&&(e.document.detachEvent("on"+t,n),e.detachEvent("on"+t,n))},unloadAdd:function(t){if(a)return null;var e=r.string(8);return i[e]=t,o&&setTimeout(this.triggerUnloadCallbacks,0),e},unloadDel:function(t){t in i&&delete i[t]},triggerUnloadCallbacks:function(){for(var t in i)i[t](),delete i[t]}};var s=function(){o||(o=!0,t.exports.triggerUnloadCallbacks())};a||t.exports.attachEvent("unload",s)}).call(this,n("c8ba"))},c2d8:function(t,e,n){},c529:function(t,e,n){"use strict";var r=n("3fb5"),i=n("ada0").EventEmitter,o=n("930c"),a=n("73aa"),s=n("89bc");function c(t){var e=this;i.call(this),this.ir=new s(t,a),this.ir.once("finish",(function(t,n){e.ir=null,e.emit("message",o.stringify([t,n]))}))}r(c,i),c.transportName="iframe-info-receiver",c.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},t.exports=c},c6e1:function(t,e,n){(function(e,n){t.exports=n()})(0,(function(){"use strict";var t=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},e=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),n=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)if(n.push(a.value),e&&n.length===e)break}catch(c){i=!0,o=c}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},i={V1_0:"1.0",V1_1:"1.1",V1_2:"1.2",supportedVersions:function(){return"1.2,1.1,1.0"},supportedProtocols:function(){return["v10.stomp","v11.stomp","v12.stomp"]}},o={"v10.stomp":i.V1_0,"v11.stomp":i.V1_1,"v12.stomp":i.V1_2};function a(t,e){var n=o[t];return!n&&e&&e("DEPRECATED: "+t+" is not a recognized STOMP version. In next major client version, this will close the connection."),n||i.V1_2}var s={LF:"\n",NULL:"\0"},c=function(t){return t.replace(/^\s+|\s+$/g,"")};function l(t){var e=encodeURIComponent(t),n=e.replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode("0x"+e)})),r=Array.prototype.map.call(n,(function(t){return t.charCodeAt(0)}));return new Uint8Array(r)}function u(t){var e=String.fromCharCode.apply(String,r(t)),n=e.replace(/(.)/g,(function(t,e){var n=e.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}));return decodeURIComponent(n)}function h(t){return t?encodeURIComponent(t).match(/%..|./g).length:0}function d(){var t=(new Date).getTime(),e=Math.floor(1e3*Math.random());return t+"-"+e}var f=function(){function n(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";t(this,n),this.command=e,this.headers=r,this.body=i}return e(n,[{key:"toString",value:function(){var t=this,e=[this.command],n=!1===this.headers["content-length"];return n&&delete this.headers["content-length"],Object.keys(this.headers).forEach((function(n){var r=t.headers[n];e.push(n+":"+r)})),this.body&&!n&&e.push("content-length:"+h(this.body)),e.push(s.LF+this.body),e.join(s.LF)}}],[{key:"unmarshallSingle",value:function(t){var e=t.search(new RegExp(s.LF+s.LF)),r=t.substring(0,e).split(s.LF),i=r.shift(),o={},a="",l=e+2,u=!0,h=!1,d=void 0;try{for(var f,p=r.reverse()[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var g=f.value,v=g.indexOf(":");o[c(g.substring(0,v))]=c(g.substring(v+1))}}catch(S){h=!0,d=S}finally{try{!u&&p.return&&p.return()}finally{if(h)throw d}}if(o["content-length"]){var m=parseInt(o["content-length"],10);a=(""+t).substring(l,l+m)}else for(var b=null,y=l;y<t.length;y++){if(b=t.charAt(y),b===s.NULL)break;a+=b}return new n(i,o,a)}},{key:"unmarshall",value:function(t){var e=t.split(new RegExp(s.NULL+s.LF+"*")),r=e.slice(0,-1),i=e.slice(-1)[0],o={frames:r.map((function(t){return n.unmarshallSingle(t)})),partial:""};return i===s.LF||-1!==i.search(RegExp(s.NULL+s.LF+"*$"))?o.frames.push(n.unmarshallSingle(i)):o.partial=i,o}},{key:"marshall",value:function(t,e,r){var i=new n(t,e,r);return i.toString()+s.NULL}}]),n}(),p=function(){function r(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(this,r);var i=n.binary,o=void 0!==i&&i,a=n.heartbeat,s=void 0===a?{outgoing:1e4,incoming:1e4}:a,c=n.debug,l=void 0===c||c,u=n.protocols,h=void 0===u?[]:u;this.ws=e,this.ws.binaryType="arraybuffer",this.isBinary=!!o,this.hasDebug=!!l,this.connected=!1,this.heartbeat=s||{outgoing:0,incoming:0},this.maxWebSocketFrameSize=16384,this.subscriptions={},this.partialData="",this.protocols=h}return e(r,[{key:"debug",value:function(){var t;this.hasDebug&&(t=console).log.apply(t,arguments)}},{key:"connect",value:function(){var t=this,e=this._parseConnect.apply(this,arguments),r=n(e,3),o=r[0],c=r[1],l=r[2];this.connectCallback=c,this.debug("Opening Web Socket..."),this.ws.onmessage=function(e){var n=e.data;if(e.data instanceof ArrayBuffer&&(n=u(new Uint8Array(e.data))),t.serverActivity=Date.now(),n!==s.LF){t.debug("<<< "+n);var r=f.unmarshall(t.partialData+n);t.partialData=r.partial,r.frames.forEach((function(e){switch(e.command){case"CONNECTED":t.debug("connected to server "+e.headers.server),t.connected=!0,t.version=e.headers.version,t._setupHeartbeat(e.headers),c&&c(e);break;case"MESSAGE":var n=e.headers.subscription,r=t.subscriptions[n]||t.onreceive;if(r){var o=t.version===i.V1_2&&e.headers.ack||e.headers["message-id"];e.ack=t.ack.bind(t,o,n),e.nack=t.nack.bind(t,o,n),r(e)}else t.debug("Unhandled received MESSAGE: "+e);break;case"RECEIPT":t.onreceipt&&t.onreceipt(e);break;case"ERROR":l&&l(e);break;default:t.debug("Unhandled frame: "+e)}}))}else t.debug("<<< PONG")},this.ws.onclose=function(e){t.debug("Whoops! Lost connection to "+t.ws.url+":",{event:e}),t._cleanUp(),l&&l(e)},this.ws.onopen=function(){t.debug("Web Socket Opened..."),o["accept-version"]=a(t.ws.protocol||t.protocols[0],t.debug.bind(t)),o["heart-beat"]||(o["heart-beat"]=[t.heartbeat.outgoing,t.heartbeat.incoming].join(",")),t._transmit("CONNECT",o)},this.ws.readyState===this.ws.OPEN&&this.ws.onopen()}},{key:"disconnect",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._transmit("DISCONNECT",e),this.ws.onclose=null,this.ws.close(),this._cleanUp(),t&&t()}},{key:"send",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},n);r.destination=t,this._transmit("SEND",r,e)}},{key:"begin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tx-"+d();return this._transmit("BEGIN",{transaction:t}),{id:t,commit:this.commit.bind(this,t),abort:this.abort.bind(this,t)}}},{key:"commit",value:function(t){this._transmit("COMMIT",{transaction:t})}},{key:"abort",value:function(t){this._transmit("ABORT",{transaction:t})}},{key:"ack",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},n),o=this.version===i.V1_2?"id":"message-id";r[o]=t,r.subscription=e,this._transmit("ACK",r)}},{key:"nack",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},n),o=this.version===i.V1_2?"id":"message-id";r[o]=t,r.subscription=e,this._transmit("NACK",r)}},{key:"subscribe",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},n);return r.id||(r.id="sub-"+d()),r.destination=t,this.subscriptions[r.id]=e,this._transmit("SUBSCRIBE",r),{id:r.id,unsubscribe:this.unsubscribe.bind(this,r.id)}}},{key:"unsubscribe",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},e);delete this.subscriptions[t],n.id=t,this._transmit("UNSUBSCRIBE",n)}},{key:"_cleanUp",value:function(){this.connected=!1,clearInterval(this.pinger),clearInterval(this.ponger)}},{key:"_transmit",value:function(t,e,n){var r=f.marshall(t,e,n);this.debug(">>> "+r,{frame:{command:t,headers:e,body:n}}),this._wsSend(r)}},{key:"_wsSend",value:function(t){this.isBinary&&(t=l(t)),this.debug(">>> length "+t.length);while(1){if(!(t.length>this.maxWebSocketFrameSize))return this.ws.send(t);this.ws.send(t.slice(0,this.maxWebSocketFrameSize)),t=t.slice(this.maxWebSocketFrameSize),this.debug("remaining = "+t.length)}}},{key:"_setupHeartbeat",value:function(t){var e=this;if(this.version===i.V1_1||this.version===i.V1_2){var r=(t["heart-beat"]||"0,0").split(",").map((function(t){return parseInt(t,10)})),o=n(r,2),a=o[0],c=o[1];if(0!==this.heartbeat.outgoing&&0!==c){var l=Math.max(this.heartbeat.outgoing,c);this.debug("send PING every "+l+"ms"),this.pinger=setInterval((function(){e._wsSend(s.LF),e.debug(">>> PING")}),l)}if(0!==this.heartbeat.incoming&&0!==a){var u=Math.max(this.heartbeat.incoming,a);this.debug("check PONG every "+u+"ms"),this.ponger=setInterval((function(){var t=Date.now()-e.serverActivity;t>2*u&&(e.debug("did not receive server activity for the last "+t+"ms"),e.ws.close())}),u)}}}},{key:"_parseConnect",value:function(){for(var t={},e=void 0,n=void 0,r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];switch(i.length){case 2:t=i[0],e=i[1];break;case 3:i[1]instanceof Function?(t=i[0],e=i[1],n=i[2]):(t.login=i[0],t.passcode=i[1],e=i[2]);break;case 4:t.login=i[0],t.passcode=i[1],e=i[2],n=i[3];break;default:t.login=i[0],t.passcode=i[1],e=i[2],n=i[3],t.host=i[4]}return[t,e,n]}}]),r}(),g={Frame:f,VERSIONS:i,client:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new WebSocket(t,e.protocols||i.supportedProtocols());return new p(n,e)},over:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new(Function.prototype.bind.apply(p,[null].concat(e)))}};return g}))},c740:function(t,e,n){"use strict";var r=n("23e7"),i=n("b727").findIndex,o=n("44d2"),a="findIndex",s=!0;a in[]&&Array(1)[a]((function(){s=!1})),r({target:"Array",proto:!0,forced:s},{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o(a)},c770:function(t,e,n){var r=n("e330"),i=r("".replace),o=function(t){return String(Error(t).stack)}("zxcasd"),a=/\n\s*at [^:]*:[^\n]*/,s=a.test(o);t.exports=function(t,e){if(s&&"string"==typeof t)while(e--)t=i(t,a,"");return t}},c9eb:function(t,e){try{t.exports="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(n){t.exports=!1}},ca34:function(t,e,n){(function(e){t.exports=e.EventSource}).call(this,n("c8ba"))},caad:function(t,e,n){"use strict";var r=n("23e7"),i=n("4d64").includes,o=n("44d2");r({target:"Array",proto:!0},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o("includes")},cc7d:function(t,e,n){"use strict";(function(e){var r=n("6945");t.exports=n("486c")(r),"_sockjs_onload"in e&&setTimeout(e._sockjs_onload,1)}).call(this,n("c8ba"))},cf14:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConsoleLogger=void 0;var r=function(){function t(t){this.logger=t,this.log=window.console.log,this.info=window.console.info,this.debug=window.console.debug,this.warn=window.console.warn,this.error=window.console.error}return t}();e.ConsoleLogger=r},cfe6:function(t,e,n){"use strict";(function(e){e.crypto&&e.crypto.getRandomValues?t.exports.randomBytes=function(t){var n=new Uint8Array(t);return e.crypto.getRandomValues(n),n}:t.exports.randomBytes=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=Math.floor(256*Math.random());return e}}).call(this,n("c8ba"))},d010:function(t,e,n){},d28b:function(t,e,n){var r=n("746f");r("iterator")},d2ca:function(t,e,n){"use strict";var r;n.r(e),n.d(e,"v1",(function(){return b})),n.d(e,"v3",(function(){return V})),n.d(e,"v4",(function(){return U})),n.d(e,"v5",(function(){return X})),n.d(e,"NIL",(function(){return q})),n.d(e,"version",(function(){return J})),n.d(e,"validate",(function(){return c})),n.d(e,"stringify",(function(){return p})),n.d(e,"parse",(function(){return S}));var i=new Uint8Array(16);function o(){if(!r&&(r="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}var a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function s(t){return"string"===typeof t&&a.test(t)}for(var c=s,l=[],u=0;u<256;++u)l.push((u+256).toString(16).substr(1));function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(l[t[e+0]]+l[t[e+1]]+l[t[e+2]]+l[t[e+3]]+"-"+l[t[e+4]]+l[t[e+5]]+"-"+l[t[e+6]]+l[t[e+7]]+"-"+l[t[e+8]]+l[t[e+9]]+"-"+l[t[e+10]]+l[t[e+11]]+l[t[e+12]]+l[t[e+13]]+l[t[e+14]]+l[t[e+15]]).toLowerCase();if(!c(n))throw TypeError("Stringified UUID is invalid");return n}var d,f,p=h,g=0,v=0;function m(t,e,n){var r=e&&n||0,i=e||new Array(16);t=t||{};var a=t.node||d,s=void 0!==t.clockseq?t.clockseq:f;if(null==a||null==s){var c=t.random||(t.rng||o)();null==a&&(a=d=[1|c[0],c[1],c[2],c[3],c[4],c[5]]),null==s&&(s=f=16383&(c[6]<<8|c[7]))}var l=void 0!==t.msecs?t.msecs:Date.now(),u=void 0!==t.nsecs?t.nsecs:v+1,h=l-g+(u-v)/1e4;if(h<0&&void 0===t.clockseq&&(s=s+1&16383),(h<0||l>g)&&void 0===t.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");g=l,v=u,f=s,l+=122192928e5;var m=(1e4*(268435455&l)+u)%4294967296;i[r++]=m>>>24&255,i[r++]=m>>>16&255,i[r++]=m>>>8&255,i[r++]=255&m;var b=l/4294967296*1e4&268435455;i[r++]=b>>>8&255,i[r++]=255&b,i[r++]=b>>>24&15|16,i[r++]=b>>>16&255,i[r++]=s>>>8|128,i[r++]=255&s;for(var y=0;y<6;++y)i[r+y]=a[y];return e||p(i)}var b=m;function y(t){if(!c(t))throw TypeError("Invalid UUID");var e,n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=255&e,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=255&e,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=255&e,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=255&e,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=255&e,n}var S=y;function w(t){t=unescape(encodeURIComponent(t));for(var e=[],n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e}var E="6ba7b810-9dad-11d1-80b4-00c04fd430c8",C="6ba7b811-9dad-11d1-80b4-00c04fd430c8",x=function(t,e,n){function r(t,r,i,o){if("string"===typeof t&&(t=w(t)),"string"===typeof r&&(r=S(r)),16!==r.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var a=new Uint8Array(16+t.length);if(a.set(r),a.set(t,r.length),a=n(a),a[6]=15&a[6]|e,a[8]=63&a[8]|128,i){o=o||0;for(var s=0;s<16;++s)i[o+s]=a[s];return i}return p(a)}try{r.name=t}catch(i){}return r.DNS=E,r.URL=C,r};function O(t){if("string"===typeof t){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var n=0;n<e.length;++n)t[n]=e.charCodeAt(n)}return _(k(I(t),8*t.length))}function _(t){for(var e=[],n=32*t.length,r="0123456789abcdef",i=0;i<n;i+=8){var o=t[i>>5]>>>i%32&255,a=parseInt(r.charAt(o>>>4&15)+r.charAt(15&o),16);e.push(a)}return e}function T(t){return 14+(t+64>>>9<<4)+1}function k(t,e){t[e>>5]|=128<<e%32,t[T(e)-1]=e;for(var n=1732584193,r=-271733879,i=-1732584194,o=271733878,a=0;a<t.length;a+=16){var s=n,c=r,l=i,u=o;n=D(n,r,i,o,t[a],7,-680876936),o=D(o,n,r,i,t[a+1],12,-389564586),i=D(i,o,n,r,t[a+2],17,606105819),r=D(r,i,o,n,t[a+3],22,-1044525330),n=D(n,r,i,o,t[a+4],7,-176418897),o=D(o,n,r,i,t[a+5],12,1200080426),i=D(i,o,n,r,t[a+6],17,-1473231341),r=D(r,i,o,n,t[a+7],22,-45705983),n=D(n,r,i,o,t[a+8],7,1770035416),o=D(o,n,r,i,t[a+9],12,-1958414417),i=D(i,o,n,r,t[a+10],17,-42063),r=D(r,i,o,n,t[a+11],22,-1990404162),n=D(n,r,i,o,t[a+12],7,1804603682),o=D(o,n,r,i,t[a+13],12,-40341101),i=D(i,o,n,r,t[a+14],17,-1502002290),r=D(r,i,o,n,t[a+15],22,1236535329),n=R(n,r,i,o,t[a+1],5,-165796510),o=R(o,n,r,i,t[a+6],9,-1069501632),i=R(i,o,n,r,t[a+11],14,643717713),r=R(r,i,o,n,t[a],20,-373897302),n=R(n,r,i,o,t[a+5],5,-701558691),o=R(o,n,r,i,t[a+10],9,38016083),i=R(i,o,n,r,t[a+15],14,-660478335),r=R(r,i,o,n,t[a+4],20,-405537848),n=R(n,r,i,o,t[a+9],5,568446438),o=R(o,n,r,i,t[a+14],9,-1019803690),i=R(i,o,n,r,t[a+3],14,-187363961),r=R(r,i,o,n,t[a+8],20,1163531501),n=R(n,r,i,o,t[a+13],5,-1444681467),o=R(o,n,r,i,t[a+2],9,-51403784),i=R(i,o,n,r,t[a+7],14,1735328473),r=R(r,i,o,n,t[a+12],20,-1926607734),n=A(n,r,i,o,t[a+5],4,-378558),o=A(o,n,r,i,t[a+8],11,-2022574463),i=A(i,o,n,r,t[a+11],16,1839030562),r=A(r,i,o,n,t[a+14],23,-35309556),n=A(n,r,i,o,t[a+1],4,-1530992060),o=A(o,n,r,i,t[a+4],11,1272893353),i=A(i,o,n,r,t[a+7],16,-155497632),r=A(r,i,o,n,t[a+10],23,-1094730640),n=A(n,r,i,o,t[a+13],4,681279174),o=A(o,n,r,i,t[a],11,-358537222),i=A(i,o,n,r,t[a+3],16,-722521979),r=A(r,i,o,n,t[a+6],23,76029189),n=A(n,r,i,o,t[a+9],4,-640364487),o=A(o,n,r,i,t[a+12],11,-421815835),i=A(i,o,n,r,t[a+15],16,530742520),r=A(r,i,o,n,t[a+2],23,-995338651),n=N(n,r,i,o,t[a],6,-198630844),o=N(o,n,r,i,t[a+7],10,1126891415),i=N(i,o,n,r,t[a+14],15,-1416354905),r=N(r,i,o,n,t[a+5],21,-57434055),n=N(n,r,i,o,t[a+12],6,1700485571),o=N(o,n,r,i,t[a+3],10,-1894986606),i=N(i,o,n,r,t[a+10],15,-1051523),r=N(r,i,o,n,t[a+1],21,-2054922799),n=N(n,r,i,o,t[a+8],6,1873313359),o=N(o,n,r,i,t[a+15],10,-30611744),i=N(i,o,n,r,t[a+6],15,-1560198380),r=N(r,i,o,n,t[a+13],21,1309151649),n=N(n,r,i,o,t[a+4],6,-145523070),o=N(o,n,r,i,t[a+11],10,-1120210379),i=N(i,o,n,r,t[a+2],15,718787259),r=N(r,i,o,n,t[a+9],21,-343485551),n=P(n,s),r=P(r,c),i=P(i,l),o=P(o,u)}return[n,r,i,o]}function I(t){if(0===t.length)return[];for(var e=8*t.length,n=new Uint32Array(T(e)),r=0;r<e;r+=8)n[r>>5]|=(255&t[r/8])<<r%32;return n}function P(t,e){var n=(65535&t)+(65535&e),r=(t>>16)+(e>>16)+(n>>16);return r<<16|65535&n}function j(t,e){return t<<e|t>>>32-e}function M(t,e,n,r,i,o){return P(j(P(P(e,t),P(r,o)),i),n)}function D(t,e,n,r,i,o,a){return M(e&n|~e&r,t,e,i,o,a)}function R(t,e,n,r,i,o,a){return M(e&r|n&~r,t,e,i,o,a)}function A(t,e,n,r,i,o,a){return M(e^n^r,t,e,i,o,a)}function N(t,e,n,r,i,o,a){return M(n^(e|~r),t,e,i,o,a)}var L=O,B=x("v3",48,L),V=B;function F(t,e,n){t=t||{};var r=t.random||(t.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return p(r)}var U=F;function W(t,e,n,r){switch(t){case 0:return e&n^~e&r;case 1:return e^n^r;case 2:return e&n^e&r^n&r;case 3:return e^n^r}}function z(t,e){return t<<e|t>>>32-e}function G(t){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"===typeof t){var r=unescape(encodeURIComponent(t));t=[];for(var i=0;i<r.length;++i)t.push(r.charCodeAt(i))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var o=t.length/4+2,a=Math.ceil(o/16),s=new Array(a),c=0;c<a;++c){for(var l=new Uint32Array(16),u=0;u<16;++u)l[u]=t[64*c+4*u]<<24|t[64*c+4*u+1]<<16|t[64*c+4*u+2]<<8|t[64*c+4*u+3];s[c]=l}s[a-1][14]=8*(t.length-1)/Math.pow(2,32),s[a-1][14]=Math.floor(s[a-1][14]),s[a-1][15]=8*(t.length-1)&4294967295;for(var h=0;h<a;++h){for(var d=new Uint32Array(80),f=0;f<16;++f)d[f]=s[h][f];for(var p=16;p<80;++p)d[p]=z(d[p-3]^d[p-8]^d[p-14]^d[p-16],1);for(var g=n[0],v=n[1],m=n[2],b=n[3],y=n[4],S=0;S<80;++S){var w=Math.floor(S/20),E=z(g,5)+W(w,v,m,b)+y+e[w]+d[S]>>>0;y=b,b=m,m=z(v,30)>>>0,v=g,g=E}n[0]=n[0]+g>>>0,n[1]=n[1]+v>>>0,n[2]=n[2]+m>>>0,n[3]=n[3]+b>>>0,n[4]=n[4]+y>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}var H=G,Y=x("v5",80,H),X=Y,q="00000000-0000-0000-0000-000000000000";function $(t){if(!c(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)}var J=$},d30c:function(t,e,n){var r=n("75ee"),i=n("a4b2");e.JsonRPC=r,e.XmlRPC=i},d5e5:function(t,e,n){"use strict";t.exports={isObject:function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},extend:function(t){if(!this.isObject(t))return t;for(var e,n,r=1,i=arguments.length;r<i;r++)for(n in e=arguments[r],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}}},d714:function(t,e,n){},d784:function(t,e,n){"use strict";n("ac1f");var r=n("e330"),i=n("6eeb"),o=n("9263"),a=n("d039"),s=n("b622"),c=n("9112"),l=s("species"),u=RegExp.prototype;t.exports=function(t,e,n,h){var d=s(t),f=!a((function(){var e={};return e[d]=function(){return 7},7!=""[t](e)})),p=f&&!a((function(){var e=!1,n=/a/;return"split"===t&&(n={},n.constructor={},n.constructor[l]=function(){return n},n.flags="",n[d]=/./[d]),n.exec=function(){return e=!0,null},n[d](""),!e}));if(!f||!p||n){var g=r(/./[d]),v=e(d,""[t],(function(t,e,n,i,a){var s=r(t),c=e.exec;return c===o||c===u.exec?f&&!a?{done:!0,value:g(e,n,i)}:{done:!0,value:s(n,e,i)}:{done:!1}}));i(String.prototype,t,v[0]),i(u,d,v[1])}h&&c(u[d],"sham",!0)}},d8d6:function(t,e,n){"use strict";(function(e){var r=n("ada0").EventEmitter,i=n("3fb5"),o=n("c282"),a=n("621f"),s=e.XMLHttpRequest,c=function(){};function l(t,e,n,i){c(t,e);var o=this;r.call(this),setTimeout((function(){o._start(t,e,n,i)}),0)}i(l,r),l.prototype._start=function(t,e,n,r){var i=this;try{this.xhr=new s}catch(h){}if(!this.xhr)return c("no xhr"),this.emit("finish",0,"no xhr support"),void this._cleanup();e=a.addQuery(e,"t="+ +new Date),this.unloadRef=o.unloadAdd((function(){c("unload cleanup"),i._cleanup(!0)}));try{this.xhr.open(t,e,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){c("xhr timeout"),i.emit("finish",0,""),i._cleanup(!1)})}catch(d){return c("exception",d),this.emit("finish",0,""),void this._cleanup(!1)}if(r&&r.noCredentials||!l.supportsCORS||(c("withCredentials"),this.xhr.withCredentials=!0),r&&r.headers)for(var u in r.headers)this.xhr.setRequestHeader(u,r.headers[u]);this.xhr.onreadystatechange=function(){if(i.xhr){var t,e,n=i.xhr;switch(c("readyState",n.readyState),n.readyState){case 3:try{e=n.status,t=n.responseText}catch(d){}c("status",e),1223===e&&(e=204),200===e&&t&&t.length>0&&(c("chunk"),i.emit("chunk",e,t));break;case 4:e=n.status,c("status",e),1223===e&&(e=204),12005!==e&&12029!==e||(e=0),c("finish",e,n.responseText),i.emit("finish",e,n.responseText),i._cleanup(!1);break}}};try{i.xhr.send(n)}catch(d){i.emit("finish",0,""),i._cleanup(!1)}},l.prototype._cleanup=function(t){if(c("cleanup"),this.xhr){if(this.removeAllListeners(),o.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),t)try{this.xhr.abort()}catch(e){}this.unloadRef=this.xhr=null}},l.prototype.close=function(){c("close"),this._cleanup(!0)},l.enabled=!!s;var u=["Active"].concat("Object").join("X");!l.enabled&&u in e&&(c("overriding xmlhttprequest"),s=function(){try{return new e[u]("Microsoft.XMLHTTP")}catch(t){return null}},l.enabled=!!new s);var h=!1;try{h="withCredentials"in new s}catch(d){}l.supportsCORS=h,t.exports=l}).call(this,n("c8ba"))},d9e2:function(t,e,n){var r=n("23e7"),i=n("da84"),o=n("2ba4"),a=n("e5cb"),s="WebAssembly",c=i[s],l=7!==Error("e",{cause:7}).cause,u=function(t,e){var n={};n[t]=a(t,e,l),r({global:!0,forced:l},n)},h=function(t,e){if(c&&c[t]){var n={};n[t]=a(s+"."+t,e,l),r({target:s,stat:!0,forced:l},n)}};u("Error",(function(t){return function(e){return o(t,this,arguments)}})),u("EvalError",(function(t){return function(e){return o(t,this,arguments)}})),u("RangeError",(function(t){return function(e){return o(t,this,arguments)}})),u("ReferenceError",(function(t){return function(e){return o(t,this,arguments)}})),u("SyntaxError",(function(t){return function(e){return o(t,this,arguments)}})),u("TypeError",(function(t){return function(e){return o(t,this,arguments)}})),u("URIError",(function(t){return function(e){return o(t,this,arguments)}})),h("CompileError",(function(t){return function(e){return o(t,this,arguments)}})),h("LinkError",(function(t){return function(e){return o(t,this,arguments)}})),h("RuntimeError",(function(t){return function(e){return o(t,this,arguments)}}))},dd13:function(t,e,n){"use strict";n("e29d")},df09:function(t,e,n){"use strict";var r=n("3fb5"),i=n("d8d6");function o(t,e,n,r){i.call(this,t,e,n,r)}r(o,i),o.enabled=i.enabled&&i.supportsCORS,t.exports=o},e01a:function(t,e,n){"use strict";var r=n("23e7"),i=n("83ab"),o=n("da84"),a=n("e330"),s=n("1a2d"),c=n("1626"),l=n("3a9b"),u=n("577e"),h=n("9bf2").f,d=n("e893"),f=o.Symbol,p=f&&f.prototype;if(i&&c(f)&&(!("description"in p)||void 0!==f().description)){var g={},v=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:u(arguments[0]),e=l(p,this)?new f(t):void 0===t?f():f(t);return""===t&&(g[e]=!0),e};d(v,f),v.prototype=p,p.constructor=v;var m="Symbol(test)"==String(f("test")),b=a(p.toString),y=a(p.valueOf),S=/^Symbol\((.*)\)[^)]+$/,w=a("".replace),E=a("".slice);h(p,"description",{configurable:!0,get:function(){var t=y(this),e=b(t);if(s(g,t))return"";var n=m?E(e,7,-1):w(e,S,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:v})}},e0ef:function(t,e,n){var r;
/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */(function(e){"use strict";function i(){}var o=i.prototype,a=e.EventEmitter;function s(t,e){var n=t.length;while(n--)if(t[n].listener===e)return n;return-1}function c(t){return function(){return this[t].apply(this,arguments)}}function l(t){return"function"===typeof t||t instanceof RegExp||!(!t||"object"!==typeof t)&&l(t.listener)}o.getListeners=function(t){var e,n,r=this._getEvents();if(t instanceof RegExp)for(n in e={},r)r.hasOwnProperty(n)&&t.test(n)&&(e[n]=r[n]);else e=r[t]||(r[t]=[]);return e},o.flattenListeners=function(t){var e,n=[];for(e=0;e<t.length;e+=1)n.push(t[e].listener);return n},o.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&(e={},e[t]=n),e||n},o.addListener=function(t,e){if(!l(e))throw new TypeError("listener must be a function");var n,r=this.getListenersAsObject(t),i="object"===typeof e;for(n in r)r.hasOwnProperty(n)&&-1===s(r[n],e)&&r[n].push(i?e:{listener:e,once:!1});return this},o.on=c("addListener"),o.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},o.once=c("addOnceListener"),o.defineEvent=function(t){return this.getListeners(t),this},o.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},o.removeListener=function(t,e){var n,r,i=this.getListenersAsObject(t);for(r in i)i.hasOwnProperty(r)&&(n=s(i[r],e),-1!==n&&i[r].splice(n,1));return this},o.off=c("removeListener"),o.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},o.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},o.manipulateListeners=function(t,e,n){var r,i,o=t?this.removeListener:this.addListener,a=t?this.removeListeners:this.addListeners;if("object"!==typeof e||e instanceof RegExp){r=n.length;while(r--)o.call(this,e,n[r])}else for(r in e)e.hasOwnProperty(r)&&(i=e[r])&&("function"===typeof i?o.call(this,r,i):a.call(this,r,i));return this},o.removeEvent=function(t){var e,n=typeof t,r=this._getEvents();if("string"===n)delete r[t];else if(t instanceof RegExp)for(e in r)r.hasOwnProperty(e)&&t.test(e)&&delete r[e];else delete this._events;return this},o.removeAllListeners=c("removeEvent"),o.emitEvent=function(t,e){var n,r,i,o,a,s=this.getListenersAsObject(t);for(o in s)if(s.hasOwnProperty(o))for(n=s[o].slice(0),i=0;i<n.length;i++)r=n[i],!0===r.once&&this.removeListener(t,r.listener),a=r.listener.apply(this,e||[]),a===this._getOnceReturnValue()&&this.removeListener(t,r.listener);return this},o.trigger=c("emitEvent"),o.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},o.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},o._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},o._getEvents=function(){return this._events||(this._events={})},i.noConflict=function(){return e.EventEmitter=a,i},r=function(){return i}.call(e,n,e,t),void 0===r||(t.exports=r)})("undefined"!==typeof window?window:this||{})},e1ff:function(t,e,n){"use strict";n("6675")},e20c:function(t,e,n){},e237:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlatformUtils=void 0;var r=n("faac"),i=function(){function t(){}return t.getInstance=function(){return this.instance||(this.instance=new t),t.instance},t.prototype.isChromeBrowser=function(){return"Chrome"===r.name},t.prototype.isSafariBrowser=function(){return"Safari"===r.name},t.prototype.isChromeMobileBrowser=function(){return"Chrome Mobile"===r.name},t.prototype.isFirefoxBrowser=function(){return"Firefox"===r.name},t.prototype.isFirefoxMobileBrowser=function(){return"Firefox Mobile"===r.name||"Firefox for iOS"===r.name},t.prototype.isOperaBrowser=function(){return"Opera"===r.name},t.prototype.isOperaMobileBrowser=function(){return"Opera Mobile"===r.name},t.prototype.isEdgeBrowser=function(){var t=(null===r||void 0===r?void 0:r.version)?parseFloat(r.version):-1;return"Microsoft Edge"===r.name&&t>=80},t.prototype.isEdgeMobileBrowser=function(){var t,e,n=(null===r||void 0===r?void 0:r.version)?parseFloat(r.version):-1;return"Microsoft Edge"===r.name&&("Android"===(null===(t=r.os)||void 0===t?void 0:t.family)||"iOS"===(null===(e=r.os)||void 0===e?void 0:e.family))&&n>45},t.prototype.isAndroidBrowser=function(){return"Android Browser"===r.name},t.prototype.isElectron=function(){return"Electron"===r.name},t.prototype.isSamsungBrowser=function(){return"Samsung Internet Mobile"===r.name||"Samsung Internet"===r.name},t.prototype.isIPhoneOrIPad=function(){var t=r.ua?r.ua:navigator.userAgent,e="ontouchend"in document,n=/\b(\w*Macintosh\w*)\b/.test(t)&&e,i=/\b(\w*iPhone\w*)\b/.test(t)&&/\b(\w*Mobile\w*)\b/.test(t)&&e;return n||i},t.prototype.isIOSWithSafari=function(){var t=r.ua?r.ua:navigator.userAgent;return this.isIPhoneOrIPad()&&/\b(\w*Apple\w*)\b/.test(navigator.vendor)&&/\b(\w*Safari\w*)\b/.test(t)&&!/\b(\w*CriOS\w*)\b/.test(t)&&!/\b(\w*FxiOS\w*)\b/.test(t)},t.prototype.isIonicIos=function(){return this.isIPhoneOrIPad()&&-1===r.ua.indexOf("Safari")},t.prototype.isIonicAndroid=function(){return"Android"===r.os.family&&"Android Browser"==r.name},t.prototype.isMobileDevice=function(){return"iOS"===r.os.family||"Android"===r.os.family},t.prototype.isReactNative=function(){return!1},t.prototype.isChromium=function(){return this.isChromeBrowser()||this.isChromeMobileBrowser()||this.isOperaBrowser()||this.isOperaMobileBrowser()||this.isEdgeBrowser()||this.isEdgeMobileBrowser()||this.isSamsungBrowser()||this.isIonicAndroid()||this.isIonicIos()||this.isElectron()},t.prototype.canScreenShare=function(){var t=(null===r||void 0===r?void 0:r.version)?parseFloat(r.version):-1;return!this.isMobileDevice()&&(this.isChromeBrowser()||this.isFirefoxBrowser()||this.isOperaBrowser()||this.isElectron()||this.isEdgeBrowser()||this.isSafariBrowser()&&t>=13)},t.prototype.getName=function(){return r.name||""},t.prototype.getVersion=function(){return r.version||""},t.prototype.getFamily=function(){return r.os.family||""},t.prototype.getDescription=function(){return r.description||""},t}();e.PlatformUtils=i},e29d:function(t,e,n){},e2b3:function(t,e,n){"use strict";var r=n("3fb5"),i=n("7577"),o=n("1548"),a=n("df09"),s=n("73aa");function c(t){if(!s.enabled&&!a.enabled)throw new Error("Transport created when disabled");i.call(this,t,"/xhr",o,a)}r(c,i),c.enabled=function(t){return!t.nullOrigin&&(!(!s.enabled||!t.sameOrigin)||a.enabled)},c.transportName="xhr-polling",c.roundTrips=2,t.exports=c},e362:function(t,e,n){"use strict";var r=n("3fb5"),i=n("9a83");function o(){i.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}r(o,i),t.exports=o},e391:function(t,e,n){var r=n("577e");t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:r(t)}},e3db:function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},e556:function(t,e,n){"use strict";var r=n("3fb5"),i=n("7577"),o=n("b185"),a=n("1548"),s=n("9d7d");function c(t){if(!s.enabled)throw new Error("Transport created when disabled");i.call(this,t,"/xhr",a,s)}r(c,i),c.enabled=o.enabled,c.transportName="xdr-polling",c.roundTrips=2,t.exports=c},e5b5:function(t){t.exports=JSON.parse('["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302","stun.ekiga.net","stun.ideasip.com","stun.schlund.de","stun.stunprotocol.org:3478","stun.voiparound.com","stun.voipbuster.com","stun.voipstunt.com","stun.voxgratia.org"]')},e5cb:function(t,e,n){"use strict";var r=n("d066"),i=n("1a2d"),o=n("9112"),a=n("3a9b"),s=n("d2bb"),c=n("e893"),l=n("7156"),u=n("e391"),h=n("ab36"),d=n("c770"),f=n("b980"),p=n("c430");t.exports=function(t,e,n,g){var v=g?2:1,m=t.split("."),b=m[m.length-1],y=r.apply(null,m);if(y){var S=y.prototype;if(!p&&i(S,"cause")&&delete S.cause,!n)return y;var w=r("Error"),E=e((function(t,e){var n=u(g?e:t,void 0),r=g?new y(t):new y;return void 0!==n&&o(r,"message",n),f&&o(r,"stack",d(r.stack,2)),this&&a(S,this)&&l(r,this,E),arguments.length>v&&h(r,arguments[v]),r}));if(E.prototype=S,"Error"!==b&&(s?s(E,w):c(E,w,{name:!0})),c(E,y),!p)try{S.name!==b&&o(S,"name",b),S.constructor=E}catch(C){}return E}}},e649:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},i.apply(this,arguments)},o=this&&this.__awaiter||function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{c(r.next(t))}catch(e){o(e)}}function s(t){try{c(r["throw"](t))}catch(e){o(e)}}function c(t){t.done?n(t.value):i(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return c([t,e])}}function c(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.WebRtcPeerSendrecv=e.WebRtcPeerSendonly=e.WebRtcPeerRecvonly=e.WebRtcPeer=void 0;var s=n("f1f1"),c=n("d2ca"),l=n("e9cb"),u=n("f66e"),h=n("e237"),d=u.OpenViduLogger.getInstance(),f=[{rid:"r0",scaleResolutionDownBy:4},{rid:"r1",scaleResolutionDownBy:2},{rid:"r2",scaleResolutionDownBy:1}],p=function(){function t(t){var e=this;this.remoteCandidatesQueue=[],this.localCandidatesQueue=[],this.iceCandidateList=[],this.candidategatheringdone=!1,h.PlatformUtils.getInstance(),this.configuration=i(i({},t),{iceServers:t.iceServers&&t.iceServers.length>0?t.iceServers:s(),mediaStream:void 0!==t.mediaStream?t.mediaStream:null,mode:t.mode?t.mode:"sendrecv",id:t.id?t.id:this.generateUniqueId()}),this.pc=new RTCPeerConnection({iceServers:this.configuration.iceServers}),this.pc.addEventListener("icecandidate",(function(t){if(null!=t.candidate){var n=t.candidate;e.configuration.onIceCandidate(n),""!==n.candidate&&e.localCandidatesQueue.push({candidate:n.candidate})}})),this.pc.addEventListener("signalingstatechange",(function(){if("stable"===e.pc.signalingState)while(e.iceCandidateList.length>0){var t=e.iceCandidateList.shift();e.pc.addIceCandidate(t)}}))}return t.prototype.getId=function(){return this.configuration.id},t.prototype.dispose=function(){if(d.debug("Disposing WebRtcPeer"),this.pc){if("closed"===this.pc.signalingState)return;this.pc.close(),this.remoteCandidatesQueue=[],this.localCandidatesQueue=[]}},t.prototype.createOffer=function(){var t=this;return new Promise((function(e,n){return o(t,void 0,void 0,(function(){var t,r,i,o,s,c,l,u,h,p,g,v;return a(this,(function(a){switch(a.label){case 0:if(!("addTransceiver"in this.pc))return[3,7];if(d.debug("[createOffer] Method RTCPeerConnection.addTransceiver() is available; using it"),"recvonly"===this.configuration.mode)return[3,5];if(!this.configuration.mediaStream)return n(new Error(this.configuration.mode+" direction requested, but no stream was configured to be sent")),[2];t=0,r=this.configuration.mediaStream.getTracks(),a.label=1;case 1:return t<r.length?(i=r[t],o={direction:this.configuration.mode,streams:[this.configuration.mediaStream]},this.configuration.simulcast&&"video"===i.kind&&(o.sendEncodings=f),s=this.pc.addTransceiver(i,o),this.configuration.simulcast&&"video"===i.kind?(c=s.sender.getParameters(),"encodings"in c&&c.encodings.length===o.sendEncodings.length?[3,3]:(c.encodings=o.sendEncodings,[4,s.sender.setParameters(c)])):[3,3]):[3,4];case 2:a.sent(),a.label=3;case 3:return t++,[3,1];case 4:return[3,6];case 5:for(l=0,u=["audio","video"];l<u.length;l++)h=u[l],this.configuration.mediaConstraints[h]&&(this.configuration.mediaStream=new MediaStream,this.pc.addTransceiver(h,{direction:this.configuration.mode,streams:[this.configuration.mediaStream]}));a.label=6;case 6:return this.pc.createOffer().then((function(t){return e(t)})).catch((function(t){return n(t)})),[3,8];case 7:d.warn("[createOffer] Method RTCPeerConnection.addTransceiver() is NOT available; using LEGACY offerToReceive{Audio,Video}"),this.configuration.mediaStream&&this.deprecatedPeerConnectionTrackApi(),p=this.configuration.mediaConstraints.audio,g=this.configuration.mediaConstraints.video,v={offerToReceiveAudio:"sendonly"!==this.configuration.mode&&p,offerToReceiveVideo:"sendonly"!==this.configuration.mode&&g},d.debug("RTCPeerConnection.createOffer() options:",JSON.stringify(v)),this.pc.createOffer(v).then((function(t){return e(t)})).catch((function(t){return n(t)})),a.label=8;case 8:return[2]}}))}))}))},t.prototype.deprecatedPeerConnectionTrackApi=function(){for(var t=0,e=this.configuration.mediaStream.getTracks();t<e.length;t++){var n=e[t];this.pc.addTrack(n,this.configuration.mediaStream)}},t.prototype.createAnswer=function(){var t=this;return new Promise((function(e,n){if("getTransceivers"in t.pc){d.debug("[createAnswer] Method RTCPeerConnection.getTransceivers() is available; using it");for(var r=function(e){if(!t.configuration.mediaConstraints[e])return"continue";var r=t.pc.getTransceivers().find((function(t){return t.receiver.track.kind===e}));r?r.direction=t.configuration.mode:n(new Error(e+" requested, but no transceiver was created from remote description"))},i=0,o=["audio","video"];i<o.length;i++){var a=o[i];r(a)}t.pc.createAnswer().then((function(t){return e(t)})).catch((function(t){return n(t)}))}else{var s=void 0,c=!0;if(t.configuration.mediaConstraints){s="boolean"!==typeof t.configuration.mediaConstraints.audio||t.configuration.mediaConstraints.audio,c="boolean"!==typeof t.configuration.mediaConstraints.video||t.configuration.mediaConstraints.video;var l={offerToReceiveAudio:s,offerToReceiveVideo:c};t.pc.createAnswer(l).then((function(t){e(t)})).catch((function(t){n(t)}))}}}))},t.prototype.processLocalOffer=function(t){var e=this;return new Promise((function(n,r){e.pc.setLocalDescription(t).then((function(){var t=e.pc.localDescription;t?(d.debug("Local description set",t.sdp),n()):r("Local description is not defined")})).catch((function(t){r(t)}))}))},t.prototype.processRemoteOffer=function(t){var e=this;return new Promise((function(n,r){var i={type:"offer",sdp:t};d.debug("SDP offer received, setting remote description",i),"closed"===e.pc.signalingState&&r("RTCPeerConnection is closed when trying to set remote description"),e.setRemoteDescription(i).then((function(){n()})).catch((function(t){r(t)}))}))},t.prototype.processLocalAnswer=function(t){var e=this;return new Promise((function(n,r){d.debug("SDP answer created, setting local description"),"closed"===e.pc.signalingState&&r("RTCPeerConnection is closed when trying to set local description"),e.pc.setLocalDescription(t).then((function(){return n()})).catch((function(t){return r(t)}))}))},t.prototype.processRemoteAnswer=function(t){var e=this;return new Promise((function(n,r){var i={type:"answer",sdp:t};d.debug("SDP answer received, setting remote description"),"closed"===e.pc.signalingState&&r("RTCPeerConnection is closed when trying to set remote description"),e.setRemoteDescription(i).then((function(){return n()})).catch((function(t){return r(t)}))}))},t.prototype.setRemoteDescription=function(t){return o(this,void 0,void 0,(function(){return a(this,(function(e){return[2,this.pc.setRemoteDescription(t)]}))}))},t.prototype.addIceCandidate=function(t){var e=this;return new Promise((function(n,r){switch(d.debug("Remote ICE candidate received",t),e.remoteCandidatesQueue.push(t),e.pc.signalingState){case"closed":r(new Error("PeerConnection object is closed"));break;case"stable":e.pc.remoteDescription?e.pc.addIceCandidate(t).then((function(){return n()})).catch((function(t){return r(t)})):(e.iceCandidateList.push(t),n());break;default:e.iceCandidateList.push(t),n()}}))},t.prototype.addIceConnectionStateChangeListener=function(t){var e=this;this.pc.addEventListener("iceconnectionstatechange",(function(){var n=e.pc.iceConnectionState;switch(n){case"disconnected":var r="IceConnectionState of RTCPeerConnection "+e.configuration.id+" ("+t+') change to "disconnected". Possible network disconnection';d.warn(r),e.configuration.onIceConnectionStateException(l.ExceptionEventName.ICE_CONNECTION_DISCONNECTED,r);break;case"failed":var i="IceConnectionState of RTCPeerConnection "+e.configuration.id+" ("+t+') to "failed"';d.error(i),e.configuration.onIceConnectionStateException(l.ExceptionEventName.ICE_CONNECTION_FAILED,i);break;case"closed":d.log("IceConnectionState of RTCPeerConnection "+e.configuration.id+" ("+t+') change to "closed"');break;case"new":d.log("IceConnectionState of RTCPeerConnection "+e.configuration.id+" ("+t+') change to "new"');break;case"checking":d.log("IceConnectionState of RTCPeerConnection "+e.configuration.id+" ("+t+') change to "checking"');break;case"connected":d.log("IceConnectionState of RTCPeerConnection "+e.configuration.id+" ("+t+') change to "connected"');break;case"completed":d.log("IceConnectionState of RTCPeerConnection "+e.configuration.id+" ("+t+') change to "completed"');break}}))},t.prototype.generateUniqueId=function(){return c.v4()},t}();e.WebRtcPeer=p;var g=function(t){function e(e){var n=this;return e.mode="recvonly",n=t.call(this,e)||this,n}return r(e,t),e}(p);e.WebRtcPeerRecvonly=g;var v=function(t){function e(e){var n=this;return e.mode="sendonly",n=t.call(this,e)||this,n}return r(e,t),e}(p);e.WebRtcPeerSendonly=v;var m=function(t){function e(e){var n=this;return e.mode="sendrecv",n=t.call(this,e)||this,n}return r(e,t),e}(p);e.WebRtcPeerSendrecv=m},e93c:function(t,e,n){t.exports=n.p+"img/icon_download.df9e9b1c.png"},e998:function(t,e,n){"use strict";var r=n("3fb5"),i=n("ada0").EventEmitter,o=function(){};function a(t,e){o(t),i.call(this),this.sendBuffer=[],this.sender=e,this.url=t}r(a,i),a.prototype.send=function(t){o("send",t),this.sendBuffer.push(t),this.sendStop||this.sendSchedule()},a.prototype.sendScheduleWait=function(){o("sendScheduleWait");var t,e=this;this.sendStop=function(){o("sendStop"),e.sendStop=null,clearTimeout(t)},t=setTimeout((function(){o("timeout"),e.sendStop=null,e.sendSchedule()}),25)},a.prototype.sendSchedule=function(){o("sendSchedule",this.sendBuffer.length);var t=this;if(this.sendBuffer.length>0){var e="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,e,(function(e){t.sendStop=null,e?(o("error",e),t.emit("close",e.code||1006,"Sending error: "+e),t.close()):t.sendScheduleWait()})),this.sendBuffer=[]}},a.prototype._cleanup=function(){o("_cleanup"),this.removeAllListeners()},a.prototype.close=function(){o("close"),this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)},t.exports=a},e9c4:function(t,e,n){var r=n("23e7"),i=n("da84"),o=n("d066"),a=n("2ba4"),s=n("e330"),c=n("d039"),l=i.Array,u=o("JSON","stringify"),h=s(/./.exec),d=s("".charAt),f=s("".charCodeAt),p=s("".replace),g=s(1..toString),v=/[\uD800-\uDFFF]/g,m=/^[\uD800-\uDBFF]$/,b=/^[\uDC00-\uDFFF]$/,y=function(t,e,n){var r=d(n,e-1),i=d(n,e+1);return h(m,t)&&!h(b,i)||h(b,t)&&!h(m,r)?"\\u"+g(f(t,0),16):t},S=c((function(){return'"\\udf06\\ud834"'!==u("\udf06\ud834")||'"\\udead"'!==u("\udead")}));u&&r({target:"JSON",stat:!0,forced:S},{stringify:function(t,e,n){for(var r=0,i=arguments.length,o=l(i);r<i;r++)o[r]=arguments[r];var s=a(u,null,o);return"string"==typeof s?p(s,v,y):s}})},e9cb:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ExceptionEvent=e.ExceptionEventName=void 0;var i=n("8733");(function(t){t["ICE_CANDIDATE_ERROR"]="ICE_CANDIDATE_ERROR",t["ICE_CONNECTION_FAILED"]="ICE_CONNECTION_FAILED",t["ICE_CONNECTION_DISCONNECTED"]="ICE_CONNECTION_DISCONNECTED",t["NO_STREAM_PLAYING_EVENT"]="NO_STREAM_PLAYING_EVENT"})(e.ExceptionEventName||(e.ExceptionEventName={}));var o=function(t){function e(e,n,r,i,o){var a=t.call(this,!1,e,"exception")||this;return a.name=n,a.origin=r,a.message=i,a.data=o,a}return r(e,t),e.prototype.callDefaultBehavior=function(){},e}(i.Event);e.ExceptionEvent=o},ef86:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Filter=void 0;var r=n("0703"),i=n("4edf"),o=n("f66e"),a=o.OpenViduLogger.getInstance(),s=function(){function t(t,e){this.handlers=new Map,this.type=t,this.options=e}return t.prototype.execMethod=function(t,e){var n=this;return new Promise((function(o,s){var c;if(a.info("Executing filter method to stream "+n.stream.streamId),"string"!==typeof e)try{c=JSON.stringify(e)}catch(u){var l="'params' property must be a JSON formatted object";a.error(l),s(l)}else c=e;n.stream.session.openvidu.sendRequest("execFilterMethod",{streamId:n.stream.streamId,method:t,params:c},(function(e,l){if(e)a.error("Error executing filter method for Stream "+n.stream.streamId,e),401===e.code?s(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to execute a filter method")):s(e);else{a.info("Filter method successfully executed on Stream "+n.stream.streamId);var u=Object.assign({},n.stream.filter);n.stream.filter.lastExecMethod={method:t,params:JSON.parse(c)},n.stream.session.emitEvent("streamPropertyChanged",[new r.StreamPropertyChangedEvent(n.stream.session,n.stream,"filter",n.stream.filter,u,"execFilterMethod")]),n.stream.streamManager.emitEvent("streamPropertyChanged",[new r.StreamPropertyChangedEvent(n.stream.streamManager,n.stream,"filter",n.stream.filter,u,"execFilterMethod")]),o()}}))}))},t.prototype.addEventListener=function(t,e){var n=this;return new Promise((function(r,o){a.info("Adding filter event listener to event "+t+" to stream "+n.stream.streamId),n.stream.session.openvidu.sendRequest("addFilterEventListener",{streamId:n.stream.streamId,eventType:t},(function(s,c){s?(a.error("Error adding filter event listener to event "+t+"for Stream "+n.stream.streamId,s),401===s.code?o(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):o(s)):(n.handlers.set(t,e),a.info("Filter event listener to event "+t+" successfully applied on Stream "+n.stream.streamId),r())}))}))},t.prototype.removeEventListener=function(t){var e=this;return new Promise((function(n,r){a.info("Removing filter event listener to event "+t+" to stream "+e.stream.streamId),e.stream.session.openvidu.sendRequest("removeFilterEventListener",{streamId:e.stream.streamId,eventType:t},(function(o,s){o?(a.error("Error removing filter event listener to event "+t+"for Stream "+e.stream.streamId,o),401===o.code?r(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):r(o)):(e.handlers.delete(t),a.info("Filter event listener to event "+t+" successfully removed on Stream "+e.stream.streamId),n())}))}))},t}();e.Filter=s},f0a5:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionEvent=void 0;var i=n("8733"),o=function(t){function e(e,n,r,i,o){var a=t.call(this,e,n,r)||this;return a.connection=i,a.reason=o,a}return r(e,t),e.prototype.callDefaultBehavior=function(){},e}(i.Event);e.ConnectionEvent=o},f100:function(t,e,n){t.exports=n.p+"img/studyroom.68be427e.png"},f1bf:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionPropertyChangedEvent=void 0;var i=n("8733"),o=function(t){function e(e,n,r,i,o){var a=t.call(this,!1,e,"connectionPropertyChanged")||this;return a.connection=n,a.changedProperty=r,a.newValue=i,a.oldValue=o,a}return r(e,t),e.prototype.callDefaultBehavior=function(){},e}(i.Event);e.ConnectionPropertyChangedEvent=o},f1f1:function(t,e,n){"use strict";var r=n("a21b"),i=function(t){var e,i={stun:(t||{}).stun||n("e5b5"),turn:(t||{}).turn||n("c09e")},o=(t||{}).stunCount||2,a=(t||{}).turnCount||0;function s(t,e){var n,o=[],a=[].concat(i[t]);while(a.length&&o.length<e)n=Math.random()*a.length|0,o=o.concat(a.splice(n,1));return o.map((function(e){return"string"===typeof e||e instanceof String?r(t+":"+e):e}))}return e=[].concat(s("stun",o)),a&&(e=e.concat(s("turn",a))),e};t.exports=i},f1f8:function(t,e,n){"use strict";(function(e){var r=n("c282"),i=n("930c"),o=n("26a0"),a=function(){};t.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){t.exports.WPrefix in e||(e[t.exports.WPrefix]={})},postMessage:function(n,r){e.parent!==e?e.parent.postMessage(i.stringify({windowId:t.exports.currentWindowId,type:n,data:r||""}),"*"):a("Cannot postMessage, no parent window.",n,r)},createIframe:function(t,n){var i,o,s=e.document.createElement("iframe"),c=function(){a("unattach"),clearTimeout(i);try{s.onload=null}catch(t){}s.onerror=null},l=function(){a("cleanup"),s&&(c(),setTimeout((function(){s&&s.parentNode.removeChild(s),s=null}),0),r.unloadDel(o))},u=function(t){a("onerror",t),s&&(l(),n(t))},h=function(t,e){a("post",t,e),setTimeout((function(){try{s&&s.contentWindow&&s.contentWindow.postMessage(t,e)}catch(n){}}),0)};return s.src=t,s.style.display="none",s.style.position="absolute",s.onerror=function(){u("onerror")},s.onload=function(){a("onload"),clearTimeout(i),i=setTimeout((function(){u("onload timeout")}),2e3)},e.document.body.appendChild(s),i=setTimeout((function(){u("timeout")}),15e3),o=r.unloadAdd(l),{post:h,cleanup:l,loaded:c}},createHtmlfile:function(n,i){var o,s,c,l=["Active"].concat("Object").join("X"),u=new e[l]("htmlfile"),h=function(){clearTimeout(o),c.onerror=null},d=function(){u&&(h(),r.unloadDel(s),c.parentNode.removeChild(c),c=u=null,CollectGarbage())},f=function(t){a("onerror",t),u&&(d(),i(t))},p=function(t,e){try{setTimeout((function(){c&&c.contentWindow&&c.contentWindow.postMessage(t,e)}),0)}catch(n){}};u.open(),u.write('<html><script>document.domain="'+e.document.domain+'";<\/script></html>'),u.close(),u.parentWindow[t.exports.WPrefix]=e[t.exports.WPrefix];var g=u.createElement("div");return u.body.appendChild(g),c=u.createElement("iframe"),g.appendChild(c),c.src=n,c.onerror=function(){f("onerror")},o=setTimeout((function(){f("timeout")}),15e3),s=r.unloadAdd(d),{post:p,cleanup:d,loaded:h}}},t.exports.iframeEnabled=!1,e.document&&(t.exports.iframeEnabled=("function"===typeof e.postMessage||"object"===typeof e.postMessage)&&!o.isKonqueror())}).call(this,n("c8ba"))},f3c7:function(t,e,n){"use strict";n("2e03")},f66e:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OpenViduLogger=void 0;var r=n("3029"),i=n("cf14"),o=n("49d9"),a=function(){function t(){this.JSNLOG_URL="/openvidu/elk/openvidu-browser-logs",this.MAX_JSNLOG_BATCH_LOG_MESSAGES=100,this.MAX_MSECONDS_BATCH_MESSAGES=5e3,this.MAX_LENGTH_STRING_JSON=1e3,this.defaultConsoleLogger=new i.ConsoleLogger(window.console),this.isProdMode=!1,this.isJSNLogSetup=!1}return t.configureJSNLog=function(t,e){var n=this;try{if(window["LOG_JSNLOG_RESULTS"]||this.instance&&t.isPro&&this.instance.isOpenViduBrowserLogsDebugActive(t)&&this.instance.canConfigureJSNLog(t,this.instance)){t.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug_app&&this.instance.replaceWindowConsole(),this.instance.isJSNLogSetup=!1,this.instance.info("Configuring JSNLogs.");var i=t.finalUserId,a=t.session.sessionId,s=function(t){var r=t.onreadystatechange;t.onreadystatechange=function(){n.isInvalidResponse(t)&&(Object.defineProperty(t,"readyState",{value:4}),Object.defineProperty(t,"status",{value:200}),n.instance.disableLogger()),r()},t.setRequestHeader("Authorization","Basic "+btoa(i+"%/%"+a+":"+e)),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.setRequestHeader("OV-Final-User-Id",i),t.setRequestHeader("OV-Session-Id",a),t.setRequestHeader("OV-Token",e)};this.instance.currentAppender=r.JL.createAjaxAppender("appender-"+i+"-"+a),this.instance.currentAppender.setOptions({beforeSend:s,maxBatchSize:1e3,batchSize:this.instance.MAX_JSNLOG_BATCH_LOG_MESSAGES,batchTimeout:this.instance.MAX_MSECONDS_BATCH_MESSAGES});var c=function(t){var e=function(){var t=new WeakSet;return function(e,n){if("object"===typeof n&&null!=n){if(t.has(n)||HTMLElement&&n instanceof HTMLElement)return;t.add(n)}return n}},r=JSON.stringify(t,e());return r.length>n.instance.MAX_LENGTH_STRING_JSON&&(r=r.substring(0,n.instance.MAX_LENGTH_STRING_JSON)+"..."),window["LOG_JSNLOG_RESULTS"]&&console.log(r),r};r.JL.setOptions({defaultAjaxUrl:t.httpUri+this.instance.JSNLOG_URL,serialize:c,enabled:!0}),r.JL().setOptions({appenders:[this.instance.currentAppender]}),this.instance.isJSNLogSetup=!0,this.instance.loggingSessionId=a,this.instance.info("JSNLog configured.")}}catch(l){console.error("Error configuring JSNLog: "),console.error(l),this.instance.disableLogger()}},t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.isInvalidResponse=function(t){return 401==t.status||403==t.status||404==t.status||0==t.status},t.prototype.canConfigureJSNLog=function(t,e){return t.session.sessionId!=e.loggingSessionId},t.prototype.isOpenViduBrowserLogsDebugActive=function(t){return t.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug||t.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug_app},t.prototype.getConsoleWithJSNLog=function(){return function(t){return{log:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.defaultConsoleLogger.log.apply(t.defaultConsoleLogger.logger,arguments),t.isJSNLogSetup&&r.JL().info(arguments)},info:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.defaultConsoleLogger.info.apply(t.defaultConsoleLogger.logger,arguments),t.isJSNLogSetup&&r.JL().info(arguments)},debug:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.defaultConsoleLogger.debug.apply(t.defaultConsoleLogger.logger,arguments)},warn:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.defaultConsoleLogger.warn.apply(t.defaultConsoleLogger.logger,arguments),t.isJSNLogSetup&&r.JL().warn(arguments)},error:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.defaultConsoleLogger.error.apply(t.defaultConsoleLogger.logger,arguments),t.isJSNLogSetup&&r.JL().error(arguments)}}}(this)},t.prototype.replaceWindowConsole=function(){window.console=this.defaultConsoleLogger.logger,window.console.log=this.getConsoleWithJSNLog().log,window.console.info=this.getConsoleWithJSNLog().info,window.console.debug=this.getConsoleWithJSNLog().debug,window.console.warn=this.getConsoleWithJSNLog().warn,window.console.error=this.getConsoleWithJSNLog().error},t.prototype.disableLogger=function(){r.JL.setOptions({enabled:!1}),this.isJSNLogSetup=!1,this.loggingSessionId=void 0,this.currentAppender=void 0,window.console=this.defaultConsoleLogger.logger,window.console.log=this.defaultConsoleLogger.log,window.console.info=this.defaultConsoleLogger.info,window.console.debug=this.defaultConsoleLogger.debug,window.console.warn=this.defaultConsoleLogger.warn,window.console.error=this.defaultConsoleLogger.error},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.isProdMode||this.defaultConsoleLogger.log.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&r.JL().info(arguments)},t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.isProdMode||this.defaultConsoleLogger.debug.apply(this.defaultConsoleLogger.logger,arguments)},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.isProdMode||this.defaultConsoleLogger.info.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&r.JL().info(arguments)},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.isProdMode||this.defaultConsoleLogger.warn.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&r.JL().warn(arguments)},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.defaultConsoleLogger.error.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&r.JL().error(arguments)},t.prototype.flush=function(){this.isJSNLogSetup&&null!=this.currentAppender&&this.currentAppender.sendBatch()},t.prototype.enableProdMode=function(){this.isProdMode=!0},t}();e.OpenViduLogger=a},f701:function(t,e,n){"use strict";var r=n("ada0").EventEmitter,i=n("3fb5");function o(){var t=this;r.call(this),this.to=setTimeout((function(){t.emit("finish",200,"{}")}),o.timeout)}i(o,r),o.prototype.close=function(){clearTimeout(this.to)},o.timeout=2e3,t.exports=o},f7a9:function(t,e,n){"use strict";var r=n("3fb5"),i=n("621f"),o=n("e998"),a=n("0e88"),s=function(){};function c(t,e,n,r,c){var l=i.addPath(t,e);s(l);var u=this;o.call(this,t,n),this.poll=new a(r,l,c),this.poll.on("message",(function(t){s("poll message",t),u.emit("message",t)})),this.poll.once("close",(function(t,e){s("poll close",t,e),u.poll=null,u.emit("close",t,e),u.close()}))}r(c,o),c.prototype.close=function(){o.prototype.close.call(this),s("close"),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)},t.exports=c},f84c:function(t,e,n){"use strict";(function(e){var r=n("3fb5"),i=n("f7a9"),o=n("f9f5"),a=n("bf4a");function s(t){if(!s.enabled())throw new Error("Transport created when disabled");i.call(this,t,"/jsonp",a,o)}r(s,i),s.enabled=function(){return!!e.document},s.transportName="jsonp-polling",s.roundTrips=1,s.needBody=!0,t.exports=s}).call(this,n("c8ba"))},f852:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{c(r.next(t))}catch(e){o(e)}}function s(t){try{c(r["throw"](t))}catch(e){o(e)}}function c(t){t.done?n(t.value):i(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return c([t,e])}}function c(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.WebRtcStats=void 0;var o,a=n("f66e"),s=n("e237"),c=a.OpenViduLogger.getInstance(),l=function(){function t(t){this.stream=t,this.STATS_ITEM_NAME="webrtc-stats-config",this.webRtcStatsEnabled=!1,this.statsInterval=1,o=s.PlatformUtils.getInstance()}return t.prototype.isEnabled=function(){return this.webRtcStatsEnabled},t.prototype.initWebRtcStats=function(){var t=this,e=localStorage.getItem(this.STATS_ITEM_NAME);if(e){this.webRtcStatsEnabled=!0;var n=JSON.parse(e);c.warn("WebRtc stats enabled for stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId),c.warn("localStorage item: "+JSON.stringify(n)),this.POST_URL=n.httpEndpoint,this.statsInterval=n.interval,this.webRtcStatsIntervalId=setInterval((function(){return r(t,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.sendStatsToHttpEndpoint()];case 1:return t.sent(),[2]}}))}))}),1e3*this.statsInterval)}else c.debug("WebRtc stats not enabled")},t.prototype.getSelectedIceCandidateInfo=function(){var t=this;return new Promise((function(e,n){return r(t,void 0,void 0,(function(){var t,n,r,a,s,c,l,u,h,d,f,p,g,v,m,b,y,S,w,E,C,x;return i(this,(function(i){switch(i.label){case 0:return[4,this.stream.getRTCPeerConnection().getStats()];case 1:if(t=i.sent(),r=new Map,a=new Map,s=new Map,t.forEach((function(t){switch("transport"===t.type&&(o.isChromium()||o.isSafariBrowser()||o.isReactNative())&&(n=t),t.type){case"candidate-pair":r.set(t.id,t);break;case"local-candidate":a.set(t.id,t);break;case"remote-candidate":s.set(t.id,t);break}})),null!=n)l=n.selectedCandidatePairId,c=r.get(l);else for(u=r.size,h=r.values(),d=0;d<u;d++)if(f=h.next().value,f["selected"]){c=f;break}if(p=c.localCandidateId,g=c.remoteCandidateId,v=a.get(p),v)for(S=this.stream.getLocalIceCandidateList(),w=S.filter((function(t){return!!t.candidate&&(t.candidate.indexOf(v.ip)>=0||t.candidate.indexOf(v.address)>=0)&&t.candidate.indexOf(v.port)>=0})),v.raw=[],m=0,b=w;m<b.length;m++)x=b[m],v.raw.push(x.candidate);else v="ERROR: No active local ICE candidate. Probably ICE-TCP is being used";if(y=s.get(g),y)for(S=this.stream.getRemoteIceCandidateList(),w=S.filter((function(t){return!!t.candidate&&(t.candidate.indexOf(y.ip)>=0||t.candidate.indexOf(y.address)>=0)&&t.candidate.indexOf(y.port)>=0})),y.raw=[],E=0,C=w;E<C.length;E++)x=C[E],y.raw.push(x.candidate);else y="ERROR: No active remote ICE candidate. Probably ICE-TCP is being used";return e({localCandidate:v,remoteCandidate:y}),[2]}}))}))}))},t.prototype.stopWebRtcStats=function(){this.webRtcStatsEnabled&&(clearInterval(this.webRtcStatsIntervalId),c.warn("WebRtc stats stopped for disposed stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId))},t.prototype.sendStats=function(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),n={headers:{"Content-type":"application/json"},body:JSON.stringify(e),method:"POST"},[4,fetch(t,n)];case 1:return i.sent(),[3,3];case 2:return r=i.sent(),c.error("sendStats error: "+JSON.stringify(r)),[3,3];case 3:return[2]}}))}))},t.prototype.sendStatsToHttpEndpoint=function(){return r(this,void 0,void 0,(function(){var t,e,n;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this.getCommonStats()];case 1:return t=r.sent(),e=this.generateJSONStatsResponse(t),[4,this.sendStats(this.POST_URL,e)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),c.log(n),[3,4];case 4:return[2]}}))}))},t.prototype.getCommonStats=function(){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(e){return[2,new Promise((function(e,n){return r(t,void 0,void 0,(function(){var t,r,o,a,s,l=this;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.stream.getRTCPeerConnection().getStats()];case 1:return t=i.sent(),r=this.getWebRtcStatsResponseOutline(),o=["framesReceived","framesDropped","framesSent","frameHeight","frameWidth"],a=["availableOutgoingBitrate","currentRoundTripTime"],t.forEach((function(t){var e=null!=t.mediaType?t.mediaType:t.kind,n=function(n,i){null!=t[i]&&null!=r[n]&&(!e&&o.indexOf(i)>-1&&(e="video"),null!=n&&null!=e&&null!=i&&null!=r[n][e]?r[n][e][i]=Number(t[i]):null!=n&&null!=i&&a.includes(i)&&(r[n][i]=Number(t[i])))};switch(t.type){case"outbound-rtp":n("outbound","bytesSent"),n("outbound","packetsSent"),n("outbound","framesEncoded"),n("outbound","nackCount"),n("outbound","firCount"),n("outbound","pliCount"),n("outbound","qpSum");break;case"inbound-rtp":n("inbound","bytesReceived"),n("inbound","packetsReceived"),n("inbound","packetsLost"),n("inbound","jitter"),n("inbound","framesDecoded"),n("inbound","nackCount"),n("inbound","firCount"),n("inbound","pliCount");break;case"track":n("inbound","jitterBufferDelay"),n("inbound","framesReceived"),n("outbound","framesDropped"),n("outbound","framesSent"),n(l.stream.isLocal()?"outbound":"inbound","frameHeight"),n(l.stream.isLocal()?"outbound":"inbound","frameWidth");break;case"candidate-pair":n("candidatepair","currentRoundTripTime"),n("candidatepair","availableOutgoingBitrate");break}})),(null===r||void 0===r?void 0:r.candidatepair)&&0!==Object.keys(r.candidatepair).length||delete r.candidatepair,[2,e(r)];case 2:return s=i.sent(),c.error("Error getting common stats: ",s),[2,n(s)];case 3:return[2]}}))}))}))]}))}))},t.prototype.generateJSONStatsResponse=function(t){return{"@timestamp":(new Date).toISOString(),participant_id:this.stream.connection.data,session_id:this.stream.session.sessionId,platform:o.getName(),platform_description:o.getDescription(),stream:"webRTC",webrtc_stats:t}},t.prototype.getWebRtcStatsResponseOutline=function(){return this.stream.isLocal()?{outbound:{audio:{},video:{}},candidatepair:{}}:{inbound:{audio:{},video:{}}}},t}();e.WebRtcStats=l},f91e:function(t,e,n){"use strict";var r=n("3fb5"),i=n("ada0").EventEmitter,o=n("ca34"),a=function(){};function s(t){a(t),i.call(this);var e=this,n=this.es=new o(t);n.onmessage=function(t){a("message",t.data),e.emit("message",decodeURI(t.data))},n.onerror=function(t){a("error",n.readyState,t);var r=2!==n.readyState?"network":"permanent";e._cleanup(),e._close(r)}}r(s,i),s.prototype.abort=function(){a("abort"),this._cleanup(),this._close("user")},s.prototype._cleanup=function(){a("cleanup");var t=this.es;t&&(t.onmessage=t.onerror=null,t.close(),this.es=null)},s.prototype._close=function(t){a("close",t);var e=this;setTimeout((function(){e.emit("close",null,t),e.removeAllListeners()}),200)},t.exports=s},f9f5:function(t,e,n){"use strict";(function(e){var r=n("f1f8"),i=n("2582"),o=n("26a0"),a=n("621f"),s=n("3fb5"),c=n("ada0").EventEmitter,l=function(){};function u(t){l(t);var n=this;c.call(this),r.polluteGlobalNamespace(),this.id="a"+i.string(6);var o=a.addQuery(t,"c="+encodeURIComponent(r.WPrefix+"."+this.id));e[r.WPrefix][this.id]=this._callback.bind(this),this._createScript(o),this.timeoutId=setTimeout((function(){l("timeout"),n._abort(new Error("JSONP script loaded abnormally (timeout)"))}),u.timeout)}s(u,c),u.prototype.abort=function(){if(l("abort"),e[r.WPrefix][this.id]){var t=new Error("JSONP user aborted read");t.code=1e3,this._abort(t)}},u.timeout=35e3,u.scriptErrorTimeout=1e3,u.prototype._callback=function(t){l("_callback",t),this._cleanup(),this.aborting||(t&&(l("message",t),this.emit("message",t)),this.emit("close",null,"network"),this.removeAllListeners())},u.prototype._abort=function(t){l("_abort",t),this._cleanup(),this.aborting=!0,this.emit("close",t.code,t.message),this.removeAllListeners()},u.prototype._cleanup=function(){if(l("_cleanup"),clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var t=this.script;t.parentNode.removeChild(t),t.onreadystatechange=t.onerror=t.onload=t.onclick=null,this.script=null}delete e[r.WPrefix][this.id]},u.prototype._scriptError=function(){l("_scriptError");var t=this;this.errorTimer||(this.errorTimer=setTimeout((function(){t.loadedOkay||t._abort(new Error("JSONP script loaded abnormally (onerror)"))}),u.scriptErrorTimeout))},u.prototype._createScript=function(t){l("_createScript",t);var n,r=this,a=this.script=e.document.createElement("script");if(a.id="a"+i.string(8),a.src=t,a.type="text/javascript",a.charset="UTF-8",a.onerror=this._scriptError.bind(this),a.onload=function(){l("onload"),r._abort(new Error("JSONP script loaded abnormally (onload)"))},a.onreadystatechange=function(){if(l("onreadystatechange",a.readyState),/loaded|closed/.test(a.readyState)){if(a&&a.htmlFor&&a.onclick){r.loadedOkay=!0;try{a.onclick()}catch(t){}}a&&r._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},"undefined"===typeof a.async&&e.document.attachEvent)if(o.isOpera())n=this.script2=e.document.createElement("script"),n.text="try{var a = document.getElementById('"+a.id+"'); if(a)a.onerror();}catch(x){};",a.async=n.async=!1;else{try{a.htmlFor=a.id,a.event="onclick"}catch(c){}a.async=!0}"undefined"!==typeof a.async&&(a.async=!0);var s=e.document.getElementsByTagName("head")[0];s.insertBefore(a,s.firstChild),n&&s.insertBefore(n,s.firstChild)},t.exports=u}).call(this,n("c8ba"))},fa28:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.FilterEvent=void 0;var i=n("8733"),o=function(t){function e(e,n,r){var i=t.call(this,!1,e,n)||this;return i.data=r,i}return r(e,t),e.prototype.callDefaultBehavior=function(){},e}(i.Event);e.FilterEvent=o},faa1:function(t,e,n){"use strict";var r,i="object"===typeof Reflect?Reflect:null,o=i&&"function"===typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};function a(t){console&&console.warn&&console.warn(t)}r=i&&"function"===typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!==t};function c(){c.init.call(this)}t.exports=c,t.exports.once=S,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var l=10;function u(t){if("function"!==typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function h(t){return void 0===t._maxListeners?c.defaultMaxListeners:t._maxListeners}function d(t,e,n,r){var i,o,s;if(u(n),o=t._events,void 0===o?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),void 0===s)s=o[e]=n,++t._eventsCount;else if("function"===typeof s?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),i=h(t),i>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=s.length,a(c)}return t}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function g(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"===typeof i?n?[i.listener||i]:[i]:n?y(i):m(i,i.length)}function v(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function b(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function y(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function S(t,e){return new Promise((function(n,r){function i(n){t.removeListener(e,o),r(n)}function o(){"function"===typeof t.removeListener&&t.removeListener("error",i),n([].slice.call(arguments))}E(t,e,o,{once:!0}),"error"!==e&&w(t,i,{once:!0})}))}function w(t,e,n){"function"===typeof t.on&&E(t,"error",e,n)}function E(t,e,n,r){if("function"===typeof t.on)r.once?t.once(e,n):t.on(e,n);else{if("function"!==typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function i(o){r.once&&t.removeEventListener(e,i),n(o)}))}}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(t){if("number"!==typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");l=t}}),c.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(t){if("number"!==typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},c.prototype.getMaxListeners=function(){return h(this)},c.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=i[t];if(void 0===c)return!1;if("function"===typeof c)o(c,this,e);else{var l=c.length,u=m(c,l);for(n=0;n<l;++n)o(u[n],this,e)}return!0},c.prototype.addListener=function(t,e){return d(this,t,e,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(t,e){return d(this,t,e,!0)},c.prototype.once=function(t,e){return u(e),this.on(t,p(this,t,e)),this},c.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,p(this,t,e)),this},c.prototype.removeListener=function(t,e){var n,r,i,o,a;if(u(e),r=this._events,void 0===r)return this;if(n=r[t],void 0===n)return this;if(n===e||n.listener===e)0===--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!==typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():b(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,a||e)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(t){var e,n,r;if(n=this._events,void 0===n)return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)i=o[r],"removeListener"!==i&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=n[t],"function"===typeof e)this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},c.prototype.listeners=function(t){return g(this,t,!0)},c.prototype.rawListeners=function(t){return g(this,t,!1)},c.listenerCount=function(t,e){return"function"===typeof t.listenerCount?t.listenerCount(e):v.call(t,e)},c.prototype.listenerCount=v,c.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},faac:function(t,e,n){(function(t,r){var i;
/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */(function(){"use strict";var o={function:!0,object:!0},a=o[typeof window]&&window||this,s=o[typeof e]&&e,c=o[typeof t]&&t&&!t.nodeType&&t,l=s&&c&&"object"==typeof r&&r;!l||l.global!==l&&l.window!==l&&l.self!==l||(a=l);var u=Math.pow(2,53)-1,h=/\bOpera/,d=Object.prototype,f=d.hasOwnProperty,p=d.toString;function g(t){return t=String(t),t.charAt(0).toUpperCase()+t.slice(1)}function v(t,e,n){var r={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return e&&n&&/^Win/i.test(t)&&!/^Windows Phone /i.test(t)&&(r=r[/[\d.]+$/.exec(t)])&&(t="Windows "+r),t=String(t),e&&n&&(t=t.replace(RegExp(e,"i"),n)),t=b(t.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),t}function m(t,e){var n=-1,r=t?t.length:0;if("number"==typeof r&&r>-1&&r<=u)while(++n<r)e(t[n],n,t);else y(t,e)}function b(t){return t=x(t),/^(?:webOS|i(?:OS|P))/.test(t)?t:g(t)}function y(t,e){for(var n in t)f.call(t,n)&&e(t[n],n,t)}function S(t){return null==t?g(t):p.call(t).slice(8,-1)}function w(t,e){var n=null!=t?typeof t[e]:"number";return!/^(?:boolean|number|string|undefined)$/.test(n)&&("object"!=n||!!t[e])}function E(t){return String(t).replace(/([ -])(?!$)/g,"$1?")}function C(t,e){var n=null;return m(t,(function(r,i){n=e(n,r,i,t)})),n}function x(t){return String(t).replace(/^ +| +$/g,"")}function O(t){var e=a,n=t&&"object"==typeof t&&"String"!=S(t);n&&(e=t,t=null);var r=e.navigator||{},i=r.userAgent||"";t||(t=i);var o,s,c=n?!!r.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(p.toString()),l="Object",u=n?l:"ScriptBridgingProxyObject",d=n?l:"Environment",f=n&&e.java?"JavaPackage":S(e.java),g=n?l:"RuntimeObject",m=/\bJava/.test(f)&&e.java,_=m&&S(e.environment)==d,T=m?"a":"α",k=m?"b":"β",I=e.document||{},P=e.operamini||e.opera,j=h.test(j=n&&P?P["[[Class]]"]:S(P))?j:P=null,M=t,D=[],R=null,A=t==i,N=A&&P&&"function"==typeof P.version&&P.version(),L=W([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),B=G(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),V=Y([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),F=z({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),U=H(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function W(e){return C(e,(function(e,n){return e||RegExp("\\b"+(n.pattern||E(n))+"\\b","i").exec(t)&&(n.label||n)}))}function z(e){return C(e,(function(e,n,r){return e||(n[V]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(V)]||RegExp("\\b"+E(r)+"(?:\\b|\\w*\\d)","i").exec(t))&&r}))}function G(e){return C(e,(function(e,n){return e||RegExp("\\b"+(n.pattern||E(n))+"\\b","i").exec(t)&&(n.label||n)}))}function H(e){return C(e,(function(e,n){var r=n.pattern||E(n);return!e&&(e=RegExp("\\b"+r+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=v(e,r,n.label||n)),e}))}function Y(e){return C(e,(function(e,n){var r=n.pattern||E(n);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=b(e[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}function X(e){return C(e,(function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))}function q(){return this.description||""}if(L&&(L=[L]),/\bAndroid\b/.test(U)&&!V&&(o=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(V=x(o[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),F&&!V?V=Y([F]):F&&V&&(V=V.replace(RegExp("^("+E(F)+")[-_.\\s]","i"),F+" ").replace(RegExp("^("+E(F)+")[-_.]?(\\w)","i"),F+" $2")),(o=/\bGoogle TV\b/.exec(V))&&(V=o[0]),/\bSimulator\b/i.test(t)&&(V=(V?V+" ":"")+"Simulator"),"Opera Mini"==B&&/\bOPiOS\b/.test(t)&&D.push("running in Turbo/Uncompressed mode"),"IE"==B&&/\blike iPhone OS\b/.test(t)?(o=O(t.replace(/like iPhone OS/,"")),F=o.manufacturer,V=o.product):/^iP/.test(V)?(B||(B="Safari"),U="iOS"+((o=/ OS ([\d_]+)/i.exec(t))?" "+o[1].replace(/_/g,"."):"")):"Konqueror"==B&&/^Linux\b/i.test(U)?U="Kubuntu":F&&"Google"!=F&&(/Chrome/.test(B)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(V))||/\bAndroid\b/.test(U)&&/^Chrome/.test(B)&&/\bVersion\//i.test(t)?(B="Android Browser",U=/\bAndroid\b/.test(U)?U:"Android"):"Silk"==B?(/\bMobi/i.test(t)||(U="Android",D.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&D.unshift("accelerated")):"UC Browser"==B&&/\bUCWEB\b/.test(t)?D.push("speed mode"):"PaleMoon"==B&&(o=/\bFirefox\/([\d.]+)\b/.exec(t))?D.push("identifying as Firefox "+o[1]):"Firefox"==B&&(o=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(U||(U="Firefox OS"),V||(V=o[1])):!B||(o=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(B))?(B&&!V&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(o+"/")+8))&&(B=null),(o=V||F||U)&&(V||F||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(U))&&(B=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(U)?U:o)+" Browser")):"Electron"==B&&(o=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&D.push("Chromium "+o),N||(N=X(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",E(B),"(?:Firefox|Minefield|NetFront)"])),(o=("iCab"==L&&parseFloat(N)>3?"WebKit":/\bOpera\b/.test(B)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(L)&&"WebKit"||!L&&/\bMSIE\b/i.test(t)&&("Mac OS"==U?"Tasman":"Trident")||"WebKit"==L&&/\bPlayStation\b(?! Vita\b)/i.test(B)&&"NetFront")&&(L=[o]),"IE"==B&&(o=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(B+=" Mobile",U="Windows Phone "+(/\+$/.test(o)?o:o+".x"),D.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(B="IE Mobile",U="Windows Phone 8.x",D.unshift("desktop mode"),N||(N=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=B&&"Trident"==L&&(o=/\brv:([\d.]+)/.exec(t))&&(B&&D.push("identifying as "+B+(N?" "+N:"")),B="IE",N=o[1]),A){if(w(e,"global"))if(m&&(o=m.lang.System,M=o.getProperty("os.arch"),U=U||o.getProperty("os.name")+" "+o.getProperty("os.version")),_){try{N=e.require("ringo/engine").version.join("."),B="RingoJS"}catch(J){(o=e.system)&&o.global.system==e.system&&(B="Narwhal",U||(U=o[0].os||null))}B||(B="Rhino")}else"object"==typeof e.process&&!e.process.browser&&(o=e.process)&&("object"==typeof o.versions&&("string"==typeof o.versions.electron?(D.push("Node "+o.versions.node),B="Electron",N=o.versions.electron):"string"==typeof o.versions.nw&&(D.push("Chromium "+N,"Node "+o.versions.node),B="NW.js",N=o.versions.nw)),B||(B="Node.js",M=o.arch,U=o.platform,N=/[\d.]+/.exec(o.version),N=N?N[0]:null));else S(o=e.runtime)==u?(B="Adobe AIR",U=o.flash.system.Capabilities.os):S(o=e.phantom)==g?(B="PhantomJS",N=(o=o.version||null)&&o.major+"."+o.minor+"."+o.patch):"number"==typeof I.documentMode&&(o=/\bTrident\/(\d+)/i.exec(t))?(N=[N,I.documentMode],(o=+o[1]+4)!=N[1]&&(D.push("IE "+N[1]+" mode"),L&&(L[1]=""),N[1]=o),N="IE"==B?String(N[1].toFixed(1)):N[0]):"number"==typeof I.documentMode&&/^(?:Chrome|Firefox)\b/.test(B)&&(D.push("masking as "+B+" "+N),B="IE",N="11.0",L=["Trident"],U="Windows");U=U&&b(U)}if(N&&(o=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(N)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(A&&r.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(R=/b/i.test(o)?"beta":"alpha",N=N.replace(RegExp(o+"\\+?$"),"")+("beta"==R?k:T)+(/\d+\+?/.exec(o)||"")),"Fennec"==B||"Firefox"==B&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(U))B="Firefox Mobile";else if("Maxthon"==B&&N)N=N.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(V))"Xbox 360"==V&&(U=null),"Xbox 360"==V&&/\bIEMobile\b/.test(t)&&D.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(B)&&(!B||V||/Browser|Mobi/.test(B))||"Windows CE"!=U&&!/Mobi/i.test(t))if("IE"==B&&A)try{null===e.external&&D.unshift("platform preview")}catch(J){D.unshift("embedded")}else(/\bBlackBerry\b/.test(V)||/\bBB10\b/.test(t))&&(o=(RegExp(V.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||N)?(o=[o,/BB10/.test(t)],U=(o[1]?(V=null,F="BlackBerry"):"Device Software")+" "+o[0],N=null):this!=y&&"Wii"!=V&&(A&&P||/Opera/.test(B)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==B&&/\bOS X (?:\d+\.){2,}/.test(U)||"IE"==B&&(U&&!/^Win/.test(U)&&N>5.5||/\bWindows XP\b/.test(U)&&N>8||8==N&&!/\bTrident\b/.test(t)))&&!h.test(o=O.call(y,t.replace(h,"")+";"))&&o.name&&(o="ing as "+o.name+((o=o.version)?" "+o:""),h.test(B)?(/\bIE\b/.test(o)&&"Mac OS"==U&&(U=null),o="identify"+o):(o="mask"+o,B=j?b(j.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(o)&&(U=null),A||(N=null)),L=["Presto"],D.push(o));else B+=" Mobile";(o=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(o=[parseFloat(o.replace(/\.(\d)$/,".0$1")),o],"Safari"==B&&"+"==o[1].slice(-1)?(B="WebKit Nightly",R="alpha",N=o[1].slice(0,-1)):N!=o[1]&&N!=(o[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(N=null),o[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==o[0]&&537.36==o[2]&&parseFloat(o[1])>=28&&"WebKit"==L&&(L=["Blink"]),A&&(c||o[1])?(L&&(L[1]="like Chrome"),o=o[1]||(o=o[0],o<530?1:o<532?2:o<532.05?3:o<533?4:o<534.03?5:o<534.07?6:o<534.1?7:o<534.13?8:o<534.16?9:o<534.24?10:o<534.3?11:o<535.01?12:o<535.02?"13+":o<535.07?15:o<535.11?16:o<535.19?17:o<536.05?18:o<536.1?19:o<537.01?20:o<537.11?"21+":o<537.13?23:o<537.18?24:o<537.24?25:o<537.36?26:"Blink"!=L?"27":"28")):(L&&(L[1]="like Safari"),o=o[0],o=o<400?1:o<500?2:o<526?3:o<533?4:o<534?"4+":o<535?5:o<537?6:o<538?7:o<601?8:o<602?9:o<604?10:o<606?11:o<608?12:"12"),L&&(L[1]+=" "+(o+="number"==typeof o?".x":/[.+]/.test(o)?"":"+")),"Safari"==B&&(!N||parseInt(N)>45)?N=o:"Chrome"==B&&/\bHeadlessChrome/i.test(t)&&D.unshift("headless")),"Opera"==B&&(o=/\bzbov|zvav$/.exec(U))?(B+=" ",D.unshift("desktop mode"),"zvav"==o?(B+="Mini",N=null):B+="Mobile",U=U.replace(RegExp(" *"+o+"$"),"")):"Safari"==B&&/\bChrome\b/.exec(L&&L[1])?(D.unshift("desktop mode"),B="Chrome Mobile",N=null,/\bOS X\b/.test(U)?(F="Apple",U="iOS 4.3+"):U=null):/\bSRWare Iron\b/.test(B)&&!N&&(N=X("Chrome")),N&&0==N.indexOf(o=/[\d.]+$/.exec(U))&&t.indexOf("/"+o+"-")>-1&&(U=x(U.replace(o,""))),U&&-1!=U.indexOf(B)&&!RegExp(B+" OS").test(U)&&(U=U.replace(RegExp(" *"+E(B)+" *"),"")),L&&!/\b(?:Avant|Nook)\b/.test(B)&&(/Browser|Lunascape|Maxthon/.test(B)||"Safari"!=B&&/^iOS/.test(U)&&/\bSafari\b/.test(L[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(B)&&L[1])&&(o=L[L.length-1])&&D.push(o),D.length&&(D=["("+D.join("; ")+")"]),F&&V&&V.indexOf(F)<0&&D.push("on "+F),V&&D.push((/^on /.test(D[D.length-1])?"":"on ")+V),U&&(o=/ ([\d.+]+)$/.exec(U),s=o&&"/"==U.charAt(U.length-o[0].length-1),U={architecture:32,family:o&&!s?U.replace(o[0],""):U,version:o?o[1]:null,toString:function(){var t=this.version;return this.family+(t&&!s?" "+t:"")+(64==this.architecture?" 64-bit":"")}}),(o=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(M))&&!/\bi686\b/i.test(M)?(U&&(U.architecture=64,U.family=U.family.replace(RegExp(" *"+o),"")),B&&(/\bWOW64\b/i.test(t)||A&&/\w(?:86|32)$/.test(r.cpuClass||r.platform)&&!/\bWin64; x64\b/i.test(t))&&D.unshift("32-bit")):U&&/^OS X/.test(U.family)&&"Chrome"==B&&parseFloat(N)>=39&&(U.architecture=64),t||(t=null);var $={};return $.description=t,$.layout=L&&L[0],$.manufacturer=F,$.name=B,$.prerelease=R,$.product=V,$.ua=t,$.version=B&&N,$.os=U||{architecture:null,family:null,version:null,toString:function(){return"null"}},$.parse=O,$.toString=q,$.version&&D.unshift(N),$.name&&D.unshift(B),U&&B&&(U!=String(U).split(" ")[0]||U!=B.split(" ")[0]&&!V)&&D.push(V?"("+U+")":"on "+U),D.length&&($.description=D.join(" ")),$}var _=O();a.platform=_,i=function(){return _}.call(e,n,e,t),void 0===i||(t.exports=i)}).call(this)}).call(this,n("62e4")(t),n("c8ba"))},fb6a:function(t,e,n){"use strict";var r=n("23e7"),i=n("da84"),o=n("e8b5"),a=n("68ee"),s=n("861d"),c=n("23cb"),l=n("07fa"),u=n("fc6a"),h=n("8418"),d=n("b622"),f=n("1dde"),p=n("f36a"),g=f("slice"),v=d("species"),m=i.Array,b=Math.max;r({target:"Array",proto:!0,forced:!g},{slice:function(t,e){var n,r,i,d=u(this),f=l(d),g=c(t,f),y=c(void 0===e?f:e,f);if(o(d)&&(n=d.constructor,a(n)&&(n===m||o(n.prototype))?n=void 0:s(n)&&(n=n[v],null===n&&(n=void 0)),n===m||void 0===n))return p(d,g,y);for(r=new(void 0===n?m:n)(b(y-g,0)),i=0;g<y;g++,i++)g in d&&h(r,i,d[g]);return r.length=i,r}})},fb6e:function(t,e){function n(t,e,n){var r={audio:!1,video:{mandatory:{chromeMediaSource:t?"screen":"desktop",maxWidth:window.screen.width>1920?window.screen.width:1920,maxHeight:window.screen.height>1080?window.screen.height:1080},optional:[]}};return n&&(r.audio={mandatory:{chromeMediaSource:t?"screen":"desktop"},optional:[]}),e&&(r.video.mandatory.chromeMediaSourceId=e,r.audio&&r.audio.mandatory&&(r.audio.mandatory.chromeMediaSourceId=e)),r}function r(t){i?i.isLoaded?t?t.forEach?i.contentWindow.postMessage({captureCustomSourceId:t},"*"):i.contentWindow.postMessage({captureSourceIdWithAudio:!0},"*"):i.contentWindow.postMessage({captureSourceId:!0},"*"):setTimeout((function(){r(t)}),100):o((function(){r(t)}))}var i;function o(t){i?t():(i=document.createElement("iframe"),i.onload=function(){i.isLoaded=!0,t()},i.src="https://openvidu.github.io/openvidu-screen-sharing-chrome-extension/",i.style.display="none",(document.body||document.documentElement).appendChild(i))}function a(){i?i.isLoaded?i.contentWindow.postMessage({getChromeExtensionStatus:!0},"*"):setTimeout(a,100):o(a)}window.getScreenId=function(t,e,i){function o(t){t.data&&(t.data.chromeMediaSourceId&&("PermissionDeniedError"===t.data.chromeMediaSourceId?e("permission-denied"):e(null,t.data.chromeMediaSourceId,n(null,t.data.chromeMediaSourceId,t.data.canRequestAudioTrack)),window.removeEventListener("message",o)),t.data.chromeExtensionStatus&&(e(t.data.chromeExtensionStatus,null,n(t.data.chromeExtensionStatus)),window.removeEventListener("message",o)))}-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveOrOpenBlob&&!navigator.msSaveBlob?navigator.mozGetUserMedia?e(null,"firefox",{video:{mozMediaSource:t,mediaSource:t}}):(window.addEventListener("message",o),i?setTimeout((function(){r(i)}),100):setTimeout(r,100)):e({video:!0})},window.getScreenConstraints=function(t){o((function(){getScreenId((function(e,n,r){r||(r={video:!0}),t(e,r.video)}))}))},window.getChromeExtensionStatus=function(t){function e(n){n.data&&n.data.chromeExtensionStatus&&(t(n.data.chromeExtensionStatus),window.removeEventListener("message",e))}navigator.mozGetUserMedia?t("installed-enabled"):(window.addEventListener("message",e),setTimeout(a,100))},e.getScreenId=window.getScreenId},fdd2:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VideoInsertMode=void 0,function(t){t["AFTER"]="AFTER",t["APPEND"]="APPEND",t["BEFORE"]="BEFORE",t["PREPEND"]="PREPEND",t["REPLACE"]="REPLACE"}(e.VideoInsertMode||(e.VideoInsertMode={}))}}]);
//# sourceMappingURL=about.42411b52.js.map